const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["../chunks/BxuyB31Y.js","../chunks/CizH5VPJ.js","../chunks/BlobBfBu.js","../chunks/CI59BmNm.js","../chunks/D_FouEMM.js","../chunks/vbI-l42I.js","../chunks/BX-sjYO1.js","../chunks/-C23ZK4E.js","../chunks/BBccnPWr.js","../chunks/iJn5IoH5.js","../chunks/BO950AV2.js","../chunks/OaA2MUvX.js","../chunks/DGloBz3m.js","../chunks/PPVm8Dsz.js"])))=>i.map(i=>d[i]);
import{_ as Ee}from"../chunks/PPVm8Dsz.js";import{c as le,a as l,f as p,t as Me}from"../chunks/vbI-l42I.js";import{o as ze}from"../chunks/D_FouEMM.js";import{B as q,p as Ae,c as o,s as n,t as j,b as Pe,d as c,g as a,C as x,D as I,r as i,n as E}from"../chunks/BlobBfBu.js";import{d as Oe,s as h}from"../chunks/OaA2MUvX.js";import{e as Be,s as oe,i as De,r as Ve,b as Ge}from"../chunks/BO950AV2.js";import{l as Re,s as Te,i as f}from"../chunks/BBccnPWr.js";import{a as B,s as He}from"../chunks/iJn5IoH5.js";import{p as Je,C as Le,W as Se}from"../chunks/vlDAd3Mk.js";import{C as Ue,l as We}from"../chunks/CT3Cgm5R.js";import{I as qe,U as Fe,r as ie,j as Ke,c as Qe,i as Xe}from"../chunks/BxuyB31Y.js";import{g as ne}from"../chunks/CizH5VPJ.js";import{v as Ye}from"../chunks/BYmFNSF7.js";import"../chunks/BX-sjYO1.js";import{s as Ze}from"../chunks/-C23ZK4E.js";function de(D,M){const V=Re(M,["children","$$slots","$$events","$$legacy"]);const w=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3"}],["path",{d:"M12 9v4"}],["path",{d:"M12 17h.01"}]];qe(D,Te({name:"triangle-alert"},()=>V,{get iconNode(){return w},children:(g,F)=>{var b=le(),G=q(b);Ze(G,M,"default",{}),l(g,b)},$$slots:{default:!0}}))}var ea=p('<span class="block text-xs mt-1 uppercase tracking-widest text-slate-500 font-black"> </span>'),aa=p('<div class="mt-4 px-3 py-1 bg-amber-500/10 border border-amber-500/20 rounded-full text-[10px] text-amber-500 font-bold uppercase tracking-wider animate-pulse flex items-center gap-2"><!> Aguardando o Mestre ficar online...</div>'),ta=p('<div class="mb-6 bg-red-500/10 border border-red-500/20 rounded-xl p-3 flex items-center gap-3"><!> <p class="text-red-400 text-sm font-bold"> </p></div>'),ra=p('<p class="text-red-400 text-xs mt-1">Senha incorreta.</p>'),sa=p('<div class="mb-6 bg-slate-950/50 p-4 rounded-xl border border-slate-800"><label for="campaign-pwd-input" class="block text-xs font-bold text-slate-500 uppercase tracking-widest mb-2 flex items-center gap-2"><div class="w-2 h-2 rounded-full bg-indigo-500 animate-pulse"></div> Senha Necessária</label> <input id="campaign-pwd-input" type="password" placeholder="Digite a senha da campanha..."/> <!></div>'),oa=p('<button><div class="w-8 h-8 rounded-full bg-slate-800 flex items-center justify-center text-xs font-bold"> </div> <div class="flex-1 text-left"><div class="font-bold text-sm"> </div> <div class="text-[10px] opacity-60"> </div></div> <!></button>'),ia=p("<div>Nenhum personagem encontrado.</div> <div>Crie um personagem primeiro!</div>",1),na=p('<div class="flex flex-col items-center gap-2"><!> <div class="text-amber-500 font-bold">Todos os seus personagens já estão em campanhas.</div> <div class="text-xs text-slate-500">Crie um novo personagem ou saia de uma campanha existente.</div></div>'),da=p('<div class="text-center py-8 text-slate-600 italic text-sm space-y-2"><!></div>'),la=p('<div class="w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"></div> Validando...',1),ca=p('<div class="w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"></div> Carregando...',1),va=p('<div class="min-h-screen bg-slate-950 flex items-center justify-center p-4"><div class="max-w-md w-full bg-slate-900 border border-slate-800 rounded-2xl p-8 shadow-2xl"><div class="flex flex-col items-center text-center mb-8"><div class="w-16 h-16 bg-indigo-600/20 rounded-full flex items-center justify-center text-indigo-400 mb-4 border border-indigo-500/30"><!></div> <h1 class="text-2xl font-bold text-white mb-2">Convite para Campanha</h1> <p class="text-slate-400">Você foi convidado para participar de <span class="text-indigo-400 font-bold"> </span> <!></p> <!></div> <!> <!> <div class="space-y-4 mb-8"><label for="char-selector" class="block text-xs font-bold text-slate-500 uppercase tracking-widest mb-2">Escolha seu Personagem</label> <div id="char-selector" class="space-y-2 max-h-60 overflow-y-auto custom-scrollbar pr-2"><!> <!></div></div> <div class="flex gap-3"><button class="flex-1 py-3 rounded-xl bg-slate-800 hover:bg-slate-700 text-white font-bold transition-all">Recusar</button> <button class="flex-1 py-3 rounded-xl bg-indigo-600 hover:bg-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed text-white font-bold transition-all shadow-lg shadow-indigo-900/20 flex items-center justify-center gap-2"><!></button></div></div></div> <!>',1);function ja(D,M){Ae(M,!0);const V=()=>B(Je,"$page",b),w=()=>B(Qe,"$character",b),g=()=>B(We,"$liveCharacters",b),F=()=>B(Xe,"$isGmOnline",b),[b,G]=He(),$=V().params.id;let y=I(()=>w().campaignName||"Buscando campanha..."),R=I(()=>w().gmName||"..."),z=I(()=>w().passwordHash),K=I(()=>g().filter(t=>!t.campaignId)),m=x(null),A=x(!1),C=x(""),k=x(!1),P=x(!1),_=x("");ze(()=>{$&&Ke($,!1)});async function ce(){if(c(_,""),!a(m)||!$)return;if(g().find(e=>e.id===a(m))?.campaignId){c(_,"Este personagem já está em uma campanha!");return}if(a(z)){if(!a(C)){c(k,!0);return}c(P,!0);const e=await Ye(a(C),a(z));if(c(P,!1),!e){c(k,!0);return}}c(k,!1),c(A,!0)}function ve(){if(!a(m)||!$)return;const t=g().find(e=>e.id===a(m));if(t){if(t.campaignId){c(_,"Este personagem já está em uma campanha!"),c(A,!1);return}Ee(async()=>{const{charactersMap:e}=await import("../chunks/BxuyB31Y.js").then(r=>r.N);return{charactersMap:e}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13]),import.meta.url).then(({charactersMap:e})=>{e.set(a(m),{...t,campaignId:$,campaignName:a(y),gmName:a(R),campaignApproval:"pending"}),ne(ie("/characters/[id]",{id:a(m)}))})}}var Q=va(),T=q(Q),X=o(T),H=o(X),J=o(H),pe=o(J);Fe(pe,{size:32}),i(J);var L=n(J,4),S=n(o(L)),me=o(S,!0);i(S);var fe=n(S,2);{var ue=t=>{var e=ea(),r=o(e);i(e),j(()=>h(r,`Mestre: ${a(R)??""}`)),l(t,e)};f(fe,t=>{a(R)!=="..."&&t(ue)})}i(L);var ge=n(L,2);{var be=t=>{var e=aa(),r=o(e);Se(r,{size:12}),E(),i(e),l(t,e)};f(ge,t=>{F()||t(be)})}i(H);var Y=n(H,2);{var _e=t=>{var e=ta(),r=o(e);de(r,{size:20,class:"text-red-500 mb-0.5"});var v=n(r,2),u=o(v,!0);i(v),i(e),j(()=>h(u,a(_))),l(t,e)};f(Y,t=>{a(_)&&t(_e)})}var Z=n(Y,2);{var xe=t=>{var e=sa(),r=n(o(e),2);Ve(r);var v=n(r,2);{var u=s=>{var d=ra();l(s,d)};f(v,s=>{a(k)&&s(u)})}i(e),j(()=>oe(r,1,`w-full bg-slate-900 border ${a(k)?"border-red-500":"border-slate-700"} rounded-lg p-3 text-white outline-none focus:border-indigo-500 transition-colors`)),Ge(r,()=>a(C),s=>c(C,s)),l(t,e)};f(Z,t=>{a(z)&&t(xe)})}var U=n(Z,2),ee=n(o(U),2),ae=o(ee);Be(ae,17,()=>a(K),De,(t,e)=>{var r=oa();r.__click=()=>{c(m,a(e).id,!0),c(_,"")};var v=o(r),u=o(v,!0);i(v);var s=n(v,2),d=o(s),W=o(d,!0);i(d);var se=n(d,2),Ne=o(se);i(se),i(s);var je=n(s,2);{var Ie=N=>{Le(N,{size:16,class:"text-indigo-400"})};f(je,N=>{a(m)===a(e).id&&N(Ie)})}i(r),j(N=>{oe(r,1,`w-full flex items-center gap-3 p-3 rounded-xl border transition-all ${a(m)===a(e).id?"bg-indigo-600/20 border-indigo-500 text-white":"bg-slate-950 border-slate-800 text-slate-400 hover:border-slate-700"}`),h(u,N),h(W,a(e).name),h(Ne,`Lvl ${a(e).level??""} • ${a(e).ancestry??""}`)},[()=>a(e).name.charAt(0)]),l(t,r)});var he=n(ae,2);{var we=t=>{var e=da(),r=o(e);{var v=s=>{var d=ia();E(2),l(s,d)},u=s=>{var d=na(),W=o(d);de(W,{size:24,class:"text-amber-500"}),E(4),i(d),l(s,d)};f(r,s=>{g().length===0?s(v):s(u,!1)})}i(e),l(t,e)};f(he,t=>{a(K).length===0&&t(we)})}i(ee),i(U);var te=n(U,2),re=o(te);re.__click=()=>ne(ie("/"));var O=n(re,2);O.__click=ce;var $e=o(O);{var ye=t=>{var e=la();E(),l(t,e)},Ce=t=>{var e=le(),r=q(e);{var v=s=>{var d=ca();E(),l(s,d)},u=s=>{var d=Me("Aceitar Convite");l(s,d)};f(r,s=>{a(y)==="Buscando campanha..."?s(v):s(u,!1)},!0)}l(t,e)};f($e,t=>{a(P)?t(ye):t(Ce,!1)})}i(O),i(te),i(X),i(T);var ke=n(T,2);{let t=I(()=>`Deseja entrar na campanha "${a(y)}" com o personagem "${g().find(e=>e.id===a(m))?.name}"?`);Ue(ke,{get isOpen(){return a(A)},title:"Confirmar Participação",get message(){return a(t)},onConfirm:ve,onCancel:()=>c(A,!1)})}j(()=>{h(me,a(y)),O.disabled=!a(m)||a(P)||!!a(z)&&!a(C)||a(y)==="Buscando campanha..."}),l(D,Q),Pe(),G()}Oe(["click"]);export{ja as component};
