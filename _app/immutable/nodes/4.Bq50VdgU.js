import"../chunks/DsnmJJEf.js";import{B as Nt,o as Je,k as d,p as ua,v as ba,j as c,q as t,x as a,u as s,z as ye,A as e,t as x,O as Na,w as k,y as gt,n as va,a2 as ca,at as pa}from"../chunks/CeF9Pysg.js";import{d as _a,s as r,o as Ga,g as Ta,e as ya}from"../chunks/s5ZUjNrT.js";import{l as ra,s as ia,i as f,p as Kt}from"../chunks/BO4Hk4Jc.js";import{e as Ve,s as st,i as Ot,$ as aa,r as ut,a as _e,h as Pa,g as xs,j as ps}from"../chunks/L5xVHH7A.js";import{a as xa,s as qt}from"../chunks/BuEkqW-1.js";import{p as ms}from"../chunks/DbIbR33v.js";import{d as Wa,m as Ia,j as fs,c as Qa,e as Zt,n as Ua,o as gs,q as wa,t as Ma,u as ja,b as at,v as Ya,f as Va,g as Da,x as hs,y as ys,z as ws}from"../chunks/COofWgfh.js";import{C as Ka,D as ka,l as ks,b as Fa,c as es,a as zs}from"../chunks/BO5uUsVl.js";import{b as $s,t as Sa,f as Ra}from"../chunks/DzIHbexc.js";import{U as ts,C as Za,W as as,r as ss}from"../chunks/DAnT4HIh.js";import{A as Cs,a as Os,b as Ea,B as js,T as Es,E as qa,M as Ms,G as ha,H as rs,C as Aa,R as Is,c as Ss,I as is,s as ns,d as os,L as Rs,S as ls,e as Ns,D as za,f as As}from"../chunks/CAdZkNEU.js";import{k as Ba}from"../chunks/53slW3xx.js";import{M as Ds,X as ma,P as ea,a as Xa,c as Ts,T as sa,b as Ps}from"../chunks/B9mfT_8k.js";import{C as ds,G as da,P as Ha,S as Us,a as Hs}from"../chunks/DbSKv2P5.js";import"../chunks/C3FPqVk7.js";import{I as na,s as oa}from"../chunks/axHpSoOd.js";import{b as vs}from"../chunks/CWVXqVlC.js";import{g as Ls}from"../chunks/BLp_9yxK.js";import{W as Fs}from"../chunks/7Z-uDSBK.js";function qs(Z,o){const n=ra(o,["children","$$slots","$$events","$$legacy"]);const ve=[["path",{d:"m6 9 6 6 6-6"}]];na(Z,ia({name:"chevron-down"},()=>n,{get iconNode(){return ve},children:(F,p)=>{var q=Nt(),X=Je(q);oa(X,o,"default",{}),d(F,q)},$$slots:{default:!0}}))}function Bs(Z,o){const n=ra(o,["children","$$slots","$$events","$$legacy"]);const ve=[["path",{d:"m18 15-6-6-6 6"}]];na(Z,ia({name:"chevron-up"},()=>n,{get iconNode(){return ve},children:(F,p)=>{var q=Nt(),X=Je(q);oa(X,o,"default",{}),d(F,q)},$$slots:{default:!0}}))}function Js(Z,o){const n=ra(o,["children","$$slots","$$events","$$legacy"]);const ve=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"}]];na(Z,ia({name:"copy"},()=>n,{get iconNode(){return ve},children:(F,p)=>{var q=Nt(),X=Je(q);oa(X,o,"default",{}),d(F,q)},$$slots:{default:!0}}))}function Gs(Z,o){const n=ra(o,["children","$$slots","$$events","$$legacy"]);const ve=[["path",{d:"M12 3q1 4 4 6.5t3 5.5a1 1 0 0 1-14 0 5 5 0 0 1 1-3 1 1 0 0 0 5 0c0-2-1.5-3-1.5-5q0-2 2.5-4"}]];na(Z,ia({name:"flame"},()=>n,{get iconNode(){return ve},children:(F,p)=>{var q=Nt(),X=Je(q);oa(X,o,"default",{}),d(F,q)},$$slots:{default:!0}}))}function Ws(Z,o){const n=ra(o,["children","$$slots","$$events","$$legacy"]);const ve=[["circle",{cx:"9",cy:"12",r:"1"}],["circle",{cx:"9",cy:"5",r:"1"}],["circle",{cx:"9",cy:"19",r:"1"}],["circle",{cx:"15",cy:"12",r:"1"}],["circle",{cx:"15",cy:"5",r:"1"}],["circle",{cx:"15",cy:"19",r:"1"}]];na(Z,ia({name:"grip-vertical"},()=>n,{get iconNode(){return ve},children:(F,p)=>{var q=Nt(),X=Je(q);oa(X,o,"default",{}),d(F,q)},$$slots:{default:!0}}))}function La(Z,o){const n=ra(o,["children","$$slots","$$events","$$legacy"]);const ve=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17"}]];na(Z,ia({name:"layers"},()=>n,{get iconNode(){return ve},children:(F,p)=>{var q=Nt(),X=Je(q);oa(X,o,"default",{}),d(F,q)},$$slots:{default:!0}}))}function cs(Z,o){const n=ra(o,["children","$$slots","$$events","$$legacy"]);const ve=[["path",{d:"m16 6 4 14"}],["path",{d:"M12 6v14"}],["path",{d:"M8 8v12"}],["path",{d:"M4 4v16"}]];na(Z,ia({name:"library"},()=>n,{get iconNode(){return ve},children:(F,p)=>{var q=Nt(),X=Je(q);oa(X,o,"default",{}),d(F,q)},$$slots:{default:!0}}))}function Qs(Z,o){const n=ra(o,["children","$$slots","$$events","$$legacy"]);const ve=[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3"}],["path",{d:"M21 21v.01"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7"}],["path",{d:"M3 12h.01"}],["path",{d:"M12 3h.01"}],["path",{d:"M12 16v.01"}],["path",{d:"M16 12h1"}],["path",{d:"M21 12v.01"}],["path",{d:"M12 21v-1"}]];na(Z,ia({name:"qr-code"},()=>n,{get iconNode(){return ve},children:(F,p)=>{var q=Nt(),X=Je(q);oa(X,o,"default",{}),d(F,q)},$$slots:{default:!0}}))}function Ja(Z,o){const n=ra(o,["children","$$slots","$$events","$$legacy"]);const ve=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7"}]];na(Z,ia({name:"save"},()=>n,{get iconNode(){return ve},children:(F,p)=>{var q=Nt(),X=Je(q);oa(X,o,"default",{}),d(F,q)},$$slots:{default:!0}}))}function us(Z,o){const n=ra(o,["children","$$slots","$$events","$$legacy"]);const ve=[["polyline",{points:"14.5 17.5 3 6 3 3 6 3 17.5 14.5"}],["line",{x1:"13",x2:"19",y1:"19",y2:"13"}],["line",{x1:"16",x2:"20",y1:"16",y2:"20"}],["line",{x1:"19",x2:"21",y1:"21",y2:"19"}],["polyline",{points:"14.5 6.5 18 3 21 3 21 6 17.5 9.5"}],["line",{x1:"5",x2:"9",y1:"14",y2:"18"}],["line",{x1:"7",x2:"4",y1:"17",y2:"20"}],["line",{x1:"3",x2:"5",y1:"19",y2:"21"}]];na(Z,ia({name:"swords"},()=>n,{get iconNode(){return ve},children:(F,p)=>{var q=Nt(),X=Je(q);oa(X,o,"default",{}),d(F,q)},$$slots:{default:!0}}))}function Vs(Z){let o=!1;return document.body&&(document.body.appendChild(Z),o=!0),{destroy(){o&&Z.parentNode&&Z.parentNode.removeChild(Z)}}}var Zs=c("<button> <!></button>"),Xs=c('<p class="text-xs text-slate-600 italic"> </p>'),Ys=c('<div class="text-xs leading-tight"><span class="text-red-400 font-bold"> </span> <span class="text-slate-400"> </span></div>'),Ks=c('<div class="space-y-1"></div>'),er=c('<div class="grid grid-cols-2 gap-2 max-h-[60vh] overflow-y-auto custom-scrollbar p-1"></div> <div class="mt-4 pt-3 border-t border-slate-800 flex flex-col gap-2"><div class="p-3 bg-slate-900/50 rounded-lg border border-slate-700/50 min-h-[60px]"><p class="text-[10px] text-slate-500 uppercase font-bold mb-1"> </p> <!></div> <div class="flex justify-end mt-2"><button class="bg-indigo-600 text-white px-4 py-2 rounded-xl font-bold text-sm shadow hover:bg-indigo-500 transition-colors w-full sm:w-auto"> </button></div></div>',1),tr=c("<div><!></div>");function ar(Z,o){ua(o,!0);const n=()=>qt(aa,"$t",ve),[ve,F]=xa();var p=Nt(),q=Je(p);{var X=i=>{var y=tr(),ae=t(y);{let Ue=ye(()=>n()("session.affliction_modal.title"));Ds(ae,{get isOpen(){return o.isOpen},get onClose(){return o.onClose},get title(){return a(Ue)},maxWidth:"max-w-md",children:(we,Ze)=>{var je=er(),Ee=Je(je);Ve(Ee,21,()=>Object.keys(Cs),Ot,(xe,Ae)=>{const _t=ye(()=>o.afflictions.includes(a(Ae)));var P=Zs();P.__click=()=>o.onToggle(a(Ae));var K=t(P),R=s(K);{var Ge=Ye=>{ds(Ye,{size:14,class:"text-red-400"})};f(R,Ye=>{a(_t)&&Ye(Ge)})}e(P),x(Ye=>{st(P,1,`flex items-center justify-between px-3 py-2 rounded-lg border text-xs font-bold transition-all ${a(_t)?"bg-red-500/20 border-red-500 text-red-100":"bg-slate-800 border-slate-700 text-slate-400 hover:bg-slate-750"}`),r(K,`${Ye??""} `)},[()=>n()(`character.afflictions.${a(Ae)}`)]),d(xe,P)}),e(Ee);var ue=s(Ee,2),Te=t(ue),ge=t(Te),Rt=t(ge,!0);e(ge);var zt=s(ge,2);{var Ft=xe=>{var Ae=Xs(),_t=t(Ae,!0);e(Ae),x(P=>r(_t,P),[()=>n()("session.affliction_modal.none_selected")]),d(xe,Ae)},ke=xe=>{var Ae=Ks();Ve(Ae,21,()=>o.afflictions,Ot,(_t,P)=>{var K=Ys(),R=t(K),Ge=t(R);e(R);var Ye=s(R,2),vt=t(Ye,!0);e(Ye),e(K),x(($t,it)=>{r(Ge,`${$t??""}:`),r(vt,it)},[()=>n()(`character.afflictions.${a(P)}`),()=>n()(`sofww.afflictions.${a(P).toLowerCase().replace(" ","_")}.effect`)]),d(_t,K)}),e(Ae),d(xe,Ae)};f(zt,xe=>{o.afflictions.length===0?xe(Ft):xe(ke,!1)})}e(Te);var Ne=s(Te,2),Xe=t(Ne);Xe.__click=function(...xe){o.onClose?.apply(this,xe)};var rt=t(Xe,!0);e(Xe),e(Ne),e(ue),x((xe,Ae)=>{r(Rt,xe),r(rt,Ae)},[()=>n()("session.affliction_modal.effects"),()=>n()("session.affliction_modal.done")]),d(we,je)},$$slots:{default:!0}})}e(y),Os(y,Ue=>Vs?.(Ue)),d(i,y)};f(q,i=>{o.isOpen&&i(X)})}d(Z,p),ba(),F()}_a(["click"]);var sr=c('<div class="absolute top-0 right-0 bg-gradient-to-l from-yellow-600/20 to-transparent border-l border-b border-yellow-500/30 text-yellow-500 text-[9px] font-black tracking-widest px-3 py-1 rounded-bl-xl z-20 uppercase shadow-[0_0_10px_rgba(234,179,8,0.2)]"> </div>'),rr=c('<div class="absolute inset-0 bg-red-950/40 animate-pulse z-0 pointer-events-none"></div>'),ir=c('<span class="text-[9px] font-black bg-red-950/40 text-red-500 px-1.5 py-0.5 rounded border border-red-900/30 uppercase tracking-wider flex-shrink-0"> </span>'),nr=c("<button><!></button>"),or=c('<button class="w-7 h-7 flex items-center justify-center rounded bg-slate-800/50 text-slate-600 hover:text-red-400 hover:bg-red-950/30 border border-slate-700/50 transition-colors"><!></button>'),lr=c('<div><div class="absolute inset-0 bg-gradient-to-b from-white/20 to-transparent"></div></div>'),dr=c('<div class="absolute inset-0 bg-gradient-to-r from-emerald-500/20 via-emerald-400/30 to-emerald-500/20 z-10"><div class="absolute inset-0 bg-gradient-to-b from-white/10 to-transparent"></div></div>'),vr=c('<div class="absolute inset-0 flex items-center justify-center pointer-events-none z-20"><span class="text-[9px] font-black uppercase text-white drop-shadow-[0_1px_1px_rgba(0,0,0,0.8)] tracking-widest leading-none mt-0.5"> </span></div>'),cr=c('<div class="absolute inset-0 flex items-center justify-center pointer-events-none z-20"><span class="text-[9px] font-black uppercase text-white drop-shadow-[0_1px_1px_rgba(0,0,0,0.8)] tracking-widest leading-none mt-0.5"> </span></div>'),ur=c('<div class="flex flex-col items-center justify-between bg-cyan-950/20 border border-cyan-500/30 rounded-lg p-1.5 w-[4.5rem] h-[3.75rem] shadow-sm"><span class="text-[9px] font-black text-cyan-400 uppercase tracking-wider mb-0.5"> </span> <span class="text-xl font-bold text-white font-mono leading-none"> </span></div>'),br=c('<button class="text-[9px] bg-red-500/10 text-red-400 px-1.5 py-0.5 rounded border border-red-500/20 hover:bg-red-500/20 hover:border-red-500/40 transition-all flex items-center gap-1 group/btn"> <!></button>'),_r=c('<div class="bg-slate-900/50 p-2 rounded border border-slate-800/50 text-center"><span class="text-[9px] text-slate-500 uppercase font-black block mb-0.5"> </span> <div class="text-white font-bold font-mono text-lg leading-none"> </div> <div> </div></div>'),xr=c('<div class="grid grid-cols-2 gap-4 mb-4"><div class="p-3 rounded-xl bg-purple-950/20 border border-purple-500/30 flex justify-between items-center group/ins"><div><span class="text-[9px] text-purple-400 uppercase font-black block"> </span> <span class="text-white font-bold text-lg font-mono leading-none"> </span></div> <!></div> <div class="p-3 rounded-xl bg-red-950/20 border border-red-500/30 flex justify-between items-center group/cor"><div><span class="text-[9px] text-red-400 uppercase font-black block"> </span> <span class="text-white font-bold text-lg font-mono leading-none"> </span></div> <!></div></div>'),pr=c("<!> ",1),mr=c('<div><div class="text-emerald-500 text-[10px] font-black uppercase mb-2 flex items-center gap-2"> <span class="h-px flex-1 bg-current opacity-20"></span></div> <div class="flex flex-wrap gap-2"></div></div>'),fr=c('<div class="text-sm bg-slate-900/30 p-2 rounded border border-slate-800/30"><span class="font-bold text-slate-300"> </span> <span class="text-slate-400 text-xs block mt-1 leading-relaxed"> </span></div>'),gr=c('<div><div> <span class="h-px flex-1 bg-current opacity-20"></span></div> <div class="grid gap-2"></div></div>'),hr=c('<div class="border-t border-slate-800/50 bg-slate-950/30 p-4"><div class="mb-4"><div class="text-slate-500 font-bold uppercase text-[10px] mb-2 flex items-center gap-2"><span> </span> <div class="h-px flex-1 bg-slate-800"></div></div> <div class="grid grid-cols-4 gap-2"></div></div> <!> <div class="grid grid-cols-2 gap-4 mb-4"><div class="p-2 rounded bg-slate-900/50 border border-slate-800/50 flex flex-col items-center"><span class="text-[9px] text-slate-500 uppercase font-black"> </span> <span class="text-white font-bold"> </span></div> <div class="p-2 rounded bg-slate-900/50 border border-slate-800/50 flex flex-col items-center"><span class="text-[9px] text-slate-500 uppercase font-black"> </span> <span class="text-white font-bold"> </span></div></div> <div class="space-y-4"><!> <!></div></div>'),yr=c('<div><!> <!> <div class="relative z-10 p-4"><div class="flex items-start gap-4 mb-3"><div class="relative flex-shrink-0"><div><!></div> <button><!></button></div> <div class="flex-1 min-w-0"><div class="flex justify-between items-start mb-1"><div class="flex flex-col min-w-0 mr-2"><div class="flex items-center gap-2"><h3> </h3> <!></div></div> <div class="flex gap-1 flex-shrink-0"><button class="w-7 h-7 flex items-center justify-center rounded bg-slate-800 text-slate-500 hover:text-white hover:bg-slate-700 border border-slate-700/50 transition-colors"><!></button> <!></div></div>  <div class="relative w-full h-3.5 sm:h-4 bg-slate-950 rounded-full border border-white/5 overflow-hidden shadow-inner group-hover:border-white/20 transition-all mb-2"><div></div> <!> <!> <!></div> <div class="flex flex-col sm:flex-row gap-3"><div class="flex items-start gap-1.5"><div class="flex flex-col items-center justify-between bg-slate-900 border border-slate-700 rounded-lg p-1.5 w-[4.5rem] h-[3.75rem] shadow-sm"><span class="text-[9px] font-black text-slate-400 uppercase tracking-wider mb-0.5"> </span> <span class="text-xl font-bold text-white font-mono leading-none"> </span></div> <div class="flex flex-col items-center justify-between bg-red-950/30 border border-red-900/50 rounded-lg p-1.5 w-[4.5rem] h-[3.75rem] shadow-sm relative group/dmg"><span class="text-[9px] font-black text-red-400 uppercase tracking-wider mb-0.5"> </span> <input type="number" class="w-full bg-transparent text-center text-white font-mono font-bold text-xl focus:outline-none p-0 leading-none placeholder-red-800"/> <span class="absolute -top-1 -right-1 flex h-2 w-2 opacity-0 group-hover/dmg:opacity-100 transition-opacity"><span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-red-400 opacity-75"></span> <span class="relative inline-flex rounded-full h-2 w-2 bg-red-500"></span></span></div> <div><span> </span> <div class="flex items-baseline gap-0.5 justify-center w-full"><input type="number" class="w-full bg-transparent text-right text-white font-mono font-bold text-xl focus:outline-none p-0 leading-none"/> <span class="text-[10px] text-slate-500 font-mono self-end mb-0.5 opacity-70"> </span></div></div> <!></div> <div class="flex flex-wrap gap-1.5 items-center flex-1"><!> <button class="text-[10px] sm:text-[9px] font-bold text-slate-500 hover:text-indigo-400 px-1.5 py-0.5 rounded border border-transparent hover:border-indigo-500/30 hover:bg-indigo-500/10 transition-all flex items-center gap-1 whitespace-nowrap"><!> </button></div></div></div></div></div>  <!> <!></div>');function wr(Z,o){ua(o,!0);const n=()=>qt(aa,"$t",ve),[ve,F]=xa();let p=Kt(o,"updateEnemy",3,(v,b)=>{}),q=Kt(o,"updatePlayer",3,(v,b)=>{}),X=Kt(o,"removeFromCombat",3,v=>{}),i=ye(()=>o.entity.type==="player"),y=ye(()=>o.entity.system==="sofdl"),ae=ye(()=>o.entity.damage||0),Ue=ye(()=>o.entity.normalHealth||o.entity.health||10),we=ye(()=>o.entity.currentHealth??a(Ue)),Ze=ye(()=>a(ae)>=a(we)),je=ye(()=>a(ae)>=a(we)/2&&!a(Ze)),Ee=ye(()=>a(we)>0?Math.min(100,Math.max(0,a(ae)/a(we)*100)):100),ue=gt(!1),Te=gt(!1);Na(()=>{const v=o.entity.afflictions||[],b=v.includes("Incapacitated");if(a(Ze)&&!b){const G={afflictions:[...v,"Incapacitated"]};o.entity.type==="player"?ge(G):p()(o.entity.instanceId,G)}else if(!a(Ze)&&b){const G={afflictions:v.filter(ee=>ee!=="Incapacitated")};o.entity.type==="player"?ge(G):p()(o.entity.instanceId,G)}});function ge(v){if(o.entity.type!=="player")return;const b=Wa.get(o.entity.id);b&&Wa.set(o.entity.id,{...b,...v}),q()(o.entity.id,v),Ia({id:o.entity.id,...v})}function Rt(v){const b=parseInt(v.target.value);if(isNaN(b))return;const G={damage:Math.max(0,b)};o.entity.type==="player"?ge(G):p()(o.entity.instanceId,G)}function zt(v){const b=parseInt(v.target.value);if(isNaN(b))return;const m=Math.max(0,b);let G=a(ae);m<a(ae)&&(G=m);const ee={currentHealth:m,damage:G};o.entity.type==="player"?ge(ee):p()(o.entity.instanceId,ee)}function Ft(){const v=!o.entity.acted;o.entity.type==="player"?ge({acted:v}):p()(o.entity.instanceId,{acted:v})}function ke(){o.entity.type==="player"&&ge({initiative:!o.entity.initiative})}function Ne(v){const b=o.entity.afflictions||[],G={afflictions:b.includes(v)?b.filter(ee=>ee!==v):[...b,v]};o.entity.type==="player"?ge(G):p()(o.entity.instanceId,G)}var Xe=yr(),rt=t(Xe);{var xe=v=>{var b=sr(),m=t(b,!0);e(b),x(G=>r(m,G),[()=>n()("session.combat_card.initiative")]),d(v,b)};f(rt,v=>{a(i)&&o.entity.initiative&&v(xe)})}var Ae=s(rt,2);{var _t=v=>{var b=rr();d(v,b)};f(Ae,v=>{a(Ze)&&v(_t)})}var P=s(Ae,2),K=t(P),R=t(K),Ge=t(R),Ye=t(Ge);Ba(Ye,()=>o.entity.imageUrl,v=>{{let b=ye(()=>o.entity.name.charAt(0));Ea(v,{get hash(){return o.entity.imageUrl},get alt(){return o.entity.name},size:"custom",get fallbackText(){return a(b)}})}}),e(Ge);var vt=s(Ge,2);vt.__click=Ft;var $t=t(vt);{var it=v=>{Xa(v,{size:14,class:""})},At=v=>{var b=Nt(),m=Je(b);{var G=fe=>{ds(fe,{size:14})},ee=fe=>{us(fe,{size:14})};f(m,fe=>{o.entity.acted?fe(G):fe(ee,!1)},!0)}d(v,b)};f($t,v=>{a(Ze)?v(it):v(At,!1)})}e(vt),e(R);var ht=s(R,2),se=t(ht),ce=t(se),Ke=t(ce),He=t(Ke),bt=t(He,!0);e(He);var nt=s(He,2);{var ie=v=>{var b=ir(),m=t(b);e(b),x(()=>r(m,`Dif ${o.entity.difficulty??""}`)),d(v,b)};f(nt,v=>{a(i)||v(ie)})}e(Ke),e(ce);var Fe=s(ce,2),E=t(Fe);E.__click=()=>k(ue,!a(ue));var ze=t(E);{var me=v=>{Bs(v,{size:14})},Le=v=>{qs(v,{size:14})};f(ze,v=>{a(ue)?v(me):v(Le,!1)})}e(E);var Se=s(E,2);{var xt=v=>{var b=nr();b.__click=ke;var m=t(b);Gs(m,{size:14}),e(b),x(G=>{st(b,1,`w-7 h-7 flex items-center justify-center rounded transition-all ${o.entity.initiative?"bg-yellow-500 text-yellow-950 shadow-lg shadow-yellow-500/20":"bg-slate-800 text-slate-500 hover:text-white hover:bg-slate-700"}`),_e(b,"title",G)},[()=>n()("session.combat_card.initiative")]),d(v,b)},et=v=>{var b=or();b.__click=()=>X()(o.entity.instanceId);var m=t(b);ma(m,{size:14}),e(b),d(v,b)};f(Se,v=>{a(i)?v(xt):v(et,!1)})}e(Fe),e(se);var tt=s(se,2),Ct=t(tt),Et=s(Ct,2);{var Dt=v=>{var b=lr();x(()=>{st(b,1,`absolute top-0 left-0 h-full transition-all duration-500 ease-out z-10
                            ${a(Ze)?"bg-gradient-to-r from-red-600 via-red-500 to-rose-500 animate-pulse":a(Ee)>=80?"bg-gradient-to-r from-red-600 to-rose-500":a(je)?"bg-gradient-to-r from-amber-600 to-orange-500":"bg-gradient-to-r from-orange-500 to-amber-400"}`),xs(b,`width: ${a(Ee)??""}%`)}),d(v,b)};f(Et,v=>{a(Ee)>0&&v(Dt)})}var Pt=s(Et,2);{var z=v=>{var b=dr();d(v,b)};f(Pt,v=>{a(ae)===0&&v(z)})}var S=s(Pt,2);{var D=v=>{var b=vr(),m=t(b),G=t(m,!0);e(m),e(b),x(ee=>r(G,ee),[()=>n()("session.combat_card.incapacitated")]),d(v,b)},$e=v=>{var b=Nt(),m=Je(b);{var G=ee=>{var fe=cr(),Be=t(fe),mt=t(Be,!0);e(Be),e(fe),x(ft=>r(mt,ft),[()=>n()("session.combat_card.injured")]),d(ee,fe)};f(m,ee=>{a(je)&&ee(G)},!0)}d(v,b)};f(S,v=>{a(Ze)?v(D):v($e,!1)})}e(tt);var ct=s(tt,2),qe=t(ct),ot=t(qe),yt=t(ot),Mt=t(yt,!0);e(yt);var Pe=s(yt,2),kt=t(Pe,!0);e(Pe),e(ot);var N=s(ot,2),j=t(N),A=t(j,!0);e(j);var ne=s(j,2);ut(ne),ne.__input=Rt,va(2),e(N);var I=s(N,2),J=t(I),Y=t(J,!0);e(J);var he=s(J,2),de=t(he);ut(de),de.__input=zt;var re=s(de,2),T=t(re);e(re),e(he),e(I);var Ce=s(I,2);{var be=v=>{var b=ur(),m=t(b),G=t(m,!0);e(m);var ee=s(m,2),fe=t(ee,!0);e(ee),e(b),x(Be=>{r(G,Be),r(fe,o.entity.perception||10)},[()=>n()("sofdl.attributes.perception")]),d(v,b)};f(Ce,v=>{a(y)&&v(be)})}e(qe);var Me=s(qe,2),dt=t(Me);Ve(dt,17,()=>o.entity.afflictions||[],Ot,(v,b)=>{var m=br();m.__click=()=>Ne(a(b));var G=t(m),ee=s(G);ma(ee,{size:8,class:"opacity-50 group-hover/btn:opacity-100"}),e(m),x(()=>r(G,`${a(b)??""} `)),d(v,m)});var pt=s(dt,2);pt.__click=()=>k(Te,!0);var wt=t(pt);ea(wt,{size:10});var lt=s(wt);e(pt),e(Me),e(ct),e(ht),e(K),e(P);var It=s(P,2);{var Ut=v=>{var b=hr(),m=t(b),G=t(m),ee=t(G),fe=t(ee,!0);e(ee),va(2),e(G);var Be=s(G,2);Ve(Be,21,()=>a(y)?["strength","agility","intellect","will"]:["str","agi","int","wil"],Ot,(Q,M)=>{const oe=ye(()=>a(y)?o.entity.attributes?.[a(M)]??10:o.entity.stats?.[a(M)]??o.entity.attributes?.[a(M)]??10),pe=ye(()=>a(oe)-10);var U=_r(),V=t(U),Ie=t(V,!0);e(V);var H=s(V,2),Re=t(H,!0);e(H);var h=s(H,2),g=t(h);e(h),e(U),x(B=>{r(Ie,B),r(Re,a(oe)),st(h,1,`text-[9px] font-bold ${a(pe)>=0?"text-emerald-500":"text-red-500"}`),r(g,`${a(pe)>=0?"+":""}${a(pe)??""}`)},[()=>a(y)?a(M).slice(0,3):a(M)]),d(Q,U)}),e(Be),e(m);var mt=s(m,2);{var ft=Q=>{var M=xr(),oe=t(M),pe=t(oe),U=t(pe),V=t(U,!0);e(U);var Ie=s(U,2),H=t(Ie,!0);e(Ie),e(pe);var Re=s(pe,2);js(Re,{size:20,class:"text-purple-500/30 group-hover/ins:text-purple-500 transition-colors"}),e(oe);var h=s(oe,2),g=t(h),B=t(g),C=t(B,!0);e(B);var L=s(B,2),le=t(L,!0);e(L),e(g);var Oe=s(g,2);Xa(Oe,{size:20,class:"text-red-500/30 group-hover/cor:text-red-500 transition-colors"}),e(h),e(M),x((We,Qe)=>{r(V,We),r(H,o.entity.insanity||0),r(C,Qe),r(le,o.entity.corruption||0)},[()=>n()("sofdl.attributes.insanity"),()=>n()("sofdl.attributes.corruption")]),d(Q,M)};f(mt,Q=>{a(y)&&Q(ft)})}var Ht=s(mt,2),St=t(Ht),Lt=t(St),Tt=t(Lt,!0);e(Lt);var Gt=s(Lt,2),Wt=t(Gt,!0);e(Gt),e(St);var Qt=s(St,2),l=t(Qt),u=t(l,!0);e(l);var _=s(l,2),w=t(_,!0);e(_),e(Qt),e(Ht);var te=s(Ht,2),$=t(te);{var O=Q=>{var M=mr(),oe=t(M),pe=t(oe);va(),e(oe);var U=s(oe,2);Ve(U,21,()=>o.entity.senses,Ot,(V,Ie)=>{const H=ye(()=>{const[g,B]=a(Ie).split(":");return{key:g,val:B}}),Re=ye(()=>n()(`character.senses.list.${a(H).key}`)+(a(H).val?` ${a(H).val}`:"")),h=ye(()=>n()(`character.senses.descriptions.${a(H).key}`));Es(V,{get text(){return a(h)},class:"text-xs bg-emerald-950/30 text-emerald-200 px-3 py-1.5 rounded border border-emerald-900/50 font-bold flex items-center gap-2 cursor-help whitespace-nowrap",children:(g,B)=>{var C=pr(),L=Je(C);qa(L,{size:12,class:"text-emerald-500 flex-shrink-0"});var le=s(L);x(()=>r(le,` ${a(Re)??""}`)),d(g,C)},$$slots:{default:!0}})}),e(U),e(M),x(V=>r(pe,`${V??""} `),[()=>n()("character.senses.title")]),d(Q,M)};f($,Q=>{o.entity.senses&&o.entity.senses.length>0&&Q(O)})}var W=s($,2);Ve(W,16,()=>[{key:"traits",label:"Traços",color:"text-amber-500"},{key:"actions",label:"Ações",color:"text-red-400"},{key:"reactions",label:"Reações",color:"text-indigo-400"},{key:"end_of_round",label:"Fim da Rodada",color:"text-emerald-400"}],Ot,(Q,M)=>{var oe=Nt(),pe=Je(oe);{var U=V=>{var Ie=gr(),H=t(Ie),Re=t(H);va(),e(H);var h=s(H,2);Ve(h,21,()=>o.entity[M.key],Ot,(g,B)=>{var C=fr(),L=t(C),le=t(L,!0);e(L);var Oe=s(L,2),We=t(Oe,!0);e(Oe),e(C),x(()=>{r(le,a(B).name),r(We,a(B).description||a(B).effect)}),d(g,C)}),e(h),e(Ie),x(()=>{st(H,1,`${M.color??""} text-[10px] font-black uppercase mb-2 flex items-center gap-2`),r(Re,`${M.label??""} `)}),d(V,Ie)};f(pe,V=>{o.entity[M.key]&&o.entity[M.key].length>0&&V(U)})}d(Q,oe)}),e(te),e(b),x((Q,M,oe)=>{r(fe,Q),r(Tt,M),r(Wt,o.entity.size||1),r(u,oe),r(w,o.entity.speed||10)},[()=>n()("session.combat_card.attributes"),()=>n()("session.combat_card.size"),()=>n()("session.combat_card.speed")]),d(v,b)};f(It,v=>{a(ue)&&v(Ut)})}var Bt=s(It,2);{let v=ye(()=>o.entity.afflictions||[]);ar(Bt,{get isOpen(){return a(Te)},onClose:()=>k(Te,!1),get afflictions(){return a(v)},onToggle:Ne})}e(Xe),x((v,b,m,G,ee)=>{st(Xe,1,`group relative overflow-hidden transition-all duration-300 rounded-2xl border ${a(i)?"bg-slate-900/80 border-indigo-500/30 hover:border-indigo-500/50 hover:shadow-indigo-900/20":"bg-slate-950/80 border-red-900/30 hover:border-red-800/50 hover:shadow-red-900/10"} shadow-lg backdrop-blur-sm`),st(Ge,1,`w-14 h-14 rounded-2xl overflow-hidden border-2 shadow-xl transition-transform group-hover:scale-105 ${a(Ze)?"border-red-600 grayscale brightness-50":a(i)?"border-indigo-500/50":"border-red-900/50"}`),st(vt,1,`absolute -bottom-2 -right-2 w-7 h-7 rounded-lg flex items-center justify-center border shadow-lg transition-all hover:scale-110 z-20 ${o.entity.acted?"bg-slate-800 border-slate-600 text-slate-500":a(i)?"bg-indigo-600 border-indigo-400 text-white":"bg-red-600 border-red-400 text-white"}`),_e(vt,"title",v),st(He,1,`text-base font-bold truncate leading-snug ${a(i)?"text-white":"text-red-100 font-serif tracking-wide"}`),r(bt,o.entity.name),st(Ct,1,`absolute inset-0 w-full ${a(ae)===0?"bg-emerald-900/20":"bg-slate-900/50"}`),r(Mt,b),r(kt,o.entity.defense||10),r(A,m),Pa(ne,a(ae)),st(I,1,`flex flex-col items-center justify-between border rounded-lg p-1.5 w-[5.5rem] h-[3.75rem] shadow-sm relative transition-colors ${a(Ze)?"bg-red-950/50 border-red-500":a(je)?"bg-orange-950/30 border-orange-500":"bg-emerald-950/30 border-emerald-900/50"}`),st(J,1,`text-[9px] font-black uppercase tracking-wider mb-0.5 ${a(Ze)?"text-red-400":a(je)?"text-orange-400":"text-emerald-400"}`),r(Y,G),Pa(de,a(we)),r(T,`/${a(Ue)??""}`),r(lt,` ${ee??""}`)},[()=>o.entity.acted?n()("session.combat_card.acted"):n()("session.combat_card.act"),()=>n()("session.combat_card.defense"),()=>n()("session.combat_card.damage"),()=>n()("session.combat_card.health"),()=>n()("session.combat_card.add_affliction")]),d(Z,Xe),ba(),F()}_a(["click","input"]);function kr(Z,{from:o,to:n},ve={}){var{delay:F=0,duration:p=ke=>Math.sqrt(ke)*120,easing:q=Ts}=ve,X=getComputedStyle(Z),i=X.transform==="none"?"":X.transform,[y,ae]=X.transformOrigin.split(" ").map(parseFloat);y/=Z.clientWidth,ae/=Z.clientHeight;var Ue=zr(Z),we=Z.clientWidth/n.width/Ue,Ze=Z.clientHeight/n.height/Ue,je=o.left+o.width*y,Ee=o.top+o.height*ae,ue=n.left+n.width*y,Te=n.top+n.height*ae,ge=(je-ue)*we,Rt=(Ee-Te)*Ze,zt=o.width/n.width,Ft=o.height/n.height;return{delay:F,duration:typeof p=="function"?p(Math.sqrt(ge*ge+Rt*Rt)):p,easing:q,css:(ke,Ne)=>{var Xe=Ne*ge,rt=Ne*Rt,xe=ke+Ne*zt,Ae=ke+Ne*Ft;return`transform: ${i} translate(${Xe}px, ${rt}px) scale(${xe}, ${Ae});`}}}function zr(Z){if("currentCSSZoom"in Z)return Z.currentCSSZoom;for(var o=Z,n=1;o!==null;)n*=+getComputedStyle(o).zoom,o=o.parentElement;return n}function $r(Z,o=1,n=0){const ve=[];let F=0;for(let i=0;i<o;i++){const y=Math.floor(Math.random()*Z)+1;ve.push(y),F+=y}let p=`${o}d${Z}`,q=[],X=0;if(n!==0)if(Z===20){const i=Math.abs(n);for(let ae=0;ae<i;ae++)q.push(Math.floor(Math.random()*6)+1);const y=Math.max(...q);n>0?(X=y,F+=y,p+=` + ${y} [Boon]`):(X=-y,F-=y,p+=` - ${y} [Bane]`)}else X=n,F+=n,p+=n>0?` + ${n}`:` - ${Math.abs(n)}`;return{total:F,results:ve,bonusRolls:q,formula:p,crit:Z===20&&ve.includes(20),modifierTotal:X}}function Cr(Z,o,n){const ve=n.map(i=>({...i,type:"enemy"}));if(Z==="standard"){const i=o.filter(we=>we.initiative).map(we=>({...we,type:"player",isFast:!0})),y=o.filter(we=>!we.initiative).map(we=>({...we,type:"player",isFast:!1})),ae=ve.filter(we=>we.initiative).map(we=>({...we,isFast:!0})),Ue=ve.filter(we=>!we.initiative).map(we=>({...we,isFast:!1}));return[...i,...ae,...y,...Ue]}if(Z==="individual")return[...o.map(y=>({...y,type:"player",totalInit:(y.initiativeRoll||0)+(y.attributes?.agility||10)-10})),...ve.map(y=>({...y,type:"enemy",totalInit:(y.initiativeRoll||0)+(y.attributes?.agility||10)-10}))].sort((y,ae)=>ae.totalInit-y.totalInit);const F=o.filter(i=>i&&i.initiative).map(i=>({...i,type:"player"})),p=o.filter(i=>i&&!i.initiative).map(i=>({...i,type:"player"})),q=[...F,...ve,...p],X=new Set;return q.filter(i=>{if(!i)return!1;const y=i.type==="player"?i.id:i.instanceId;return X.has(y)?!1:(X.add(y),!0)})}var Or=c('<span class="text-[10px] bg-slate-800 text-slate-400 px-1.5 py-0.5 rounded-full"> </span>'),jr=c('<div class="p-3 rounded-xl border border-amber-500/30 bg-amber-500/5 flex items-center gap-3 transition-all hover:bg-amber-500/10 shadow-sm"><div class="flex-1"><div class="font-bold text-sm text-amber-200 leading-none"> </div> <div class="text-[9px] text-amber-500/60 font-medium mt-1 uppercase tracking-tighter"> </div></div> <div class="flex items-center gap-1.5"><button class="p-2 rounded-lg bg-green-600/20 text-green-400 hover:bg-green-600 hover:text-white transition-all shadow-lg active:scale-90" title="Aprovar"><!></button> <button class="p-2 rounded-lg bg-red-600/20 text-red-400 hover:bg-red-600 hover:text-white transition-all shadow-lg active:scale-90" title="Recusar"><!></button></div></div>'),Er=c('<div class="space-y-2 animate-in fade-in slide-in-from-top-2"><div class="flex items-center gap-2 px-1"><div class="w-1.5 h-1.5 rounded-full bg-amber-500 animate-pulse"></div> <span class="text-[10px] font-black text-amber-500 uppercase tracking-wider"> </span></div> <!> <div class="h-px bg-slate-800/50 mx-2 my-2"></div></div>'),Mr=c('<span class="text-indigo-400 font-bold uppercase tracking-tighter mr-1"> </span>'),Ir=c('<div><div></div> <div class="flex-1"><div> </div> <div class="text-[10px] text-slate-500 font-medium"><!> </div></div> <div class="flex items-center gap-1"><button><!></button> <button class="text-slate-600 hover:text-red-400 p-1.5 hover:bg-red-400/10 rounded-lg transition-all"><!></button></div></div>'),Sr=c('<div class="text-xs text-slate-600 italic p-6 border-2 border-dashed border-slate-800 rounded-xl text-center"> </div>'),Rr=c('<button class="w-full bg-indigo-600 hover:bg-indigo-500 text-white py-3 rounded-xl font-black uppercase text-[10px] tracking-[0.2em] shadow-lg shadow-indigo-900/20 transition-all active:scale-[0.98] flex items-center justify-center gap-2"><!> </button> <p class="text-[9px] text-slate-600 text-center font-bold uppercase tracking-tighter"> </p>',1),Nr=c('<div class="flex justify-center p-3 bg-white rounded-xl mb-2 animate-in zoom-in-95 duration-200 shadow-xl mx-auto w-32 h-32"><img class="w-24 h-24"/></div>'),Ar=c('<div class="absolute bottom-full left-1/2 -translate-x-1/2 mb-2 px-2 py-1 bg-green-500 text-white text-[10px] font-bold rounded shadow-lg animate-in fade-in slide-in-from-bottom-1 whitespace-nowrap"><!> </div>'),Dr=c('<div class="flex items-center justify-between"><div class="flex items-center gap-2"><span class="text-[10px] font-black text-indigo-400 uppercase tracking-widest flex items-center gap-1"><!> </span></div> <button class="text-slate-500 hover:text-white transition-colors p-1"><!></button></div> <!> <div class="relative group"><div class="flex gap-1"><div class="flex-1 bg-slate-950 border border-slate-800 rounded-lg p-2 text-[10px] text-slate-400 font-mono truncate cursor-pointer hover:border-slate-700 transition-colors flex items-center"> </div> <button class="bg-indigo-600 hover:bg-indigo-500 text-white p-2 rounded-lg transition-all active:scale-95 shadow-lg shadow-indigo-900/20 relative"><!> <!></button></div></div> <button class="w-full text-[9px] text-slate-600 hover:text-red-400 font-bold uppercase tracking-widest transition-colors mt-1"> </button>',1),Tr=c('<div class="flex justify-between items-center bg-slate-950 p-2 rounded border border-slate-800 group hover:border-indigo-500/30 transition-all cursor-move hover:bg-slate-800/50" draggable="true"><div class="truncate flex-1 flex items-center gap-2"><!> <div class="min-w-0 flex-1"><div class="text-sm font-bold text-white truncate flex items-center gap-1"> <!></div> <div class="text-[10px] text-slate-500"> </div></div></div> <button class="text-slate-500 hover:text-indigo-400 p-1 ml-2 bg-slate-900 rounded border border-slate-800 hover:bg-slate-800"><!></button></div>'),Pr=c('<div class="text-center text-slate-600 italic text-xs mt-4"> </div>'),Ur=c("<!> <!>",1),Hr=c('<div class="flex justify-between items-center bg-slate-950 p-2 rounded border border-slate-800 group hover:border-indigo-500/30 transition-all cursor-move hover:bg-slate-800/50" draggable="true"><div class="truncate flex-1"><div class="text-sm font-bold text-white truncate flex items-center gap-1"> <!></div> <div class="text-[10px] text-slate-500"> </div></div> <button class="text-slate-500 hover:text-indigo-400 p-1 ml-2 bg-slate-900 rounded border border-slate-800 hover:bg-slate-800"><!></button></div>'),Lr=c('<div class="text-center text-slate-600 italic text-xs mt-4"> </div>'),Fr=c("<!> <!>",1),qr=c('<button class="bg-green-600 hover:bg-green-500 text-white px-6 py-2 rounded-lg font-bold flex items-center gap-2 shadow-lg shadow-green-900/20"><!> </button>'),Br=c('<div class="flex items-center gap-4"><button class="p-2 hover:bg-slate-700 rounded text-slate-400"><!></button> <div class="text-center"><div class="text-[10px] font-bold text-slate-500 uppercase"> </div><div class="text-3xl font-mono font-bold text-white leading-none"> </div></div> <button class="bg-indigo-600 hover:bg-indigo-500 text-white px-4 py-2 rounded font-bold flex items-center gap-2"><!> </button> <div class="h-8 w-px bg-slate-700 mx-2"></div> <button class="text-red-400 hover:text-red-300 text-xs font-bold px-3 py-2 border border-red-900/30 rounded bg-red-900/10"> </button></div>'),Jr=c("<div><!></div>"),Gr=c('<div class="text-center text-slate-500 italic py-10"> </div>'),Wr=c('<div class="text-sm"><span class="font-bold text-yellow-500"> </span> <span class="text-slate-300"> </span></div>'),Qr=c('<div class="bg-slate-900 border border-slate-700 rounded-lg p-4"><h4 class="font-bold text-white mb-2 pb-2 border-b border-slate-800 flex items-center gap-2"><!> </h4> <div class="space-y-2"></div></div>'),Vr=c('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/80 p-4" role="button" aria-label="Fechar" tabindex="-1"><div class="bg-slate-800 rounded-xl w-full max-w-lg border border-slate-700 shadow-2xl p-6 relative" role="dialog" aria-modal="true"><div class="flex items-center gap-3 mb-6"><div class="p-3 bg-yellow-900/20 rounded-full border border-yellow-500/30 text-yellow-500"><!></div> <div><h3 class="font-bold text-white text-xl"> </h3> <p class="text-slate-400 text-sm"> </p></div></div> <div class="space-y-4 mb-8 max-h-[60vh] overflow-y-auto custom-scrollbar"></div> <div class="flex gap-3"><button class="flex-1 py-1.5 rounded bg-slate-700 hover:bg-slate-600 text-white font-bold text-sm"> </button> <button class="flex-1 py-1.5 rounded bg-indigo-600 hover:bg-indigo-500 text-white font-bold text-sm"> </button></div></div></div>'),Zr=c('<button class="w-full text-left flex items-center gap-3 p-3 bg-slate-900 border border-slate-700 hover:border-indigo-500 hover:bg-indigo-500/10 rounded-xl group transition-all"><div class="w-10 h-10 rounded-full bg-slate-800 flex items-center justify-center text-sm font-bold text-slate-500 group-hover:text-indigo-400 border border-slate-700 group-hover:border-indigo-500/30"> </div> <div class="flex-1"><div class="font-bold text-white group-hover:text-indigo-300"> </div> <div class="text-[10px] text-slate-500"> </div></div> <div class="bg-slate-800 p-2 rounded-lg text-slate-500 group-hover:bg-indigo-500 group-hover:text-white transition-colors"><!></div></button>'),Xr=c('<div class="text-center py-8"><div class="w-12 h-12 bg-slate-700/50 rounded-full flex items-center justify-center mx-auto mb-3 text-slate-500"><!></div> <p class="text-slate-500 text-sm font-bold"> </p> <p class="text-[10px] text-slate-600 mt-1"> </p></div>'),Yr=c('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/80 p-4" role="button" aria-label="Fechar" tabindex="-1"><div class="bg-slate-800 rounded-xl w-full max-w-md border border-slate-700 shadow-2xl p-6" role="dialog" aria-modal="true"><div class="flex justify-between items-center mb-6"><div><h3 class="font-bold text-white text-lg"> </h3> <p class="text-xs text-slate-400"> </p></div> <button class="bg-slate-700 hover:bg-slate-600 p-2 rounded-lg text-white transition-colors"><!></button></div> <div class="space-y-3 max-h-[60vh] overflow-y-auto custom-scrollbar pr-2"><!> <!></div></div></div>'),Kr=c('<div class="flex justify-between items-center bg-slate-950 p-3 rounded-xl border border-slate-800 group active:border-indigo-500/50 transition-all"><div class="truncate flex-1 flex flex-col"><div class="text-sm font-bold text-white truncate flex items-center gap-1"> <!></div> <div class="text-[10px] text-slate-500"> </div></div> <button class="text-white hover:bg-indigo-600 p-2 bg-slate-800 rounded-lg border border-slate-700"><!></button></div>'),ei=c('<div class="text-center text-slate-600 italic text-xs mt-4"> </div>'),ti=c("<!> <!>",1),ai=c('<div class="flex justify-between items-center bg-slate-950 p-3 rounded-xl border border-slate-800 group active:border-indigo-500/50 transition-all"><div class="truncate flex-1"><div class="text-sm font-bold text-white truncate flex items-center gap-1"> <!></div> <div class="text-[10px] text-slate-500"> </div></div> <button class="text-white hover:bg-indigo-600 p-2 bg-slate-800 rounded-lg border border-slate-700"><!></button></div>'),si=c('<div class="text-center text-slate-600 italic text-xs mt-4"> </div>'),ri=c("<!> <!>",1),ii=c('<div class="fixed inset-0 z-50 flex justify-end bg-black/60"><div class="w-full max-w-[300px] h-full bg-slate-900 border-l border-slate-800 p-4 shadow-2xl animate-in slide-in-from-right duration-300"><div class="flex justify-between items-center mb-4"><h3 class="font-bold text-white uppercase tracking-widest text-sm flex items-center gap-2"><!> </h3> <button class="bg-slate-800 p-2 rounded-lg text-slate-400 hover:text-white"><!></button></div> <div class="flex items-center gap-2 mb-3 bg-slate-950 p-1 rounded-lg border border-slate-800"><button><!> </button> <button><!> </button></div> <div class="h-[calc(100%-100px)] overflow-y-auto custom-scrollbar space-y-2"><!></div></div></div>'),ni=c('<div class="grid grid-cols-1 lg:grid-cols-4 gap-6 h-full relative"><div class="space-y-6"><div class="bg-slate-900 border border-slate-800 rounded-xl p-4 flex flex-col gap-4"><div class="flex justify-between items-center bg-slate-950/50 p-2 rounded-lg border border-slate-800"><h3 class="text-xs font-black text-slate-500 uppercase tracking-widest flex items-center gap-2"><!> <!></h3> <button class="text-[10px] bg-slate-800 hover:bg-slate-700 text-white px-2.5 py-1.5 rounded-md font-bold transition-all border border-slate-700 active:scale-95"> </button></div> <!> <div class="space-y-2 flex-1 overflow-y-auto max-h-[300px] custom-scrollbar pr-1"><div class="space-y-2"><!> <!></div></div> <div class="pt-4 border-t border-slate-800 space-y-3"><!></div></div> <div class="hidden lg:flex flex-col h-[400px] bg-slate-900 border border-slate-800 rounded-xl p-4"><div class="flex items-center gap-2 mb-3 bg-slate-950 p-1 rounded-lg border border-slate-800"><button><!> </button> <button><!> </button></div> <div class="flex-1 overflow-y-auto pr-1 custom-scrollbar space-y-2"><!></div></div></div> <div class="lg:col-span-2 space-y-4" role="region" aria-label="Combat Zone"><div class="bg-slate-900 border border-slate-800 rounded-xl p-4 flex justify-between items-center shadow-lg sticky top-0 z-20"><div class="flex items-center gap-4"><!></div></div> <div class="space-y-3 pb-20"><!> <!></div></div> <div class="hidden lg:flex flex-col gap-4"></div></div> <!> <!> <!> <button class="lg:hidden fixed bottom-24 right-4 bg-slate-800 text-white p-3 rounded-full shadow-lg border border-slate-700 z-40 active:scale-90 transition-transform" aria-label="Add Enemy"><!></button> <!> <!>',1);function oi(Z,o){ua(o,!0);const n=()=>qt(ks,"$liveCharacters",X),ve=()=>qt(Fa,"$liveEnemies",X),F=()=>qt(es,"$liveEncounters",X),p=()=>qt(aa,"$t",X),q=()=>qt(wa,"$isHistoryOpen",X),[X,i]=xa();let y=gt(!1),ae=gt(!1),Ue=gt(!1),we=gt(!1);const Ze={active:!1,round:1};let je=gt("enemies"),Ee=gt(!1),ue=gt(ca([])),Te=gt(ca({isOpen:!1,title:"",message:"",onConfirm:()=>{}}));Ga(()=>{if(o.campaign?.id){fs(o.campaign.id,!0);const l=Ta(aa)("common.labels.master");Qa.update(_=>({..._,campaignId:o.campaign.id,name:o.campaign.gmName||l}));const u=setInterval(()=>{const _=Zt.get(o.campaign.id)||o.campaign,w=Ta(aa)("common.labels.master");Ua(o.campaign.id,{name:_.name,gmName:_.gmName||w})},3e4);return()=>{clearInterval(u),gs(),Qa.update(_=>({..._,campaignId:null}))}}});const ge=ye(()=>typeof window<"u"?`${window.location.origin}${ss("/campaigns/[id]/invite",{id:o.campaign?.id})}`:"");function Rt(){a(ge)&&(navigator.clipboard.writeText(a(ge)),k(Ue,!0),setTimeout(()=>{k(Ue,!1)},2e3))}let zt=ye(()=>o.campaign?.sessionRoster||[]),Ft=ye(()=>o.campaign?.combat||Ze),ke=ye(()=>o.campaign?.activeEnemies||[]),Ne=ye(()=>o.campaign?.members||[]),Xe=ye(()=>o.campaign?.initiativeStyle||"dle"),rt=ye(()=>Array.from(new Set([...a(zt),...a(Ne).map(u=>u.id)])).map(u=>{const _=n().find(te=>te.id===u),w=a(Ne).find(te=>te.id===u);return _&&w?{..._,...w,lastUpdate:w.lastUpdate}:_||w}).filter(Boolean)),xe=ye(()=>a(rt).filter(l=>!l.campaignApproval||l.campaignApproval==="approved")),Ae=ye(()=>a(rt).filter(l=>l.campaignApproval==="pending")),_t=ye(()=>n().filter(l=>!a(zt).includes(l.id)&&!a(Ne).some(u=>u.id===l.id)&&(l.system||ka)===(o.campaign?.system||ka))),P=ye(()=>ve().filter(l=>{const u=(l.system||ka)===(o.campaign?.system||ka),_=l.campaignId===o.campaign?.id||l.global;return u&&_})),K=ye(()=>F().filter(l=>(l.system||ka)===(o.campaign?.system||ka)&&!0));function R(l){if(!o.campaign?.id)return;const _={...Zt.get(o.campaign.id)||o.campaign,...l};Zt.set(o.campaign.id,_),l.combat&&Ma(o.campaign.id,l.combat),(l.name||l.gmName)&&Ua(o.campaign.id,{name:_.name,gmName:_.gmName})}function Ge(l){if(a(zt).includes(l)){const u=a(zt).filter(_=>_!==l);R({sessionRoster:u})}else{const u=[...a(zt),l];R({sessionRoster:u})}}function Ye(l){ze(l,{campaignApproval:"approved"}),Ia({id:l,campaignApproval:"approved"})}function vt(l){Ia({id:l,campaignApproval:"rejected",campaignId:null});const _=((Zt.get(o.campaign.id)||o.campaign).members||[]).filter(w=>w.id!==l);R({members:_})}function $t(l){const u=a(rt).find(_=>_.id===l);k(Te,{isOpen:!0,title:p()("session.players.remove_title"),message:p()("session.players.remove_message",{values:{name:u?.name||"este personagem"}}),onConfirm:()=>{const _=Zt.get(o.campaign.id)||o.campaign;Ia({id:l,campaignId:null});const w=(_.sessionRoster||[]).filter(O=>O!==l),te=(_.members||[]).filter(O=>O.id!==l),$=(_.activeEnemies||[]).filter(O=>O.type!=="player"||O.id!==l);R({sessionRoster:w,members:te,activeEnemies:$}),a(Te).isOpen=!1}},!0)}function it(l){const _=(Zt.get(o.campaign.id)||o.campaign).activeEnemies||[],w={...l,instanceId:ja(),damage:0,currentHealth:l.health,afflictions:[],acted:!1,initiative:!1};R({activeEnemies:[..._,w]})}function At(l){const _=(Zt.get(o.campaign.id)||o.campaign).activeEnemies||[];let w=[];l.enemies.forEach(te=>{const $=ve().find(O=>O.id===te.enemyId);if($)for(let O=0;O<te.count;O++)w.push({...$,instanceId:ja(),damage:0,currentHealth:$.health,afflictions:[],acted:!1,initiative:!1})}),R({activeEnemies:[..._,...w]})}function ht(){R({combat:{active:!0,round:1}}),Ma(o.campaign.id,{active:!0,round:1})}function se(){const l=a(ke).filter(u=>u.damage<(u.currentHealth??u.health)&&u.endOfRound&&u.endOfRound.length>0).map(u=>({name:u.name,effects:u.endOfRound}));if(l.length>0){k(ue,l,!0),k(Ee,!0);return}ce()}function ce(){const l=Zt.get(o.campaign.id)||o.campaign,u=(l.combat?.round||1)+1,_=(l.activeEnemies||[]).map(w=>({...w,acted:!1}));R({combat:{...l.combat,round:u},activeEnemies:_}),Ma(o.campaign.id,{active:!0,round:u}),k(Ee,!1)}function Ke(l){R({combat:{active:!1,round:1}}),Ma(o.campaign.id,{active:!1,round:1})}function He(l){const u=Zt.get(o.campaign.id)||o.campaign;R({activeEnemies:(u.activeEnemies||[]).filter(_=>_.instanceId!==l)})}function bt(l,u){const _=Zt.get(o.campaign.id)||o.campaign;R({activeEnemies:(_.activeEnemies||[]).map(w=>w.instanceId===l?{...w,...u}:w)})}function nt(){const l=Zt.get(o.campaign.id)||o.campaign,u=l.combat?.round||1;u>1&&R({combat:{...l.combat,round:u-1}})}let ie=gt(ca(Date.now()));Ga(()=>{const l=setInterval(()=>{k(ie,Date.now(),!0)},1e4);return()=>clearInterval(l)});let Fe=ye(()=>(()=>{const l=a(xe).filter(u=>a(zt).includes(u.id));return Cr(a(Xe),l,a(ke))})());function E(l){return l.lastUpdate?a(ie)-l.lastUpdate<6e4:!1}function ze(l,u){const _=Zt.get(o.campaign.id)||o.campaign,w=_.members||[],te=w.findIndex(M=>M.id===l);let $=w;te!==-1&&($=[...w],$[te]={...$[te],...u});const O=_.activeEnemies||[],W=O.findIndex(M=>M.id===l&&M.type==="player");let Q=O;W!==-1&&(Q=[...O],Q[W]={...Q[W],...u}),R({members:$,activeEnemies:Q})}function me(l,u,_){l.dataTransfer&&(l.dataTransfer.setData("application/json",JSON.stringify({item:u,type:_})),l.dataTransfer.effectAllowed="copy")}function Le(l){return l.preventDefault(),!1}function Se(l){l.preventDefault();const u=l.dataTransfer?.getData("application/json");if(u)try{const{item:_,type:w}=JSON.parse(u);w==="enemy"?it(_):w==="encounter"&&At(_)}catch(_){console.error("Drop error",_)}}var xt=ni(),et=Je(xt),tt=t(et),Ct=t(tt),Et=t(Ct),Dt=t(Et),Pt=t(Dt);ts(Pt,{size:14,class:"text-indigo-500"});var z=s(Pt),S=s(z);{var D=l=>{var u=Or(),_=t(u,!0);e(u),x(()=>r(_,a(xe).length)),d(l,u)};f(S,l=>{a(xe).length>0&&l(D)})}e(Dt);var $e=s(Dt,2);$e.__click=()=>k(y,!a(y));var ct=t($e,!0);e($e),e(Et);var qe=s(Et,2);{var ot=l=>{var u=Er(),_=t(u),w=s(t(_),2),te=t(w);e(w),e(_);var $=s(_,2);Ve($,17,()=>a(Ae),O=>O.id,(O,W)=>{var Q=jr(),M=t(Q),oe=t(M),pe=t(oe,!0);e(oe);var U=s(oe,2),V=t(U,!0);e(U),e(M);var Ie=s(M,2),H=t(Ie);H.__click=()=>Ye(a(W).id);var Re=t(H);Za(Re,{size:14}),e(H);var h=s(H,2);h.__click=()=>vt(a(W).id);var g=t(h);sa(g,{size:14}),e(h),e(Ie),e(Q),x(B=>{r(pe,a(W).name),r(V,B)},[()=>p()("session.players.new_request")]),d(O,Q)}),va(2),e(u),x(O=>r(te,`${O??""} (${a(Ae).length??""})`),[()=>p()("session.players.waiting_approval")]),d(l,u)};f(qe,l=>{a(Ae).length>0&&l(ot)})}var yt=s(qe,2),Mt=t(yt),Pe=t(Mt);Ve(Pe,17,()=>a(xe),l=>l.id,(l,u)=>{const _=ye(()=>E(a(u))),w=ye(()=>a(zt).includes(a(u).id));var te=Ir(),$=t(te),O=s($,2),W=t(O),Q=t(W,!0);e(W);var M=s(W,2),oe=t(M);{var pe=C=>{var L=Mr(),le=t(L,!0);e(L),x(Oe=>r(le,Oe),[()=>p()("common.labels.session")]),d(C,L)};f(oe,C=>{a(w)&&C(pe)})}var U=s(oe);e(M),e(O);var V=s(O,2),Ie=t(V);Ie.__click=()=>Ge(a(u).id);var H=t(Ie);{var Re=C=>{Ms(C,{size:14})},h=C=>{ea(C,{size:14})};f(H,C=>{a(w)?C(Re):C(h,!1)})}e(Ie);var g=s(Ie,2);g.__click=()=>$t(a(u).id);var B=t(g);sa(B,{size:14}),e(g),e(V),e(te),x((C,L,le)=>{st(te,1,`p-2.5 rounded-xl border flex items-center gap-3 transition-all ${a(_)?"bg-indigo-900/10 border-indigo-500/20":"bg-slate-900/50 border-slate-800"} ${a(_)||a(w)?"opacity-100":"opacity-40"} hover:border-indigo-500/40 group shadow-sm`),st($,1,`w-2 h-2 rounded-full ${a(_)?"bg-green-500 shadow-[0_0_8px_rgba(74,222,128,0.4)]":"bg-slate-700"}`),st(W,1,`font-bold text-sm ${a(_)?"text-white":"text-slate-500"} group-hover:text-indigo-300 transition-colors`),r(Q,a(u).name),r(U,` ${C??""} ${a(u).level??""} • ${a(u).ancestry??""}`),st(Ie,1,`p-1.5 rounded-lg transition-all ${a(w)?"text-amber-400 hover:bg-amber-400/10":"text-slate-500 hover:text-indigo-400 hover:bg-indigo-400/10"}`),_e(Ie,"title",L),_e(g,"title",le)},[()=>p()("common.labels.level"),()=>a(w)?p()("session.players.remove_from_session"):p()("session.players.add_to_session"),()=>p()("session.players.kick_from_campaign")]),d(l,te)});var kt=s(Pe,2);{var N=l=>{var u=Sr(),_=t(u,!0);e(u),x(w=>r(_,w),[()=>p()("session.players.none")]),d(l,u)};f(kt,l=>{a(xe).length===0&&l(N)})}e(Mt),e(yt);var j=s(yt,2),A=t(j);{var ne=l=>{var u=Rr(),_=Je(u);_.__click=()=>R({isPublished:!0});var w=t(_);da(w,{size:14});var te=s(w);e(_);var $=s(_,2),O=t($,!0);e($),x((W,Q)=>{r(te,` ${W??""}`),r(O,Q)},[()=>p()("session.publish.publish_session"),()=>p()("session.publish.make_visible")]),d(l,u)},I=l=>{var u=Dr(),_=Je(u),w=t(_),te=t(w),$=t(te);as($,{size:10,class:"animate-pulse"});var O=s($);e(te),e(w);var W=s(w,2);W.__click=()=>k(we,!a(we));var Q=t(W);Qs(Q,{size:14}),e(W),e(_);var M=s(_,2);{var oe=L=>{var le=Nr(),Oe=t(le);e(le),x((We,Qe)=>{_e(Oe,"src",We),_e(Oe,"alt",Qe)},[()=>`https://api.qrserver.com/v1/create-qr-code/?size=100x100&data=${encodeURIComponent(a(ge))}`,()=>p()("session.publish.qr_alt")]),d(L,le)};f(M,L=>{a(we)&&L(oe)})}var pe=s(M,2),U=t(pe),V=t(U);V.__click=Rt;var Ie=t(V,!0);e(V);var H=s(V,2);H.__click=Rt;var Re=t(H);{var h=L=>{var le=Ar(),Oe=t(le);Za(Oe,{size:10,class:"inline mr-1"});var We=s(Oe);e(le),x(Qe=>r(We,` ${Qe??""}`),[()=>p()("common.buttons.copied")]),d(L,le)};f(Re,L=>{a(Ue)&&L(h)})}var g=s(Re,2);Js(g,{size:14}),e(H),e(U),e(pe);var B=s(pe,2);B.__click=()=>R({isPublished:!1});var C=t(B,!0);e(B),x((L,le,Oe,We)=>{r(O,` ${L??""}`),_e(W,"title",le),r(Ie,a(ge)),_e(H,"aria-label",Oe),r(C,We)},[()=>p()("session.publish.public_session"),()=>p()("session.publish.qr_code"),()=>p()("session.publish.copy_link"),()=>p()("session.publish.remove_public")]),d(l,u)};f(A,l=>{o.campaign?.isPublished?l(I,!1):l(ne)})}e(j),e(Ct);var J=s(Ct,2),Y=t(J),he=t(Y);he.__click=()=>k(je,"enemies");var de=t(he);ha(de,{size:14});var re=s(de);e(he);var T=s(he,2);T.__click=()=>k(je,"encounters");var Ce=t(T);La(Ce,{size:14});var be=s(Ce);e(T),e(Y);var Me=s(Y,2),dt=t(Me);{var pt=l=>{var u=Ur(),_=Je(u);Ve(_,17,()=>a(P),$=>$.id,($,O)=>{var W=Tr(),Q=t(W),M=t(Q);Ws(M,{size:12,class:"text-slate-600 cursor-grab"});var oe=s(M,2),pe=t(oe),U=t(pe),V=s(U);{var Ie=B=>{da(B,{size:10,class:"text-indigo-400"})};f(V,B=>{a(O).global&&B(Ie)})}e(pe);var H=s(pe,2),Re=t(H);e(H),e(oe),e(Q);var h=s(Q,2);h.__click=()=>it(a(O));var g=t(h);ea(g,{size:16}),e(h),e(W),x(B=>{r(U,`${a(O).name??""} `),r(Re,`${B??""} ${a(O).difficulty??""}`)},[()=>p()("session.enemies.difficulty")]),ya("dragstart",W,B=>me(B,a(O),"enemy")),d($,W)});var w=s(_,2);{var te=$=>{var O=Pr(),W=t(O,!0);e(O),x(Q=>r(W,Q),[()=>p()("session.enemies.none")]),d($,O)};f(w,$=>{a(P).length===0&&$(te)})}d(l,u)},wt=l=>{var u=Fr(),_=Je(u);Ve(_,17,()=>a(K),$=>$.id,($,O)=>{var W=Hr(),Q=t(W),M=t(Q),oe=t(M),pe=s(oe);{var U=h=>{da(h,{size:10,class:"text-indigo-400"})};f(pe,h=>{a(O).global&&h(U)})}e(M);var V=s(M,2),Ie=t(V);e(V),e(Q);var H=s(Q,2);H.__click=()=>At(a(O));var Re=t(H);Ha(Re,{size:14}),e(H),e(W),x((h,g)=>{r(oe,`${a(O).name??""} `),r(Ie,`${h??""} ${g??""}`)},[()=>a(O).enemies?.reduce((h,g)=>h+g.count,0)||0,()=>p()("session.enemies.title")]),ya("dragstart",W,h=>me(h,a(O),"encounter")),d($,W)});var w=s(_,2);{var te=$=>{var O=Lr(),W=t(O,!0);e(O),x(Q=>r(W,Q),[()=>p()("session.enemies.no_encounters")]),d($,O)};f(w,$=>{a(K).length===0&&$(te)})}d(l,u)};f(dt,l=>{a(je)==="enemies"?l(pt):l(wt,!1)})}e(Me),e(J),e(tt);var lt=s(tt,2),It=t(lt),Ut=t(It),Bt=t(Ut);{var v=l=>{var u=qr();u.__click=ht;var _=t(u);us(_,{size:20});var w=s(_);e(u),x(te=>r(w,` ${te??""}`),[()=>p()("session.combat.start")]),d(l,u)},b=l=>{var u=Br(),_=t(u);_.__click=nt;var w=t(_);Aa(w,{size:20}),e(_);var te=s(_,2),$=t(te),O=t($,!0);e($);var W=s($),Q=t(W,!0);e(W),e(te);var M=s(te,2);M.__click=se;var oe=t(M);Is(oe,{size:16});var pe=s(oe);e(M);var U=s(M,4);U.__click=()=>Ke();var V=t(U,!0);e(U),e(u),x((Ie,H,Re,h,g)=>{_e(_,"title",Ie),r(O,H),r(Q,a(Ft).round),_e(M,"title",Re),r(pe,` ${h??""}`),r(V,g)},[()=>p()("session.combat.previous"),()=>p()("session.combat.round"),()=>p()("session.combat.next"),()=>p()("session.combat.next"),()=>p()("session.combat.end")]),d(l,u)};f(Bt,l=>{a(Ft).active?l(b,!1):l(v)})}e(Ut),e(It);var m=s(It,2),G=t(m);Ve(G,25,()=>a(Fe),l=>l.type==="player"?l.id:l.instanceId,(l,u)=>{var _=Jr(),w=t(_);wr(w,{get entity(){return a(u)},updateEnemy:bt,removeFromCombat:He,updatePlayer:ze}),e(_),$s(_,()=>kr,()=>({duration:300})),d(l,_)});var ee=s(G,2);{var fe=l=>{var u=Gr(),_=t(u,!0);e(u),x(w=>r(_,w),[()=>p()("session.combat.empty")]),d(l,u)};f(ee,l=>{a(Fe).length===0&&l(fe)})}e(m),e(lt),va(2),e(et);var Be=s(et,2);{var mt=l=>{var u=Vr();u.__click=h=>{h.target===h.currentTarget&&k(Ee,!1)};var _=t(u),w=t(_),te=t(w),$=t(te);Ss($,{size:24}),e(te);var O=s(te,2),W=t(O),Q=t(W,!0);e(W);var M=s(W,2),oe=t(M,!0);e(M),e(O),e(w);var pe=s(w,2);Ve(pe,21,()=>a(ue),Ot,(h,g)=>{var B=Qr(),C=t(B),L=t(C);ha(L,{size:14,class:"text-slate-500"});var le=s(L);e(C);var Oe=s(C,2);Ve(Oe,21,()=>a(g).effects,Ot,(We,Qe)=>{var De=Wr(),jt=t(De),Vt=t(jt);e(jt);var Yt=s(jt,2),ta=t(Yt,!0);e(Yt),e(De),x(()=>{r(Vt,`${a(Qe).name??""}:`),r(ta,a(Qe).desc)}),d(We,De)}),e(Oe),e(B),x(()=>r(le,` ${a(g).name??""}`)),d(h,B)}),e(pe);var U=s(pe,2),V=t(U);V.__click=()=>k(Ee,!1);var Ie=t(V,!0);e(V);var H=s(V,2);H.__click=ce;var Re=t(H,!0);e(H),e(U),e(_),e(u),x((h,g,B,C)=>{r(Q,h),r(oe,g),r(Ie,B),r(Re,C)},[()=>p()("session.end_of_round.title"),()=>p()("session.end_of_round.summary"),()=>p()("common.buttons.cancel"),()=>p()("session.end_of_round.advance")]),d(l,u)};f(Be,l=>{a(Ee)&&l(mt)})}var ft=s(Be,2);{var Ht=l=>{var u=Yr();u.__click=H=>{H.target===H.currentTarget&&k(y,!1)};var _=t(u),w=t(_),te=t(w),$=t(te),O=t($,!0);e($);var W=s($,2),Q=t(W,!0);e(W),e(te);var M=s(te,2);M.__click=()=>k(y,!1);var oe=t(M);ma(oe,{size:16}),e(M),e(w);var pe=s(w,2),U=t(pe);Ve(U,17,()=>a(_t),Ot,(H,Re)=>{var h=Zr();h.__click=()=>Ge(a(Re).id);var g=t(h),B=t(g,!0);e(g);var C=s(g,2),L=t(C),le=t(L,!0);e(L);var Oe=s(L,2),We=t(Oe);e(Oe),e(C);var Qe=s(C,2),De=t(Qe);ea(De,{size:16}),e(Qe),e(h),x((jt,Vt)=>{r(B,jt),r(le,a(Re).name),r(We,`${Vt??""} ${a(Re).level??""} • ${a(Re).ancestry??""}`)},[()=>a(Re).name.charAt(0),()=>p()("common.labels.level")]),d(H,h)});var V=s(U,2);{var Ie=H=>{var Re=Xr(),h=t(Re),g=t(h);ha(g,{size:24}),e(h);var B=s(h,2),C=t(B,!0);e(B);var L=s(B,2),le=t(L,!0);e(L),e(Re),x((Oe,We)=>{r(C,Oe),r(le,We)},[()=>p()("session.manage_session.no_available"),()=>p()("session.manage_session.all_in_session")]),d(H,Re)};f(V,H=>{a(_t).length===0&&H(Ie)})}e(pe),e(_),e(u),x((H,Re)=>{r(O,H),r(Q,Re)},[()=>p()("session.manage_session.title"),()=>p()("session.manage_session.description")]),d(l,u)};f(ft,l=>{a(y)&&l(Ht)})}var St=s(ft,2);{var Lt=l=>{var u=ii();u.__click=C=>{C.target===C.currentTarget&&k(ae,!1)};var _=t(u),w=t(_),te=t(w),$=t(te);ha($,{size:16});var O=s($);e(te);var W=s(te,2);W.__click=()=>k(ae,!1);var Q=t(W);ma(Q,{size:18}),e(W),e(w);var M=s(w,2),oe=t(M);oe.__click=()=>k(je,"enemies");var pe=t(oe);ha(pe,{size:14});var U=s(pe);e(oe);var V=s(oe,2);V.__click=()=>k(je,"encounters");var Ie=t(V);La(Ie,{size:14});var H=s(Ie);e(V),e(M);var Re=s(M,2),h=t(Re);{var g=C=>{var L=ti(),le=Je(L);Ve(le,17,()=>a(P),Qe=>Qe.id,(Qe,De)=>{var jt=Kr(),Vt=t(jt),Yt=t(Vt),ta=t(Yt),fa=s(ta);{var ga=Xt=>{da(Xt,{size:10,class:"text-indigo-400"})};f(fa,Xt=>{a(De).global&&Xt(ga)})}e(Yt);var la=s(Yt,2),$a=t(la);e(la),e(Vt);var Jt=s(Vt,2);Jt.__click=()=>{it(a(De)),k(ae,!1)};var Ca=t(Jt);ea(Ca,{size:16}),e(Jt),e(jt),x(Xt=>{r(ta,`${a(De).name??""} `),r($a,`${Xt??""} ${a(De).difficulty??""}`)},[()=>p()("session.enemies.difficulty")]),d(Qe,jt)});var Oe=s(le,2);{var We=Qe=>{var De=ei(),jt=t(De,!0);e(De),x(Vt=>r(jt,Vt),[()=>p()("session.enemies.none")]),d(Qe,De)};f(Oe,Qe=>{a(P).length===0&&Qe(We)})}d(C,L)},B=C=>{var L=ri(),le=Je(L);Ve(le,17,()=>a(K),Qe=>Qe.id,(Qe,De)=>{var jt=ai(),Vt=t(jt),Yt=t(Vt),ta=t(Yt),fa=s(ta);{var ga=Xt=>{da(Xt,{size:10,class:"text-indigo-400"})};f(fa,Xt=>{a(De).global&&Xt(ga)})}e(Yt);var la=s(Yt,2),$a=t(la);e(la),e(Vt);var Jt=s(Vt,2);Jt.__click=()=>{At(a(De)),k(ae,!1)};var Ca=t(Jt);Ha(Ca,{size:16}),e(Jt),e(jt),x((Xt,Oa)=>{r(ta,`${a(De).name??""} `),r($a,`${Xt??""} ${Oa??""}`)},[()=>a(De).enemies?.reduce((Xt,Oa)=>Xt+Oa.count,0)||0,()=>p()("session.enemies.title")]),d(Qe,jt)});var Oe=s(le,2);{var We=Qe=>{var De=si(),jt=t(De,!0);e(De),x(Vt=>r(jt,Vt),[()=>p()("session.enemies.no_encounters")]),d(Qe,De)};f(Oe,Qe=>{a(K).length===0&&Qe(We)})}d(C,L)};f(h,C=>{a(je)==="enemies"?C(g):C(B,!1)})}e(Re),e(_),e(u),x((C,L,le)=>{r(O,` ${C??""}`),st(oe,1,`flex-1 text-xs font-bold py-2 rounded flex items-center justify-center gap-2 transition-colors ${a(je)==="enemies"?"bg-indigo-600 text-white":"text-slate-500 hover:text-white"}`),r(U,` ${L??""}`),st(V,1,`flex-1 text-xs font-bold py-2 rounded flex items-center justify-center gap-2 transition-colors ${a(je)==="encounters"?"bg-indigo-600 text-white":"text-slate-500 hover:text-white"}`),r(H,` ${le??""}`)},[()=>p()("session.enemies.title"),()=>p()("session.enemies.title"),()=>p()("session.enemies.encounters")]),d(l,u)};f(St,l=>{a(ae)&&l(Lt)})}var Tt=s(St,2);Tt.__click=()=>k(ae,!0);var Gt=t(Tt);ha(Gt,{size:24}),e(Tt);var Wt=s(Tt,2);rs(Wt,{get isOpen(){return q()},onClose:()=>wa.set(!1)});var Qt=s(Wt,2);Ka(Qt,{get isOpen(){return a(Te).isOpen},get title(){return a(Te).title},get message(){return a(Te).message},get onConfirm(){return a(Te).onConfirm},onCancel:()=>a(Te).isOpen=!1}),x((l,u,_,w)=>{r(z,` ${l??""} `),r(ct,u),st(he,1,`flex-1 text-xs font-bold py-1.5 rounded flex items-center justify-center gap-2 transition-colors ${a(je)==="enemies"?"bg-indigo-600 text-white":"text-slate-500 hover:text-white"}`),r(re,` ${_??""}`),st(T,1,`flex-1 text-xs font-bold py-1.5 rounded flex items-center justify-center gap-2 transition-colors ${a(je)==="encounters"?"bg-indigo-600 text-white":"text-slate-500 hover:text-white"}`),r(be,` ${w??""}`)},[()=>p()("session.players.title"),()=>a(y)?p()("session.players.close"):p()("session.players.add"),()=>p()("session.enemies.title"),()=>p()("session.enemies.encounters")]),ya("dragover",lt,Le),ya("drop",lt,Se),d(Z,xt),ba(),i()}_a(["click"]);var li=c('<div class="w-16 h-16 rounded-lg overflow-hidden border border-slate-700 shadow-lg flex-shrink-0"><!></div>'),di=c('<div class="text-xs text-slate-500 italic mt-2 leading-relaxed opacity-75"> </div>'),vi=c('<span class="text-slate-400"> </span>'),ci=c('<span class="text-slate-400"> </span>'),ui=c('<div class="text-sm mb-4"><span class="text-slate-500 font-bold"> </span> <span class="text-white ml-1"> </span></div>'),bi=c('<div class="mb-3 text-sm"><span class="font-bold text-indigo-400"> </span> <span class="text-slate-300 ml-1"> </span></div>'),_i=c('<span class="text-slate-300"> </span>'),xi=c('<div class="mb-2 text-sm"><span class="font-bold text-white"> </span> <span class="text-slate-400"> </span> <span class="text-white ml-1"> </span> <!></div>'),pi=c('<div class="mt-4"><h4 class="text-red-500 font-bold text-xs uppercase mb-2 tracking-wider"> </h4> <!></div>'),mi=c('<div class="mb-2 text-sm"><span class="font-bold text-white"> </span> <span class="text-slate-300 ml-1"> </span></div>'),fi=c('<div class="mt-4"><h4 class="text-orange-500 font-bold text-xs uppercase mb-2 tracking-wider"> </h4> <!></div>'),gi=c('<div class="mb-2 text-sm"><span class="font-bold text-white"> </span> <span class="text-slate-300 ml-1"> </span></div>'),hi=c('<div class="mt-4"><h4 class="text-yellow-500 font-bold text-xs uppercase mb-2 tracking-wider"> </h4> <!></div>'),yi=c('<div class="w-full max-w-md bg-slate-900 border border-slate-700 rounded-xl p-5 shadow-2xl"><div class="flex items-start gap-3 mb-4"><!> <div class="flex-1 min-w-0"><div class="flex items-baseline gap-2"><h2 class="text-xl font-bold text-white font-serif tracking-wide"> </h2> <span class="text-red-500 font-bold text-sm"> </span></div> <div class="text-sm text-slate-400 mt-1"> </div> <!></div></div> <div class="text-sm mb-3"><span class="text-slate-500 font-bold"> </span> <span class="text-white ml-1"> </span> <!></div> <div class="text-sm mb-3"><span class="text-slate-500 font-bold"> </span> <span class="text-white ml-1"> </span> <span class="text-slate-500 font-bold ml-3"> </span> <span class="text-white ml-1"> </span></div> <div class="text-sm mb-3"><span class="text-white"><span class="text-slate-500 font-bold"> </span> <span class="text-slate-500 font-bold"> </span> <span class="text-slate-500 font-bold"> </span> <span class="text-slate-500 font-bold"> </span> </span></div> <div class="text-sm mb-3"><span class="text-slate-500 font-bold"> </span> <span class="text-white ml-1"> </span> <!></div> <!> <div class="border-t border-slate-700 my-4"></div> <!> <!> <!> <!></div>'),wi=c('<div class="space-y-4 animate-in fade-in slide-in-from-bottom-2 duration-300"><div class="flex items-center gap-4"><div class="relative group cursor-pointer"><div class="w-16 h-16 rounded-xl overflow-hidden border border-slate-700"><!></div> <div class="absolute inset-0 bg-black/50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity rounded-xl"><!></div></div> <div class="flex-1"><label for="enemy-name" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-name" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white font-bold text-lg"/></div></div> <div><label for="enemy-desc-text" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <textarea id="enemy-desc-text" class="w-full bg-slate-900 border border-slate-700 rounded p-3 text-white text-sm min-h-[100px] resize-none focus:border-indigo-500 focus:outline-none transition-colors"></textarea></div> <div><label for="enemy-desc" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-desc" type="text" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white text-sm"/></div> <div class="flex items-center gap-2 mt-4"><input id="enemy-global" type="checkbox" class="w-4 h-4 bg-slate-900 border-slate-700 rounded focus:ring-indigo-500"/> <label for="enemy-global" class="text-sm font-bold text-slate-400 select-none cursor-pointer flex items-center gap-2"><!> </label></div></div>'),ki=c('<div class="bg-slate-900 p-3 rounded border border-slate-700 text-center"><label class="text-[10px] text-slate-500 uppercase font-bold block mb-1 text-ellipsis overflow-hidden whitespace-nowrap"> </label> <input type="number" class="w-full bg-transparent text-center font-bold text-white text-xl focus:outline-none mb-1"/> <div> </div></div>'),zi=c('<div class="space-y-6 animate-in fade-in slide-in-from-bottom-2 duration-300"><div class="grid grid-cols-2 gap-4"><div><label for="enemy-diff" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-diff" type="number" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div> <div><label for="enemy-size" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-size" type="text" placeholder="1/2, 1, 2..." class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div></div> <div class="grid grid-cols-2 gap-4"><div><label for="enemy-speed" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-speed" type="number" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div> <div><label for="enemy-health" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-health" type="number" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div></div> <div class="grid grid-cols-2 gap-4"><div><label for="enemy-defense" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-defense" type="number" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div> <div><label for="enemy-perception" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-perception" type="number" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div></div> <div><h4 class="text-indigo-400 font-bold text-sm uppercase mb-3 border-b border-indigo-500/20 pb-2"> </h4> <div class="grid grid-cols-4 gap-3"></div></div> <div class="space-y-3 pt-4 border-t border-slate-800"><div><label for="enemy-speed-notes" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-speed-notes" type="text" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white text-sm"/></div> <div><label for="enemy-senses" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-senses" type="text" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white text-sm"/></div> <div><label for="enemy-immune" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <textarea id="enemy-immune" class="w-full bg-slate-900 border border-slate-700 rounded p-3 text-white text-sm min-h-[80px] resize-none focus:border-indigo-500 focus:outline-none transition-colors"></textarea></div></div></div>'),$i=c('<div class="flex gap-2 items-start"><div class="flex-1 space-y-1"><input class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm font-bold placeholder-slate-600"/> <textarea class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm placeholder-slate-600 resize-none" rows="2"></textarea></div> <button class="mt-1 text-slate-600 hover:text-red-400 p-2 hover:bg-slate-800 rounded"><!></button></div>'),Ci=c('<div class="text-xs text-slate-600 italic text-center py-4 border-2 border-dashed border-slate-800 rounded"> </div>'),Oi=c('<div class="flex gap-2 items-start"><div class="flex-1 space-y-2"><div class="grid grid-cols-2 gap-2"><input class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm font-bold placeholder-slate-600"/> <select class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm"><option> </option><option> </option></select></div> <div class="grid grid-cols-2 gap-2"><input class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm placeholder-slate-600"/> <input class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm placeholder-slate-600"/></div> <textarea class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm placeholder-slate-600 resize-none" rows="2"></textarea></div> <button class="mt-1 text-slate-600 hover:text-red-400 p-2 hover:bg-slate-800 rounded"><!></button></div>'),ji=c('<div class="text-xs text-slate-600 italic text-center py-4 border-2 border-dashed border-slate-800 rounded"> </div>'),Ei=c('<div class="flex gap-2 items-start"><div class="flex-1 space-y-1"><input class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm font-bold placeholder-slate-600"/> <textarea class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm placeholder-slate-600 resize-none" rows="2"></textarea></div> <button class="mt-1 text-slate-600 hover:text-red-400 p-2 hover:bg-slate-800 rounded"><!></button></div>'),Mi=c('<div class="text-xs text-slate-600 italic text-center py-4 border-2 border-dashed border-slate-800 rounded"> </div>'),Ii=c('<div class="flex gap-2 items-start"><div class="flex-1 space-y-1"><input class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm font-bold placeholder-slate-600"/> <textarea class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm placeholder-slate-600 resize-none" rows="2"></textarea></div> <button class="mt-1 text-slate-600 hover:text-red-400 p-2 hover:bg-slate-800 rounded"><!></button></div>'),Si=c('<div class="text-xs text-slate-600 italic text-center py-4 border-2 border-dashed border-slate-800 rounded"> </div>'),Ri=c('<div class="space-y-6 animate-in fade-in slide-in-from-bottom-2 duration-300"><div class="p-4 bg-slate-900 rounded border border-indigo-500/30"><div class="flex justify-between items-center mb-3"><h4 class="font-bold text-sm uppercase text-indigo-400"> </h4> <button class="text-xs bg-slate-800 px-2 py-1 rounded hover:bg-slate-700 text-white flex items-center gap-1 border border-slate-700"><!> </button></div> <div class="space-y-3"><!> <!></div></div> <div class="p-4 bg-slate-900 rounded border border-red-500/30"><div class="flex justify-between items-center mb-3"><h4 class="font-bold text-sm uppercase text-red-400"> </h4> <button class="text-xs bg-slate-800 px-2 py-1 rounded hover:bg-slate-700 text-white flex items-center gap-1 border border-slate-700"><!> </button></div> <div class="space-y-3"><!> <!></div></div> <div class="p-4 bg-slate-900 rounded border border-orange-500/30"><div class="flex justify-between items-center mb-3"><h4 class="font-bold text-sm uppercase text-orange-400"> </h4> <button class="text-xs bg-slate-800 px-2 py-1 rounded hover:bg-slate-700 text-white flex items-center gap-1 border border-slate-700"><!> </button></div> <div class="space-y-3"><!> <!></div></div> <div class="p-4 bg-slate-900 rounded border border-yellow-500/30"><div class="flex justify-between items-center mb-3"><h4 class="font-bold text-sm uppercase text-yellow-400"> </h4> <button class="text-xs bg-slate-800 px-2 py-1 rounded hover:bg-slate-700 text-white flex items-center gap-1 border border-slate-700"><!> </button></div> <div class="space-y-3"><!> <!></div></div></div>'),Ni=c('<div class="flex-1 flex items-start justify-center p-4 min-h-0 animate-in fade-in slide-in-from-right-2 duration-300"><!></div>'),Ai=c('<div class="fixed inset-0 z-[100] flex items-center justify-center bg-black/80 lg:p-4" role="button" aria-label="Close" tabindex="-1"><div class="bg-slate-900 w-full h-full lg:rounded-xl lg:max-w-6xl lg:h-[90vh] border-0 lg:border border-slate-700 shadow-2xl overflow-hidden flex flex-col lg:flex-row" role="dialog" aria-modal="true" aria-labelledby="modal-title"><div class="w-full lg:w-1/2 flex flex-col h-full border-r border-slate-700"><div class="p-4 border-b border-slate-700 bg-slate-900 flex justify-between items-center"><div class="flex items-center gap-3"><button class="lg:hidden text-slate-400 hover:text-white p-1 rounded-full hover:bg-slate-800 transition-colors"><!></button> <h3 id="modal-title" class="font-bold text-white text-lg"> </h3></div> <button class="hidden lg:block text-slate-400 hover:text-white"><!></button></div> <div class="flex border-b border-slate-700 bg-slate-900/50 overflow-x-auto"><button> </button> <button> </button> <button> </button> <button> </button></div> <div class="flex-1 overflow-y-auto p-6 custom-scrollbar bg-slate-800/50"><!></div> <div class="p-4 border-t border-slate-700 bg-slate-900 flex justify-end gap-3 safe-area-bottom"><button class="px-6 py-2 rounded bg-indigo-600 hover:bg-indigo-500 text-white font-bold flex items-center gap-2 transition-colors"><!> </button></div></div> <div class="hidden lg:flex w-1/2 bg-slate-950 flex-col border-l border-slate-800"><div class="p-4 border-b border-slate-800 bg-slate-950"><h3 class="font-bold text-slate-500 text-xs uppercase flex items-center gap-2"><!> </h3></div> <div class="flex-1 p-8 overflow-y-auto flex items-start justify-center bg-[radial-gradient(ellipse_at_top,_var(--tw-gradient-stops))] from-slate-900 via-slate-950 to-slate-950"><!></div></div></div></div> <input type="file" hidden="" accept="image/*"/> <!>',1);function Di(Z,o){ua(o,!0);const n=()=>qt(aa,"$t",ve),[ve,F]=xa(),p=P=>{var K=yi(),R=t(K),Ge=t(R);{var Ye=v=>{var b=li(),m=t(b);Ea(m,{get hash(){return a(i).imageUrl},get alt(){return a(i).name},size:"custom"}),e(b),d(v,b)};f(Ge,v=>{a(i).imageUrl&&v(Ye)})}var vt=s(Ge,2),$t=t(vt),it=t($t),At=t(it,!0);e(it);var ht=s(it,2),se=t(ht);e(ht),e($t);var ce=s($t,2),Ke=t(ce);e(ce);var He=s(ce,2);{var bt=v=>{var b=di(),m=t(b,!0);e(b),x(()=>r(m,a(i).description)),d(v,b)};f(He,v=>{a(i).description&&v(bt)})}e(vt),e(R);var nt=s(R,2),ie=t(nt),Fe=t(ie,!0);e(ie);var E=s(ie,2),ze=t(E);e(E);var me=s(E,2);{var Le=v=>{var b=vi(),m=t(b);e(b),x(()=>r(m,`; ${a(i).senses??""}`)),d(v,b)};f(me,v=>{a(i).senses&&v(Le)})}e(nt);var Se=s(nt,2),xt=t(Se),et=t(xt,!0);e(xt);var tt=s(xt,2),Ct=t(tt,!0);e(tt);var Et=s(tt,2),Dt=t(Et,!0);e(Et);var Pt=s(Et,2),z=t(Pt,!0);e(Pt),e(Se);var S=s(Se,2),D=t(S),$e=t(D),ct=t($e,!0);e($e);var qe=s($e),ot=s(qe),yt=t(ot,!0);e(ot);var Mt=s(ot),Pe=s(Mt),kt=t(Pe,!0);e(Pe);var N=s(Pe),j=s(N),A=t(j,!0);e(j);var ne=s(j);e(D),e(S);var I=s(S,2),J=t(I),Y=t(J,!0);e(J);var he=s(J,2),de=t(he,!0);e(he);var re=s(he,2);{var T=v=>{var b=ci(),m=t(b);e(b),x(()=>r(m,`; ${a(i).speedNotes??""}`)),d(v,b)};f(re,v=>{a(i).speedNotes&&v(T)})}e(I);var Ce=s(I,2);{var be=v=>{var b=ui(),m=t(b),G=t(m,!0);e(m);var ee=s(m,2),fe=t(ee,!0);e(ee),e(b),x(Be=>{r(G,Be),r(fe,a(i).immunities)},[()=>n()("session.enemy_modal.immunities")]),d(v,b)};f(Ce,v=>{a(i).immunities&&v(be)})}var Me=s(Ce,4);{var dt=v=>{var b=Nt(),m=Je(b);Ve(m,17,()=>a(i).traits,Ot,(G,ee)=>{var fe=bi(),Be=t(fe),mt=t(Be,!0);e(Be);var ft=s(Be,2),Ht=t(ft,!0);e(ft),e(fe),x(()=>{r(mt,a(ee).name),r(Ht,a(ee).desc)}),d(G,fe)}),d(v,b)};f(Me,v=>{a(i).traits.length>0&&v(dt)})}var pt=s(Me,2);{var wt=v=>{var b=pi(),m=t(b),G=t(m,!0);e(m);var ee=s(m,2);Ve(ee,17,()=>a(i).attackOptions,Ot,(fe,Be)=>{var mt=xi(),ft=t(mt),Ht=t(ft,!0);e(ft);var St=s(ft,2),Lt=t(St);e(St);var Tt=s(St,2),Gt=t(Tt);e(Tt);var Wt=s(Tt,2);{var Qt=l=>{var u=_i(),_=t(u);e(u),x(()=>r(_,`; ${a(Be).desc??""}`)),d(l,u)};f(Wt,l=>{a(Be).desc&&l(Qt)})}e(mt),x(l=>{r(Ht,a(Be).name),r(Lt,`(${l??""})`),r(Gt,`${a(Be).attackRoll??""} (${a(Be).damage??""})`)},[()=>a(Be).type==="melee"?n()("session.enemy_modal.melee").toLowerCase():n()("session.enemy_modal.ranged").toLowerCase()]),d(fe,mt)}),e(b),x(fe=>r(G,fe),[()=>n()("session.enemy_modal.attack_options")]),d(v,b)};f(pt,v=>{a(i).attackOptions.length>0&&v(wt)})}var lt=s(pt,2);{var It=v=>{var b=fi(),m=t(b),G=t(m,!0);e(m);var ee=s(m,2);Ve(ee,17,()=>a(i).specialAttacks,Ot,(fe,Be)=>{var mt=mi(),ft=t(mt),Ht=t(ft,!0);e(ft);var St=s(ft,2),Lt=t(St,!0);e(St),e(mt),x(()=>{r(Ht,a(Be).name),r(Lt,a(Be).desc)}),d(fe,mt)}),e(b),x(fe=>r(G,fe),[()=>n()("session.enemy_modal.special_attacks")]),d(v,b)};f(lt,v=>{a(i).specialAttacks.length>0&&v(It)})}var Ut=s(lt,2);{var Bt=v=>{var b=hi(),m=t(b),G=t(m,!0);e(m);var ee=s(m,2);Ve(ee,17,()=>a(i).endOfRound,Ot,(fe,Be)=>{var mt=gi(),ft=t(mt),Ht=t(ft,!0);e(ft);var St=s(ft,2),Lt=t(St,!0);e(St),e(mt),x(()=>{r(Ht,a(Be).name),r(Lt,a(Be).desc)}),d(fe,mt)}),e(b),x(fe=>r(G,fe),[()=>n()("session.enemy_modal.end_of_round")]),d(v,b)};f(Ut,v=>{a(i).endOfRound.length>0&&v(Bt)})}e(K),x((v,b,m,G,ee,fe,Be,mt,ft,Ht,St,Lt,Tt,Gt,Wt,Qt)=>{r(At,v),r(se,`${b??""} ${a(i).difficulty??""}`),r(Ke,`${m??""} ${a(i).size??""} ${a(i).descriptors??""}`),r(Fe,G),r(ze,`${a(i).perception??""} (${ee??""})`),r(et,fe),r(Ct,a(i).defense),r(Dt,Be),r(z,a(i).health),r(ct,mt),r(qe,` ${a(i).attributes.strength??""} (${ft??""}), `),r(yt,Ht),r(Mt,` ${a(i).attributes.agility??""} (${St??""}), `),r(kt,Lt),r(N,` ${a(i).attributes.intellect??""} (${Tt??""}), `),r(A,Gt),r(ne,` ${a(i).attributes.will??""} (${Wt??""})`),r(Y,Qt),r(de,a(i).speed)},[()=>a(i).name||n()("session.enemy_modal.enemy_default"),()=>n()("session.enemies.difficulty").toUpperCase(),()=>n()("session.enemy_modal.size"),()=>n()("sofdl.attributes.perception"),()=>ue(a(i).perception),()=>n()("session.enemy_modal.defense"),()=>n()("session.enemy_modal.health"),()=>n()("sofdl.attributes.strength"),()=>ue(a(i).attributes.strength),()=>n()("sofdl.attributes.agility"),()=>ue(a(i).attributes.agility),()=>n()("sofdl.attributes.intellect"),()=>ue(a(i).attributes.intellect),()=>n()("sofdl.attributes.will"),()=>ue(a(i).attributes.will),()=>n()("session.enemy_modal.speed")]),d(P,K)};let q=Kt(o,"isOpen",3,!1),X=Kt(o,"initialData",3,"{}"),i=gt(ca(Ee())),y=gt("general"),ae=gt(!1),Ue=gt(""),we=gt(void 0);function Ze(P){const K=P.target.files;if(K&&K.length>0){const R=K[0],Ge=new FileReader;Ge.onload=()=>{k(Ue,Ge.result,!0),k(ae,!0)},Ge.readAsDataURL(R)}P.target&&(P.target.value="")}async function je(P){try{const K=await ns(P);a(i).imageUrl=K,k(ae,!1)}catch(K){console.error(K),alert(K.message||"Erro ao salvar imagem")}}function Ee(){return{name:"",difficulty:1,size:"1",description:"",descriptors:"",perception:10,senses:"",defense:10,health:10,attributes:{strength:10,agility:10,intellect:10,will:10},speed:10,speedNotes:"",immunities:"",traits:[],attackOptions:[],specialAttacks:[],endOfRound:[],imageUrl:"",global:!1}}function ue(P){const K=P-10;return K>=0?`+${K}`:`${K}`}Na(()=>{if(q()&&X())try{const P=JSON.parse(X());Object.keys(P).length===0?k(i,Ee(),!0):k(i,{...Ee(),...P},!0)}catch{k(i,Ee(),!0)}});function Te(){a(i).traits=[...a(i).traits,{name:"",desc:""}]}function ge(P){a(i).traits=a(i).traits.filter((K,R)=>R!==P)}function Rt(){a(i).attackOptions=[...a(i).attackOptions,{name:"",type:"melee",attackRoll:"+0",damage:"1d6",desc:""}]}function zt(P){a(i).attackOptions=a(i).attackOptions.filter((K,R)=>R!==P)}function Ft(){a(i).specialAttacks=[...a(i).specialAttacks,{name:"",desc:""}]}function ke(P){a(i).specialAttacks=a(i).specialAttacks.filter((K,R)=>R!==P)}function Ne(){a(i).endOfRound=[...a(i).endOfRound,{name:"",desc:""}]}function Xe(P){a(i).endOfRound=a(i).endOfRound.filter((K,R)=>R!==P)}function rt(P){}var xe=Nt(),Ae=Je(xe);{var _t=P=>{var K=Ai(),R=Je(K);R.__click=rt;var Ge=t(R),Ye=t(Ge),vt=t(Ye),$t=t(vt),it=t($t);it.__click=function(...Pe){o.onClose?.apply(this,Pe)};var At=t(it);Aa(At,{size:24}),e(it);var ht=s(it,2),se=t(ht,!0);e(ht),e($t);var ce=s($t,2);ce.__click=function(...Pe){o.onClose?.apply(this,Pe)};var Ke=t(ce);ma(Ke,{size:20}),e(ce),e(vt);var He=s(vt,2),bt=t(He);bt.__click=()=>k(y,"general");var nt=t(bt,!0);e(bt);var ie=s(bt,2);ie.__click=()=>k(y,"stats");var Fe=t(ie,!0);e(ie);var E=s(ie,2);E.__click=()=>k(y,"abilities");var ze=t(E,!0);e(E);var me=s(E,2);me.__click=()=>k(y,"preview");var Le=t(me,!0);e(me),e(He);var Se=s(He,2),xt=t(Se);{var et=Pe=>{var kt=wi(),N=t(kt),j=t(N);j.__click=()=>a(we)?.click();var A=t(j),ne=t(A);Ba(ne,()=>a(i).imageUrl,m=>{Ea(m,{get hash(){return a(i).imageUrl},get alt(){return a(i).name},size:"custom",fallbackText:"?"})}),e(A);var I=s(A,2),J=t(I);os(J,{size:20,class:"text-white"}),e(I),e(j);var Y=s(j,2),he=t(Y),de=t(he,!0);e(he);var re=s(he,2);ut(re),e(Y),e(N);var T=s(N,2),Ce=t(T),be=t(Ce,!0);e(Ce);var Me=s(Ce,2);pa(Me),e(T);var dt=s(T,2),pt=t(dt),wt=t(pt,!0);e(pt);var lt=s(pt,2);ut(lt),e(dt);var It=s(dt,2),Ut=t(It);ut(Ut);var Bt=s(Ut,2),v=t(Bt);da(v,{size:14});var b=s(v);e(Bt),e(It),e(kt),x((m,G,ee,fe,Be,mt)=>{r(de,m),r(be,G),_e(Me,"placeholder",ee),r(wt,fe),_e(lt,"placeholder",Be),r(b,` ${mt??""}`)},[()=>n()("session.enemy_modal.name"),()=>n()("session.enemy_modal.description"),()=>n()("session.enemy_modal.description_placeholder"),()=>n()("session.enemy_modal.descriptors"),()=>n()("session.enemy_modal.descriptors_placeholder"),()=>n()("session.enemy_modal.global_enemy")]),at(re,()=>a(i).name,m=>a(i).name=m),at(Me,()=>a(i).description,m=>a(i).description=m),at(lt,()=>a(i).descriptors,m=>a(i).descriptors=m),Ya(Ut,()=>a(i).global,m=>a(i).global=m),d(Pe,kt)},tt=Pe=>{var kt=Nt(),N=Je(kt);{var j=ne=>{var I=zi(),J=t(I),Y=t(J),he=t(Y),de=t(he,!0);e(he);var re=s(he,2);ut(re),e(Y);var T=s(Y,2),Ce=t(T),be=t(Ce,!0);e(Ce);var Me=s(Ce,2);ut(Me),e(T),e(J);var dt=s(J,2),pt=t(dt),wt=t(pt),lt=t(wt,!0);e(wt);var It=s(wt,2);ut(It),e(pt);var Ut=s(pt,2),Bt=t(Ut),v=t(Bt,!0);e(Bt);var b=s(Bt,2);ut(b),e(Ut),e(dt);var m=s(dt,2),G=t(m),ee=t(G),fe=t(ee,!0);e(ee);var Be=s(ee,2);ut(Be),e(G);var mt=s(G,2),ft=t(mt),Ht=t(ft,!0);e(ft);var St=s(ft,2);ut(St),e(mt),e(m);var Lt=s(m,2),Tt=t(Lt),Gt=t(Tt,!0);e(Tt);var Wt=s(Tt,2);Ve(Wt,5,()=>[{key:"strength",label:n()("sofdl.attributes.strength")},{key:"agility",label:n()("sofdl.attributes.agility")},{key:"intellect",label:n()("sofdl.attributes.intellect")},{key:"will",label:n()("sofdl.attributes.will")}],Ot,(U,V)=>{var Ie=ki(),H=t(Ie),Re=t(H,!0);e(H);var h=s(H,2);ut(h);var g=s(h,2),B=t(g,!0);e(g),e(Ie),x((C,L)=>{_e(H,"for",`attr-${a(V).key??""}`),_e(H,"title",a(V).label),r(Re,C),_e(h,"id",`attr-${a(V).key??""}`),st(g,1,`text-xs font-bold ${a(i).attributes[a(V).key]-10>=0?"text-green-500":"text-red-500"}`),r(B,L)},[()=>a(V).label.substring(0,3),()=>ue(a(i).attributes[a(V).key])]),at(h,()=>a(i).attributes[a(V).key],C=>a(i).attributes[a(V).key]=C),d(U,Ie)}),e(Wt),e(Lt);var Qt=s(Lt,2),l=t(Qt),u=t(l),_=t(u,!0);e(u);var w=s(u,2);ut(w),e(l);var te=s(l,2),$=t(te),O=t($,!0);e($);var W=s($,2);ut(W),e(te);var Q=s(te,2),M=t(Q),oe=t(M,!0);e(M);var pe=s(M,2);pa(pe),e(Q),e(Qt),e(I),x((U,V,Ie,H,Re,h,g,B,C,L,le,Oe,We)=>{r(de,U),r(be,V),r(lt,Ie),r(v,H),r(fe,Re),r(Ht,h),r(Gt,g),r(_,B),_e(w,"placeholder",C),r(O,L),_e(W,"placeholder",le),r(oe,Oe),_e(pe,"placeholder",We)},[()=>n()("session.enemy_modal.difficulty"),()=>n()("session.enemy_modal.size"),()=>n()("session.enemy_modal.speed"),()=>n()("session.enemy_modal.health"),()=>n()("session.enemy_modal.defense"),()=>n()("sofdl.attributes.perception"),()=>n()("session.enemy_modal.main_attributes"),()=>n()("session.enemy_modal.speed_notes"),()=>n()("session.enemy_modal.speed_notes_placeholder"),()=>n()("session.enemy_modal.senses"),()=>n()("session.enemy_modal.senses_placeholder_sotdl"),()=>n()("session.enemy_modal.immunities"),()=>n()("session.enemy_modal.immunities_placeholder_sotdl")]),at(re,()=>a(i).difficulty,U=>a(i).difficulty=U),at(Me,()=>a(i).size,U=>a(i).size=U),at(It,()=>a(i).speed,U=>a(i).speed=U),at(b,()=>a(i).health,U=>a(i).health=U),at(Be,()=>a(i).defense,U=>a(i).defense=U),at(St,()=>a(i).perception,U=>a(i).perception=U),at(w,()=>a(i).speedNotes,U=>a(i).speedNotes=U),at(W,()=>a(i).senses,U=>a(i).senses=U),at(pe,()=>a(i).immunities,U=>a(i).immunities=U),d(ne,I)},A=ne=>{var I=Nt(),J=Je(I);{var Y=de=>{var re=Ri(),T=t(re),Ce=t(T),be=t(Ce),Me=t(be,!0);e(be);var dt=s(be,2);dt.__click=Te;var pt=t(dt);ea(pt,{size:12});var wt=s(pt);e(dt),e(Ce);var lt=s(Ce,2),It=t(lt);Ve(It,17,()=>a(i).traits,Ot,(h,g,B)=>{var C=$i(),L=t(C),le=t(L);ut(le);var Oe=s(le,2);pa(Oe),e(L);var We=s(L,2);We.__click=()=>ge(B);var Qe=t(We);sa(Qe,{size:16}),e(We),e(C),x((De,jt)=>{_e(le,"placeholder",De),_e(Oe,"placeholder",jt)},[()=>n()("session.enemy_modal.name_placeholder"),()=>n()("session.enemy_modal.desc_placeholder")]),at(le,()=>a(g).name,De=>a(g).name=De),at(Oe,()=>a(g).desc,De=>a(g).desc=De),d(h,C)});var Ut=s(It,2);{var Bt=h=>{var g=Ci(),B=t(g,!0);e(g),x(C=>r(B,C),[()=>n()("session.enemy_modal.empty")]),d(h,g)};f(Ut,h=>{a(i).traits.length===0&&h(Bt)})}e(lt),e(T);var v=s(T,2),b=t(v),m=t(b),G=t(m,!0);e(m);var ee=s(m,2);ee.__click=Rt;var fe=t(ee);ea(fe,{size:12});var Be=s(fe);e(ee),e(b);var mt=s(b,2),ft=t(mt);Ve(ft,17,()=>a(i).attackOptions,Ot,(h,g,B)=>{var C=Oi(),L=t(C),le=t(L),Oe=t(le);ut(Oe);var We=s(Oe,2),Qe=t(We),De=t(Qe,!0);e(Qe),Qe.value=Qe.__value="melee";var jt=s(Qe),Vt=t(jt,!0);e(jt),jt.value=jt.__value="ranged",e(We),e(le);var Yt=s(le,2),ta=t(Yt);ut(ta);var fa=s(ta,2);ut(fa),e(Yt);var ga=s(Yt,2);pa(ga),e(L);var la=s(L,2);la.__click=()=>zt(B);var $a=t(la);sa($a,{size:16}),e(la),e(C),x((Jt,Ca,Xt,Oa,bs,_s)=>{_e(Oe,"placeholder",Jt),r(De,Ca),r(Vt,Xt),_e(ta,"placeholder",Oa),_e(fa,"placeholder",bs),_e(ga,"placeholder",_s)},[()=>n()("session.enemy_modal.name_placeholder"),()=>n()("session.enemy_modal.melee"),()=>n()("session.enemy_modal.ranged"),()=>n()("session.enemy_modal.attack_placeholder"),()=>n()("session.enemy_modal.damage_placeholder"),()=>n()("session.enemy_modal.desc_effects_placeholder")]),at(Oe,()=>a(g).name,Jt=>a(g).name=Jt),ps(We,()=>a(g).type,Jt=>a(g).type=Jt),at(ta,()=>a(g).attackRoll,Jt=>a(g).attackRoll=Jt),at(fa,()=>a(g).damage,Jt=>a(g).damage=Jt),at(ga,()=>a(g).desc,Jt=>a(g).desc=Jt),d(h,C)});var Ht=s(ft,2);{var St=h=>{var g=ji(),B=t(g,!0);e(g),x(C=>r(B,C),[()=>n()("session.enemy_modal.empty")]),d(h,g)};f(Ht,h=>{a(i).attackOptions.length===0&&h(St)})}e(mt),e(v);var Lt=s(v,2),Tt=t(Lt),Gt=t(Tt),Wt=t(Gt,!0);e(Gt);var Qt=s(Gt,2);Qt.__click=Ft;var l=t(Qt);ea(l,{size:12});var u=s(l);e(Qt),e(Tt);var _=s(Tt,2),w=t(_);Ve(w,17,()=>a(i).specialAttacks,Ot,(h,g,B)=>{var C=Ei(),L=t(C),le=t(L);ut(le);var Oe=s(le,2);pa(Oe),e(L);var We=s(L,2);We.__click=()=>ke(B);var Qe=t(We);sa(Qe,{size:16}),e(We),e(C),x((De,jt)=>{_e(le,"placeholder",De),_e(Oe,"placeholder",jt)},[()=>n()("session.enemy_modal.name_placeholder"),()=>n()("session.enemy_modal.desc_placeholder")]),at(le,()=>a(g).name,De=>a(g).name=De),at(Oe,()=>a(g).desc,De=>a(g).desc=De),d(h,C)});var te=s(w,2);{var $=h=>{var g=Mi(),B=t(g,!0);e(g),x(C=>r(B,C),[()=>n()("session.enemy_modal.empty")]),d(h,g)};f(te,h=>{a(i).specialAttacks.length===0&&h($)})}e(_),e(Lt);var O=s(Lt,2),W=t(O),Q=t(W),M=t(Q,!0);e(Q);var oe=s(Q,2);oe.__click=Ne;var pe=t(oe);ea(pe,{size:12});var U=s(pe);e(oe),e(W);var V=s(W,2),Ie=t(V);Ve(Ie,17,()=>a(i).endOfRound,Ot,(h,g,B)=>{var C=Ii(),L=t(C),le=t(L);ut(le);var Oe=s(le,2);pa(Oe),e(L);var We=s(L,2);We.__click=()=>Xe(B);var Qe=t(We);sa(Qe,{size:16}),e(We),e(C),x((De,jt)=>{_e(le,"placeholder",De),_e(Oe,"placeholder",jt)},[()=>n()("session.enemy_modal.name_placeholder"),()=>n()("session.enemy_modal.desc_placeholder")]),at(le,()=>a(g).name,De=>a(g).name=De),at(Oe,()=>a(g).desc,De=>a(g).desc=De),d(h,C)});var H=s(Ie,2);{var Re=h=>{var g=Si(),B=t(g,!0);e(g),x(C=>r(B,C),[()=>n()("session.enemy_modal.empty")]),d(h,g)};f(H,h=>{a(i).endOfRound.length===0&&h(Re)})}e(V),e(O),e(re),x((h,g,B,C,L,le,Oe,We)=>{r(Me,h),r(wt,` ${g??""}`),r(G,B),r(Be,` ${C??""}`),r(Wt,L),r(u,` ${le??""}`),r(M,Oe),r(U,` ${We??""}`)},[()=>n()("session.enemy_modal.traits"),()=>n()("common.buttons.add"),()=>n()("session.enemy_modal.attack_options"),()=>n()("common.buttons.add"),()=>n()("session.enemy_modal.special_attacks"),()=>n()("common.buttons.add"),()=>n()("session.enemy_modal.end_of_round"),()=>n()("common.buttons.add")]),d(de,re)},he=de=>{var re=Nt(),T=Je(re);{var Ce=be=>{var Me=Ni(),dt=t(Me);p(dt),e(Me),d(be,Me)};f(T,be=>{a(y)==="preview"&&be(Ce)},!0)}d(de,re)};f(J,de=>{a(y)==="abilities"?de(Y):de(he,!1)},!0)}d(ne,I)};f(N,ne=>{a(y)==="stats"?ne(j):ne(A,!1)},!0)}d(Pe,kt)};f(xt,Pe=>{a(y)==="general"?Pe(et):Pe(tt,!1)})}e(Se);var Ct=s(Se,2),Et=t(Ct);Et.__click=()=>o.onSave(a(i));var Dt=t(Et);Ja(Dt,{size:18});var Pt=s(Dt);e(Et),e(Ct),e(Ye);var z=s(Ye,2),S=t(z),D=t(S),$e=t(D);qa($e,{size:14});var ct=s($e);e(D),e(S);var qe=s(S,2),ot=t(qe);p(ot),e(qe),e(z),e(Ge),e(R);var yt=s(R,2);yt.__change=Ze,vs(yt,Pe=>k(we,Pe),()=>a(we));var Mt=s(yt,2);is(Mt,{get isOpen(){return a(ae)},get imageUrl(){return a(Ue)},onClose:()=>k(ae,!1),onCrop:je}),x((Pe,kt,N,j,A,ne,I)=>{r(se,Pe),st(bt,1,`flex-1 py-3 px-4 text-sm font-bold border-b-2 whitespace-nowrap transition-colors ${a(y)==="general"?"border-indigo-500 text-indigo-400 bg-slate-800":"border-transparent text-slate-500 hover:text-white"}`),r(nt,kt),st(ie,1,`flex-1 py-3 px-4 text-sm font-bold border-b-2 whitespace-nowrap transition-colors ${a(y)==="stats"?"border-indigo-500 text-indigo-400 bg-slate-800":"border-transparent text-slate-500 hover:text-white"}`),r(Fe,N),st(E,1,`flex-1 py-3 px-4 text-sm font-bold border-b-2 whitespace-nowrap transition-colors ${a(y)==="abilities"?"border-indigo-500 text-indigo-400 bg-slate-800":"border-transparent text-slate-500 hover:text-white"}`),r(ze,j),st(me,1,`lg:hidden flex-1 py-3 px-4 text-sm font-bold border-b-2 whitespace-nowrap transition-colors ${a(y)==="preview"?"border-indigo-500 text-indigo-400 bg-slate-800":"border-transparent text-slate-500 hover:text-white"}`),r(Le,A),r(Pt,` ${ne??""}`),r(ct,` ${I??""}`)},[()=>n()("session.enemy_modal.title_sotdl"),()=>n()("session.enemy_modal.tab_general"),()=>n()("session.enemy_modal.tab_stats"),()=>n()("session.enemy_modal.tab_abilities"),()=>n()("session.enemy_modal.preview"),()=>n()("common.buttons.save"),()=>n()("session.enemy_modal.preview")]),Sa(3,Ge,()=>Ra,()=>({y:20,duration:300})),Sa(3,R,()=>Ra,()=>({duration:200,opacity:1})),d(P,K)};f(Ae,P=>{q()&&P(_t)})}d(Z,xe),ba(),F()}_a(["click","change"]);var Ti=c('<div class="w-16 h-16 rounded-lg overflow-hidden border border-slate-700 shadow-lg flex-shrink-0"><!></div>'),Pi=c('<div class="bg-slate-950 p-2 rounded border border-slate-800"><div class="text-[10px] text-slate-500 uppercase font-bold mb-1"> </div> <div class="text-white font-bold"> <span> </span></div></div>'),Ui=c('<div class="flex gap-2"><span class="font-bold text-slate-500 uppercase"> </span> <span class="text-white"> </span></div>'),Hi=c('<div class="flex gap-2"><span class="font-bold text-slate-500 uppercase"> </span> <span class="text-white"> </span></div>'),Li=c('<div class="flex gap-2"><span class="font-bold text-slate-500 uppercase"> </span> <span class="text-white"> </span></div>'),Fi=c('<div class="mb-2 pl-3 border-l-2 border-indigo-900"><span class="font-bold text-white"> </span> <span class="text-slate-300"> </span></div>'),qi=c('<div><h4 class="font-bold text-indigo-400 uppercase text-xs mb-2 tracking-wider"> </h4> <!></div>'),Bi=c('<div class="mb-2 pl-3 border-l-2 border-red-900/50"><span class="font-bold text-white"> </span> <span class="text-slate-300"> </span></div>'),Ji=c('<div><h4 class="font-bold text-red-500 uppercase text-xs mb-2 tracking-wider"> </h4> <!></div>'),Gi=c('<div class="mb-2 pl-3 border-l-2 border-orange-900/50"><span class="font-bold text-white"> </span> <span class="text-slate-300"> </span></div>'),Wi=c('<div><h4 class="font-bold text-orange-400 uppercase text-xs mb-2 tracking-wider"> </h4> <!></div>'),Qi=c('<div class="mb-2 pl-3 border-l-2 border-yellow-900/50"><span class="font-bold text-white"> </span> <span class="text-slate-300"> </span></div>'),Vi=c('<div><h4 class="font-bold text-yellow-500 uppercase text-xs mb-2 tracking-wider"> </h4> <!></div>'),Zi=c('<div class="w-full max-w-md bg-slate-900 border border-slate-700 rounded-xl p-5 shadow-2xl relative"><div class="absolute -top-3 -right-3 bg-red-600 text-white text-xs font-bold px-3 py-1 rounded-full shadow-lg border border-red-400"> </div> <div class="flex items-center gap-3 mb-4"><!> <div class="flex-1 min-w-0"><h2 class="text-2xl font-bold text-white mb-1 font-serif tracking-wide truncate"> </h2> <div class="h-1 w-20 bg-red-600 rounded-full"></div></div></div> <div class="grid grid-cols-2 gap-4 mb-4 text-sm"><div class="bg-slate-950 p-2 rounded border border-slate-800 flex justify-between items-center"><span class="text-slate-500 uppercase font-bold text-[10px]"> </span> <span class="text-white font-mono font-bold text-lg"> </span></div> <div class="bg-slate-950 p-2 rounded border border-slate-800 flex justify-between items-center"><span class="text-slate-500 uppercase font-bold text-[10px]"> </span> <span class="text-white font-mono font-bold text-lg"> </span></div> <div class="bg-slate-950 p-2 rounded border border-slate-800 flex justify-between items-center"><span class="text-slate-500 uppercase font-bold text-[10px]"> </span> <span class="text-white font-mono font-bold"> </span></div> <div class="bg-slate-950 p-2 rounded border border-slate-800 flex justify-between items-center"><span class="text-slate-500 uppercase font-bold text-[10px]"> </span> <span class="text-white font-mono font-bold"> </span></div></div> <div class="grid grid-cols-4 gap-2 mb-6 text-center font-mono text-slate-300"></div> <div class="mb-6 space-y-2 text-xs"><!> <!> <!></div> <div class="space-y-5 text-sm"><!> <!> <!> <!></div></div>'),Xi=c('<div class="space-y-4 animate-in fade-in slide-in-from-bottom-2 duration-300"><div class="flex items-center gap-4"><div class="relative group cursor-pointer"><div class="w-16 h-16 rounded-xl overflow-hidden border border-slate-700"><!></div> <div class="absolute inset-0 bg-black/50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity rounded-xl"><!></div></div> <div class="flex-1"><label for="enemy-name" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-name" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white font-bold text-lg"/></div></div> <div><label for="enemy-desc" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <textarea id="enemy-desc" class="w-full bg-slate-900 border border-slate-700 rounded p-3 text-white text-sm min-h-[100px] resize-none focus:border-indigo-500 focus:outline-none transition-colors"></textarea></div> <div class="flex items-center gap-2"><input id="enemy-global" type="checkbox" class="w-4 h-4 bg-slate-900 border-slate-700 rounded focus:ring-indigo-500"/> <label for="enemy-global" class="text-sm font-bold text-slate-400 select-none cursor-pointer flex items-center gap-2"><!> </label></div></div>'),Yi=c('<div class="bg-slate-900 p-2 rounded border border-slate-700 text-center"><label class="text-[10px] text-slate-500 uppercase font-bold block mb-1 text-ellipsis overflow-hidden whitespace-nowrap"> </label> <input type="number" class="w-full bg-transparent text-center font-bold text-white text-xl focus:outline-none mb-1"/> <div> </div></div>'),Ki=c('<div class="space-y-6 animate-in fade-in slide-in-from-bottom-2 duration-300"><div class="grid grid-cols-2 gap-4"><div><label for="enemy-diff" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label><input id="enemy-diff" type="number" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div> <div><label for="enemy-size" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label><input id="enemy-size" type="number" step="0.5" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div></div> <div class="grid grid-cols-2 gap-4"><div><label for="enemy-defense" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label><input id="enemy-defense" type="number" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div> <div><label for="enemy-health" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label><input id="enemy-health" type="number" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div></div> <div class="grid grid-cols-2 gap-4"><div><label for="enemy-damage" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label><input id="enemy-damage" type="number" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div> <div><label for="enemy-speed" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label><input id="enemy-speed" type="number" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div></div> <div><h4 class="text-indigo-400 font-bold text-sm uppercase mb-3 text-center border-b border-indigo-500/20 pb-2"> </h4> <div class="grid grid-cols-4 gap-3"></div></div> <div class="space-y-3 pt-4 border-t border-slate-800"><div><label for="enemy-senses" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label><input id="enemy-senses" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white text-sm"/></div> <div><label for="enemy-langs" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label><input id="enemy-langs" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white text-sm"/></div> <div><label for="enemy-immune" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label><input id="enemy-immune" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white text-sm"/></div></div></div>'),en=c('<div class="flex gap-2 items-start animate-in fade-in slide-in-from-left-2"><div class="flex-1 space-y-1"><input class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm font-bold placeholder-slate-600 focus:border-indigo-500 focus:outline-none"/> <textarea class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm placeholder-slate-600 resize-none focus:border-indigo-500 focus:outline-none" rows="2"></textarea></div> <button class="mt-1 text-slate-600 hover:text-red-400 p-2 hover:bg-slate-800 rounded"><!></button></div>'),tn=c('<div class="text-xs text-slate-600 italic text-center py-4 border-2 border-dashed border-slate-800 rounded"> </div>'),an=c('<div><div class="flex justify-between items-center mb-3"><h4> </h4> <button class="text-xs bg-slate-800 px-2 py-1 rounded hover:bg-slate-700 text-white flex items-center gap-1 border border-slate-700"><!> </button></div> <div class="space-y-3"><!> <!></div></div>'),sn=c('<div class="space-y-6 animate-in fade-in slide-in-from-bottom-2 duration-300"></div>'),rn=c('<div class="flex-1 flex items-start justify-center p-4 min-h-0 animate-in fade-in slide-in-from-right-2 duration-300"><!></div>'),nn=c('<div class="fixed inset-0 z-[100] flex items-center justify-center bg-black/80 lg:p-4" role="button" tabindex="-1"><div class="bg-slate-900 w-full h-full lg:rounded-xl lg:max-w-6xl lg:h-[90vh] border-0 lg:border border-slate-700 shadow-2xl overflow-hidden flex flex-col lg:flex-row" role="dialog" aria-modal="true" aria-labelledby="modal-title"><div class="w-full lg:w-1/2 flex flex-col h-full border-r border-slate-700"><div class="p-4 border-b border-slate-700 bg-slate-900 flex justify-between items-center"><div class="flex items-center gap-3"><button class="lg:hidden text-slate-400 hover:text-white p-1 rounded-full hover:bg-slate-800 transition-colors"><!></button> <h3 id="modal-title" class="font-bold text-white text-lg"> </h3></div> <button class="hidden lg:block text-slate-400 hover:text-white"><!></button></div> <div class="flex border-b border-slate-700 bg-slate-900/50 overflow-x-auto"><button> </button> <button> </button> <button> </button> <button> </button></div> <div class="flex-1 overflow-y-auto p-6 custom-scrollbar bg-slate-800/50"><!></div> <div class="p-4 border-t border-slate-700 bg-slate-900 flex justify-end gap-3 safe-area-bottom"><button class="px-6 py-2 rounded bg-indigo-600 hover:bg-indigo-500 text-white font-bold flex items-center gap-2 transition-colors"><!> </button></div></div> <div class="hidden lg:flex w-1/2 bg-slate-950 flex-col border-l border-slate-800"><div class="p-4 border-b border-slate-800 bg-slate-950"><h3 class="font-bold text-slate-500 text-xs uppercase flex items-center gap-2"><!> </h3></div> <div class="flex-1 p-8 overflow-y-auto flex items-center justify-center bg-[radial-gradient(ellipse_at_top,_var(--tw-gradient-stops))] from-slate-900 via-slate-950 to-slate-950"><!></div></div></div></div> <input type="file" hidden="" accept="image/*"/> <!>',1);function on(Z,o){ua(o,!0);const n=()=>qt(aa,"$t",ve),[ve,F]=xa(),p=ke=>{var Ne=Zi(),Xe=t(Ne),rt=t(Xe);e(Xe);var xe=s(Xe,2),Ae=t(xe);{var _t=N=>{var j=Ti(),A=t(j);Ea(A,{get hash(){return a(i).imageUrl},get alt(){return a(i).name},size:"custom"}),e(j),d(N,j)};f(Ae,N=>{a(i).imageUrl&&N(_t)})}var P=s(Ae,2),K=t(P),R=t(K,!0);e(K),va(2),e(P),e(xe);var Ge=s(xe,2),Ye=t(Ge),vt=t(Ye),$t=t(vt,!0);e(vt);var it=s(vt,2),At=t(it,!0);e(it),e(Ye);var ht=s(Ye,2),se=t(ht),ce=t(se,!0);e(se);var Ke=s(se,2),He=t(Ke,!0);e(Ke),e(ht);var bt=s(ht,2),nt=t(bt),ie=t(nt,!0);e(nt);var Fe=s(nt,2),E=t(Fe,!0);e(Fe),e(bt);var ze=s(bt,2),me=t(ze),Le=t(me,!0);e(me);var Se=s(me,2),xt=t(Se,!0);e(Se),e(ze),e(Ge);var et=s(Ge,2);Ve(et,20,()=>["str","agi","int","wil"],Ot,(N,j)=>{var A=Pi(),ne=t(A),I=t(ne,!0);e(ne);var J=s(ne,2),Y=t(J),he=s(Y),de=t(he);e(he),e(J),e(A),x(()=>{r(I,j),r(Y,`${a(i).stats[j]??""} `),st(he,1,`text-xs ${a(i).stats[j]-10>=0?"text-green-500":"text-red-500"}`),r(de,`(${a(i).stats[j]-10>=0?"+":""}${a(i).stats[j]-10})`)}),d(N,A)}),e(et);var tt=s(et,2),Ct=t(tt);{var Et=N=>{var j=Ui(),A=t(j),ne=t(A);e(A);var I=s(A,2),J=t(I,!0);e(I),e(j),x(Y=>{r(ne,`${Y??""}:`),r(J,a(i).senses)},[()=>n()("session.enemy_modal.senses")]),d(N,j)};f(Ct,N=>{a(i).senses&&N(Et)})}var Dt=s(Ct,2);{var Pt=N=>{var j=Hi(),A=t(j),ne=t(A);e(A);var I=s(A,2),J=t(I,!0);e(I),e(j),x(Y=>{r(ne,`${Y??""}:`),r(J,a(i).languages)},[()=>n()("session.enemy_modal.languages")]),d(N,j)};f(Dt,N=>{a(i).languages&&N(Pt)})}var z=s(Dt,2);{var S=N=>{var j=Li(),A=t(j),ne=t(A);e(A);var I=s(A,2),J=t(I,!0);e(I),e(j),x(Y=>{r(ne,`${Y??""}:`),r(J,a(i).immune)},[()=>n()("session.enemy_modal.immunities")]),d(N,j)};f(z,N=>{a(i).immune&&N(S)})}e(tt);var D=s(tt,2),$e=t(D);{var ct=N=>{var j=qi(),A=t(j),ne=t(A,!0);e(A);var I=s(A,2);Ve(I,17,()=>a(i).traits,Ot,(J,Y,he,de)=>{var re=Fi(),T=t(re),Ce=t(T);e(T);var be=s(T,2),Me=t(be,!0);e(be),e(re),x(()=>{r(Ce,`${a(Y).name??""}:`),r(Me,a(Y).desc)}),d(J,re)}),e(j),x(J=>r(ne,J),[()=>n()("session.enemy_modal.traits")]),d(N,j)};f($e,N=>{a(i).traits.length>0&&N(ct)})}var qe=s($e,2);{var ot=N=>{var j=Ji(),A=t(j),ne=t(A,!0);e(A);var I=s(A,2);Ve(I,17,()=>a(i).actions,Ot,(J,Y,he,de)=>{var re=Bi(),T=t(re),Ce=t(T);e(T);var be=s(T,2),Me=t(be,!0);e(be),e(re),x(()=>{r(Ce,`${a(Y).name??""}:`),r(Me,a(Y).desc)}),d(J,re)}),e(j),x(J=>r(ne,J),[()=>n()("session.enemy_modal.actions")]),d(N,j)};f(qe,N=>{a(i).actions.length>0&&N(ot)})}var yt=s(qe,2);{var Mt=N=>{var j=Wi(),A=t(j),ne=t(A,!0);e(A);var I=s(A,2);Ve(I,17,()=>a(i).reactions,Ot,(J,Y,he,de)=>{var re=Gi(),T=t(re),Ce=t(T);e(T);var be=s(T,2),Me=t(be,!0);e(be),e(re),x(()=>{r(Ce,`${a(Y).name??""}:`),r(Me,a(Y).desc)}),d(J,re)}),e(j),x(J=>r(ne,J),[()=>n()("session.enemy_modal.reactions")]),d(N,j)};f(yt,N=>{a(i).reactions.length>0&&N(Mt)})}var Pe=s(yt,2);{var kt=N=>{var j=Vi(),A=t(j),ne=t(A,!0);e(A);var I=s(A,2);Ve(I,17,()=>a(i).endOfRound,Ot,(J,Y,he,de)=>{var re=Qi(),T=t(re),Ce=t(T);e(T);var be=s(T,2),Me=t(be,!0);e(be),e(re),x(()=>{r(Ce,`${a(Y).name??""}:`),r(Me,a(Y).desc)}),d(J,re)}),e(j),x(J=>r(ne,J),[()=>n()("session.enemy_modal.end_of_round")]),d(N,j)};f(Pe,N=>{a(i).endOfRound.length>0&&N(kt)})}e(D),e(Ne),x((N,j,A,ne,I,J)=>{r(rt,`${N??""} ${a(i).difficulty??""}`),r(R,j),r($t,A),r(At,a(i).defense),r(ce,ne),r(He,a(i).health),r(ie,I),r(E,a(i).size),r(Le,J),r(xt,a(i).speed)},[()=>n()("session.enemy_modal.difficulty"),()=>a(i).name||n()("session.enemy_modal.enemy_default"),()=>n()("session.enemy_modal.defense"),()=>n()("session.enemy_modal.health"),()=>n()("session.enemy_modal.size"),()=>n()("session.enemy_modal.speed")]),d(ke,Ne)};let q=Kt(o,"isOpen",3,!1),X=Kt(o,"initialData",3,"{}"),i=gt(ca(Ee())),y=gt("general"),ae=gt(!1),Ue=gt(""),we=gt(void 0);function Ze(ke){const Ne=ke.target.files;if(Ne&&Ne.length>0){const Xe=Ne[0],rt=new FileReader;rt.onload=()=>{k(Ue,rt.result,!0),k(ae,!0)},rt.readAsDataURL(Xe)}ke.target&&(ke.target.value="")}async function je(ke){try{const Ne=await ns(ke);a(i).imageUrl=Ne,k(ae,!1)}catch(Ne){console.error(Ne),alert(Ne.message||"Erro ao salvar imagem")}}function Ee(){return{name:"",difficulty:1,defense:10,health:10,damage:0,size:1,speed:10,description:"",senses:"",languages:"",immune:"",imageUrl:"",stats:{str:10,agi:10,int:10,wil:10},traits:[],actions:[],reactions:[],endOfRound:[],global:!1}}Na(()=>{if(q()&&X())try{const ke=JSON.parse(X());Object.keys(ke).length===0?k(i,Ee(),!0):k(i,{...Ee(),...ke},!0)}catch{k(i,Ee(),!0)}});function ue(ke){a(i)[ke]=[...a(i)[ke],{name:"",desc:""}]}function Te(ke,Ne){a(i)[ke]=a(i)[ke].filter((Xe,rt)=>rt!==Ne)}function ge(ke){}var Rt=Nt(),zt=Je(Rt);{var Ft=ke=>{var Ne=nn(),Xe=Je(Ne);Xe.__click=ge;var rt=t(Xe),xe=t(rt),Ae=t(xe),_t=t(Ae),P=t(_t);P.__click=function(...D){o.onClose?.apply(this,D)};var K=t(P);Aa(K,{size:24}),e(P);var R=s(P,2),Ge=t(R,!0);e(R),e(_t);var Ye=s(_t,2);Ye.__click=function(...D){o.onClose?.apply(this,D)};var vt=t(Ye);ma(vt,{size:20}),e(Ye),e(Ae);var $t=s(Ae,2),it=t($t);it.__click=()=>k(y,"general");var At=t(it,!0);e(it);var ht=s(it,2);ht.__click=()=>k(y,"stats");var se=t(ht,!0);e(ht);var ce=s(ht,2);ce.__click=()=>k(y,"abilities");var Ke=t(ce,!0);e(ce);var He=s(ce,2);He.__click=()=>k(y,"preview");var bt=t(He,!0);e(He),e($t);var nt=s($t,2),ie=t(nt);{var Fe=D=>{var $e=Xi(),ct=t($e),qe=t(ct);qe.__click=()=>a(we)?.click();var ot=t(qe),yt=t(ot);Ba(yt,()=>a(i).imageUrl,be=>{Ea(be,{get hash(){return a(i).imageUrl},get alt(){return a(i).name},size:"custom",fallbackText:"?"})}),e(ot);var Mt=s(ot,2),Pe=t(Mt);os(Pe,{size:20,class:"text-white"}),e(Mt),e(qe);var kt=s(qe,2),N=t(kt),j=t(N,!0);e(N);var A=s(N,2);ut(A),e(kt),e(ct);var ne=s(ct,2),I=t(ne),J=t(I,!0);e(I);var Y=s(I,2);pa(Y),e(ne);var he=s(ne,2),de=t(he);ut(de);var re=s(de,2),T=t(re);da(T,{size:14});var Ce=s(T);e(re),e(he),e($e),x((be,Me,dt,pt)=>{r(j,be),r(J,Me),_e(Y,"placeholder",dt),r(Ce,` ${pt??""}`)},[()=>n()("session.enemy_modal.name"),()=>n()("session.enemy_modal.description"),()=>n()("session.enemy_modal.description_placeholder"),()=>n()("session.enemy_modal.global_enemy")]),at(A,()=>a(i).name,be=>a(i).name=be),at(Y,()=>a(i).description,be=>a(i).description=be),Ya(de,()=>a(i).global,be=>a(i).global=be),d(D,$e)},E=D=>{var $e=Nt(),ct=Je($e);{var qe=yt=>{var Mt=Ki(),Pe=t(Mt),kt=t(Pe),N=t(kt),j=t(N,!0);e(N);var A=s(N);ut(A),e(kt);var ne=s(kt,2),I=t(ne),J=t(I,!0);e(I);var Y=s(I);ut(Y),e(ne),e(Pe);var he=s(Pe,2),de=t(he),re=t(de),T=t(re,!0);e(re);var Ce=s(re);ut(Ce),e(de);var be=s(de,2),Me=t(be),dt=t(Me,!0);e(Me);var pt=s(Me);ut(pt),e(be),e(he);var wt=s(he,2),lt=t(wt),It=t(lt),Ut=t(It,!0);e(It);var Bt=s(It);ut(Bt),e(lt);var v=s(lt,2),b=t(v),m=t(b,!0);e(b);var G=s(b);ut(G),e(v),e(wt);var ee=s(wt,2),fe=t(ee),Be=t(fe,!0);e(fe);var mt=s(fe,2);Ve(mt,20,()=>["str","agi","int","wil"],Ot,($,O)=>{var W=Yi(),Q=t(W),M=t(Q,!0);e(Q);var oe=s(Q,2);ut(oe);var pe=s(oe,2),U=t(pe);e(pe),e(W),x(V=>{_e(Q,"for",`attr-${O??""}`),r(M,V),_e(oe,"id",`attr-${O??""}`),st(pe,1,`text-xs font-bold ${a(i).stats[O]-10>=0?"text-green-500":"text-red-500"}`),r(U,`${a(i).stats[O]-10>=0?"+":""}${a(i).stats[O]-10}`)},[()=>n()("sofww.attributes."+O).substring(0,3)]),at(oe,()=>a(i).stats[O],V=>a(i).stats[O]=V),d($,W)}),e(mt),e(ee);var ft=s(ee,2),Ht=t(ft),St=t(Ht),Lt=t(St,!0);e(St);var Tt=s(St);ut(Tt),e(Ht);var Gt=s(Ht,2),Wt=t(Gt),Qt=t(Wt,!0);e(Wt);var l=s(Wt);ut(l),e(Gt);var u=s(Gt,2),_=t(u),w=t(_,!0);e(_);var te=s(_);ut(te),e(u),e(ft),e(Mt),x(($,O,W,Q,M,oe,pe,U,V,Ie,H,Re,h)=>{r(j,$),r(J,O),r(T,W),r(dt,Q),r(Ut,M),r(m,oe),r(Be,pe),r(Lt,U),_e(Tt,"placeholder",V),r(Qt,Ie),_e(l,"placeholder",H),r(w,Re),_e(te,"placeholder",h)},[()=>n()("session.enemy_modal.difficulty"),()=>n()("session.enemy_modal.size"),()=>n()("session.enemy_modal.defense"),()=>n()("session.enemy_modal.health"),()=>n()("session.enemy_modal.damage"),()=>n()("session.enemy_modal.speed"),()=>n()("session.enemy_modal.main_attributes"),()=>n()("session.enemy_modal.senses"),()=>n()("session.enemy_modal.senses_placeholder"),()=>n()("session.enemy_modal.languages"),()=>n()("session.enemy_modal.languages_placeholder"),()=>n()("session.enemy_modal.immunities"),()=>n()("session.enemy_modal.immunities_placeholder")]),at(A,()=>a(i).difficulty,$=>a(i).difficulty=$),at(Y,()=>a(i).size,$=>a(i).size=$),at(Ce,()=>a(i).defense,$=>a(i).defense=$),at(pt,()=>a(i).health,$=>a(i).health=$),at(Bt,()=>a(i).damage,$=>a(i).damage=$),at(G,()=>a(i).speed,$=>a(i).speed=$),at(Tt,()=>a(i).senses,$=>a(i).senses=$),at(l,()=>a(i).languages,$=>a(i).languages=$),at(te,()=>a(i).immune,$=>a(i).immune=$),d(yt,Mt)},ot=yt=>{var Mt=Nt(),Pe=Je(Mt);{var kt=j=>{var A=sn();Ve(A,20,()=>[{key:"traits",label:"traits",color:"text-indigo-400",border:"border-indigo-500/30"},{key:"actions",label:"actions",color:"text-red-400",border:"border-red-500/30"},{key:"reactions",label:"reactions",color:"text-orange-400",border:"border-orange-500/30"},{key:"endOfRound",label:"end_of_round",color:"text-yellow-400",border:"border-yellow-500/30"}],Ot,(ne,I)=>{var J=an(),Y=t(J),he=t(Y),de=t(he,!0);e(he);var re=s(he,2);re.__click=()=>ue(I.key);var T=t(re);ea(T,{size:12});var Ce=s(T);e(re),e(Y);var be=s(Y,2),Me=t(be);Ve(Me,17,()=>a(i)[I.key],Ot,(wt,lt,It)=>{var Ut=en(),Bt=t(Ut),v=t(Bt);ut(v);var b=s(v,2);pa(b),e(Bt);var m=s(Bt,2);m.__click=()=>Te(I.key,It);var G=t(m);sa(G,{size:16}),e(m),e(Ut),x((ee,fe)=>{_e(v,"placeholder",ee),_e(b,"placeholder",fe)},[()=>n()("session.enemy_modal.name_placeholder"),()=>n()("session.enemy_modal.desc_placeholder")]),at(v,()=>a(lt).name,ee=>a(lt).name=ee),at(b,()=>a(lt).desc,ee=>a(lt).desc=ee),d(wt,Ut)});var dt=s(Me,2);{var pt=wt=>{var lt=tn(),It=t(lt,!0);e(lt),x(Ut=>r(It,Ut),[()=>n()("session.enemy_modal.empty")]),d(wt,lt)};f(dt,wt=>{a(i)[I.key].length===0&&wt(pt)})}e(be),e(J),x((wt,lt)=>{st(J,1,`p-4 bg-slate-900 rounded border ${I.border??""}`),st(he,1,`font-bold text-sm uppercase ${I.color??""}`),r(de,wt),r(Ce,` ${lt??""}`)},[()=>n()("session.enemy_modal."+I.label),()=>n()("session.enemy_modal.add")]),d(ne,J)}),e(A),d(j,A)},N=j=>{var A=Nt(),ne=Je(A);{var I=J=>{var Y=rn(),he=t(Y);p(he),e(Y),d(J,Y)};f(ne,J=>{a(y)==="preview"&&J(I)},!0)}d(j,A)};f(Pe,j=>{a(y)==="abilities"?j(kt):j(N,!1)},!0)}d(yt,Mt)};f(ct,yt=>{a(y)==="stats"?yt(qe):yt(ot,!1)},!0)}d(D,$e)};f(ie,D=>{a(y)==="general"?D(Fe):D(E,!1)})}e(nt);var ze=s(nt,2),me=t(ze);me.__click=()=>o.onSave(a(i));var Le=t(me);Ja(Le,{size:18});var Se=s(Le);e(me),e(ze),e(xe);var xt=s(xe,2),et=t(xt),tt=t(et),Ct=t(tt);qa(Ct,{size:14});var Et=s(Ct);e(tt),e(et);var Dt=s(et,2),Pt=t(Dt);p(Pt),e(Dt),e(xt),e(rt),e(Xe);var z=s(Xe,2);z.__change=Ze,vs(z,D=>k(we,D),()=>a(we));var S=s(z,2);is(S,{get isOpen(){return a(ae)},get imageUrl(){return a(Ue)},onClose:()=>k(ae,!1),onCrop:je}),x((D,$e,ct,qe,ot,yt,Mt,Pe)=>{_e(Xe,"aria-label",D),r(Ge,$e),st(it,1,`flex-1 py-3 px-4 text-sm font-bold border-b-2 whitespace-nowrap transition-colors ${a(y)==="general"?"border-indigo-500 text-indigo-400 bg-slate-800":"border-transparent text-slate-500 hover:text-white"}`),r(At,ct),st(ht,1,`flex-1 py-3 px-4 text-sm font-bold border-b-2 whitespace-nowrap transition-colors ${a(y)==="stats"?"border-indigo-500 text-indigo-400 bg-slate-800":"border-transparent text-slate-500 hover:text-white"}`),r(se,qe),st(ce,1,`flex-1 py-3 px-4 text-sm font-bold border-b-2 whitespace-nowrap transition-colors ${a(y)==="abilities"?"border-indigo-500 text-indigo-400 bg-slate-800":"border-transparent text-slate-500 hover:text-white"}`),r(Ke,ot),st(He,1,`lg:hidden flex-1 py-3 px-4 text-sm font-bold border-b-2 whitespace-nowrap transition-colors ${a(y)==="preview"?"border-indigo-500 text-indigo-400 bg-slate-800":"border-transparent text-slate-500 hover:text-white"}`),r(bt,yt),r(Se,` ${Mt??""}`),r(Et,` ${Pe??""}`)},[()=>n()("session.enemy_modal.close"),()=>n()("session.enemy_modal.title"),()=>n()("session.enemy_modal.tab_general"),()=>n()("session.enemy_modal.tab_stats"),()=>n()("session.enemy_modal.tab_abilities"),()=>n()("session.enemy_modal.preview"),()=>n()("common.buttons.save"),()=>n()("session.enemy_modal.preview")]),Sa(3,rt,()=>Ra,()=>({y:20,duration:300})),Sa(3,Xe,()=>Ra,()=>({duration:200,opacity:1})),d(ke,Ne)};f(zt,ke=>{q()&&ke(Ft)})}d(Z,Rt),ba(),F()}_a(["click","change"]);var ln=c('<div class="flex justify-between items-center bg-slate-800 p-2 rounded border border-slate-700"><div class="flex-1"><div class="text-sm font-bold text-white"> </div> <div class="text-[10px] text-slate-400"> </div></div> <div class="flex items-center gap-2"><input type="number" min="1" class="w-12 bg-slate-900 border border-slate-600 rounded text-center text-white"/> <button class="text-red-400 hover:text-red-300"><!></button></div></div>'),dn=c('<div class="text-center text-slate-600 italic text-sm py-4"> </div>'),vn=c('<div class="flex justify-between items-center bg-slate-950 p-2 rounded border border-slate-800 hover:border-indigo-500/30 transition-colors"><div><div class="text-sm font-bold text-white max-w-[120px] truncate"> </div> <div class="text-[10px] text-slate-500"> </div></div> <button class="text-indigo-400 hover:text-white p-1 bg-slate-900 rounded border border-slate-800"><!></button></div>'),cn=c('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/80 p-4" role="button" tabindex="-1"><div class="bg-slate-800 rounded-xl w-full max-w-2xl p-6 border border-slate-700 shadow-2xl flex flex-col max-h-[90vh]" role="dialog" aria-modal="true" aria-labelledby="encounter-modal-title"><div class="flex justify-between items-center mb-6"><h3 id="encounter-modal-title" class="text-xl font-bold text-white"> </h3> <button class="text-slate-400 hover:text-white"><!></button></div> <div class="space-y-4 mb-6"><div><label for="encounter-name" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="encounter-name" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white outline-hidden focus:border-indigo-500"/></div></div> <div class="flex-1 flex gap-4 min-h-0"><div class="flex-1 bg-slate-900 border border-slate-800 rounded-lg p-3 flex flex-col"><h4 class="text-xs text-slate-500 uppercase font-bold mb-2"> </h4> <div class="flex-1 overflow-y-auto space-y-2 custom-scrollbar"><!> <!></div></div> <div class="flex-1 bg-slate-900 border border-slate-800 rounded-lg p-3 flex flex-col"><h4 class="text-xs text-slate-500 uppercase font-bold mb-2"> </h4> <div class="flex-1 overflow-y-auto space-y-2 custom-scrollbar"></div></div></div> <div class="flex gap-3 mt-6 pt-4 border-t border-slate-700"><button class="flex-1 bg-slate-700 hover:bg-slate-600 text-white py-2 rounded font-bold"> </button> <button class="flex-1 bg-indigo-600 hover:bg-indigo-500 text-white py-2 rounded font-bold flex items-center justify-center gap-2"><!> </button></div></div></div>');function un(Z,o){ua(o,!0);const n=()=>qt(aa,"$t",F),ve=()=>qt(Fa,"$liveEnemies",F),[F,p]=xa();let q=Kt(o,"isOpen",3,!1),X=Kt(o,"initialData",3,"{}"),i=gt(ca({name:"",enemies:[]}));Na(()=>{if(q()&&X())try{const ue=JSON.parse(X());k(i,{name:ue.name||"",enemies:ue.enemies||[]},!0)}catch{k(i,{name:"",enemies:[]},!0)}});function y(ue){a(i).enemies.find(ge=>ge.enemyId===ue)?a(i).enemies=a(i).enemies.map(ge=>ge.enemyId===ue?{...ge,count:ge.count+1}:ge):a(i).enemies=[...a(i).enemies,{enemyId:ue,count:1}]}function ae(ue){a(i).enemies=a(i).enemies.filter((Te,ge)=>ge!==ue)}function Ue(ue,Te){const ge=Math.max(1,parseInt(Te)||1);a(i).enemies[ue].count=ge}function we(ue){}var Ze=Nt(),je=Je(Ze);{var Ee=ue=>{var Te=cn();Te.__click=we;var ge=t(Te),Rt=t(ge),zt=t(Rt),Ft=t(zt,!0);e(zt);var ke=s(zt,2);ke.__click=function(...E){o.onClose?.apply(this,E)};var Ne=t(ke);ma(Ne,{size:20}),e(ke),e(Rt);var Xe=s(Rt,2),rt=t(Xe),xe=t(rt),Ae=t(xe,!0);e(xe);var _t=s(xe,2);ut(_t),e(rt),e(Xe);var P=s(Xe,2),K=t(P),R=t(K),Ge=t(R,!0);e(R);var Ye=s(R,2),vt=t(Ye);Ve(vt,17,()=>a(i).enemies,Ot,(E,ze,me)=>{const Le=ye(()=>ve().find(D=>D.id===a(ze).enemyId));var Se=ln(),xt=t(Se),et=t(xt),tt=t(et,!0);e(et);var Ct=s(et,2),Et=t(Ct);e(Ct),e(xt);var Dt=s(xt,2),Pt=t(Dt);ut(Pt),Pt.__input=D=>Ue(me,D.target.value);var z=s(Pt,2);z.__click=()=>ae(me);var S=t(z);sa(S,{size:16}),e(z),e(Dt),e(Se),x(D=>{r(tt,D),r(Et,`Dif ${(a(Le)?a(Le).difficulty:"?")??""}`),Pa(Pt,a(ze).count)},[()=>a(Le)?a(Le).name:n()("session.encounter_modal.unknown")]),d(E,Se)});var $t=s(vt,2);{var it=E=>{var ze=dn(),me=t(ze,!0);e(ze),x(Le=>r(me,Le),[()=>n()("session.encounter_modal.none_added")]),d(E,ze)};f($t,E=>{a(i).enemies.length===0&&E(it)})}e(Ye),e(K);var At=s(K,2),ht=t(At),se=t(ht,!0);e(ht);var ce=s(ht,2);Ve(ce,5,ve,E=>E.id,(E,ze)=>{var me=vn(),Le=t(me),Se=t(Le),xt=t(Se,!0);e(Se);var et=s(Se,2),tt=t(et);e(et),e(Le);var Ct=s(Le,2);Ct.__click=()=>y(a(ze).id);var Et=t(Ct);ea(Et,{size:16}),e(Ct),e(me),x(()=>{r(xt,a(ze).name),r(tt,`Dif ${a(ze).difficulty??""}`)}),d(E,me)}),e(ce),e(At),e(P);var Ke=s(P,2),He=t(Ke);He.__click=function(...E){o.onClose?.apply(this,E)};var bt=t(He,!0);e(He);var nt=s(He,2);nt.__click=()=>o.onSave(a(i));var ie=t(nt);Ja(ie,{size:18});var Fe=s(ie);e(nt),e(Ke),e(ge),e(Te),x((E,ze,me,Le,Se,xt,et,tt)=>{_e(Te,"aria-label",E),r(Ft,ze),r(Ae,me),_e(_t,"placeholder",Le),r(Ge,Se),r(se,xt),r(bt,et),r(Fe,` ${tt??""}`)},[()=>n()("session.encounter_modal.close"),()=>n()("session.encounter_modal.title"),()=>n()("session.encounter_modal.name"),()=>n()("session.encounter_modal.name_placeholder"),()=>n()("session.encounter_modal.enemies_in_encounter"),()=>n()("session.encounter_modal.add_enemies"),()=>n()("common.buttons.cancel"),()=>n()("session.encounter_modal.save_encounter")]),at(_t,()=>a(i).name,E=>a(i).name=E),d(ue,Te)};f(je,ue=>{q()&&ue(Ee)})}d(Z,Ze),ba(),p()}_a(["click","input"]);var bn=c('<div class="text-[10px] text-slate-400 flex items-center gap-1.5 bg-slate-950 p-1 px-1.5 rounded-lg border border-slate-800/50"><span class="text-indigo-400 font-black"> </span> <span class="font-medium truncate max-w-[80px]"> </span></div>'),_n=c('<div class="text-[10px] text-slate-600 italic"> </div>'),xn=c('<div class="bg-slate-900 border border-slate-800 rounded-2xl p-4 transition-all hover:border-indigo-500/30 group relative flex flex-col justify-between shadow-lg hover:shadow-indigo-500/10" role="region"><div class="flex-1"><div class="flex items-center gap-2 mb-2"><div class="font-bold text-white text-base group-hover:text-indigo-400 transition-colors uppercase tracking-tight truncate"> </div> <!></div> <div class="flex flex-wrap gap-1"><!> <!></div></div> <div class="flex gap-2 mt-3 pt-3 border-t border-slate-800/50"><button class="flex-1 bg-indigo-600 hover:bg-indigo-500 text-white py-1.5 rounded-lg text-xs font-bold flex items-center justify-center gap-2 transition-all active:scale-95 shadow-lg shadow-indigo-900/20"><!> </button> <button class="p-1.5 text-slate-400 hover:text-white bg-slate-800/50 rounded-lg border border-slate-800 transition-all" title="Editar"><!></button> <button class="p-1.5 text-slate-400 hover:text-red-400 bg-slate-800/50 rounded-lg border border-slate-800 hover:border-red-900/30 transition-all"><!></button></div></div>'),pn=c('<button class="text-[10px] font-bold text-indigo-400 hover:text-indigo-300 mt-1 uppercase tracking-wider"> </button>'),mn=c('<div class="mb-4 flex-1"><p> </p> <!></div>'),fn=c('<div class="mb-4 flex-1 text-[10px] text-slate-600 italic"> </div>'),gn=c('<div class="bg-slate-900 border border-slate-800 rounded-2xl p-5 hover:border-indigo-500/30 transition-all relative group cursor-move hover:shadow-lg hover:shadow-indigo-500/10 active:scale-[0.98] flex flex-col" draggable="true" role="listitem"><div class="flex justify-between items-start mb-3"><div class="flex items-center gap-2"><h3 class="font-bold text-lg text-white group-hover:text-indigo-400 transition-colors"> </h3> <!></div> <span class="text-[10px] font-black bg-indigo-500/10 text-indigo-400 border border-indigo-400/20 px-2 py-1 rounded-lg uppercase"> </span></div> <!> <div class="mt-auto flex gap-2 pt-4 border-t border-slate-800/50"><button class="flex-1 bg-slate-800/50 hover:bg-slate-800 text-white py-2 rounded-xl text-xs font-bold border border-slate-800 transition-all"> </button> <button class="bg-slate-800/50 hover:bg-red-900/20 text-slate-500 hover:text-red-400 px-3 rounded-xl border border-slate-800 hover:border-red-900/30 transition-all"><!></button></div></div>'),hn=c('<div class="text-center text-slate-500 italic col-span-3"> </div>'),yn=c('<div><div class="mb-12"><div class="flex justify-between items-center mb-6"><h3 class="text-sm font-black text-indigo-400 uppercase tracking-widest flex items-center gap-2"><!> </h3></div> <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"><button class="min-h-[120px] border-2 border-dashed border-slate-800 rounded-2xl flex flex-col items-center justify-center text-slate-500 hover:border-indigo-500 hover:text-indigo-400 transition-all hover:bg-indigo-500/5 gap-2 group"><!> <span class="font-bold text-sm"> </span></button> <!></div></div> <div class="mb-6"><h3 class="text-sm font-black text-indigo-400 uppercase tracking-widest flex items-center gap-2 mb-6"><!> </h3></div> <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"><button class="min-h-[180px] border-2 border-dashed border-slate-800 rounded-2xl flex flex-col items-center justify-center text-slate-500 hover:border-indigo-500 hover:text-indigo-400 transition-all hover:bg-indigo-500/5 gap-2 group"><!> <span class="font-bold text-sm"> </span></button> <!> <!></div> <!> <!> <!></div>');function wn(Z,o){ua(o,!0);const n=()=>qt(Fa,"$liveEnemies",p),ve=()=>qt(es,"$liveEncounters",p),F=()=>qt(aa,"$t",p),[p,q]=xa();let X=gt(!1),i=gt(null),y=gt("{}"),ae=gt(!1),Ue=gt(null),we=gt("{}"),Ze=gt(ca({isOpen:!1,title:"",message:"",onConfirm:()=>{}}));function je(){return{name:"",difficulty:1,defense:10,health:10,damage:0,size:1,speed:10,description:"",senses:"",languages:"",immune:"",stats:{str:10,agi:10,int:10,wil:10},traits:[],actions:[],reactions:[],endOfRound:[]}}function Ee(z=null){k(i,z?z.id:null,!0),z?k(y,JSON.stringify(z),!0):a(Ae)==="sofdl"?k(y,"{}"):k(y,JSON.stringify(je()),!0),k(X,!0)}let ue=ca(new Set);function Te(z){ue.has(z)?ue.delete(z):ue.add(z)}function ge(z){const S=a(i)||ja(),D=Zt.get(o.campId);Va.set(S,{...z,id:S,campaignId:o.campId,system:D?.system||"sofww"}),k(X,!1)}function Rt(z){const S=n().find(D=>D.id===z);k(Ze,{isOpen:!0,title:"Excluir Inimigo",message:`Tem certeza que deseja excluir permanentemente o inimigo "${S?.name||"este inimigo"}"?`,onConfirm:()=>{Va.delete(z),a(Ze).isOpen=!1}},!0)}function zt(z=null){k(Ue,z?z.id:null,!0),k(we,JSON.stringify(z||{name:"",enemies:[]}),!0),k(ae,!0)}function Ft(z){const S=a(Ue)||ja();Da.set(S,{...z,id:S,system:a(Ae)}),k(ae,!1)}function ke(z){const S=ve().find(D=>D.id===z);k(Ze,{isOpen:!0,title:"Excluir Encontro",message:`Tem certeza que deseja excluir permanentemente o encontro "${S?.name||"este encontro"}"?`,onConfirm:()=>{Da.delete(z),a(Ze).isOpen=!1}},!0)}function Ne(z){const S=Zt.get(o.campId);if(!S)return;const D=S.activeEnemies||[];let $e=[];z.enemies.forEach(ct=>{const qe=n().find(ot=>ot.id===ct.enemyId);if(qe)for(let ot=0;ot<ct.count;ot++)$e.push({...qe,instanceId:ja(),damage:0,currentHealth:qe.health,afflictions:[],acted:!1,initiative:!1})}),Zt.set(o.campId,{...S,activeEnemies:[...D,...$e]})}function Xe(z,S){z.dataTransfer.setData("text/plain",S.id),z.dataTransfer.effectAllowed="copy"}function rt(z){return z.preventDefault(),!1}function xe(z,S){z.preventDefault();const D=z.dataTransfer.getData("text/plain");if(!D)return;const $e=S.enemies||[],ct=$e.find(ot=>ot.enemyId===D);let qe;ct?qe=$e.map(ot=>ot.enemyId===D?{...ot,count:ot.count+1}:ot):qe=[...$e,{enemyId:D,count:1}],Da.set(S.id,{...S,enemies:qe})}let Ae=ye(()=>Zt.get(o.campId)?.system||"sofww"),_t=ye(()=>n().filter(z=>{const D=(z.system||"sofww")===a(Ae),$e=z.global===!0,ct=z.campaignId===o.campId;return D&&($e||ct)})),P=ye(()=>ve().filter(z=>{const D=(z.system||"sofww")===a(Ae),$e=z.global===!0,ct=z.campaignId===o.campId;return D&&($e||ct)}));var K=yn(),R=t(K),Ge=t(R),Ye=t(Ge),vt=t(Ye);La(vt,{size:16});var $t=s(vt);e(Ye),e(Ge);var it=s(Ge,2),At=t(it);At.__click=()=>zt();var ht=t(At);ea(ht,{size:28,class:"group-hover:scale-110 transition-transform"});var se=s(ht,2),ce=t(se,!0);e(se),e(At);var Ke=s(At,2);Ve(Ke,17,()=>a(P),z=>z.id,(z,S)=>{var D=xn(),$e=t(D),ct=t($e),qe=t(ct),ot=t(qe,!0);e(qe);var yt=s(qe,2);{var Mt=T=>{da(T,{size:12,class:"text-indigo-400"})};f(yt,T=>{a(S).global&&T(Mt)})}e(ct);var Pe=s(ct,2),kt=t(Pe);Ve(kt,17,()=>a(S).enemies||[],Ot,(T,Ce)=>{const be=ye(()=>n().find(It=>It.id===a(Ce).enemyId));var Me=bn(),dt=t(Me),pt=t(dt);e(dt);var wt=s(dt,2),lt=t(wt,!0);e(wt),e(Me),x(()=>{r(pt,`${a(Ce).count??""}x`),r(lt,a(be)?a(be).name:"...")}),d(T,Me)});var N=s(kt,2);{var j=T=>{var Ce=_n(),be=t(Ce,!0);e(Ce),x(Me=>r(be,Me),[()=>F()("session.bestiary.empty_encounter")]),d(T,Ce)};f(N,T=>{a(S).enemies?.length||T(j)})}e(Pe),e($e);var A=s($e,2),ne=t(A);ne.__click=()=>Ne(a(S));var I=t(ne);Ha(I,{size:12,fill:"currentColor"});var J=s(I);e(ne);var Y=s(ne,2);Y.__click=()=>zt(a(S));var he=t(Y);Ps(he,{size:14}),e(Y);var de=s(Y,2);de.__click=()=>ke(a(S).id);var re=t(de);sa(re,{size:14}),e(de),e(A),e(D),x(T=>{_e(D,"aria-label",`Encontro ${a(S).name??""}`),r(ot,a(S).name),r(J,` ${T??""}`)},[()=>F()("session.bestiary.start")]),ya("dragover",D,rt),ya("drop",D,T=>xe(T,a(S))),d(z,D)}),e(it),e(R);var He=s(R,2),bt=t(He),nt=t(bt);ha(nt,{size:16});var ie=s(nt);e(bt),e(He);var Fe=s(He,2),E=t(Fe);E.__click=()=>Ee();var ze=t(E);ea(ze,{size:32,class:"group-hover:scale-110 transition-transform"});var me=s(ze,2),Le=t(me,!0);e(me),e(E);var Se=s(E,2);Ve(Se,17,()=>a(_t),z=>z.id,(z,S)=>{var D=gn(),$e=t(D),ct=t($e),qe=t(ct),ot=t(qe,!0);e(qe);var yt=s(qe,2);{var Mt=de=>{da(de,{size:14,class:"text-indigo-400"})};f(yt,de=>{a(S).global&&de(Mt)})}e(ct);var Pe=s(ct,2),kt=t(Pe);e(Pe),e($e);var N=s($e,2);{var j=de=>{var re=mn(),T=t(re),Ce=t(T,!0);e(T);var be=s(T,2);{var Me=dt=>{var pt=pn();pt.__click=()=>Te(a(S).id);var wt=t(pt,!0);e(pt),x(lt=>r(wt,lt),[()=>ue.has(a(S).id)?F()("session.bestiary.see_less"):F()("session.bestiary.see_more")]),d(dt,pt)};f(be,dt=>{a(S).description.length>120&&dt(Me)})}e(re),x(dt=>{st(T,1,`text-xs text-slate-400 leading-relaxed ${dt??""}`),r(Ce,a(S).description)},[()=>ue.has(a(S).id)?"":"line-clamp-3"]),d(de,re)},A=de=>{var re=fn(),T=t(re,!0);e(re),x(Ce=>r(T,Ce),[()=>F()("session.bestiary.no_description")]),d(de,re)};f(N,de=>{a(S).description?de(j):de(A,!1)})}var ne=s(N,2),I=t(ne);I.__click=()=>Ee(a(S));var J=t(I,!0);e(I);var Y=s(I,2);Y.__click=()=>Rt(a(S).id);var he=t(Y);sa(he,{size:14}),e(Y),e(ne),e(D),x((de,re)=>{r(ot,a(S).name),r(kt,`${de??""} ${a(S).difficulty??""}`),r(J,re)},[()=>F()("session.bestiary.level"),()=>F()("common.buttons.edit")]),ya("dragstart",D,de=>Xe(de,a(S))),d(z,D)});var xt=s(Se,2);{var et=z=>{var S=hn(),D=t(S,!0);e(S),x($e=>r(D,$e),[()=>F()("session.bestiary.no_enemies")]),d(z,S)};f(xt,z=>{a(_t).length===0&&z(et)})}e(Fe);var tt=s(Fe,2);{var Ct=z=>{Di(z,{get isOpen(){return a(X)},get initialData(){return a(y)},onClose:()=>k(X,!1),onSave:ge})},Et=z=>{on(z,{get isOpen(){return a(X)},get initialData(){return a(y)},onClose:()=>k(X,!1),onSave:ge})};f(tt,z=>{a(Ae)==="sofdl"?z(Ct):z(Et,!1)})}var Dt=s(tt,2);un(Dt,{get isOpen(){return a(ae)},get initialData(){return a(we)},onClose:()=>k(ae,!1),onSave:Ft});var Pt=s(Dt,2);Ka(Pt,{get isOpen(){return a(Ze).isOpen},get title(){return a(Ze).title},get message(){return a(Ze).message},get onConfirm(){return a(Ze).onConfirm},onCancel:()=>a(Ze).isOpen=!1}),e(K),x((z,S,D,$e)=>{r($t,` ${z??""}`),r(ce,S),r(ie,` ${D??""}`),r(Le,$e)},[()=>F()("session.bestiary.encounters_title"),()=>F()("session.bestiary.new_encounter"),()=>F()("session.bestiary.title"),()=>F()("session.bestiary.new_enemy")]),d(Z,K),ba(),q()}_a(["click"]);var kn=c('<div class="flex items-center gap-1 text-slate-400 ml-1"><!> <span class="text-xs"> </span></div>'),zn=c('<div class="flex items-center gap-1 text-emerald-400"><!> <span class="text-xs font-bold hidden sm:block"> </span></div> <!>',1),$n=c('<div class="flex items-center gap-1 text-slate-500"><!> <span class="text-xs hidden sm:block"> </span></div>'),Cn=c('<span class="absolute -top-1 -right-1 flex h-3 w-3"><span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-red-400 opacity-75"></span> <span class="relative inline-flex rounded-full h-3 w-3 bg-red-500 border border-slate-900"></span></span>'),On=c('<header class="bg-slate-900/80 backdrop-blur-md border-b border-white/5 sticky top-0 z-40 shadow-2xl"><div class="max-w-7xl mx-auto px-2 sm:px-4 py-4 sm:py-3"><div class="flex items-center justify-between gap-2 sm:gap-4"><div class="flex items-center gap-1 sm:gap-3 shrink-0"><button class="p-2 text-slate-400 hover:text-white hover:bg-white/5 rounded-full transition-all flex items-center gap-1 group"><!> <!></button> <div class="flex flex-col"><h1 class="text-base sm:text-lg font-black text-white leading-tight truncate max-w-[140px] sm:max-w-none"> </h1> <span class="text-xs text-indigo-400 font-mono font-black uppercase tracking-wider"> </span></div></div> <div class="hidden md:flex bg-slate-950/50 p-1 rounded-xl border border-white/5"><button><!> <span class="hidden min-[400px]:block"> </span></button> <button><!> <span class="hidden min-[400px]:block"> </span></button></div> <div class="flex items-center gap-1 sm:gap-2"><div class="flex items-center gap-2 mr-2 border-r border-white/10 pr-2"><!></div> <button class="p-2 sm:p-2.5 text-slate-400 hover:text-white hover:bg-white/5 rounded-lg transition-all"><!></button> <button class="p-2 sm:p-2.5 bg-indigo-600/10 text-indigo-400 border border-indigo-400/20 rounded-lg hover:bg-indigo-600 hover:text-white transition-all relative"><!> <!></button></div></div></div></header>');function jn(Z,o){ua(o,!0);const n=()=>qt(aa,"$t",q),ve=()=>qt(hs,"$syncState",q),F=()=>qt(wa,"$isHistoryOpen",q),p=()=>qt(ys,"$hasUnreadRolls",q),[q,X]=xa();let i=Kt(o,"campaignName",3,""),y=Kt(o,"gmName",3,"Mestre"),ae=Kt(o,"activeSubTab",3,"session"),Ue=Kt(o,"onTabChange",3,()=>{}),we=Kt(o,"onOpenSettings",3,()=>{});var Ze=On(),je=t(Ze),Ee=t(je),ue=t(Ee),Te=t(ue);Te.__click=()=>Ls(ss("/"));var ge=t(Te);Aa(ge,{size:20,class:"group-hover:-translate-x-0.5 transition-transform"});var Rt=s(ge,2);Rs(Rt,{size:18,class:"hidden sm:block opacity-50"}),e(Te);var zt=s(Te,2),Ft=t(zt),ke=t(Ft,!0);e(Ft);var Ne=s(Ft,2),Xe=t(Ne,!0);e(Ne),e(zt),e(ue);var rt=s(ue,2),xe=t(rt);xe.__click=()=>Ue()("session");var Ae=t(xe);{let ie=ye(()=>ae()==="session"?"opacity-100":"opacity-50");ls(Ae,{size:14,get class(){return a(ie)}})}var _t=s(Ae,2),P=t(_t,!0);e(_t),e(xe);var K=s(xe,2);K.__click=()=>Ue()("bestiary");var R=t(K);{let ie=ye(()=>ae()==="bestiary"?"opacity-100":"opacity-50");cs(R,{size:14,get class(){return a(ie)}})}var Ge=s(R,2),Ye=t(Ge,!0);e(Ge),e(K),e(rt);var vt=s(rt,2),$t=t(vt),it=t($t);{var At=ie=>{var Fe=zn(),E=Je(Fe),ze=t(E);as(ze,{size:16});var me=s(ze,2),Le=t(me,!0);e(me),e(E);var Se=s(E,2);{var xt=et=>{var tt=kn(),Ct=t(tt);ts(Ct,{size:14});var Et=s(Ct,2),Dt=t(Et,!0);e(Et),e(tt),x(Pt=>{_e(tt,"title",Pt),r(Dt,ve().peers.length)},[()=>n()("common.status.peers",{values:{count:ve().peers.length}})]),d(et,tt)};f(Se,et=>{ve().peers.length>0&&et(xt)})}x((et,tt)=>{_e(E,"title",et),r(Le,tt)},[()=>n()("common.status.connected"),()=>n()("common.status.connected")]),d(ie,Fe)},ht=ie=>{var Fe=$n(),E=t(Fe);Fs(E,{size:16});var ze=s(E,2),me=t(ze,!0);e(ze),e(Fe),x((Le,Se)=>{_e(Fe,"title",Le),r(me,Se)},[()=>n()("common.status.offline"),()=>n()("common.status.offline")]),d(ie,Fe)};f(it,ie=>{ve().isConnected?ie(At):ie(ht,!1)})}e($t);var se=s($t,2);se.__click=function(...ie){we()?.apply(this,ie)};var ce=t(se);Us(ce,{size:20}),e(se);var Ke=s(se,2);Ke.__click=()=>wa.update(ie=>!ie);var He=t(Ke);Ns(He,{size:20});var bt=s(He,2);{var nt=ie=>{var Fe=Cn();d(ie,Fe)};f(bt,ie=>{p()&&ie(nt)})}e(Ke),e(vt),e(Ee),e(je),e(Ze),x((ie,Fe,E,ze,me,Le,Se,xt)=>{_e(Te,"aria-label",ie),_e(Te,"title",Fe),r(ke,i()),r(Xe,y()),st(xe,1,`flex items-center gap-2 px-3 sm:px-4 py-1.5 rounded-lg text-xs font-black transition-all ${ae()==="session"?"bg-indigo-600 text-white shadow-lg shadow-indigo-500/20":"text-slate-500 hover:text-slate-300"}`),_e(xe,"aria-pressed",ae()==="session"),r(P,E),st(K,1,`flex items-center gap-2 px-3 sm:px-4 py-1.5 rounded-lg text-xs font-black transition-all ${ae()==="bestiary"?"bg-indigo-600 text-white shadow-lg shadow-indigo-500/20":"text-slate-500 hover:text-slate-300"}`),_e(K,"aria-pressed",ae()==="bestiary"),r(Ye,ze),_e(se,"aria-label",me),_e(se,"title",Le),_e(Ke,"aria-label",Se),_e(Ke,"title",xt),_e(Ke,"aria-pressed",F())},[()=>n()("character.header.back_dashboard"),()=>n()("character.header.back_dashboard"),()=>n()("common.labels.session"),()=>n()("common.labels.bestiary"),()=>n()("common.buttons.settings"),()=>n()("common.buttons.settings"),()=>n()("character.header.history"),()=>n()("character.header.history")]),d(Z,Ze),ba(),X()}_a(["click"]);var En=c('<!> <!> <main class="max-w-7xl mx-auto p-4 md:p-8 animate-in slide-in-from-bottom-4 duration-500"><!></main>',1),Mn=c('<div class="flex flex-col items-center justify-center min-h-screen p-4 text-center"><div class="w-20 h-20 bg-slate-800 rounded-full flex items-center justify-center mx-auto mb-6 text-slate-600"><svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-ghost"><path d="M9 10h.01"></path><path d="M15 10h.01"></path><path d="M12 2a8 8 0 0 0-8 8v12l3-3 2.5 2.5L12 19l2.5 2.5L17 19l3 3V10a8 8 0 0 0-8-8z"></path></svg></div> <h1 class="text-2xl font-black text-white mb-2 uppercase tracking-tight"> </h1> <p class="text-slate-400 mb-8 max-w-md"> </p> <button class="bg-indigo-600 hover:bg-indigo-500 text-white px-8 py-3 rounded-xl font-bold transition-all flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-arrow-left"><path d="m12 19-7-7 7-7"></path><path d="19 12H5"></path></svg> </button></div>'),In=c('<div class="flex items-center justify-center min-h-screen"><div class="relative w-16 h-16"><div class="absolute inset-0 border-4 border-indigo-500/20 rounded-full"></div> <div class="absolute inset-0 border-4 border-indigo-500 border-t-transparent rounded-full animate-spin"></div></div></div>'),Sn=c('<div class="fixed bottom-24 left-1/2 -translate-x-1/2 md:left-8 md:translate-x-0 z-[60] flex flex-col items-center gap-2"><div class="bg-slate-900/95 backdrop-blur-md border border-white/10 rounded-2xl p-2 flex items-center gap-2 shadow-2xl animate-in zoom-in-95 slide-in-from-bottom-4 duration-200"><button class="bg-indigo-600/20 hover:bg-indigo-600 text-indigo-400 hover:text-white font-bold w-12 h-12 rounded-xl flex flex-col items-center justify-center transition-all active:scale-95 shadow-lg border border-indigo-500/20"><span class="text-[10px] opacity-70">d20</span> <!></button> <button class="bg-slate-800 hover:bg-slate-700 text-white font-bold w-12 h-12 rounded-xl flex flex-col items-center justify-center transition-all active:scale-95 shadow-lg border border-white/5"><span class="text-[10px] opacity-70">1d6</span> <!></button> <button class="bg-slate-800 hover:bg-slate-700 text-white font-bold w-12 h-12 rounded-xl flex flex-col items-center justify-center transition-all active:scale-95 shadow-lg border border-white/5"><span class="text-[10px] opacity-70">2d6</span> <!></button> <button class="bg-slate-800 hover:bg-slate-700 text-white font-bold w-12 h-12 rounded-xl flex flex-col items-center justify-center transition-all active:scale-95 shadow-lg border border-white/5"><span class="text-[10px] opacity-70">3d6</span> <!></button> <div class="w-px h-8 bg-white/10 mx-1"></div> <button class="w-10 h-10 flex items-center justify-center text-slate-500 hover:text-white transition-colors"><!></button></div></div>  <div class="fixed inset-0 bg-black/40 z-[55]"></div>',1),Rn=c('<div class="min-h-screen bg-slate-950 text-slate-100 font-sans pb-20"><!> <!> <!> <div class="hidden md:block fixed bottom-8 left-8 z-[60]"><button class="w-16 h-16 bg-indigo-600 hover:bg-indigo-500 text-white rounded-full shadow-[0_0_20px_rgba(79,70,229,0.4)] flex items-center justify-center transition-all active:scale-90 border-2 border-white/10 group" title="Rolagens Rápidas"><!></button></div> <nav class="md:hidden fixed bottom-0 left-0 right-0 z-50 px-4 pb-6 pt-2 pointer-events-none"><div class="max-w-md mx-auto relative h-16 pointer-events-auto"><div class="absolute inset-0 bg-slate-900 border border-white/10 rounded-2xl shadow-2xl overflow-hidden"><div class="absolute inset-x-0 top-0 h-px bg-gradient-to-r from-transparent via-indigo-500/30 to-transparent"></div></div> <div class="relative h-full flex items-center justify-around px-2"><button><!> <span class="text-[9px] font-black uppercase tracking-widest leading-none">Sessão</span></button> <div class="relative w-16 h-16 -mt-10 flex items-center justify-center"><div class="absolute inset-0 bg-indigo-600/20 rounded-full blur-xl animate-pulse"></div> <button class="relative w-14 h-14 bg-indigo-600 rounded-full flex items-center justify-center shadow-[0_0_20px_rgba(79,70,229,0.5)] border-4 border-slate-900 transition-all active:scale-90 hover:bg-indigo-500 z-10" aria-label="Rolar Dados"><!></button></div> <button><!> <span class="text-[9px] font-black uppercase tracking-widest leading-none">Bestiário</span></button></div></div></nav> <!></div>');function eo(Z,o){ua(o,!0);const n=()=>qt(ms,"$page",q),ve=()=>qt(zs,"$liveCampaigns",q),F=()=>qt(aa,"$t",q),p=()=>qt(wa,"$isHistoryOpen",q),[q,X]=xa();let i=gt("session"),y=gt(!1),ae=ye(()=>n().params.id),Ue=ye(()=>ve().find(se=>se.id===a(ae))),we=ye(()=>!!a(Ue));function Ze(se){if(!a(ae)||!a(Ue))return;const ce={...a(Ue),...se};Zt.set(a(ae),ce),Ua(a(ae),{name:ce.name,gmName:ce.gmName}),k(y,!1)}let je=gt(!1),Ee=gt(ca({isOpen:!1,sides:20,count:1,modifier:0}));function ue(se,ce=1){k(Ee,{isOpen:!0,sides:se,count:ce,modifier:0},!0)}function Te(se){if(!a(Ue))return;const ce=$r(a(Ee).sides,a(Ee).count,se);let Ke="";a(Ee).count>1&&(Ke+=`Dados: [${ce.results.join(", ")}] `),ce.bonusRolls?.length>0&&(Ke+=`Bonus Rolls: [${ce.bonusRolls.join(", ")}] -> ${Math.abs(ce.modifierTotal)}`);const He=a(Ue).gmName||Ta(aa)("common.labels.master");ws.addToHistory({source:"GM",charName:He,name:`${a(Ee).count}d${a(Ee).sides} ${se?se>0?`+${se}`:se:""}`,description:Ke.trim()||null,total:ce.total,formula:ce.formula,crit:ce.crit}),wa.set(!0),a(Ee).isOpen=!1}var ge=Rn(),Rt=t(ge);{var zt=se=>{var ce=En(),Ke=Je(ce);jn(Ke,{get campaignName(){return a(Ue).name},get gmName(){return a(Ue).gmName},get activeSubTab(){return a(i)},onTabChange:E=>k(i,E,!0),onOpenSettings:()=>k(y,!0)});var He=s(Ke,2);{let E=ye(()=>JSON.stringify(a(Ue)));Hs(He,{get isOpen(){return a(y)},get initialData(){return a(E)},onClose:()=>k(y,!1),onSave:Ze})}var bt=s(He,2),nt=t(bt);{var ie=E=>{oi(E,{get campaign(){return a(Ue)}})},Fe=E=>{var ze=Nt(),me=Je(ze);{var Le=Se=>{wn(Se,{get campId(){return a(ae)}})};f(me,Se=>{a(i)==="bestiary"&&Se(Le)},!0)}d(E,ze)};f(nt,E=>{a(i)==="session"?E(ie):E(Fe,!1)})}e(bt),d(se,ce)},Ft=se=>{var ce=Nt(),Ke=Je(ce);{var He=nt=>{var ie=Mn(),Fe=s(t(ie),2),E=t(Fe,!0);e(Fe);var ze=s(Fe,2),me=t(ze,!0);e(ze);var Le=s(ze,2);Le.__click=()=>window.history.back();var Se=s(t(Le));e(Le),e(ie),x((xt,et,tt)=>{r(E,xt),r(me,et),r(Se,` ${tt??""}`)},[()=>F()("campaign.not_found.title"),()=>F()("campaign.not_found.message"),()=>F()("common.buttons.back")]),d(nt,ie)},bt=nt=>{var ie=In();d(nt,ie)};f(Ke,nt=>{a(we)&&!a(Ue)?nt(He):nt(bt,!1)},!0)}d(se,ce)};f(Rt,se=>{a(we)&&a(Ue)?se(zt):se(Ft,!1)})}var ke=s(Rt,2);rs(ke,{get isOpen(){return p()},onClose:()=>wa.set(!1)});var Ne=s(ke,2);{var Xe=se=>{var ce=Sn(),Ke=Je(ce),He=t(Ke),bt=t(He);bt.__click=()=>{ue(20),k(je,!1)};var nt=s(t(bt),2);za(nt,{size:16}),e(bt);var ie=s(bt,2);ie.__click=()=>{ue(6),k(je,!1)};var Fe=s(t(ie),2);za(Fe,{size:16}),e(ie);var E=s(ie,2);E.__click=()=>{ue(6,2),k(je,!1)};var ze=s(t(E),2);za(ze,{size:16}),e(E);var me=s(E,2);me.__click=()=>{ue(6,3),k(je,!1)};var Le=s(t(me),2);za(Le,{size:16}),e(me);var Se=s(me,4);Se.__click=()=>k(je,!1);var xt=t(Se);ma(xt,{size:20}),e(Se),e(He),e(Ke);var et=s(Ke,2);et.__click=()=>k(je,!1),d(se,ce)};f(Ne,se=>{a(je)&&se(Xe)})}var rt=s(Ne,2),xe=t(rt);xe.__click=()=>k(je,!a(je));var Ae=t(xe);za(Ae,{size:32,class:"group-hover:rotate-12 transition-transform"}),e(xe),e(rt);var _t=s(rt,2),P=t(_t),K=s(t(P),2),R=t(K);R.__click=()=>{k(i,"session"),k(je,!1)};var Ge=t(R);{let se=ye(()=>a(i)==="session"?"animate-in zoom-in-75 duration-300":"");ls(Ge,{size:20,get class(){return a(se)}})}va(2),e(R);var Ye=s(R,2),vt=s(t(Ye),2);vt.__click=()=>k(je,!a(je));var $t=t(vt);{let se=ye(()=>a(je)?"rotate-90":"rotate-0");za($t,{size:28,get class(){return`text-white ${a(se)??""} transition-transform duration-300`}})}e(vt),e(Ye);var it=s(Ye,2);it.__click=()=>{k(i,"bestiary"),k(je,!1)};var At=t(it);{let se=ye(()=>a(i)==="bestiary"?"animate-in zoom-in-75 duration-300":"");cs(At,{size:20,get class(){return a(se)}})}va(2),e(it),e(K),e(P),e(_t);var ht=s(_t,2);{let se=ye(()=>`${F()("session.quick.roll_title")} (${a(Ee).count}d${a(Ee).sides})`),ce=ye(()=>a(Ee).sides===20?F()("session.quick.boons_banes"):F()("session.quick.fixed_modifier"));As(ht,{get isOpen(){return a(Ee).isOpen},get title(){return a(se)},get label(){return a(ce)},onClose:()=>a(Ee).isOpen=!1,onRoll:Te,initialModifier:0})}e(ge),x(()=>{st(R,1,`flex flex-col items-center justify-center gap-1 flex-1 transition-all ${a(i)==="session"?"text-indigo-400":"text-slate-500 hover:text-slate-300"}`),st(it,1,`flex flex-col items-center justify-center gap-1 flex-1 transition-all ${a(i)==="bestiary"?"text-indigo-400":"text-slate-500 hover:text-slate-300"}`)}),d(Z,ge),ba(),X()}_a(["click"]);export{eo as component};
