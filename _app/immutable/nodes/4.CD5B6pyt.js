import"../chunks/DsnmJJEf.js";import{B as ht,o as Ae,k as v,p as ja,v as Ea,j as u,q as t,x as a,u as s,z as ue,A as e,t as b,O as $s,w as O,y as Qe,n as Ca,a2 as Oa,at as Ua}from"../chunks/CeF9Pysg.js";import{d as Ma,s as r,o as Fs,g as Rs,e as Ha}from"../chunks/s5ZUjNrT.js";import{l as ga,s as ha,i as w,p as ra}from"../chunks/BO4Hk4Jc.js";import{e as Se,s as Ue,i as ot,$ as ba,r as Xe,a as se,h as Ns,g as ur,j as br}from"../chunks/L5xVHH7A.js";import{a as Sa,s as kt}from"../chunks/BuEkqW-1.js";import{p as _r}from"../chunks/CCMs5yy_.js";import{d as qs,m as zs,j as xr,c as Bs,e as Vt,n as As,o as pr,q as La,t as ks,u as xs,b as Be,v as Vs,f as Js,g as Is,x as mr,y as fr,z as gr}from"../chunks/COofWgfh.js";import{C as Gs,D as Za,l as hr,b as Ps,c as Zs,a as yr}from"../chunks/BO5uUsVl.js";import{b as wr}from"../chunks/DzIHbexc.js";import{U as Xs,C as Ws,W as Ys,r as Ks}from"../chunks/DpVpwn6h.js";import{A as kr,a as zr,b as ps,B as $r,T as Cr,E as Us,M as Or,G as Pa,H as er,C as tr,R as jr,c as Er,I as ar,s as sr,d as rr,L as Mr,S as ir,e as Sr,D as Xa,f as Ir}from"../chunks/D9JbxOfe.js";import{k as Hs}from"../chunks/53slW3xx.js";import{M as Rr,X as Ra,P as da,a as Qs,c as Nr,T as fa,b as Ar}from"../chunks/B9mfT_8k.js";import{C as nr,G as $a,P as Ds,S as Dr,a as Tr}from"../chunks/DbSKv2P5.js";import"../chunks/C3FPqVk7.js";import{I as ya,s as wa}from"../chunks/axHpSoOd.js";import{b as or}from"../chunks/CWVXqVlC.js";import{g as Pr}from"../chunks/CfiZAJE8.js";import{W as Ur}from"../chunks/7Z-uDSBK.js";function Hr(F,o){const i=ga(o,["children","$$slots","$$events","$$legacy"]);const Z=[["path",{d:"m6 9 6 6 6-6"}]];ya(F,ha({name:"chevron-down"},()=>i,{get iconNode(){return Z},children:(P,p)=>{var U=ht(),n=Ae(U);wa(n,o,"default",{}),v(P,U)},$$slots:{default:!0}}))}function Lr(F,o){const i=ga(o,["children","$$slots","$$events","$$legacy"]);const Z=[["path",{d:"m18 15-6-6-6 6"}]];ya(F,ha({name:"chevron-up"},()=>i,{get iconNode(){return Z},children:(P,p)=>{var U=ht(),n=Ae(U);wa(n,o,"default",{}),v(P,U)},$$slots:{default:!0}}))}function Fr(F,o){const i=ga(o,["children","$$slots","$$events","$$legacy"]);const Z=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"}]];ya(F,ha({name:"copy"},()=>i,{get iconNode(){return Z},children:(P,p)=>{var U=ht(),n=Ae(U);wa(n,o,"default",{}),v(P,U)},$$slots:{default:!0}}))}function qr(F,o){const i=ga(o,["children","$$slots","$$events","$$legacy"]);const Z=[["path",{d:"M12 3q1 4 4 6.5t3 5.5a1 1 0 0 1-14 0 5 5 0 0 1 1-3 1 1 0 0 0 5 0c0-2-1.5-3-1.5-5q0-2 2.5-4"}]];ya(F,ha({name:"flame"},()=>i,{get iconNode(){return Z},children:(P,p)=>{var U=ht(),n=Ae(U);wa(n,o,"default",{}),v(P,U)},$$slots:{default:!0}}))}function Br(F,o){const i=ga(o,["children","$$slots","$$events","$$legacy"]);const Z=[["circle",{cx:"9",cy:"12",r:"1"}],["circle",{cx:"9",cy:"5",r:"1"}],["circle",{cx:"9",cy:"19",r:"1"}],["circle",{cx:"15",cy:"12",r:"1"}],["circle",{cx:"15",cy:"5",r:"1"}],["circle",{cx:"15",cy:"19",r:"1"}]];ya(F,ha({name:"grip-vertical"},()=>i,{get iconNode(){return Z},children:(P,p)=>{var U=ht(),n=Ae(U);wa(n,o,"default",{}),v(P,U)},$$slots:{default:!0}}))}function Ts(F,o){const i=ga(o,["children","$$slots","$$events","$$legacy"]);const Z=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17"}]];ya(F,ha({name:"layers"},()=>i,{get iconNode(){return Z},children:(P,p)=>{var U=ht(),n=Ae(U);wa(n,o,"default",{}),v(P,U)},$$slots:{default:!0}}))}function lr(F,o){const i=ga(o,["children","$$slots","$$events","$$legacy"]);const Z=[["path",{d:"m16 6 4 14"}],["path",{d:"M12 6v14"}],["path",{d:"M8 8v12"}],["path",{d:"M4 4v16"}]];ya(F,ha({name:"library"},()=>i,{get iconNode(){return Z},children:(P,p)=>{var U=ht(),n=Ae(U);wa(n,o,"default",{}),v(P,U)},$$slots:{default:!0}}))}function Jr(F,o){const i=ga(o,["children","$$slots","$$events","$$legacy"]);const Z=[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3"}],["path",{d:"M21 21v.01"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7"}],["path",{d:"M3 12h.01"}],["path",{d:"M12 3h.01"}],["path",{d:"M12 16v.01"}],["path",{d:"M16 12h1"}],["path",{d:"M21 12v.01"}],["path",{d:"M12 21v-1"}]];ya(F,ha({name:"qr-code"},()=>i,{get iconNode(){return Z},children:(P,p)=>{var U=ht(),n=Ae(U);wa(n,o,"default",{}),v(P,U)},$$slots:{default:!0}}))}function Ls(F,o){const i=ga(o,["children","$$slots","$$events","$$legacy"]);const Z=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7"}]];ya(F,ha({name:"save"},()=>i,{get iconNode(){return Z},children:(P,p)=>{var U=ht(),n=Ae(U);wa(n,o,"default",{}),v(P,U)},$$slots:{default:!0}}))}function dr(F,o){const i=ga(o,["children","$$slots","$$events","$$legacy"]);const Z=[["polyline",{points:"14.5 17.5 3 6 3 3 6 3 17.5 14.5"}],["line",{x1:"13",x2:"19",y1:"19",y2:"13"}],["line",{x1:"16",x2:"20",y1:"16",y2:"20"}],["line",{x1:"19",x2:"21",y1:"21",y2:"19"}],["polyline",{points:"14.5 6.5 18 3 21 3 21 6 17.5 9.5"}],["line",{x1:"5",x2:"9",y1:"14",y2:"18"}],["line",{x1:"7",x2:"4",y1:"17",y2:"20"}],["line",{x1:"3",x2:"5",y1:"19",y2:"21"}]];ya(F,ha({name:"swords"},()=>i,{get iconNode(){return Z},children:(P,p)=>{var U=ht(),n=Ae(U);wa(n,o,"default",{}),v(P,U)},$$slots:{default:!0}}))}function Wr(F){let o=!1;return document.body&&(document.body.appendChild(F),o=!0),{destroy(){o&&F.parentNode&&F.parentNode.removeChild(F)}}}var Qr=u("<button> <!></button>"),Vr=u('<p class="text-xs text-slate-600 italic"> </p>'),Gr=u('<div class="text-xs leading-tight"><span class="text-red-400 font-bold"> </span> <span class="text-slate-400"> </span></div>'),Zr=u('<div class="space-y-1"></div>'),Xr=u('<div class="grid grid-cols-2 gap-2 max-h-[60vh] overflow-y-auto custom-scrollbar p-1"></div> <div class="mt-4 pt-3 border-t border-slate-800 flex flex-col gap-2"><div class="p-3 bg-slate-900/50 rounded-lg border border-slate-700/50 min-h-[60px]"><p class="text-[10px] text-slate-500 uppercase font-bold mb-1"> </p> <!></div> <div class="flex justify-end mt-2"><button class="bg-indigo-600 text-white px-4 py-2 rounded-xl font-bold text-sm shadow hover:bg-indigo-500 transition-colors w-full sm:w-auto"> </button></div></div>',1),Yr=u("<div><!></div>");function Kr(F,o){ja(o,!0);const i=()=>kt(ba,"$t",Z),[Z,P]=Sa();var p=ht(),U=Ae(p);{var n=y=>{var M=Yr(),X=t(M);{let ye=ue(()=>i()("session.affliction_modal.title"));Rr(X,{get isOpen(){return o.isOpen},get onClose(){return o.onClose},get title(){return a(ye)},maxWidth:"max-w-md",children:(we,Ie)=>{var ee=Xr(),me=Ae(ee);Se(me,21,()=>Object.keys(kr),ot,(fe,Oe)=>{const te=ue(()=>o.afflictions.includes(a(Oe)));var Y=Qr();Y.__click=()=>o.onToggle(a(Oe));var de=t(Y),K=s(de);{var Ve=et=>{nr(et,{size:14,class:"text-red-400"})};w(K,et=>{a(te)&&et(Ve)})}e(Y),b(et=>{Ue(Y,1,`flex items-center justify-between px-3 py-2 rounded-lg border text-xs font-bold transition-all ${a(te)?"bg-red-500/20 border-red-500 text-red-100":"bg-slate-800 border-slate-700 text-slate-400 hover:bg-slate-750"}`),r(de,`${et??""} `)},[()=>i()(`character.afflictions.${a(Oe)}`)]),v(fe,Y)}),e(me);var le=s(me,2),ke=t(le),ie=t(ke),_t=t(ie,!0);e(ie);var it=s(ie,2);{var Ce=fe=>{var Oe=Vr(),te=t(Oe,!0);e(Oe),b(Y=>r(te,Y),[()=>i()("session.affliction_modal.none_selected")]),v(fe,Oe)},Re=fe=>{var Oe=Zr();Se(Oe,21,()=>o.afflictions,ot,(te,Y)=>{var de=Gr(),K=t(de),Ve=t(K);e(K);var et=s(K,2),Ge=t(et,!0);e(et),e(de),b((Pt,lt)=>{r(Ve,`${Pt??""}:`),r(Ge,lt)},[()=>i()(`character.afflictions.${a(Y)}`),()=>i()(`sofww.afflictions.${a(Y).toLowerCase().replace(" ","_")}.effect`)]),v(te,de)}),e(Oe),v(fe,Oe)};w(it,fe=>{o.afflictions.length===0?fe(Ce):fe(Re,!1)})}e(ke);var He=s(ke,2),Je=t(He);Je.__click=function(...fe){o.onClose?.apply(this,fe)};var Ke=t(Je,!0);e(Je),e(He),e(le),b((fe,Oe)=>{r(_t,fe),r(Ke,Oe)},[()=>i()("session.affliction_modal.effects"),()=>i()("session.affliction_modal.done")]),v(we,ee)},$$slots:{default:!0}})}e(M),zr(M,ye=>Wr?.(ye)),v(y,M)};w(U,y=>{o.isOpen&&y(n)})}v(F,p),Ea(),P()}Ma(["click"]);var ei=u('<div class="absolute top-0 right-0 bg-gradient-to-l from-yellow-600/20 to-transparent border-l border-b border-yellow-500/30 text-yellow-500 text-[9px] font-black tracking-widest px-3 py-1 rounded-bl-xl z-20 uppercase shadow-[0_0_10px_rgba(234,179,8,0.2)]"> </div>'),ti=u('<div class="absolute inset-0 bg-red-950/40 animate-pulse z-0 pointer-events-none"></div>'),ai=u('<span class="text-[9px] font-black bg-red-950/40 text-red-500 px-1.5 py-0.5 rounded border border-red-900/30 uppercase tracking-wider flex-shrink-0"> </span>'),si=u("<button><!></button>"),ri=u('<button class="w-7 h-7 flex items-center justify-center rounded bg-slate-800/50 text-slate-600 hover:text-red-400 hover:bg-red-950/30 border border-slate-700/50 transition-colors"><!></button>'),ii=u('<div><div class="absolute inset-0 bg-gradient-to-b from-white/20 to-transparent"></div></div>'),ni=u('<div class="absolute inset-0 bg-gradient-to-r from-emerald-500/20 via-emerald-400/30 to-emerald-500/20 z-10"><div class="absolute inset-0 bg-gradient-to-b from-white/10 to-transparent"></div></div>'),oi=u('<div class="absolute inset-0 flex items-center justify-center pointer-events-none z-20"><span class="text-[9px] font-black uppercase text-white drop-shadow-[0_1px_1px_rgba(0,0,0,0.8)] tracking-widest leading-none mt-0.5"> </span></div>'),li=u('<div class="absolute inset-0 flex items-center justify-center pointer-events-none z-20"><span class="text-[9px] font-black uppercase text-white drop-shadow-[0_1px_1px_rgba(0,0,0,0.8)] tracking-widest leading-none mt-0.5"> </span></div>'),di=u('<div class="flex flex-col items-center justify-between bg-cyan-950/20 border border-cyan-500/30 rounded-lg p-1.5 w-[4.5rem] h-[3.75rem] shadow-sm"><span class="text-[9px] font-black text-cyan-400 uppercase tracking-wider mb-0.5"> </span> <span class="text-xl font-bold text-white font-mono leading-none"> </span></div>'),vi=u('<button class="text-[9px] bg-red-500/10 text-red-400 px-1.5 py-0.5 rounded border border-red-500/20 hover:bg-red-500/20 hover:border-red-500/40 transition-all flex items-center gap-1 group/btn"> <!></button>'),ci=u('<div class="bg-slate-900/50 p-2 rounded border border-slate-800/50 text-center"><span class="text-[9px] text-slate-500 uppercase font-black block mb-0.5"> </span> <div class="text-white font-bold font-mono text-lg leading-none"> </div> <div> </div></div>'),ui=u('<div class="grid grid-cols-2 gap-4 mb-4"><div class="p-3 rounded-xl bg-purple-950/20 border border-purple-500/30 flex justify-between items-center group/ins"><div><span class="text-[9px] text-purple-400 uppercase font-black block"> </span> <span class="text-white font-bold text-lg font-mono leading-none"> </span></div> <!></div> <div class="p-3 rounded-xl bg-red-950/20 border border-red-500/30 flex justify-between items-center group/cor"><div><span class="text-[9px] text-red-400 uppercase font-black block"> </span> <span class="text-white font-bold text-lg font-mono leading-none"> </span></div> <!></div></div>'),bi=u("<!> ",1),_i=u('<div><div class="text-emerald-500 text-[10px] font-black uppercase mb-2 flex items-center gap-2"> <span class="h-px flex-1 bg-current opacity-20"></span></div> <div class="flex flex-wrap gap-2"></div></div>'),xi=u('<div class="text-sm bg-slate-900/30 p-2 rounded border border-slate-800/30"><span class="font-bold text-slate-300"> </span> <span class="text-slate-400 text-xs block mt-1 leading-relaxed"> </span></div>'),pi=u('<div><div> <span class="h-px flex-1 bg-current opacity-20"></span></div> <div class="grid gap-2"></div></div>'),mi=u('<div class="border-t border-slate-800/50 bg-slate-950/30 p-4"><div class="mb-4"><div class="text-slate-500 font-bold uppercase text-[10px] mb-2 flex items-center gap-2"><span> </span> <div class="h-px flex-1 bg-slate-800"></div></div> <div class="grid grid-cols-4 gap-2"></div></div> <!> <div class="grid grid-cols-2 gap-4 mb-4"><div class="p-2 rounded bg-slate-900/50 border border-slate-800/50 flex flex-col items-center"><span class="text-[9px] text-slate-500 uppercase font-black"> </span> <span class="text-white font-bold"> </span></div> <div class="p-2 rounded bg-slate-900/50 border border-slate-800/50 flex flex-col items-center"><span class="text-[9px] text-slate-500 uppercase font-black"> </span> <span class="text-white font-bold"> </span></div></div> <div class="space-y-4"><!> <!></div></div>'),fi=u('<div><!> <!> <div class="relative z-10 p-4"><div class="flex items-start gap-4 mb-3"><div class="relative flex-shrink-0"><div><!></div> <button><!></button></div> <div class="flex-1 min-w-0"><div class="flex justify-between items-start mb-1"><div class="flex flex-col min-w-0 mr-2"><div class="flex items-center gap-2"><h3> </h3> <!></div></div> <div class="flex gap-1 flex-shrink-0"><button class="w-7 h-7 flex items-center justify-center rounded bg-slate-800 text-slate-500 hover:text-white hover:bg-slate-700 border border-slate-700/50 transition-colors"><!></button> <!></div></div>  <div class="relative w-full h-3.5 sm:h-4 bg-slate-950 rounded-full border border-white/5 overflow-hidden shadow-inner group-hover:border-white/20 transition-all mb-2"><div></div> <!> <!> <!></div> <div class="flex flex-col sm:flex-row gap-3"><div class="flex items-start gap-1.5"><div class="flex flex-col items-center justify-between bg-slate-900 border border-slate-700 rounded-lg p-1.5 w-[4.5rem] h-[3.75rem] shadow-sm"><span class="text-[9px] font-black text-slate-400 uppercase tracking-wider mb-0.5"> </span> <span class="text-xl font-bold text-white font-mono leading-none"> </span></div> <div class="flex flex-col items-center justify-between bg-red-950/30 border border-red-900/50 rounded-lg p-1.5 w-[4.5rem] h-[3.75rem] shadow-sm relative group/dmg"><span class="text-[9px] font-black text-red-400 uppercase tracking-wider mb-0.5"> </span> <input type="number" class="w-full bg-transparent text-center text-white font-mono font-bold text-xl focus:outline-none p-0 leading-none placeholder-red-800"/> <span class="absolute -top-1 -right-1 flex h-2 w-2 opacity-0 group-hover/dmg:opacity-100 transition-opacity"><span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-red-400 opacity-75"></span> <span class="relative inline-flex rounded-full h-2 w-2 bg-red-500"></span></span></div> <div><span> </span> <div class="flex items-baseline gap-0.5 justify-center w-full"><input type="number" class="w-full bg-transparent text-right text-white font-mono font-bold text-xl focus:outline-none p-0 leading-none"/> <span class="text-[10px] text-slate-500 font-mono self-end mb-0.5 opacity-70"> </span></div></div> <!></div> <div class="flex flex-wrap gap-1.5 items-center flex-1"><!> <button class="text-[10px] sm:text-[9px] font-bold text-slate-500 hover:text-indigo-400 px-1.5 py-0.5 rounded border border-transparent hover:border-indigo-500/30 hover:bg-indigo-500/10 transition-all flex items-center gap-1 whitespace-nowrap"><!> </button></div></div></div></div></div>  <!> <!></div>');function gi(F,o){ja(o,!0);const i=()=>kt(ba,"$t",Z),[Z,P]=Sa();let p=ra(o,"updateEnemy",3,(h,E)=>{}),U=ra(o,"updatePlayer",3,(h,E)=>{}),n=ra(o,"removeFromCombat",3,h=>{}),y=ue(()=>o.entity.type==="player"),M=ue(()=>o.entity.system==="sofdl"),X=ue(()=>o.entity.damage||0),ye=ue(()=>o.entity.normalHealth||o.entity.health||10),we=ue(()=>o.entity.currentHealth??a(ye)),Ie=ue(()=>a(X)>=a(we)),ee=ue(()=>a(X)>=a(we)/2&&!a(Ie)),me=ue(()=>a(we)>0?Math.min(100,Math.max(0,a(X)/a(we)*100)):100),le=Qe(!1),ke=Qe(!1);$s(()=>{const h=o.entity.afflictions||[],E=h.includes("Incapacitated");if(a(Ie)&&!E){const he={afflictions:[...h,"Incapacitated"]};o.entity.type==="player"?ie(he):p()(o.entity.instanceId,he)}else if(!a(Ie)&&E){const he={afflictions:h.filter(Ye=>Ye!=="Incapacitated")};o.entity.type==="player"?ie(he):p()(o.entity.instanceId,he)}});function ie(h){if(o.entity.type!=="player")return;const E=qs.get(o.entity.id);E&&qs.set(o.entity.id,{...E,...h}),U()(o.entity.id,h),zs({id:o.entity.id,...h})}function _t(h){const E=parseInt(h.target.value);if(isNaN(E))return;const he={damage:Math.max(0,E)};o.entity.type==="player"?ie(he):p()(o.entity.instanceId,he)}function it(h){const E=parseInt(h.target.value);if(isNaN(E))return;const _e=Math.max(0,E);let he=a(X);_e<a(X)&&(he=_e);const Ye={currentHealth:_e,damage:he};o.entity.type==="player"?ie(Ye):p()(o.entity.instanceId,Ye)}function Ce(){const h=!o.entity.acted;o.entity.type==="player"?ie({acted:h}):p()(o.entity.instanceId,{acted:h})}function Re(){o.entity.type==="player"&&ie({initiative:!o.entity.initiative})}function He(h){const E=o.entity.afflictions||[],he={afflictions:E.includes(h)?E.filter(Ye=>Ye!==h):[...E,h]};o.entity.type==="player"?ie(he):p()(o.entity.instanceId,he)}var Je=fi(),Ke=t(Je);{var fe=h=>{var E=ei(),_e=t(E,!0);e(E),b(he=>r(_e,he),[()=>i()("session.combat_card.initiative")]),v(h,E)};w(Ke,h=>{a(y)&&o.entity.initiative&&h(fe)})}var Oe=s(Ke,2);{var te=h=>{var E=ti();v(h,E)};w(Oe,h=>{a(Ie)&&h(te)})}var Y=s(Oe,2),de=t(Y),K=t(de),Ve=t(K),et=t(Ve);Hs(et,()=>o.entity.imageUrl,h=>{{let E=ue(()=>o.entity.name.charAt(0));ps(h,{get hash(){return o.entity.imageUrl},get alt(){return o.entity.name},size:"custom",get fallbackText(){return a(E)}})}}),e(Ve);var Ge=s(Ve,2);Ge.__click=Ce;var Pt=t(Ge);{var lt=h=>{Qs(h,{size:14,class:""})},zt=h=>{var E=ht(),_e=Ae(E);{var he=jt=>{nr(jt,{size:14})},Ye=jt=>{dr(jt,{size:14})};w(_e,jt=>{o.entity.acted?jt(he):jt(Ye,!1)},!0)}v(h,E)};w(Pt,h=>{a(Ie)?h(lt):h(zt,!1)})}e(Ge),e(K);var yt=s(K,2),W=t(yt),ze=t(W),De=t(ze),We=t(De),tt=t(We,!0);e(We);var ut=s(We,2);{var ae=h=>{var E=ai(),_e=t(E);e(E),b(()=>r(_e,`Dif ${o.entity.difficulty??""}`)),v(h,E)};w(ut,h=>{a(y)||h(ae)})}e(De),e(ze);var Pe=s(ze,2),q=t(Pe);q.__click=()=>O(le,!a(le));var $e=t(q);{var je=h=>{Lr(h,{size:14})},Me=h=>{Hr(h,{size:14})};w($e,h=>{a(le)?h(je):h(Me,!1)})}e(q);var Te=s(q,2);{var dt=h=>{var E=si();E.__click=Re;var _e=t(E);qr(_e,{size:14}),e(E),b(he=>{Ue(E,1,`w-7 h-7 flex items-center justify-center rounded transition-all ${o.entity.initiative?"bg-yellow-500 text-yellow-950 shadow-lg shadow-yellow-500/20":"bg-slate-800 text-slate-500 hover:text-white hover:bg-slate-700"}`),se(E,"title",he)},[()=>i()("session.combat_card.initiative")]),v(h,E)},Ze=h=>{var E=ri();E.__click=()=>n()(o.entity.instanceId);var _e=t(E);Ra(_e,{size:14}),e(E),v(h,E)};w(Te,h=>{a(y)?h(dt):h(Ze,!1)})}e(Pe),e(W);var at=s(W,2),xt=t(at),$t=s(xt,2);{var St=h=>{var E=ii();b(()=>{Ue(E,1,`absolute top-0 left-0 h-full transition-all duration-500 ease-out z-10
                            ${a(Ie)?"bg-gradient-to-r from-red-600 via-red-500 to-rose-500 animate-pulse":a(me)>=80?"bg-gradient-to-r from-red-600 to-rose-500":a(ee)?"bg-gradient-to-r from-amber-600 to-orange-500":"bg-gradient-to-r from-orange-500 to-amber-400"}`),ur(E,`width: ${a(me)??""}%`)}),v(h,E)};w($t,h=>{a(me)>0&&h(St)})}var It=s($t,2);{var I=h=>{var E=ni();v(h,E)};w(It,h=>{a(X)===0&&h(I)})}var L=s(It,2);{var ge=h=>{var E=oi(),_e=t(E),he=t(_e,!0);e(_e),e(E),b(Ye=>r(he,Ye),[()=>i()("session.combat_card.incapacitated")]),v(h,E)},st=h=>{var E=ht(),_e=Ae(E);{var he=Ye=>{var jt=li(),Qt=t(jt),ma=t(Qt,!0);e(Qt),e(jt),b(_a=>r(ma,_a),[()=>i()("session.combat_card.injured")]),v(Ye,jt)};w(_e,Ye=>{a(ee)&&Ye(he)},!0)}v(h,E)};w(L,h=>{a(Ie)?h(ge):h(st,!1)})}e(at);var mt=s(at,2),vt=t(mt),ct=t(vt),Bt=t(ct),Xt=t(Bt,!0);e(Bt);var Yt=s(Bt,2),Kt=t(Yt,!0);e(Yt),e(ct);var Gt=s(ct,2),ea=t(Gt),ia=t(ea,!0);e(ea);var Ut=s(ea,2);Xe(Ut),Ut.__input=_t,Ca(2),e(Gt);var wt=s(Gt,2),Jt=t(wt),Rt=t(Jt,!0);e(Jt);var Wt=s(Jt,2),rt=t(Wt);Xe(rt),rt.__input=it;var Ct=s(rt,2),Le=t(Ct);e(Ct),e(Wt),e(wt);var Ot=s(wt,2);{var ta=h=>{var E=di(),_e=t(E),he=t(_e,!0);e(_e);var Ye=s(_e,2),jt=t(Ye,!0);e(Ye),e(E),b(Qt=>{r(he,Qt),r(jt,o.entity.perception||10)},[()=>i()("sofdl.attributes.perception")]),v(h,E)};w(Ot,h=>{a(M)&&h(ta)})}e(vt);var Ht=s(vt,2),Nt=t(Ht);Se(Nt,17,()=>o.entity.afflictions||[],ot,(h,E)=>{var _e=vi();_e.__click=()=>He(a(E));var he=t(_e),Ye=s(he);Ra(Ye,{size:8,class:"opacity-50 group-hover/btn:opacity-100"}),e(_e),b(()=>r(he,`${a(E)??""} `)),v(h,_e)});var At=s(Nt,2);At.__click=()=>O(ke,!0);var sa=t(At);da(sa,{size:10});var aa=s(sa);e(At),e(Ht),e(mt),e(yt),e(de),e(Y);var na=s(Y,2);{var pa=h=>{var E=mi(),_e=t(E),he=t(_e),Ye=t(he),jt=t(Ye,!0);e(Ye),Ca(2),e(he);var Qt=s(he,2);Se(Qt,21,()=>a(M)?["strength","agility","intellect","will"]:["str","agi","int","wil"],ot,(j,z)=>{const V=ue(()=>a(M)?o.entity.attributes?.[a(z)]??10:o.entity.stats?.[a(z)]??o.entity.attributes?.[a(z)]??10),re=ue(()=>a(V)-10);var ce=ci(),J=t(ce),xe=t(J,!0);e(J);var _=s(J,2),$=t(_,!0);e(_);var f=s(_,2),T=t(f);e(f),e(ce),b(S=>{r(xe,S),r($,a(V)),Ue(f,1,`text-[9px] font-bold ${a(re)>=0?"text-emerald-500":"text-red-500"}`),r(T,`${a(re)>=0?"+":""}${a(re)??""}`)},[()=>a(M)?a(z).slice(0,3):a(z)]),v(j,ce)}),e(Qt),e(_e);var ma=s(_e,2);{var _a=j=>{var z=ui(),V=t(z),re=t(V),ce=t(re),J=t(ce,!0);e(ce);var xe=s(ce,2),_=t(xe,!0);e(xe),e(re);var $=s(re,2);$r($,{size:20,class:"text-purple-500/30 group-hover/ins:text-purple-500 transition-colors"}),e(V);var f=s(V,2),T=t(f),S=t(T),m=t(S,!0);e(S);var x=s(S,2),N=t(x,!0);e(x),e(T);var A=s(T,2);Qs(A,{size:20,class:"text-red-500/30 group-hover/cor:text-red-500 transition-colors"}),e(f),e(z),b((ne,H)=>{r(J,ne),r(_,o.entity.insanity||0),r(m,H),r(N,o.entity.corruption||0)},[()=>i()("sofdl.attributes.insanity"),()=>i()("sofdl.attributes.corruption")]),v(j,z)};w(ma,j=>{a(M)&&j(_a)})}var xa=s(ma,2),va=t(xa),ka=t(va),B=t(ka,!0);e(ka);var Q=s(ka,2),ve=t(Q,!0);e(Q),e(va);var Fe=s(va,2),l=t(Fe),d=t(l,!0);e(l);var c=s(l,2),g=t(c,!0);e(c),e(Fe),e(xa);var D=s(xa,2),C=t(D);{var k=j=>{var z=_i(),V=t(z),re=t(V);Ca(),e(V);var ce=s(V,2);Se(ce,21,()=>o.entity.senses,ot,(J,xe)=>{const _=ue(()=>{const[T,S]=a(xe).split(":");return{key:T,val:S}}),$=ue(()=>i()(`character.senses.list.${a(_).key}`)+(a(_).val?` ${a(_).val}`:"")),f=ue(()=>i()(`character.senses.descriptions.${a(_).key}`));Cr(J,{get text(){return a(f)},class:"text-xs bg-emerald-950/30 text-emerald-200 px-3 py-1.5 rounded border border-emerald-900/50 font-bold flex items-center gap-2 cursor-help whitespace-nowrap",children:(T,S)=>{var m=bi(),x=Ae(m);Us(x,{size:12,class:"text-emerald-500 flex-shrink-0"});var N=s(x);b(()=>r(N,` ${a($)??""}`)),v(T,m)},$$slots:{default:!0}})}),e(ce),e(z),b(J=>r(re,`${J??""} `),[()=>i()("character.senses.title")]),v(j,z)};w(C,j=>{o.entity.senses&&o.entity.senses.length>0&&j(k)})}var R=s(C,2);Se(R,16,()=>[{key:"traits",label:"Traços",color:"text-amber-500"},{key:"actions",label:"Ações",color:"text-red-400"},{key:"reactions",label:"Reações",color:"text-indigo-400"},{key:"end_of_round",label:"Fim da Rodada",color:"text-emerald-400"}],ot,(j,z)=>{var V=ht(),re=Ae(V);{var ce=J=>{var xe=pi(),_=t(xe),$=t(_);Ca(),e(_);var f=s(_,2);Se(f,21,()=>o.entity[z.key],ot,(T,S)=>{var m=xi(),x=t(m),N=t(x,!0);e(x);var A=s(x,2),ne=t(A,!0);e(A),e(m),b(()=>{r(N,a(S).name),r(ne,a(S).description||a(S).effect)}),v(T,m)}),e(f),e(xe),b(()=>{Ue(_,1,`${z.color??""} text-[10px] font-black uppercase mb-2 flex items-center gap-2`),r($,`${z.label??""} `)}),v(J,xe)};w(re,J=>{o.entity[z.key]&&o.entity[z.key].length>0&&J(ce)})}v(j,V)}),e(D),e(E),b((j,z,V)=>{r(jt,j),r(B,z),r(ve,o.entity.size||1),r(d,V),r(g,o.entity.speed||10)},[()=>i()("session.combat_card.attributes"),()=>i()("session.combat_card.size"),()=>i()("session.combat_card.speed")]),v(h,E)};w(na,h=>{a(le)&&h(pa)})}var Ia=s(na,2);{let h=ue(()=>o.entity.afflictions||[]);Kr(Ia,{get isOpen(){return a(ke)},onClose:()=>O(ke,!1),get afflictions(){return a(h)},onToggle:He})}e(Je),b((h,E,_e,he,Ye)=>{Ue(Je,1,`group relative overflow-hidden transition-all duration-300 rounded-2xl border ${a(y)?"bg-slate-900/80 border-indigo-500/30 hover:border-indigo-500/50 hover:shadow-indigo-900/20":"bg-slate-950/80 border-red-900/30 hover:border-red-800/50 hover:shadow-red-900/10"} shadow-lg backdrop-blur-sm`),Ue(Ve,1,`w-14 h-14 rounded-2xl overflow-hidden border-2 shadow-xl transition-transform group-hover:scale-105 ${a(Ie)?"border-red-600 grayscale brightness-50":a(y)?"border-indigo-500/50":"border-red-900/50"}`),Ue(Ge,1,`absolute -bottom-2 -right-2 w-7 h-7 rounded-lg flex items-center justify-center border shadow-lg transition-all hover:scale-110 z-20 ${o.entity.acted?"bg-slate-800 border-slate-600 text-slate-500":a(y)?"bg-indigo-600 border-indigo-400 text-white":"bg-red-600 border-red-400 text-white"}`),se(Ge,"title",h),Ue(We,1,`text-base font-bold truncate leading-snug ${a(y)?"text-white":"text-red-100 font-serif tracking-wide"}`),r(tt,o.entity.name),Ue(xt,1,`absolute inset-0 w-full ${a(X)===0?"bg-emerald-900/20":"bg-slate-900/50"}`),r(Xt,E),r(Kt,o.entity.defense||10),r(ia,_e),Ns(Ut,a(X)),Ue(wt,1,`flex flex-col items-center justify-between border rounded-lg p-1.5 w-[5.5rem] h-[3.75rem] shadow-sm relative transition-colors ${a(Ie)?"bg-red-950/50 border-red-500":a(ee)?"bg-orange-950/30 border-orange-500":"bg-emerald-950/30 border-emerald-900/50"}`),Ue(Jt,1,`text-[9px] font-black uppercase tracking-wider mb-0.5 ${a(Ie)?"text-red-400":a(ee)?"text-orange-400":"text-emerald-400"}`),r(Rt,he),Ns(rt,a(we)),r(Le,`/${a(ye)??""}`),r(aa,` ${Ye??""}`)},[()=>o.entity.acted?i()("session.combat_card.acted"):i()("session.combat_card.act"),()=>i()("session.combat_card.defense"),()=>i()("session.combat_card.damage"),()=>i()("session.combat_card.health"),()=>i()("session.combat_card.add_affliction")]),v(F,Je),Ea(),P()}Ma(["click","input"]);function hi(F,{from:o,to:i},Z={}){var{delay:P=0,duration:p=Re=>Math.sqrt(Re)*120,easing:U=Nr}=Z,n=getComputedStyle(F),y=n.transform==="none"?"":n.transform,[M,X]=n.transformOrigin.split(" ").map(parseFloat);M/=F.clientWidth,X/=F.clientHeight;var ye=yi(F),we=F.clientWidth/i.width/ye,Ie=F.clientHeight/i.height/ye,ee=o.left+o.width*M,me=o.top+o.height*X,le=i.left+i.width*M,ke=i.top+i.height*X,ie=(ee-le)*we,_t=(me-ke)*Ie,it=o.width/i.width,Ce=o.height/i.height;return{delay:P,duration:typeof p=="function"?p(Math.sqrt(ie*ie+_t*_t)):p,easing:U,css:(Re,He)=>{var Je=He*ie,Ke=He*_t,fe=Re+He*it,Oe=Re+He*Ce;return`transform: ${y} translate(${Je}px, ${Ke}px) scale(${fe}, ${Oe});`}}}function yi(F){if("currentCSSZoom"in F)return F.currentCSSZoom;for(var o=F,i=1;o!==null;)i*=+getComputedStyle(o).zoom,o=o.parentElement;return i}function wi(F,o=1,i=0){const Z=[];let P=0;for(let y=0;y<o;y++){const M=Math.floor(Math.random()*F)+1;Z.push(M),P+=M}let p=`${o}d${F}`,U=[],n=0;if(i!==0)if(F===20){const y=Math.abs(i);for(let X=0;X<y;X++)U.push(Math.floor(Math.random()*6)+1);const M=Math.max(...U);i>0?(n=M,P+=M,p+=` + ${M} [Boon]`):(n=-M,P-=M,p+=` - ${M} [Bane]`)}else n=i,P+=i,p+=i>0?` + ${i}`:` - ${Math.abs(i)}`;return{total:P,results:Z,bonusRolls:U,formula:p,crit:F===20&&Z.includes(20),modifierTotal:n}}function ki(F,o,i){const Z=i.map(y=>({...y,type:"enemy"}));if(F==="standard"){const y=o.filter(we=>we.initiative).map(we=>({...we,type:"player",isFast:!0})),M=o.filter(we=>!we.initiative).map(we=>({...we,type:"player",isFast:!1})),X=Z.filter(we=>we.initiative).map(we=>({...we,isFast:!0})),ye=Z.filter(we=>!we.initiative).map(we=>({...we,isFast:!1}));return[...y,...X,...M,...ye]}if(F==="individual")return[...o.map(M=>({...M,type:"player",totalInit:(M.initiativeRoll||0)+(M.attributes?.agility||10)-10})),...Z.map(M=>({...M,type:"enemy",totalInit:(M.initiativeRoll||0)+(M.attributes?.agility||10)-10}))].sort((M,X)=>X.totalInit-M.totalInit);const P=o.filter(y=>y&&y.initiative).map(y=>({...y,type:"player"})),p=o.filter(y=>y&&!y.initiative).map(y=>({...y,type:"player"})),U=[...P,...Z,...p],n=new Set;return U.filter(y=>{if(!y)return!1;const M=y.type==="player"?y.id:y.instanceId;return n.has(M)?!1:(n.add(M),!0)})}var zi=u('<span class="text-[10px] bg-slate-800 text-slate-400 px-1.5 py-0.5 rounded-full"> </span>'),$i=u('<div class="p-3 rounded-xl border border-amber-500/30 bg-amber-500/5 flex items-center gap-3 transition-all hover:bg-amber-500/10 shadow-sm"><div class="flex-1"><div class="font-bold text-sm text-amber-200 leading-none"> </div> <div class="text-[9px] text-amber-500/60 font-medium mt-1 uppercase tracking-tighter"> </div></div> <div class="flex items-center gap-1.5"><button class="p-2 rounded-lg bg-green-600/20 text-green-400 hover:bg-green-600 hover:text-white transition-all shadow-lg active:scale-90" title="Aprovar"><!></button> <button class="p-2 rounded-lg bg-red-600/20 text-red-400 hover:bg-red-600 hover:text-white transition-all shadow-lg active:scale-90" title="Recusar"><!></button></div></div>'),Ci=u('<div class="space-y-2 animate-in fade-in slide-in-from-top-2"><div class="flex items-center gap-2 px-1"><div class="w-1.5 h-1.5 rounded-full bg-amber-500 animate-pulse"></div> <span class="text-[10px] font-black text-amber-500 uppercase tracking-wider"> </span></div> <!> <div class="h-px bg-slate-800/50 mx-2 my-2"></div></div>'),Oi=u('<span class="text-indigo-400 font-bold uppercase tracking-tighter mr-1"> </span>'),ji=u('<div><div></div> <div class="flex-1"><div> </div> <div class="text-[10px] text-slate-500 font-medium"><!> </div></div> <div class="flex items-center gap-1"><button><!></button> <button class="text-slate-600 hover:text-red-400 p-1.5 hover:bg-red-400/10 rounded-lg transition-all"><!></button></div></div>'),Ei=u('<div class="text-xs text-slate-600 italic p-6 border-2 border-dashed border-slate-800 rounded-xl text-center"> </div>'),Mi=u('<button class="w-full bg-indigo-600 hover:bg-indigo-500 text-white py-3 rounded-xl font-black uppercase text-[10px] tracking-[0.2em] shadow-lg shadow-indigo-900/20 transition-all active:scale-[0.98] flex items-center justify-center gap-2"><!> </button> <p class="text-[9px] text-slate-600 text-center font-bold uppercase tracking-tighter"> </p>',1),Si=u('<div class="flex justify-center p-3 bg-white rounded-xl mb-2 animate-in zoom-in-95 duration-200 shadow-xl mx-auto w-32 h-32"><img class="w-24 h-24"/></div>'),Ii=u('<div class="absolute bottom-full left-1/2 -translate-x-1/2 mb-2 px-2 py-1 bg-green-500 text-white text-[10px] font-bold rounded shadow-lg animate-in fade-in slide-in-from-bottom-1 whitespace-nowrap"><!> </div>'),Ri=u('<div class="flex items-center justify-between"><div class="flex items-center gap-2"><span class="text-[10px] font-black text-indigo-400 uppercase tracking-widest flex items-center gap-1"><!> </span></div> <button class="text-slate-500 hover:text-white transition-colors p-1"><!></button></div> <!> <div class="relative group"><div class="flex gap-1"><div class="flex-1 bg-slate-950 border border-slate-800 rounded-lg p-2 text-[10px] text-slate-400 font-mono truncate cursor-pointer hover:border-slate-700 transition-colors flex items-center"> </div> <button class="bg-indigo-600 hover:bg-indigo-500 text-white p-2 rounded-lg transition-all active:scale-95 shadow-lg shadow-indigo-900/20 relative"><!> <!></button></div></div> <button class="w-full text-[9px] text-slate-600 hover:text-red-400 font-bold uppercase tracking-widest transition-colors mt-1"> </button>',1),Ni=u('<div class="flex justify-between items-center bg-slate-950 p-2 rounded border border-slate-800 group hover:border-indigo-500/30 transition-all cursor-move hover:bg-slate-800/50" draggable="true"><div class="truncate flex-1 flex items-center gap-2"><!> <div class="min-w-0 flex-1"><div class="text-sm font-bold text-white truncate flex items-center gap-1"> <!></div> <div class="text-[10px] text-slate-500"> </div></div></div> <button class="text-slate-500 hover:text-indigo-400 p-1 ml-2 bg-slate-900 rounded border border-slate-800 hover:bg-slate-800"><!></button></div>'),Ai=u('<div class="text-center text-slate-600 italic text-xs mt-4"> </div>'),Di=u("<!> <!>",1),Ti=u('<div class="flex justify-between items-center bg-slate-950 p-2 rounded border border-slate-800 group hover:border-indigo-500/30 transition-all cursor-move hover:bg-slate-800/50" draggable="true"><div class="truncate flex-1"><div class="text-sm font-bold text-white truncate flex items-center gap-1"> <!></div> <div class="text-[10px] text-slate-500"> </div></div> <button class="text-slate-500 hover:text-indigo-400 p-1 ml-2 bg-slate-900 rounded border border-slate-800 hover:bg-slate-800"><!></button></div>'),Pi=u('<div class="text-center text-slate-600 italic text-xs mt-4"> </div>'),Ui=u("<!> <!>",1),Hi=u('<button class="bg-green-600 hover:bg-green-500 text-white px-6 py-2 rounded-lg font-bold flex items-center gap-2 shadow-lg shadow-green-900/20"><!> </button>'),Li=u('<div class="flex items-center gap-4"><button class="p-2 hover:bg-slate-700 rounded text-slate-400"><!></button> <div class="text-center"><div class="text-[10px] font-bold text-slate-500 uppercase"> </div><div class="text-3xl font-mono font-bold text-white leading-none"> </div></div> <button class="bg-indigo-600 hover:bg-indigo-500 text-white px-4 py-2 rounded font-bold flex items-center gap-2"><!> </button> <div class="h-8 w-px bg-slate-700 mx-2"></div> <button class="text-red-400 hover:text-red-300 text-xs font-bold px-3 py-2 border border-red-900/30 rounded bg-red-900/10"> </button></div>'),Fi=u("<div><!></div>"),qi=u('<div class="text-center text-slate-500 italic py-10"> </div>'),Bi=u('<div class="text-sm"><span class="font-bold text-yellow-500"> </span> <span class="text-slate-300"> </span></div>'),Ji=u('<div class="bg-slate-900 border border-slate-700 rounded-lg p-4"><h4 class="font-bold text-white mb-2 pb-2 border-b border-slate-800 flex items-center gap-2"><!> </h4> <div class="space-y-2"></div></div>'),Wi=u('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/80 p-4" role="button" aria-label="Fechar" tabindex="-1"><div class="bg-slate-800 rounded-xl w-full max-w-lg border border-slate-700 shadow-2xl p-6 relative" role="dialog" aria-modal="true"><div class="flex items-center gap-3 mb-6"><div class="p-3 bg-yellow-900/20 rounded-full border border-yellow-500/30 text-yellow-500"><!></div> <div><h3 class="font-bold text-white text-xl"> </h3> <p class="text-slate-400 text-sm"> </p></div></div> <div class="space-y-4 mb-8 max-h-[60vh] overflow-y-auto custom-scrollbar"></div> <div class="flex gap-3"><button class="flex-1 py-1.5 rounded bg-slate-700 hover:bg-slate-600 text-white font-bold text-sm"> </button> <button class="flex-1 py-1.5 rounded bg-indigo-600 hover:bg-indigo-500 text-white font-bold text-sm"> </button></div></div></div>'),Qi=u('<button class="w-full text-left flex items-center gap-3 p-3 bg-slate-900 border border-slate-700 hover:border-indigo-500 hover:bg-indigo-500/10 rounded-xl group transition-all"><div class="w-10 h-10 rounded-full bg-slate-800 flex items-center justify-center text-sm font-bold text-slate-500 group-hover:text-indigo-400 border border-slate-700 group-hover:border-indigo-500/30"> </div> <div class="flex-1"><div class="font-bold text-white group-hover:text-indigo-300"> </div> <div class="text-[10px] text-slate-500"> </div></div> <div class="bg-slate-800 p-2 rounded-lg text-slate-500 group-hover:bg-indigo-500 group-hover:text-white transition-colors"><!></div></button>'),Vi=u('<div class="text-center py-8"><div class="w-12 h-12 bg-slate-700/50 rounded-full flex items-center justify-center mx-auto mb-3 text-slate-500"><!></div> <p class="text-slate-500 text-sm font-bold"> </p> <p class="text-[10px] text-slate-600 mt-1"> </p></div>'),Gi=u('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/80 p-4" role="button" aria-label="Fechar" tabindex="-1"><div class="bg-slate-800 rounded-xl w-full max-w-md border border-slate-700 shadow-2xl p-6" role="dialog" aria-modal="true"><div class="flex justify-between items-center mb-6"><div><h3 class="font-bold text-white text-lg"> </h3> <p class="text-xs text-slate-400"> </p></div> <button class="bg-slate-700 hover:bg-slate-600 p-2 rounded-lg text-white transition-colors"><!></button></div> <div class="space-y-3 max-h-[60vh] overflow-y-auto custom-scrollbar pr-2"><!> <!></div></div></div>'),Zi=u('<div class="flex justify-between items-center bg-slate-950 p-3 rounded-xl border border-slate-800 group active:border-indigo-500/50 transition-all"><div class="truncate flex-1 flex flex-col"><div class="text-sm font-bold text-white truncate flex items-center gap-1"> <!></div> <div class="text-[10px] text-slate-500"> </div></div> <button class="text-white hover:bg-indigo-600 p-2 bg-slate-800 rounded-lg border border-slate-700"><!></button></div>'),Xi=u('<div class="text-center text-slate-600 italic text-xs mt-4"> </div>'),Yi=u("<!> <!>",1),Ki=u('<div class="flex justify-between items-center bg-slate-950 p-3 rounded-xl border border-slate-800 group active:border-indigo-500/50 transition-all"><div class="truncate flex-1"><div class="text-sm font-bold text-white truncate flex items-center gap-1"> <!></div> <div class="text-[10px] text-slate-500"> </div></div> <button class="text-white hover:bg-indigo-600 p-2 bg-slate-800 rounded-lg border border-slate-700"><!></button></div>'),en=u('<div class="text-center text-slate-600 italic text-xs mt-4"> </div>'),tn=u("<!> <!>",1),an=u('<div class="fixed inset-0 z-50 flex justify-end bg-black/60"><div class="w-full max-w-[300px] h-full bg-slate-900 border-l border-slate-800 p-4 shadow-2xl animate-in slide-in-from-right duration-300"><div class="flex justify-between items-center mb-4"><h3 class="font-bold text-white uppercase tracking-widest text-sm flex items-center gap-2"><!> </h3> <button class="bg-slate-800 p-2 rounded-lg text-slate-400 hover:text-white"><!></button></div> <div class="flex items-center gap-2 mb-3 bg-slate-950 p-1 rounded-lg border border-slate-800"><button><!> </button> <button><!> </button></div> <div class="h-[calc(100%-100px)] overflow-y-auto custom-scrollbar space-y-2"><!></div></div></div>'),sn=u('<div class="grid grid-cols-1 lg:grid-cols-4 gap-6 h-full relative"><div class="space-y-6"><div class="bg-slate-900 border border-slate-800 rounded-xl p-4 flex flex-col gap-4"><div class="flex justify-between items-center bg-slate-950/50 p-2 rounded-lg border border-slate-800"><h3 class="text-xs font-black text-slate-500 uppercase tracking-widest flex items-center gap-2"><!> <!></h3> <button class="text-[10px] bg-slate-800 hover:bg-slate-700 text-white px-2.5 py-1.5 rounded-md font-bold transition-all border border-slate-700 active:scale-95"> </button></div> <!> <div class="space-y-2 flex-1 overflow-y-auto max-h-[300px] custom-scrollbar pr-1"><div class="space-y-2"><!> <!></div></div> <div class="pt-4 border-t border-slate-800 space-y-3"><!></div></div> <div class="hidden lg:flex flex-col h-[400px] bg-slate-900 border border-slate-800 rounded-xl p-4"><div class="flex items-center gap-2 mb-3 bg-slate-950 p-1 rounded-lg border border-slate-800"><button><!> </button> <button><!> </button></div> <div class="flex-1 overflow-y-auto pr-1 custom-scrollbar space-y-2"><!></div></div></div> <div class="lg:col-span-2 space-y-4" role="region" aria-label="Combat Zone"><div class="bg-slate-900 border border-slate-800 rounded-xl p-4 flex justify-between items-center shadow-lg sticky top-0 z-20"><div class="flex items-center gap-4"><!></div></div> <div class="space-y-3 pb-20"><!> <!></div></div> <div class="hidden lg:flex flex-col gap-4"></div></div> <!> <!> <!> <button class="lg:hidden fixed bottom-24 right-4 bg-slate-800 text-white p-3 rounded-full shadow-lg border border-slate-700 z-40 active:scale-90 transition-transform" aria-label="Add Enemy"><!></button> <!> <!>',1);function rn(F,o){ja(o,!0);const i=()=>kt(hr,"$liveCharacters",n),Z=()=>kt(Ps,"$liveEnemies",n),P=()=>kt(Zs,"$liveEncounters",n),p=()=>kt(ba,"$t",n),U=()=>kt(La,"$isHistoryOpen",n),[n,y]=Sa();let M=Qe(!1),X=Qe(!1),ye=Qe(!1),we=Qe(!1);const Ie={active:!1,round:1};let ee=Qe("enemies"),me=Qe(!1),le=Qe(Oa([])),ke=Qe(Oa({isOpen:!1,title:"",message:"",onConfirm:()=>{}}));Fs(()=>{if(o.campaign?.id){xr(o.campaign.id,!0);const l=Rs(ba)("common.labels.master");Bs.update(c=>({...c,campaignId:o.campaign.id,name:o.campaign.gmName||l}));const d=setInterval(()=>{const c=Vt.get(o.campaign.id)||o.campaign,g=Rs(ba)("common.labels.master");As(o.campaign.id,{name:c.name,gmName:c.gmName||g})},3e4);return()=>{clearInterval(d),pr(),Bs.update(c=>({...c,campaignId:null}))}}});const ie=ue(()=>typeof window<"u"?`${window.location.origin}${Ks("/campaigns/[id]/invite",{id:o.campaign?.id})}`:"");function _t(){a(ie)&&(navigator.clipboard.writeText(a(ie)),O(ye,!0),setTimeout(()=>{O(ye,!1)},2e3))}let it=ue(()=>o.campaign?.sessionRoster||[]),Ce=ue(()=>o.campaign?.combat||Ie),Re=ue(()=>o.campaign?.activeEnemies||[]),He=ue(()=>o.campaign?.members||[]),Je=ue(()=>o.campaign?.initiativeStyle||"dle"),Ke=ue(()=>Array.from(new Set([...a(it),...a(He).map(d=>d.id)])).map(d=>{const c=i().find(D=>D.id===d),g=a(He).find(D=>D.id===d);return c&&g?{...c,...g,lastUpdate:g.lastUpdate}:c||g}).filter(Boolean)),fe=ue(()=>a(Ke).filter(l=>!l.campaignApproval||l.campaignApproval==="approved")),Oe=ue(()=>a(Ke).filter(l=>l.campaignApproval==="pending")),te=ue(()=>i().filter(l=>!a(it).includes(l.id)&&!a(He).some(d=>d.id===l.id)&&(l.system||Za)===(o.campaign?.system||Za))),Y=ue(()=>Z().filter(l=>{const d=(l.system||Za)===(o.campaign?.system||Za),c=l.campaignId===o.campaign?.id||l.global;return d&&c})),de=ue(()=>P().filter(l=>(l.system||Za)===(o.campaign?.system||Za)&&!0));function K(l){if(!o.campaign?.id)return;const c={...Vt.get(o.campaign.id)||o.campaign,...l};Vt.set(o.campaign.id,c),l.combat&&ks(o.campaign.id,l.combat),(l.name||l.gmName)&&As(o.campaign.id,{name:c.name,gmName:c.gmName})}function Ve(l){if(a(it).includes(l)){const d=a(it).filter(c=>c!==l);K({sessionRoster:d})}else{const d=[...a(it),l];K({sessionRoster:d})}}function et(l){$e(l,{campaignApproval:"approved"}),zs({id:l,campaignApproval:"approved"})}function Ge(l){zs({id:l,campaignApproval:"rejected",campaignId:null});const c=((Vt.get(o.campaign.id)||o.campaign).members||[]).filter(g=>g.id!==l);K({members:c})}function Pt(l){const d=a(Ke).find(c=>c.id===l);O(ke,{isOpen:!0,title:p()("session.players.remove_title"),message:p()("session.players.remove_message",{values:{name:d?.name||"este personagem"}}),onConfirm:()=>{const c=Vt.get(o.campaign.id)||o.campaign;zs({id:l,campaignId:null});const g=(c.sessionRoster||[]).filter(k=>k!==l),D=(c.members||[]).filter(k=>k.id!==l),C=(c.activeEnemies||[]).filter(k=>k.type!=="player"||k.id!==l);K({sessionRoster:g,members:D,activeEnemies:C}),a(ke).isOpen=!1}},!0)}function lt(l){const c=(Vt.get(o.campaign.id)||o.campaign).activeEnemies||[],g={...l,instanceId:xs(),damage:0,currentHealth:l.health,afflictions:[],acted:!1,initiative:!1};K({activeEnemies:[...c,g]})}function zt(l){const c=(Vt.get(o.campaign.id)||o.campaign).activeEnemies||[];let g=[];l.enemies.forEach(D=>{const C=Z().find(k=>k.id===D.enemyId);if(C)for(let k=0;k<D.count;k++)g.push({...C,instanceId:xs(),damage:0,currentHealth:C.health,afflictions:[],acted:!1,initiative:!1})}),K({activeEnemies:[...c,...g]})}function yt(){K({combat:{active:!0,round:1}}),ks(o.campaign.id,{active:!0,round:1})}function W(){const l=a(Re).filter(d=>d.damage<(d.currentHealth??d.health)&&d.endOfRound&&d.endOfRound.length>0).map(d=>({name:d.name,effects:d.endOfRound}));if(l.length>0){O(le,l,!0),O(me,!0);return}ze()}function ze(){const l=Vt.get(o.campaign.id)||o.campaign,d=(l.combat?.round||1)+1,c=(l.activeEnemies||[]).map(g=>({...g,acted:!1}));K({combat:{...l.combat,round:d},activeEnemies:c}),ks(o.campaign.id,{active:!0,round:d}),O(me,!1)}function De(l){K({combat:{active:!1,round:1}}),ks(o.campaign.id,{active:!1,round:1})}function We(l){const d=Vt.get(o.campaign.id)||o.campaign;K({activeEnemies:(d.activeEnemies||[]).filter(c=>c.instanceId!==l)})}function tt(l,d){const c=Vt.get(o.campaign.id)||o.campaign;K({activeEnemies:(c.activeEnemies||[]).map(g=>g.instanceId===l?{...g,...d}:g)})}function ut(){const l=Vt.get(o.campaign.id)||o.campaign,d=l.combat?.round||1;d>1&&K({combat:{...l.combat,round:d-1}})}let ae=Qe(Oa(Date.now()));Fs(()=>{const l=setInterval(()=>{O(ae,Date.now(),!0)},1e4);return()=>clearInterval(l)});let Pe=ue(()=>(()=>{const l=a(fe).filter(d=>a(it).includes(d.id));return ki(a(Je),l,a(Re))})());function q(l){return l.lastUpdate?a(ae)-l.lastUpdate<6e4:!1}function $e(l,d){const c=Vt.get(o.campaign.id)||o.campaign,g=c.members||[],D=g.findIndex(z=>z.id===l);let C=g;D!==-1&&(C=[...g],C[D]={...C[D],...d});const k=c.activeEnemies||[],R=k.findIndex(z=>z.id===l&&z.type==="player");let j=k;R!==-1&&(j=[...k],j[R]={...j[R],...d}),K({members:C,activeEnemies:j})}function je(l,d,c){l.dataTransfer&&(l.dataTransfer.setData("application/json",JSON.stringify({item:d,type:c})),l.dataTransfer.effectAllowed="copy")}function Me(l){return l.preventDefault(),!1}function Te(l){l.preventDefault();const d=l.dataTransfer?.getData("application/json");if(d)try{const{item:c,type:g}=JSON.parse(d);g==="enemy"?lt(c):g==="encounter"&&zt(c)}catch(c){console.error("Drop error",c)}}var dt=sn(),Ze=Ae(dt),at=t(Ze),xt=t(at),$t=t(xt),St=t($t),It=t(St);Xs(It,{size:14,class:"text-indigo-500"});var I=s(It),L=s(I);{var ge=l=>{var d=zi(),c=t(d,!0);e(d),b(()=>r(c,a(fe).length)),v(l,d)};w(L,l=>{a(fe).length>0&&l(ge)})}e(St);var st=s(St,2);st.__click=()=>O(M,!a(M));var mt=t(st,!0);e(st),e($t);var vt=s($t,2);{var ct=l=>{var d=Ci(),c=t(d),g=s(t(c),2),D=t(g);e(g),e(c);var C=s(c,2);Se(C,17,()=>a(Oe),k=>k.id,(k,R)=>{var j=$i(),z=t(j),V=t(z),re=t(V,!0);e(V);var ce=s(V,2),J=t(ce,!0);e(ce),e(z);var xe=s(z,2),_=t(xe);_.__click=()=>et(a(R).id);var $=t(_);Ws($,{size:14}),e(_);var f=s(_,2);f.__click=()=>Ge(a(R).id);var T=t(f);fa(T,{size:14}),e(f),e(xe),e(j),b(S=>{r(re,a(R).name),r(J,S)},[()=>p()("session.players.new_request")]),v(k,j)}),Ca(2),e(d),b(k=>r(D,`${k??""} (${a(Oe).length??""})`),[()=>p()("session.players.waiting_approval")]),v(l,d)};w(vt,l=>{a(Oe).length>0&&l(ct)})}var Bt=s(vt,2),Xt=t(Bt),Yt=t(Xt);Se(Yt,17,()=>a(fe),l=>l.id,(l,d)=>{const c=ue(()=>q(a(d))),g=ue(()=>a(it).includes(a(d).id));var D=ji(),C=t(D),k=s(C,2),R=t(k),j=t(R,!0);e(R);var z=s(R,2),V=t(z);{var re=m=>{var x=Oi(),N=t(x,!0);e(x),b(A=>r(N,A),[()=>p()("common.labels.session")]),v(m,x)};w(V,m=>{a(g)&&m(re)})}var ce=s(V);e(z),e(k);var J=s(k,2),xe=t(J);xe.__click=()=>Ve(a(d).id);var _=t(xe);{var $=m=>{Or(m,{size:14})},f=m=>{da(m,{size:14})};w(_,m=>{a(g)?m($):m(f,!1)})}e(xe);var T=s(xe,2);T.__click=()=>Pt(a(d).id);var S=t(T);fa(S,{size:14}),e(T),e(J),e(D),b((m,x,N)=>{Ue(D,1,`p-2.5 rounded-xl border flex items-center gap-3 transition-all ${a(c)?"bg-indigo-900/10 border-indigo-500/20":"bg-slate-900/50 border-slate-800"} ${a(c)||a(g)?"opacity-100":"opacity-40"} hover:border-indigo-500/40 group shadow-sm`),Ue(C,1,`w-2 h-2 rounded-full ${a(c)?"bg-green-500 shadow-[0_0_8px_rgba(74,222,128,0.4)]":"bg-slate-700"}`),Ue(R,1,`font-bold text-sm ${a(c)?"text-white":"text-slate-500"} group-hover:text-indigo-300 transition-colors`),r(j,a(d).name),r(ce,` ${m??""} ${a(d).level??""} • ${a(d).ancestry??""}`),Ue(xe,1,`p-1.5 rounded-lg transition-all ${a(g)?"text-amber-400 hover:bg-amber-400/10":"text-slate-500 hover:text-indigo-400 hover:bg-indigo-400/10"}`),se(xe,"title",x),se(T,"title",N)},[()=>p()("common.labels.level"),()=>a(g)?p()("session.players.remove_from_session"):p()("session.players.add_to_session"),()=>p()("session.players.kick_from_campaign")]),v(l,D)});var Kt=s(Yt,2);{var Gt=l=>{var d=Ei(),c=t(d,!0);e(d),b(g=>r(c,g),[()=>p()("session.players.none")]),v(l,d)};w(Kt,l=>{a(fe).length===0&&l(Gt)})}e(Xt),e(Bt);var ea=s(Bt,2),ia=t(ea);{var Ut=l=>{var d=Mi(),c=Ae(d);c.__click=()=>K({isPublished:!0});var g=t(c);$a(g,{size:14});var D=s(g);e(c);var C=s(c,2),k=t(C,!0);e(C),b((R,j)=>{r(D,` ${R??""}`),r(k,j)},[()=>p()("session.publish.publish_session"),()=>p()("session.publish.make_visible")]),v(l,d)},wt=l=>{var d=Ri(),c=Ae(d),g=t(c),D=t(g),C=t(D);Ys(C,{size:10,class:"animate-pulse"});var k=s(C);e(D),e(g);var R=s(g,2);R.__click=()=>O(we,!a(we));var j=t(R);Jr(j,{size:14}),e(R),e(c);var z=s(c,2);{var V=x=>{var N=Si(),A=t(N);e(N),b((ne,H)=>{se(A,"src",ne),se(A,"alt",H)},[()=>`https://api.qrserver.com/v1/create-qr-code/?size=100x100&data=${encodeURIComponent(a(ie))}`,()=>p()("session.publish.qr_alt")]),v(x,N)};w(z,x=>{a(we)&&x(V)})}var re=s(z,2),ce=t(re),J=t(ce);J.__click=_t;var xe=t(J,!0);e(J);var _=s(J,2);_.__click=_t;var $=t(_);{var f=x=>{var N=Ii(),A=t(N);Ws(A,{size:10,class:"inline mr-1"});var ne=s(A);e(N),b(H=>r(ne,` ${H??""}`),[()=>p()("common.buttons.copied")]),v(x,N)};w($,x=>{a(ye)&&x(f)})}var T=s($,2);Fr(T,{size:14}),e(_),e(ce),e(re);var S=s(re,2);S.__click=()=>K({isPublished:!1});var m=t(S,!0);e(S),b((x,N,A,ne)=>{r(k,` ${x??""}`),se(R,"title",N),r(xe,a(ie)),se(_,"aria-label",A),r(m,ne)},[()=>p()("session.publish.public_session"),()=>p()("session.publish.qr_code"),()=>p()("session.publish.copy_link"),()=>p()("session.publish.remove_public")]),v(l,d)};w(ia,l=>{o.campaign?.isPublished?l(wt,!1):l(Ut)})}e(ea),e(xt);var Jt=s(xt,2),Rt=t(Jt),Wt=t(Rt);Wt.__click=()=>O(ee,"enemies");var rt=t(Wt);Pa(rt,{size:14});var Ct=s(rt);e(Wt);var Le=s(Wt,2);Le.__click=()=>O(ee,"encounters");var Ot=t(Le);Ts(Ot,{size:14});var ta=s(Ot);e(Le),e(Rt);var Ht=s(Rt,2),Nt=t(Ht);{var At=l=>{var d=Di(),c=Ae(d);Se(c,17,()=>a(Y),C=>C.id,(C,k)=>{var R=Ni(),j=t(R),z=t(j);Br(z,{size:12,class:"text-slate-600 cursor-grab"});var V=s(z,2),re=t(V),ce=t(re),J=s(ce);{var xe=S=>{$a(S,{size:10,class:"text-indigo-400"})};w(J,S=>{a(k).global&&S(xe)})}e(re);var _=s(re,2),$=t(_);e(_),e(V),e(j);var f=s(j,2);f.__click=()=>lt(a(k));var T=t(f);da(T,{size:16}),e(f),e(R),b(S=>{r(ce,`${a(k).name??""} `),r($,`${S??""} ${a(k).difficulty??""}`)},[()=>p()("session.enemies.difficulty")]),Ha("dragstart",R,S=>je(S,a(k),"enemy")),v(C,R)});var g=s(c,2);{var D=C=>{var k=Ai(),R=t(k,!0);e(k),b(j=>r(R,j),[()=>p()("session.enemies.none")]),v(C,k)};w(g,C=>{a(Y).length===0&&C(D)})}v(l,d)},sa=l=>{var d=Ui(),c=Ae(d);Se(c,17,()=>a(de),C=>C.id,(C,k)=>{var R=Ti(),j=t(R),z=t(j),V=t(z),re=s(V);{var ce=f=>{$a(f,{size:10,class:"text-indigo-400"})};w(re,f=>{a(k).global&&f(ce)})}e(z);var J=s(z,2),xe=t(J);e(J),e(j);var _=s(j,2);_.__click=()=>zt(a(k));var $=t(_);Ds($,{size:14}),e(_),e(R),b((f,T)=>{r(V,`${a(k).name??""} `),r(xe,`${f??""} ${T??""}`)},[()=>a(k).enemies?.reduce((f,T)=>f+T.count,0)||0,()=>p()("session.enemies.title")]),Ha("dragstart",R,f=>je(f,a(k),"encounter")),v(C,R)});var g=s(c,2);{var D=C=>{var k=Pi(),R=t(k,!0);e(k),b(j=>r(R,j),[()=>p()("session.enemies.no_encounters")]),v(C,k)};w(g,C=>{a(de).length===0&&C(D)})}v(l,d)};w(Nt,l=>{a(ee)==="enemies"?l(At):l(sa,!1)})}e(Ht),e(Jt),e(at);var aa=s(at,2),na=t(aa),pa=t(na),Ia=t(pa);{var h=l=>{var d=Hi();d.__click=yt;var c=t(d);dr(c,{size:20});var g=s(c);e(d),b(D=>r(g,` ${D??""}`),[()=>p()("session.combat.start")]),v(l,d)},E=l=>{var d=Li(),c=t(d);c.__click=ut;var g=t(c);tr(g,{size:20}),e(c);var D=s(c,2),C=t(D),k=t(C,!0);e(C);var R=s(C),j=t(R,!0);e(R),e(D);var z=s(D,2);z.__click=W;var V=t(z);jr(V,{size:16});var re=s(V);e(z);var ce=s(z,4);ce.__click=()=>De();var J=t(ce,!0);e(ce),e(d),b((xe,_,$,f,T)=>{se(c,"title",xe),r(k,_),r(j,a(Ce).round),se(z,"title",$),r(re,` ${f??""}`),r(J,T)},[()=>p()("session.combat.previous"),()=>p()("session.combat.round"),()=>p()("session.combat.next"),()=>p()("session.combat.next"),()=>p()("session.combat.end")]),v(l,d)};w(Ia,l=>{a(Ce).active?l(E,!1):l(h)})}e(pa),e(na);var _e=s(na,2),he=t(_e);Se(he,25,()=>a(Pe),l=>l.type==="player"?l.id:l.instanceId,(l,d)=>{var c=Fi(),g=t(c);gi(g,{get entity(){return a(d)},updateEnemy:tt,removeFromCombat:We,updatePlayer:$e}),e(c),wr(c,()=>hi,()=>({duration:300})),v(l,c)});var Ye=s(he,2);{var jt=l=>{var d=qi(),c=t(d,!0);e(d),b(g=>r(c,g),[()=>p()("session.combat.empty")]),v(l,d)};w(Ye,l=>{a(Pe).length===0&&l(jt)})}e(_e),e(aa),Ca(2),e(Ze);var Qt=s(Ze,2);{var ma=l=>{var d=Wi();d.__click=f=>{f.target===f.currentTarget&&O(me,!1)};var c=t(d),g=t(c),D=t(g),C=t(D);Er(C,{size:24}),e(D);var k=s(D,2),R=t(k),j=t(R,!0);e(R);var z=s(R,2),V=t(z,!0);e(z),e(k),e(g);var re=s(g,2);Se(re,21,()=>a(le),ot,(f,T)=>{var S=Ji(),m=t(S),x=t(m);Pa(x,{size:14,class:"text-slate-500"});var N=s(x);e(m);var A=s(m,2);Se(A,21,()=>a(T).effects,ot,(ne,H)=>{var G=Bi(),oe=t(G),Ee=t(oe);e(oe);var qe=s(oe,2),ft=t(qe,!0);e(qe),e(G),b(()=>{r(Ee,`${a(H).name??""}:`),r(ft,a(H).desc)}),v(ne,G)}),e(A),e(S),b(()=>r(N,` ${a(T).name??""}`)),v(f,S)}),e(re);var ce=s(re,2),J=t(ce);J.__click=()=>O(me,!1);var xe=t(J,!0);e(J);var _=s(J,2);_.__click=ze;var $=t(_,!0);e(_),e(ce),e(c),e(d),b((f,T,S,m)=>{r(j,f),r(V,T),r(xe,S),r($,m)},[()=>p()("session.end_of_round.title"),()=>p()("session.end_of_round.summary"),()=>p()("common.buttons.cancel"),()=>p()("session.end_of_round.advance")]),v(l,d)};w(Qt,l=>{a(me)&&l(ma)})}var _a=s(Qt,2);{var xa=l=>{var d=Gi();d.__click=_=>{_.target===_.currentTarget&&O(M,!1)};var c=t(d),g=t(c),D=t(g),C=t(D),k=t(C,!0);e(C);var R=s(C,2),j=t(R,!0);e(R),e(D);var z=s(D,2);z.__click=()=>O(M,!1);var V=t(z);Ra(V,{size:16}),e(z),e(g);var re=s(g,2),ce=t(re);Se(ce,17,()=>a(te),ot,(_,$)=>{var f=Qi();f.__click=()=>Ve(a($).id);var T=t(f),S=t(T,!0);e(T);var m=s(T,2),x=t(m),N=t(x,!0);e(x);var A=s(x,2),ne=t(A);e(A),e(m);var H=s(m,2),G=t(H);da(G,{size:16}),e(H),e(f),b((oe,Ee)=>{r(S,oe),r(N,a($).name),r(ne,`${Ee??""} ${a($).level??""} • ${a($).ancestry??""}`)},[()=>a($).name.charAt(0),()=>p()("common.labels.level")]),v(_,f)});var J=s(ce,2);{var xe=_=>{var $=Vi(),f=t($),T=t(f);Pa(T,{size:24}),e(f);var S=s(f,2),m=t(S,!0);e(S);var x=s(S,2),N=t(x,!0);e(x),e($),b((A,ne)=>{r(m,A),r(N,ne)},[()=>p()("session.manage_session.no_available"),()=>p()("session.manage_session.all_in_session")]),v(_,$)};w(J,_=>{a(te).length===0&&_(xe)})}e(re),e(c),e(d),b((_,$)=>{r(k,_),r(j,$)},[()=>p()("session.manage_session.title"),()=>p()("session.manage_session.description")]),v(l,d)};w(_a,l=>{a(M)&&l(xa)})}var va=s(_a,2);{var ka=l=>{var d=an();d.__click=m=>{m.target===m.currentTarget&&O(X,!1)};var c=t(d),g=t(c),D=t(g),C=t(D);Pa(C,{size:16});var k=s(C);e(D);var R=s(D,2);R.__click=()=>O(X,!1);var j=t(R);Ra(j,{size:18}),e(R),e(g);var z=s(g,2),V=t(z);V.__click=()=>O(ee,"enemies");var re=t(V);Pa(re,{size:14});var ce=s(re);e(V);var J=s(V,2);J.__click=()=>O(ee,"encounters");var xe=t(J);Ts(xe,{size:14});var _=s(xe);e(J),e(z);var $=s(z,2),f=t($);{var T=m=>{var x=Yi(),N=Ae(x);Se(N,17,()=>a(Y),H=>H.id,(H,G)=>{var oe=Zi(),Ee=t(oe),qe=t(Ee),ft=t(qe),Ne=s(ft);{var Et=pt=>{$a(pt,{size:10,class:"text-indigo-400"})};w(Ne,pt=>{a(G).global&&pt(Et)})}e(qe);var Dt=s(qe,2),Zt=t(Dt);e(Dt),e(Ee);var qt=s(Ee,2);qt.__click=()=>{lt(a(G)),O(X,!1)};var ca=t(qt);da(ca,{size:16}),e(qt),e(oe),b(pt=>{r(ft,`${a(G).name??""} `),r(Zt,`${pt??""} ${a(G).difficulty??""}`)},[()=>p()("session.enemies.difficulty")]),v(H,oe)});var A=s(N,2);{var ne=H=>{var G=Xi(),oe=t(G,!0);e(G),b(Ee=>r(oe,Ee),[()=>p()("session.enemies.none")]),v(H,G)};w(A,H=>{a(Y).length===0&&H(ne)})}v(m,x)},S=m=>{var x=tn(),N=Ae(x);Se(N,17,()=>a(de),H=>H.id,(H,G)=>{var oe=Ki(),Ee=t(oe),qe=t(Ee),ft=t(qe),Ne=s(ft);{var Et=pt=>{$a(pt,{size:10,class:"text-indigo-400"})};w(Ne,pt=>{a(G).global&&pt(Et)})}e(qe);var Dt=s(qe,2),Zt=t(Dt);e(Dt),e(Ee);var qt=s(Ee,2);qt.__click=()=>{zt(a(G)),O(X,!1)};var ca=t(qt);Ds(ca,{size:16}),e(qt),e(oe),b((pt,za)=>{r(ft,`${a(G).name??""} `),r(Zt,`${pt??""} ${za??""}`)},[()=>a(G).enemies?.reduce((pt,za)=>pt+za.count,0)||0,()=>p()("session.enemies.title")]),v(H,oe)});var A=s(N,2);{var ne=H=>{var G=en(),oe=t(G,!0);e(G),b(Ee=>r(oe,Ee),[()=>p()("session.enemies.no_encounters")]),v(H,G)};w(A,H=>{a(de).length===0&&H(ne)})}v(m,x)};w(f,m=>{a(ee)==="enemies"?m(T):m(S,!1)})}e($),e(c),e(d),b((m,x,N)=>{r(k,` ${m??""}`),Ue(V,1,`flex-1 text-xs font-bold py-2 rounded flex items-center justify-center gap-2 transition-colors ${a(ee)==="enemies"?"bg-indigo-600 text-white":"text-slate-500 hover:text-white"}`),r(ce,` ${x??""}`),Ue(J,1,`flex-1 text-xs font-bold py-2 rounded flex items-center justify-center gap-2 transition-colors ${a(ee)==="encounters"?"bg-indigo-600 text-white":"text-slate-500 hover:text-white"}`),r(_,` ${N??""}`)},[()=>p()("session.enemies.title"),()=>p()("session.enemies.title"),()=>p()("session.enemies.encounters")]),v(l,d)};w(va,l=>{a(X)&&l(ka)})}var B=s(va,2);B.__click=()=>O(X,!0);var Q=t(B);Pa(Q,{size:24}),e(B);var ve=s(B,2);er(ve,{get isOpen(){return U()},onClose:()=>La.set(!1)});var Fe=s(ve,2);Gs(Fe,{get isOpen(){return a(ke).isOpen},get title(){return a(ke).title},get message(){return a(ke).message},get onConfirm(){return a(ke).onConfirm},onCancel:()=>a(ke).isOpen=!1}),b((l,d,c,g)=>{r(I,` ${l??""} `),r(mt,d),Ue(Wt,1,`flex-1 text-xs font-bold py-1.5 rounded flex items-center justify-center gap-2 transition-colors ${a(ee)==="enemies"?"bg-indigo-600 text-white":"text-slate-500 hover:text-white"}`),r(Ct,` ${c??""}`),Ue(Le,1,`flex-1 text-xs font-bold py-1.5 rounded flex items-center justify-center gap-2 transition-colors ${a(ee)==="encounters"?"bg-indigo-600 text-white":"text-slate-500 hover:text-white"}`),r(ta,` ${g??""}`)},[()=>p()("session.players.title"),()=>a(M)?p()("session.players.close"):p()("session.players.add"),()=>p()("session.enemies.title"),()=>p()("session.enemies.encounters")]),Ha("dragover",aa,Me),Ha("drop",aa,Te),v(F,dt),Ea(),y()}Ma(["click"]);var nn=u('<div class="space-y-4"><div class="flex items-center gap-4"><div class="relative group cursor-pointer"><div class="w-16 h-16 rounded-xl overflow-hidden border border-slate-700"><!></div> <div class="absolute inset-0 bg-black/50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity rounded-xl"><!></div></div> <div class="flex-1"><label for="enemy-name" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-name" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white font-bold text-lg"/></div></div> <div class="grid grid-cols-3 gap-4"><div><label for="enemy-diff" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-diff" type="number" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div> <div><label for="enemy-size" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-size" type="text" placeholder="1/2, 1, 2..." class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div> <div><label for="enemy-desc" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-desc" type="text" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white text-sm"/></div></div> <div class="flex items-center gap-2 mt-4"><input id="enemy-global" type="checkbox" class="w-4 h-4 bg-slate-900 border-slate-700 rounded focus:ring-indigo-500"/> <label for="enemy-global" class="text-sm font-bold text-slate-400 select-none cursor-pointer flex items-center gap-2"><!> </label></div> <div class="grid grid-cols-2 gap-4"><div><label for="enemy-perception" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-perception" type="number" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div> <div><label for="enemy-senses" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-senses" type="text" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white text-sm"/></div></div> <div class="grid grid-cols-2 gap-4"><div><label for="enemy-defense" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-defense" type="number" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div> <div><label for="enemy-health" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-health" type="number" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div></div> <div class="grid grid-cols-2 gap-4"><div><label for="enemy-speed" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-speed" type="number" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div> <div><label for="enemy-speed-notes" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-speed-notes" type="text" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white text-sm"/></div></div> <div><label for="enemy-immune" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <textarea id="enemy-immune" class="w-full bg-slate-900 border border-slate-700 rounded p-3 text-white text-sm min-h-[80px] resize-none focus:border-indigo-500 focus:outline-none transition-colors"></textarea></div></div>'),on=u('<div class="bg-slate-900 p-3 rounded border border-slate-700 text-center"><label class="text-[10px] text-slate-500 uppercase font-bold block mb-1 text-ellipsis overflow-hidden whitespace-nowrap"> </label> <input type="number" class="w-full bg-transparent text-center font-bold text-white text-xl focus:outline-none mb-1"/> <div> </div></div>'),ln=u('<div class="space-y-6"><div><h4 class="text-indigo-400 font-bold text-sm uppercase mb-3"> </h4> <div class="grid grid-cols-4 gap-3"></div></div></div>'),dn=u('<div class="flex gap-2 items-start"><div class="flex-1 space-y-1"><input class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm font-bold placeholder-slate-600"/> <textarea class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm placeholder-slate-600 resize-none" rows="2"></textarea></div> <button class="mt-1 text-slate-600 hover:text-red-400 p-2 hover:bg-slate-800 rounded"><!></button></div>'),vn=u('<div class="text-xs text-slate-600 italic text-center py-4 border-2 border-dashed border-slate-800 rounded"> </div>'),cn=u('<div class="flex gap-2 items-start"><div class="flex-1 space-y-2"><div class="grid grid-cols-2 gap-2"><input class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm font-bold placeholder-slate-600"/> <select class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm"><option> </option><option> </option></select></div> <div class="grid grid-cols-2 gap-2"><input class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm placeholder-slate-600"/> <input class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm placeholder-slate-600"/></div> <textarea class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm placeholder-slate-600 resize-none" rows="2"></textarea></div> <button class="mt-1 text-slate-600 hover:text-red-400 p-2 hover:bg-slate-800 rounded"><!></button></div>'),un=u('<div class="text-xs text-slate-600 italic text-center py-4 border-2 border-dashed border-slate-800 rounded"> </div>'),bn=u('<div class="flex gap-2 items-start"><div class="flex-1 space-y-1"><input class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm font-bold placeholder-slate-600"/> <textarea class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm placeholder-slate-600 resize-none" rows="2"></textarea></div> <button class="mt-1 text-slate-600 hover:text-red-400 p-2 hover:bg-slate-800 rounded"><!></button></div>'),_n=u('<div class="text-xs text-slate-600 italic text-center py-4 border-2 border-dashed border-slate-800 rounded"> </div>'),xn=u('<div class="flex gap-2 items-start"><div class="flex-1 space-y-1"><input class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm font-bold placeholder-slate-600"/> <textarea class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm placeholder-slate-600 resize-none" rows="2"></textarea></div> <button class="mt-1 text-slate-600 hover:text-red-400 p-2 hover:bg-slate-800 rounded"><!></button></div>'),pn=u('<div class="text-xs text-slate-600 italic text-center py-4 border-2 border-dashed border-slate-800 rounded"> </div>'),mn=u('<div class="space-y-6"><div class="p-4 bg-slate-900 rounded border border-indigo-500/30"><div class="flex justify-between items-center mb-3"><h4 class="font-bold text-sm uppercase text-indigo-400"> </h4> <button class="text-xs bg-slate-800 px-2 py-1 rounded hover:bg-slate-700 text-white flex items-center gap-1 border border-slate-700"><!> </button></div> <div class="space-y-3"><!> <!></div></div> <div class="p-4 bg-slate-900 rounded border border-red-500/30"><div class="flex justify-between items-center mb-3"><h4 class="font-bold text-sm uppercase text-red-400"> </h4> <button class="text-xs bg-slate-800 px-2 py-1 rounded hover:bg-slate-700 text-white flex items-center gap-1 border border-slate-700"><!> </button></div> <div class="space-y-3"><!> <!></div></div> <div class="p-4 bg-slate-900 rounded border border-orange-500/30"><div class="flex justify-between items-center mb-3"><h4 class="font-bold text-sm uppercase text-orange-400"> </h4> <button class="text-xs bg-slate-800 px-2 py-1 rounded hover:bg-slate-700 text-white flex items-center gap-1 border border-slate-700"><!> </button></div> <div class="space-y-3"><!> <!></div></div> <div class="p-4 bg-slate-900 rounded border border-yellow-500/30"><div class="flex justify-between items-center mb-3"><h4 class="font-bold text-sm uppercase text-yellow-400"> </h4> <button class="text-xs bg-slate-800 px-2 py-1 rounded hover:bg-slate-700 text-white flex items-center gap-1 border border-slate-700"><!> </button></div> <div class="space-y-3"><!> <!></div></div></div>'),fn=u('<div class="w-16 h-16 rounded-lg overflow-hidden border border-slate-700 shadow-lg flex-shrink-0"><!></div>'),gn=u('<span class="text-slate-400"> </span>'),hn=u('<span class="text-slate-400"> </span>'),yn=u('<div class="text-sm mb-4"><span class="text-slate-500 font-bold"> </span> <span class="text-white ml-1"> </span></div>'),wn=u('<div class="mb-3 text-sm"><span class="font-bold text-indigo-400"> </span> <span class="text-slate-300 ml-1"> </span></div>'),kn=u('<span class="text-slate-300"> </span>'),zn=u('<div class="mb-2 text-sm"><span class="font-bold text-white"> </span> <span class="text-slate-400"> </span> <span class="text-white ml-1"> </span> <!></div>'),$n=u('<div class="mt-4"><h4 class="text-red-500 font-bold text-xs uppercase mb-2 tracking-wider"> </h4> <!></div>'),Cn=u('<div class="mb-2 text-sm"><span class="font-bold text-white"> </span> <span class="text-slate-300 ml-1"> </span></div>'),On=u('<div class="mt-4"><h4 class="text-orange-500 font-bold text-xs uppercase mb-2 tracking-wider"> </h4> <!></div>'),jn=u('<div class="mb-2 text-sm"><span class="font-bold text-white"> </span> <span class="text-slate-300 ml-1"> </span></div>'),En=u('<div class="mt-4"><h4 class="text-yellow-500 font-bold text-xs uppercase mb-2 tracking-wider"> </h4> <!></div>'),Mn=u('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/80 p-4" role="button" aria-label="Close" tabindex="-1"><div class="bg-slate-800 rounded-xl w-full max-w-6xl h-[90vh] border border-slate-700 shadow-2xl overflow-hidden flex flex-col lg:flex-row" role="dialog" aria-modal="true" aria-labelledby="modal-title"><div class="w-full lg:w-1/2 flex flex-col h-full border-r border-slate-700"><div class="p-4 border-b border-slate-700 bg-slate-900 flex justify-between items-center"><h3 id="modal-title" class="font-bold text-white text-lg"> </h3> <button class="lg:hidden text-slate-400 hover:text-white"><!></button></div> <div class="flex border-b border-slate-700 bg-slate-900/50"><button> </button> <button> </button> <button> </button></div> <div class="flex-1 overflow-y-auto p-6 custom-scrollbar bg-slate-800/50"><!></div> <div class="p-4 border-t border-slate-700 bg-slate-900 flex justify-end gap-3"><button class="px-6 py-2 rounded bg-slate-800 hover:bg-slate-700 text-white font-bold transition-colors"> </button> <button class="px-6 py-2 rounded bg-indigo-600 hover:bg-indigo-500 text-white font-bold flex items-center gap-2 transition-colors"><!> </button></div></div> <div class="hidden lg:flex w-1/2 bg-slate-950 flex-col border-l border-slate-800"><div class="p-4 border-b border-slate-800 bg-slate-950"><h3 class="font-bold text-slate-500 text-xs uppercase flex items-center gap-2"><!> </h3></div> <div class="flex-1 p-8 overflow-y-auto flex items-start justify-center bg-[radial-gradient(ellipse_at_top,_var(--tw-gradient-stops))] from-slate-900 via-slate-950 to-slate-950"><div class="w-full max-w-md bg-slate-900 border border-slate-700 rounded-xl p-5 shadow-2xl"><div class="flex items-start gap-3 mb-4"><!> <div class="flex-1 min-w-0"><div class="flex items-baseline gap-2"><h2 class="text-xl font-bold text-white font-serif tracking-wide"> </h2> <span class="text-red-500 font-bold text-sm"> </span></div> <div class="text-sm text-slate-400 mt-1"> </div></div></div> <div class="text-sm mb-3"><span class="text-slate-500 font-bold"> </span> <span class="text-white ml-1"> </span> <!></div> <div class="text-sm mb-3"><span class="text-slate-500 font-bold"> </span> <span class="text-white ml-1"> </span> <span class="text-slate-500 font-bold ml-3"> </span> <span class="text-white ml-1"> </span></div> <div class="text-sm mb-3"><span class="text-white"><span class="text-slate-500 font-bold"> </span> <span class="text-slate-500 font-bold"> </span> <span class="text-slate-500 font-bold"> </span> <span class="text-slate-500 font-bold"> </span> </span></div> <div class="text-sm mb-3"><span class="text-slate-500 font-bold"> </span> <span class="text-white ml-1"> </span> <!></div> <!> <div class="border-t border-slate-700 my-4"></div> <!> <!> <!> <!></div></div></div></div></div> <input type="file" hidden="" accept="image/*"/> <!>',1);function Sn(F,o){ja(o,!0);const i=()=>kt(ba,"$t",Z),[Z,P]=Sa();let p=ra(o,"isOpen",3,!1),U=ra(o,"initialData",3,"{}"),n=Qe(Oa(ee())),y=Qe("stats"),M=Qe(!1),X=Qe(""),ye=Qe(void 0);function we(te){const Y=te.target.files;if(Y&&Y.length>0){const de=Y[0],K=new FileReader;K.onload=()=>{O(X,K.result,!0),O(M,!0)},K.readAsDataURL(de)}te.target&&(te.target.value="")}async function Ie(te){try{const Y=await sr(te);a(n).imageUrl=Y,O(M,!1)}catch(Y){console.error(Y),alert(Y.message||"Erro ao salvar imagem")}}function ee(){return{name:"",difficulty:1,size:"1",descriptors:"",perception:10,senses:"",defense:10,health:10,attributes:{strength:10,agility:10,intellect:10,will:10},speed:10,speedNotes:"",immunities:"",traits:[],attackOptions:[],specialAttacks:[],endOfRound:[],imageUrl:"",global:!1}}function me(te){const Y=te-10;return Y>=0?`+${Y}`:`${Y}`}$s(()=>{if(p()&&U())try{const te=JSON.parse(U());Object.keys(te).length===0?O(n,ee(),!0):O(n,{...ee(),...te},!0)}catch{O(n,ee(),!0)}});function le(){a(n).traits=[...a(n).traits,{name:"",desc:""}]}function ke(te){a(n).traits=a(n).traits.filter((Y,de)=>de!==te)}function ie(){a(n).attackOptions=[...a(n).attackOptions,{name:"",type:"melee",attackRoll:"+0",damage:"1d6",desc:""}]}function _t(te){a(n).attackOptions=a(n).attackOptions.filter((Y,de)=>de!==te)}function it(){a(n).specialAttacks=[...a(n).specialAttacks,{name:"",desc:""}]}function Ce(te){a(n).specialAttacks=a(n).specialAttacks.filter((Y,de)=>de!==te)}function Re(){a(n).endOfRound=[...a(n).endOfRound,{name:"",desc:""}]}function He(te){a(n).endOfRound=a(n).endOfRound.filter((Y,de)=>de!==te)}function Je(te){}var Ke=ht(),fe=Ae(Ke);{var Oe=te=>{var Y=Mn(),de=Ae(Y);de.__click=Je;var K=t(de),Ve=t(K),et=t(Ve),Ge=t(et),Pt=t(Ge,!0);e(Ge);var lt=s(Ge,2);lt.__click=function(..._){o.onClose?.apply(this,_)};var zt=t(lt);Ra(zt,{size:20}),e(lt),e(et);var yt=s(et,2),W=t(yt);W.__click=()=>O(y,"stats");var ze=t(W,!0);e(W);var De=s(W,2);De.__click=()=>O(y,"attributes");var We=t(De,!0);e(De);var tt=s(De,2);tt.__click=()=>O(y,"abilities");var ut=t(tt,!0);e(tt),e(yt);var ae=s(yt,2),Pe=t(ae);{var q=_=>{var $=nn(),f=t($),T=t(f);T.__click=()=>a(ye)?.click();var S=t(T),m=t(S);Hs(m,()=>a(n).imageUrl,pe=>{ps(pe,{get hash(){return a(n).imageUrl},get alt(){return a(n).name},size:"custom",fallbackText:"?"})}),e(S);var x=s(S,2),N=t(x);rr(N,{size:20,class:"text-white"}),e(x),e(T);var A=s(T,2),ne=t(A),H=t(ne,!0);e(ne);var G=s(ne,2);Xe(G),e(A),e(f);var oe=s(f,2),Ee=t(oe),qe=t(Ee),ft=t(qe,!0);e(qe);var Ne=s(qe,2);Xe(Ne),e(Ee);var Et=s(Ee,2),Dt=t(Et),Zt=t(Dt,!0);e(Dt);var qt=s(Dt,2);Xe(qt),e(Et);var ca=s(Et,2),pt=t(ca),za=t(pt,!0);e(pt);var Na=s(pt,2);Xe(Na),e(ca),e(oe);var Ya=s(oe,2),Aa=t(Ya);Xe(Aa);var Ka=s(Aa,2),ms=t(Ka);$a(ms,{size:14});var fs=s(ms);e(Ka),e(Ya);var Fa=s(Ya,2),es=t(Fa),ts=t(es),as=t(ts,!0);e(ts);var qa=s(ts,2);Xe(qa),e(es);var Ba=s(es,2),ss=t(Ba),rs=t(ss,!0);e(ss);var Ja=s(ss,2);Xe(Ja),e(Ba),e(Fa);var is=s(Fa,2),Wa=t(is),Qa=t(Wa),Cs=t(Qa,!0);e(Qa);var gs=s(Qa,2);Xe(gs),e(Wa);var ns=s(Wa,2),Da=t(ns),os=t(Da,!0);e(Da);var hs=s(Da,2);Xe(hs),e(ns),e(is);var Ta=s(is,2),Va=t(Ta),ls=t(Va),ys=t(ls,!0);e(ls);var ds=s(ls,2);Xe(ds),e(Va);var ws=s(Va,2),vs=t(ws),bt=t(vs,!0);e(vs);var be=s(vs,2);Xe(be),e(ws),e(Ta);var Tt=s(Ta,2),nt=t(Tt),Lt=t(nt,!0);e(nt);var gt=s(nt,2);Ua(gt),e(Tt),e($),b((pe,Ft,oa,Mt,ua,Os,cs,Ga,us,bs,_s,js,la,Es,Ms,Ss)=>{r(H,pe),r(ft,Ft),r(Zt,oa),r(za,Mt),se(Na,"placeholder",ua),r(fs,` ${Os??""}`),r(as,cs),r(rs,Ga),se(Ja,"placeholder",us),r(Cs,bs),r(os,_s),r(ys,js),r(bt,la),se(be,"placeholder",Es),r(Lt,Ms),se(gt,"placeholder",Ss)},[()=>i()("session.enemy_modal.name"),()=>i()("session.enemy_modal.difficulty"),()=>i()("session.enemy_modal.size"),()=>i()("session.enemy_modal.descriptors"),()=>i()("session.enemy_modal.descriptors_placeholder"),()=>i()("session.enemy_modal.global_enemy"),()=>i()("sofdl.attributes.perception"),()=>i()("session.enemy_modal.senses"),()=>i()("session.enemy_modal.senses_placeholder_sotdl"),()=>i()("session.enemy_modal.defense"),()=>i()("session.enemy_modal.health"),()=>i()("session.enemy_modal.speed"),()=>i()("session.enemy_modal.speed_notes"),()=>i()("session.enemy_modal.speed_notes_placeholder"),()=>i()("session.enemy_modal.immunities"),()=>i()("session.enemy_modal.immunities_placeholder_sotdl")]),Be(G,()=>a(n).name,pe=>a(n).name=pe),Be(Ne,()=>a(n).difficulty,pe=>a(n).difficulty=pe),Be(qt,()=>a(n).size,pe=>a(n).size=pe),Be(Na,()=>a(n).descriptors,pe=>a(n).descriptors=pe),Vs(Aa,()=>a(n).global,pe=>a(n).global=pe),Be(qa,()=>a(n).perception,pe=>a(n).perception=pe),Be(Ja,()=>a(n).senses,pe=>a(n).senses=pe),Be(gs,()=>a(n).defense,pe=>a(n).defense=pe),Be(hs,()=>a(n).health,pe=>a(n).health=pe),Be(ds,()=>a(n).speed,pe=>a(n).speed=pe),Be(be,()=>a(n).speedNotes,pe=>a(n).speedNotes=pe),Be(gt,()=>a(n).immunities,pe=>a(n).immunities=pe),v(_,$)},$e=_=>{var $=ht(),f=Ae($);{var T=m=>{var x=ln(),N=t(x),A=t(N),ne=t(A,!0);e(A);var H=s(A,2);Se(H,5,()=>[{key:"strength",label:i()("sofdl.attributes.strength")},{key:"agility",label:i()("sofdl.attributes.agility")},{key:"intellect",label:i()("sofdl.attributes.intellect")},{key:"will",label:i()("sofdl.attributes.will")}],ot,(G,oe)=>{var Ee=on(),qe=t(Ee),ft=t(qe,!0);e(qe);var Ne=s(qe,2);Xe(Ne);var Et=s(Ne,2),Dt=t(Et,!0);e(Et),e(Ee),b((Zt,qt)=>{se(qe,"for",`attr-${a(oe).key??""}`),se(qe,"title",a(oe).label),r(ft,Zt),se(Ne,"id",`attr-${a(oe).key??""}`),Ue(Et,1,`text-xs font-bold ${a(n).attributes[a(oe).key]-10>=0?"text-green-500":"text-red-500"}`),r(Dt,qt)},[()=>a(oe).label.substring(0,3),()=>me(a(n).attributes[a(oe).key])]),Be(Ne,()=>a(n).attributes[a(oe).key],Zt=>a(n).attributes[a(oe).key]=Zt),v(G,Ee)}),e(H),e(N),e(x),b(G=>r(ne,G),[()=>i()("session.enemy_modal.main_attributes")]),v(m,x)},S=m=>{var x=ht(),N=Ae(x);{var A=ne=>{var H=mn(),G=t(H),oe=t(G),Ee=t(oe),qe=t(Ee,!0);e(Ee);var ft=s(Ee,2);ft.__click=le;var Ne=t(ft);da(Ne,{size:12});var Et=s(Ne);e(ft),e(oe);var Dt=s(oe,2),Zt=t(Dt);Se(Zt,17,()=>a(n).traits,ot,(bt,be,Tt)=>{var nt=dn(),Lt=t(nt),gt=t(Lt);Xe(gt);var pe=s(gt,2);Ua(pe),e(Lt);var Ft=s(Lt,2);Ft.__click=()=>ke(Tt);var oa=t(Ft);fa(oa,{size:16}),e(Ft),e(nt),b((Mt,ua)=>{se(gt,"placeholder",Mt),se(pe,"placeholder",ua)},[()=>i()("session.enemy_modal.name_placeholder"),()=>i()("session.enemy_modal.desc_placeholder")]),Be(gt,()=>a(be).name,Mt=>a(be).name=Mt),Be(pe,()=>a(be).desc,Mt=>a(be).desc=Mt),v(bt,nt)});var qt=s(Zt,2);{var ca=bt=>{var be=vn(),Tt=t(be,!0);e(be),b(nt=>r(Tt,nt),[()=>i()("session.enemy_modal.empty")]),v(bt,be)};w(qt,bt=>{a(n).traits.length===0&&bt(ca)})}e(Dt),e(G);var pt=s(G,2),za=t(pt),Na=t(za),Ya=t(Na,!0);e(Na);var Aa=s(Na,2);Aa.__click=ie;var Ka=t(Aa);da(Ka,{size:12});var ms=s(Ka);e(Aa),e(za);var fs=s(za,2),Fa=t(fs);Se(Fa,17,()=>a(n).attackOptions,ot,(bt,be,Tt)=>{var nt=cn(),Lt=t(nt),gt=t(Lt),pe=t(gt);Xe(pe);var Ft=s(pe,2),oa=t(Ft),Mt=t(oa,!0);e(oa),oa.value=oa.__value="melee";var ua=s(oa),Os=t(ua,!0);e(ua),ua.value=ua.__value="ranged",e(Ft),e(gt);var cs=s(gt,2),Ga=t(cs);Xe(Ga);var us=s(Ga,2);Xe(us),e(cs);var bs=s(cs,2);Ua(bs),e(Lt);var _s=s(Lt,2);_s.__click=()=>_t(Tt);var js=t(_s);fa(js,{size:16}),e(_s),e(nt),b((la,Es,Ms,Ss,vr,cr)=>{se(pe,"placeholder",la),r(Mt,Es),r(Os,Ms),se(Ga,"placeholder",Ss),se(us,"placeholder",vr),se(bs,"placeholder",cr)},[()=>i()("session.enemy_modal.name_placeholder"),()=>i()("session.enemy_modal.melee"),()=>i()("session.enemy_modal.ranged"),()=>i()("session.enemy_modal.attack_placeholder"),()=>i()("session.enemy_modal.damage_placeholder"),()=>i()("session.enemy_modal.desc_effects_placeholder")]),Be(pe,()=>a(be).name,la=>a(be).name=la),br(Ft,()=>a(be).type,la=>a(be).type=la),Be(Ga,()=>a(be).attackRoll,la=>a(be).attackRoll=la),Be(us,()=>a(be).damage,la=>a(be).damage=la),Be(bs,()=>a(be).desc,la=>a(be).desc=la),v(bt,nt)});var es=s(Fa,2);{var ts=bt=>{var be=un(),Tt=t(be,!0);e(be),b(nt=>r(Tt,nt),[()=>i()("session.enemy_modal.empty")]),v(bt,be)};w(es,bt=>{a(n).attackOptions.length===0&&bt(ts)})}e(fs),e(pt);var as=s(pt,2),qa=t(as),Ba=t(qa),ss=t(Ba,!0);e(Ba);var rs=s(Ba,2);rs.__click=it;var Ja=t(rs);da(Ja,{size:12});var is=s(Ja);e(rs),e(qa);var Wa=s(qa,2),Qa=t(Wa);Se(Qa,17,()=>a(n).specialAttacks,ot,(bt,be,Tt)=>{var nt=bn(),Lt=t(nt),gt=t(Lt);Xe(gt);var pe=s(gt,2);Ua(pe),e(Lt);var Ft=s(Lt,2);Ft.__click=()=>Ce(Tt);var oa=t(Ft);fa(oa,{size:16}),e(Ft),e(nt),b((Mt,ua)=>{se(gt,"placeholder",Mt),se(pe,"placeholder",ua)},[()=>i()("session.enemy_modal.name_placeholder"),()=>i()("session.enemy_modal.desc_placeholder")]),Be(gt,()=>a(be).name,Mt=>a(be).name=Mt),Be(pe,()=>a(be).desc,Mt=>a(be).desc=Mt),v(bt,nt)});var Cs=s(Qa,2);{var gs=bt=>{var be=_n(),Tt=t(be,!0);e(be),b(nt=>r(Tt,nt),[()=>i()("session.enemy_modal.empty")]),v(bt,be)};w(Cs,bt=>{a(n).specialAttacks.length===0&&bt(gs)})}e(Wa),e(as);var ns=s(as,2),Da=t(ns),os=t(Da),hs=t(os,!0);e(os);var Ta=s(os,2);Ta.__click=Re;var Va=t(Ta);da(Va,{size:12});var ls=s(Va);e(Ta),e(Da);var ys=s(Da,2),ds=t(ys);Se(ds,17,()=>a(n).endOfRound,ot,(bt,be,Tt)=>{var nt=xn(),Lt=t(nt),gt=t(Lt);Xe(gt);var pe=s(gt,2);Ua(pe),e(Lt);var Ft=s(Lt,2);Ft.__click=()=>He(Tt);var oa=t(Ft);fa(oa,{size:16}),e(Ft),e(nt),b((Mt,ua)=>{se(gt,"placeholder",Mt),se(pe,"placeholder",ua)},[()=>i()("session.enemy_modal.name_placeholder"),()=>i()("session.enemy_modal.desc_placeholder")]),Be(gt,()=>a(be).name,Mt=>a(be).name=Mt),Be(pe,()=>a(be).desc,Mt=>a(be).desc=Mt),v(bt,nt)});var ws=s(ds,2);{var vs=bt=>{var be=pn(),Tt=t(be,!0);e(be),b(nt=>r(Tt,nt),[()=>i()("session.enemy_modal.empty")]),v(bt,be)};w(ws,bt=>{a(n).endOfRound.length===0&&bt(vs)})}e(ys),e(ns),e(H),b((bt,be,Tt,nt,Lt,gt,pe,Ft)=>{r(qe,bt),r(Et,` ${be??""}`),r(Ya,Tt),r(ms,` ${nt??""}`),r(ss,Lt),r(is,` ${gt??""}`),r(hs,pe),r(ls,` ${Ft??""}`)},[()=>i()("session.enemy_modal.traits"),()=>i()("common.buttons.add"),()=>i()("session.enemy_modal.attack_options"),()=>i()("common.buttons.add"),()=>i()("session.enemy_modal.special_attacks"),()=>i()("common.buttons.add"),()=>i()("session.enemy_modal.end_of_round"),()=>i()("common.buttons.add")]),v(ne,H)};w(N,ne=>{a(y)==="abilities"&&ne(A)},!0)}v(m,x)};w(f,m=>{a(y)==="attributes"?m(T):m(S,!1)},!0)}v(_,$)};w(Pe,_=>{a(y)==="stats"?_(q):_($e,!1)})}e(ae);var je=s(ae,2),Me=t(je);Me.__click=function(..._){o.onClose?.apply(this,_)};var Te=t(Me,!0);e(Me);var dt=s(Me,2);dt.__click=()=>o.onSave(a(n));var Ze=t(dt);Ls(Ze,{size:18});var at=s(Ze);e(dt),e(je),e(Ve);var xt=s(Ve,2),$t=t(xt),St=t($t),It=t(St);Us(It,{size:14});var I=s(It);e(St),e($t);var L=s($t,2),ge=t(L),st=t(ge),mt=t(st);{var vt=_=>{var $=fn(),f=t($);ps(f,{get hash(){return a(n).imageUrl},get alt(){return a(n).name},size:"custom"}),e($),v(_,$)};w(mt,_=>{a(n).imageUrl&&_(vt)})}var ct=s(mt,2),Bt=t(ct),Xt=t(Bt),Yt=t(Xt,!0);e(Xt);var Kt=s(Xt,2),Gt=t(Kt);e(Kt),e(Bt);var ea=s(Bt,2),ia=t(ea);e(ea),e(ct),e(st);var Ut=s(st,2),wt=t(Ut),Jt=t(wt,!0);e(wt);var Rt=s(wt,2),Wt=t(Rt);e(Rt);var rt=s(Rt,2);{var Ct=_=>{var $=gn(),f=t($);e($),b(()=>r(f,`; ${a(n).senses??""}`)),v(_,$)};w(rt,_=>{a(n).senses&&_(Ct)})}e(Ut);var Le=s(Ut,2),Ot=t(Le),ta=t(Ot,!0);e(Ot);var Ht=s(Ot,2),Nt=t(Ht,!0);e(Ht);var At=s(Ht,2),sa=t(At,!0);e(At);var aa=s(At,2),na=t(aa,!0);e(aa),e(Le);var pa=s(Le,2),Ia=t(pa),h=t(Ia),E=t(h,!0);e(h);var _e=s(h),he=s(_e),Ye=t(he,!0);e(he);var jt=s(he),Qt=s(jt),ma=t(Qt,!0);e(Qt);var _a=s(Qt),xa=s(_a),va=t(xa,!0);e(xa);var ka=s(xa);e(Ia),e(pa);var B=s(pa,2),Q=t(B),ve=t(Q,!0);e(Q);var Fe=s(Q,2),l=t(Fe,!0);e(Fe);var d=s(Fe,2);{var c=_=>{var $=hn(),f=t($);e($),b(()=>r(f,`; ${a(n).speedNotes??""}`)),v(_,$)};w(d,_=>{a(n).speedNotes&&_(c)})}e(B);var g=s(B,2);{var D=_=>{var $=yn(),f=t($),T=t(f,!0);e(f);var S=s(f,2),m=t(S,!0);e(S),e($),b(x=>{r(T,x),r(m,a(n).immunities)},[()=>i()("session.enemy_modal.immunities")]),v(_,$)};w(g,_=>{a(n).immunities&&_(D)})}var C=s(g,4);{var k=_=>{var $=ht(),f=Ae($);Se(f,17,()=>a(n).traits,ot,(T,S)=>{var m=wn(),x=t(m),N=t(x,!0);e(x);var A=s(x,2),ne=t(A,!0);e(A),e(m),b(()=>{r(N,a(S).name),r(ne,a(S).desc)}),v(T,m)}),v(_,$)};w(C,_=>{a(n).traits.length>0&&_(k)})}var R=s(C,2);{var j=_=>{var $=$n(),f=t($),T=t(f,!0);e(f);var S=s(f,2);Se(S,17,()=>a(n).attackOptions,ot,(m,x)=>{var N=zn(),A=t(N),ne=t(A,!0);e(A);var H=s(A,2),G=t(H);e(H);var oe=s(H,2),Ee=t(oe);e(oe);var qe=s(oe,2);{var ft=Ne=>{var Et=kn(),Dt=t(Et);e(Et),b(()=>r(Dt,`; ${a(x).desc??""}`)),v(Ne,Et)};w(qe,Ne=>{a(x).desc&&Ne(ft)})}e(N),b(Ne=>{r(ne,a(x).name),r(G,`(${Ne??""})`),r(Ee,`${a(x).attackRoll??""} (${a(x).damage??""})`)},[()=>a(x).type==="melee"?i()("session.enemy_modal.melee").toLowerCase():i()("session.enemy_modal.ranged").toLowerCase()]),v(m,N)}),e($),b(m=>r(T,m),[()=>i()("session.enemy_modal.attack_options")]),v(_,$)};w(R,_=>{a(n).attackOptions.length>0&&_(j)})}var z=s(R,2);{var V=_=>{var $=On(),f=t($),T=t(f,!0);e(f);var S=s(f,2);Se(S,17,()=>a(n).specialAttacks,ot,(m,x)=>{var N=Cn(),A=t(N),ne=t(A,!0);e(A);var H=s(A,2),G=t(H,!0);e(H),e(N),b(()=>{r(ne,a(x).name),r(G,a(x).desc)}),v(m,N)}),e($),b(m=>r(T,m),[()=>i()("session.enemy_modal.special_attacks")]),v(_,$)};w(z,_=>{a(n).specialAttacks.length>0&&_(V)})}var re=s(z,2);{var ce=_=>{var $=En(),f=t($),T=t(f,!0);e(f);var S=s(f,2);Se(S,17,()=>a(n).endOfRound,ot,(m,x)=>{var N=jn(),A=t(N),ne=t(A,!0);e(A);var H=s(A,2),G=t(H,!0);e(H),e(N),b(()=>{r(ne,a(x).name),r(G,a(x).desc)}),v(m,N)}),e($),b(m=>r(T,m),[()=>i()("session.enemy_modal.end_of_round")]),v(_,$)};w(re,_=>{a(n).endOfRound.length>0&&_(ce)})}e(ge),e(L),e(xt),e(K),e(de);var J=s(de,2);J.__change=we,or(J,_=>O(ye,_),()=>a(ye));var xe=s(J,2);ar(xe,{get isOpen(){return a(M)},get imageUrl(){return a(X)},onClose:()=>O(M,!1),onCrop:Ie}),b((_,$,f,T,S,m,x,N,A,ne,H,G,oe,Ee,qe,ft,Ne,Et,Dt,Zt,qt,ca,pt)=>{r(Pt,_),Ue(W,1,`flex-1 py-3 text-sm font-bold border-b-2 transition-colors ${a(y)==="stats"?"border-indigo-500 text-indigo-400 bg-slate-800":"border-transparent text-slate-500 hover:text-white"}`),r(ze,$),Ue(De,1,`flex-1 py-3 text-sm font-bold border-b-2 transition-colors ${a(y)==="attributes"?"border-indigo-500 text-indigo-400 bg-slate-800":"border-transparent text-slate-500 hover:text-white"}`),r(We,f),Ue(tt,1,`flex-1 py-3 text-sm font-bold border-b-2 transition-colors ${a(y)==="abilities"?"border-indigo-500 text-indigo-400 bg-slate-800":"border-transparent text-slate-500 hover:text-white"}`),r(ut,T),r(Te,S),r(at,` ${m??""}`),r(I,` ${x??""}`),r(Yt,N),r(Gt,`${A??""} ${a(n).difficulty??""}`),r(ia,`${ne??""} ${a(n).size??""} ${a(n).descriptors??""}`),r(Jt,H),r(Wt,`${a(n).perception??""} (${G??""})`),r(ta,oe),r(Nt,a(n).defense),r(sa,Ee),r(na,a(n).health),r(E,qe),r(_e,` ${a(n).attributes.strength??""} (${ft??""}), `),r(Ye,Ne),r(jt,` ${a(n).attributes.agility??""} (${Et??""}), `),r(ma,Dt),r(_a,` ${a(n).attributes.intellect??""} (${Zt??""}), `),r(va,qt),r(ka,` ${a(n).attributes.will??""} (${ca??""})`),r(ve,pt),r(l,a(n).speed)},[()=>i()("session.enemy_modal.title_sotdl"),()=>i()("session.enemy_modal.tab_general"),()=>i()("session.enemy_modal.tab_attributes"),()=>i()("session.enemy_modal.tab_abilities"),()=>i()("common.buttons.cancel"),()=>i()("common.buttons.save"),()=>i()("session.enemy_modal.preview"),()=>a(n).name||i()("session.enemy_modal.enemy_default"),()=>i()("session.enemies.difficulty").toUpperCase(),()=>i()("session.enemy_modal.size"),()=>i()("sofdl.attributes.perception"),()=>me(a(n).perception),()=>i()("session.enemy_modal.defense"),()=>i()("session.enemy_modal.health"),()=>i()("sofdl.attributes.strength"),()=>me(a(n).attributes.strength),()=>i()("sofdl.attributes.agility"),()=>me(a(n).attributes.agility),()=>i()("sofdl.attributes.intellect"),()=>me(a(n).attributes.intellect),()=>i()("sofdl.attributes.will"),()=>me(a(n).attributes.will),()=>i()("session.enemy_modal.speed")]),v(te,Y)};w(fe,te=>{p()&&te(Oe)})}v(F,Ke),Ea(),P()}Ma(["click","change"]);var In=u('<div class="space-y-4"><div class="flex items-center gap-4"><div class="relative group cursor-pointer"><div class="w-16 h-16 rounded-xl overflow-hidden border border-slate-700"><!></div> <div class="absolute inset-0 bg-black/50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity rounded-xl"><!></div></div> <div class="flex-1"><label for="enemy-name" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-name" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white font-bold text-lg"/></div></div> <div class="grid grid-cols-2 gap-4"><div><label for="enemy-diff" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label><input id="enemy-diff" type="number" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div> <div><label for="enemy-size" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label><input id="enemy-size" type="number" step="0.5" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div></div> <div class="flex items-center gap-2"><input id="enemy-global" type="checkbox" class="w-4 h-4 bg-slate-900 border-slate-700 rounded focus:ring-indigo-500"/> <label for="enemy-global" class="text-sm font-bold text-slate-400 select-none cursor-pointer flex items-center gap-2"><!> </label></div> <div><label for="enemy-desc" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <textarea id="enemy-desc" class="w-full bg-slate-900 border border-slate-700 rounded p-3 text-white text-sm min-h-[100px] resize-none focus:border-indigo-500 focus:outline-none transition-colors"></textarea></div> <div class="grid grid-cols-1"><div><label for="enemy-speed" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label><input id="enemy-speed" type="number" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div></div></div>'),Rn=u('<div class="bg-slate-900 p-2 rounded border border-slate-700 text-center"><label class="text-[10px] text-slate-500 uppercase font-bold block mb-1"> </label> <input type="number" class="w-full bg-transparent text-center font-bold text-white text-xl focus:outline-none mb-1"/> <div> </div></div>'),Nn=u('<div class="space-y-6"><div><h4 class="text-indigo-400 font-bold text-sm uppercase mb-3"> </h4> <div class="grid grid-cols-4 gap-3"></div></div> <div class="space-y-3"><div><label for="enemy-senses" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label><input id="enemy-senses" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white text-sm"/></div> <div><label for="enemy-langs" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label><input id="enemy-langs" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white text-sm"/></div> <div><label for="enemy-immune" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label><input id="enemy-immune" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white text-sm"/></div></div></div>'),An=u('<div class="flex gap-2 items-start animate-in fade-in slide-in-from-left-2"><div class="flex-1 space-y-1"><input class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm font-bold placeholder-slate-600 focus:border-indigo-500 focus:outline-none"/> <textarea class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm placeholder-slate-600 resize-none focus:border-indigo-500 focus:outline-none" rows="2"></textarea></div> <button class="mt-1 text-slate-600 hover:text-red-400 p-2 hover:bg-slate-800 rounded"><!></button></div>'),Dn=u('<div class="text-xs text-slate-600 italic text-center py-4 border-2 border-dashed border-slate-800 rounded"> </div>'),Tn=u('<div><div class="flex justify-between items-center mb-3"><h4> </h4> <button class="text-xs bg-slate-800 px-2 py-1 rounded hover:bg-slate-700 text-white flex items-center gap-1 border border-slate-700"><!> </button></div> <div class="space-y-3"><!> <!></div></div>'),Pn=u('<div class="space-y-6"></div>'),Un=u('<div class="w-16 h-16 rounded-lg overflow-hidden border border-slate-700 shadow-lg flex-shrink-0"><!></div>'),Hn=u('<div class="bg-slate-950 p-2 rounded border border-slate-800"><div class="text-[10px] text-slate-500 uppercase font-bold mb-1"> </div> <div class="text-white font-bold"> <span> </span></div></div>'),Ln=u('<div class="flex gap-2"><span class="font-bold text-slate-500 uppercase"> </span> <span class="text-white"> </span></div>'),Fn=u('<div class="flex gap-2"><span class="font-bold text-slate-500 uppercase"> </span> <span class="text-white"> </span></div>'),qn=u('<div class="flex gap-2"><span class="font-bold text-slate-500 uppercase"> </span> <span class="text-white"> </span></div>'),Bn=u('<div class="mb-2 pl-3 border-l-2 border-indigo-900"><span class="font-bold text-white"> </span> <span class="text-slate-300"> </span></div>'),Jn=u('<div><h4 class="font-bold text-indigo-400 uppercase text-xs mb-2 tracking-wider"> </h4> <!></div>'),Wn=u('<div class="mb-2 pl-3 border-l-2 border-red-900/50"><span class="font-bold text-white"> </span> <span class="text-slate-300"> </span></div>'),Qn=u('<div><h4 class="font-bold text-red-500 uppercase text-xs mb-2 tracking-wider"> </h4> <!></div>'),Vn=u('<div class="mb-2 pl-3 border-l-2 border-orange-900/50"><span class="font-bold text-white"> </span> <span class="text-slate-300"> </span></div>'),Gn=u('<div><h4 class="font-bold text-orange-400 uppercase text-xs mb-2 tracking-wider"> </h4> <!></div>'),Zn=u('<div class="mb-2 pl-3 border-l-2 border-yellow-900/50"><span class="font-bold text-white"> </span> <span class="text-slate-300"> </span></div>'),Xn=u('<div><h4 class="font-bold text-yellow-500 uppercase text-xs mb-2 tracking-wider"> </h4> <!></div>'),Yn=u('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/80 p-4" role="button" tabindex="-1"><div class="bg-slate-800 rounded-xl w-full max-w-6xl h-[90vh] border border-slate-700 shadow-2xl overflow-hidden flex flex-col lg:flex-row" role="dialog" aria-modal="true" aria-labelledby="modal-title"><div class="w-full lg:w-1/2 flex flex-col h-full border-r border-slate-700"><div class="p-4 border-b border-slate-700 bg-slate-900 flex justify-between items-center"><h3 id="modal-title" class="font-bold text-white text-lg"> </h3> <button class="lg:hidden text-slate-400 hover:text-white"><!></button></div> <div class="flex border-b border-slate-700 bg-slate-900/50"><button> </button> <button> </button> <button> </button></div> <div class="flex-1 overflow-y-auto p-6 custom-scrollbar bg-slate-800/50"><!></div> <div class="p-4 border-t border-slate-700 bg-slate-900 flex justify-end gap-3"><button class="px-6 py-2 rounded bg-slate-800 hover:bg-slate-700 text-white font-bold transition-colors"> </button> <button class="px-6 py-2 rounded bg-indigo-600 hover:bg-indigo-500 text-white font-bold flex items-center gap-2 transition-colors"><!> </button></div></div> <div class="hidden lg:flex w-1/2 bg-slate-950 flex-col border-l border-slate-800"><div class="p-4 border-b border-slate-800 bg-slate-950"><h3 class="font-bold text-slate-500 text-xs uppercase flex items-center gap-2"><!> </h3></div> <div class="flex-1 p-8 overflow-y-auto flex items-center justify-center bg-[radial-gradient(ellipse_at_top,_var(--tw-gradient-stops))] from-slate-900 via-slate-950 to-slate-950"><div class="w-full max-w-md bg-slate-900 border border-slate-700 rounded-xl p-5 shadow-2xl relative"><div class="absolute -top-3 -right-3 bg-red-600 text-white text-xs font-bold px-3 py-1 rounded-full shadow-lg border border-red-400"> </div> <div class="flex items-center gap-3 mb-4"><!> <div class="flex-1 min-w-0"><h2 class="text-2xl font-bold text-white mb-1 font-serif tracking-wide truncate"> </h2> <div class="h-1 w-20 bg-red-600 rounded-full"></div></div></div> <div class="grid grid-cols-2 gap-4 mb-4 text-sm"><div class="bg-slate-950 p-2 rounded border border-slate-800 flex justify-between items-center"><span class="text-slate-500 uppercase font-bold text-[10px]"> </span> <span class="text-white font-mono font-bold text-lg"> </span></div> <div class="bg-slate-950 p-2 rounded border border-slate-800 flex justify-between items-center"><span class="text-slate-500 uppercase font-bold text-[10px]"> </span> <span class="text-white font-mono font-bold text-lg"> </span></div> <div class="bg-slate-950 p-2 rounded border border-slate-800 flex justify-between items-center"><span class="text-slate-500 uppercase font-bold text-[10px]"> </span> <span class="text-white font-mono font-bold"> </span></div> <div class="bg-slate-950 p-2 rounded border border-slate-800 flex justify-between items-center"><span class="text-slate-500 uppercase font-bold text-[10px]"> </span> <span class="text-white font-mono font-bold"> </span></div></div> <div class="grid grid-cols-4 gap-2 mb-6 text-center font-mono text-slate-300"></div> <div class="mb-6 space-y-2 text-xs"><!> <!> <!></div> <div class="space-y-5 text-sm"><!> <!> <!> <!></div></div></div></div></div></div> <input type="file" hidden="" accept="image/*"/> <!>',1);function Kn(F,o){ja(o,!0);const i=()=>kt(ba,"$t",Z),[Z,P]=Sa();let p=ra(o,"isOpen",3,!1),U=ra(o,"initialData",3,"{}"),n=Qe(Oa(ee())),y=Qe("stats"),M=Qe(!1),X=Qe(""),ye=Qe(void 0);function we(Ce){const Re=Ce.target.files;if(Re&&Re.length>0){const He=Re[0],Je=new FileReader;Je.onload=()=>{O(X,Je.result,!0),O(M,!0)},Je.readAsDataURL(He)}Ce.target&&(Ce.target.value="")}async function Ie(Ce){try{const Re=await sr(Ce);a(n).imageUrl=Re,O(M,!1)}catch(Re){console.error(Re),alert(Re.message||"Erro ao salvar imagem")}}function ee(){return{name:"",difficulty:1,defense:10,health:10,damage:0,size:1,speed:10,description:"",senses:"",languages:"",immune:"",imageUrl:"",stats:{str:10,agi:10,int:10,wil:10},traits:[],actions:[],reactions:[],endOfRound:[],global:!1}}$s(()=>{if(p()&&U())try{const Ce=JSON.parse(U());Object.keys(Ce).length===0?O(n,ee(),!0):O(n,{...ee(),...Ce},!0)}catch{O(n,ee(),!0)}});function me(Ce){a(n)[Ce]=[...a(n)[Ce],{name:"",desc:""}]}function le(Ce,Re){a(n)[Ce]=a(n)[Ce].filter((He,Je)=>Je!==Re)}function ke(Ce){}var ie=ht(),_t=Ae(ie);{var it=Ce=>{var Re=Yn(),He=Ae(Re);He.__click=ke;var Je=t(He),Ke=t(Je),fe=t(Ke),Oe=t(fe),te=t(Oe,!0);e(Oe);var Y=s(Oe,2);Y.__click=function(...B){o.onClose?.apply(this,B)};var de=t(Y);Ra(de,{size:20}),e(Y),e(fe);var K=s(fe,2),Ve=t(K);Ve.__click=()=>O(y,"stats");var et=t(Ve,!0);e(Ve);var Ge=s(Ve,2);Ge.__click=()=>O(y,"attributes");var Pt=t(Ge,!0);e(Ge);var lt=s(Ge,2);lt.__click=()=>O(y,"abilities");var zt=t(lt,!0);e(lt),e(K);var yt=s(K,2),W=t(yt);{var ze=B=>{var Q=In(),ve=t(Q),Fe=t(ve);Fe.__click=()=>a(ye)?.click();var l=t(Fe),d=t(l);Hs(d,()=>a(n).imageUrl,Ne=>{ps(Ne,{get hash(){return a(n).imageUrl},get alt(){return a(n).name},size:"custom",fallbackText:"?"})}),e(l);var c=s(l,2),g=t(c);rr(g,{size:20,class:"text-white"}),e(c),e(Fe);var D=s(Fe,2),C=t(D),k=t(C,!0);e(C);var R=s(C,2);Xe(R),e(D),e(ve);var j=s(ve,2),z=t(j),V=t(z),re=t(V,!0);e(V);var ce=s(V);Xe(ce),e(z);var J=s(z,2),xe=t(J),_=t(xe,!0);e(xe);var $=s(xe);Xe($),e(J),e(j);var f=s(j,2),T=t(f);Xe(T);var S=s(T,2),m=t(S);$a(m,{size:14});var x=s(m);e(S),e(f);var N=s(f,2),A=t(N),ne=t(A,!0);e(A);var H=s(A,2);Ua(H),e(N);var G=s(N,2),oe=t(G),Ee=t(oe),qe=t(Ee,!0);e(Ee);var ft=s(Ee);Xe(ft),e(oe),e(G),e(Q),b((Ne,Et,Dt,Zt,qt,ca,pt)=>{r(k,Ne),r(re,Et),r(_,Dt),r(x,` ${Zt??""}`),r(ne,qt),se(H,"placeholder",ca),r(qe,pt)},[()=>i()("session.enemy_modal.name"),()=>i()("session.enemy_modal.difficulty"),()=>i()("session.enemy_modal.size"),()=>i()("session.enemy_modal.global_enemy"),()=>i()("session.enemy_modal.description"),()=>i()("session.enemy_modal.description_placeholder"),()=>i()("session.enemy_modal.speed")]),Be(R,()=>a(n).name,Ne=>a(n).name=Ne),Be(ce,()=>a(n).difficulty,Ne=>a(n).difficulty=Ne),Be($,()=>a(n).size,Ne=>a(n).size=Ne),Vs(T,()=>a(n).global,Ne=>a(n).global=Ne),Be(H,()=>a(n).description,Ne=>a(n).description=Ne),Be(ft,()=>a(n).speed,Ne=>a(n).speed=Ne),v(B,Q)},De=B=>{var Q=ht(),ve=Ae(Q);{var Fe=d=>{var c=Nn(),g=t(c),D=t(g),C=t(D,!0);e(D);var k=s(D,2);Se(k,20,()=>["str","agi","int","wil"],ot,(m,x)=>{var N=Rn(),A=t(N),ne=t(A,!0);e(A);var H=s(A,2);Xe(H);var G=s(H,2),oe=t(G);e(G),e(N),b(Ee=>{se(A,"for",`attr-${x??""}`),r(ne,Ee),se(H,"id",`attr-${x??""}`),Ue(G,1,`text-xs font-bold ${a(n).stats[x]-10>=0?"text-green-500":"text-red-500"}`),r(oe,`${a(n).stats[x]-10>=0?"+":""}${a(n).stats[x]-10}`)},[()=>i()("sofww.attributes."+x).substring(0,3)]),Be(H,()=>a(n).stats[x],Ee=>a(n).stats[x]=Ee),v(m,N)}),e(k),e(g);var R=s(g,2),j=t(R),z=t(j),V=t(z,!0);e(z);var re=s(z);Xe(re),e(j);var ce=s(j,2),J=t(ce),xe=t(J,!0);e(J);var _=s(J);Xe(_),e(ce);var $=s(ce,2),f=t($),T=t(f,!0);e(f);var S=s(f);Xe(S),e($),e(R),e(c),b((m,x,N,A,ne,H,G)=>{r(C,m),r(V,x),se(re,"placeholder",N),r(xe,A),se(_,"placeholder",ne),r(T,H),se(S,"placeholder",G)},[()=>i()("session.enemy_modal.main_attributes"),()=>i()("session.enemy_modal.senses"),()=>i()("session.enemy_modal.senses_placeholder"),()=>i()("session.enemy_modal.languages"),()=>i()("session.enemy_modal.languages_placeholder"),()=>i()("session.enemy_modal.immunities"),()=>i()("session.enemy_modal.immunities_placeholder")]),Be(re,()=>a(n).senses,m=>a(n).senses=m),Be(_,()=>a(n).languages,m=>a(n).languages=m),Be(S,()=>a(n).immune,m=>a(n).immune=m),v(d,c)},l=d=>{var c=ht(),g=Ae(c);{var D=C=>{var k=Pn();Se(k,20,()=>[{key:"traits",label:"traits",color:"text-indigo-400",border:"border-indigo-500/30"},{key:"actions",label:"actions",color:"text-red-400",border:"border-red-500/30"},{key:"reactions",label:"reactions",color:"text-orange-400",border:"border-orange-500/30"},{key:"endOfRound",label:"end_of_round",color:"text-yellow-400",border:"border-yellow-500/30"}],ot,(R,j)=>{var z=Tn(),V=t(z),re=t(V),ce=t(re,!0);e(re);var J=s(re,2);J.__click=()=>me(j.key);var xe=t(J);da(xe,{size:12});var _=s(xe);e(J),e(V);var $=s(V,2),f=t($);Se(f,17,()=>a(n)[j.key],ot,(m,x,N)=>{var A=An(),ne=t(A),H=t(ne);Xe(H);var G=s(H,2);Ua(G),e(ne);var oe=s(ne,2);oe.__click=()=>le(j.key,N);var Ee=t(oe);fa(Ee,{size:16}),e(oe),e(A),b((qe,ft)=>{se(H,"placeholder",qe),se(G,"placeholder",ft)},[()=>i()("session.enemy_modal.name_placeholder"),()=>i()("session.enemy_modal.desc_placeholder")]),Be(H,()=>a(x).name,qe=>a(x).name=qe),Be(G,()=>a(x).desc,qe=>a(x).desc=qe),v(m,A)});var T=s(f,2);{var S=m=>{var x=Dn(),N=t(x,!0);e(x),b(A=>r(N,A),[()=>i()("session.enemy_modal.empty")]),v(m,x)};w(T,m=>{a(n)[j.key].length===0&&m(S)})}e($),e(z),b((m,x)=>{Ue(z,1,`p-4 bg-slate-900 rounded border ${j.border??""}`),Ue(re,1,`font-bold text-sm uppercase ${j.color??""}`),r(ce,m),r(_,` ${x??""}`)},[()=>i()("session.enemy_modal."+j.label),()=>i()("session.enemy_modal.add")]),v(R,z)}),e(k),v(C,k)};w(g,C=>{a(y)==="abilities"&&C(D)},!0)}v(d,c)};w(ve,d=>{a(y)==="attributes"?d(Fe):d(l,!1)},!0)}v(B,Q)};w(W,B=>{a(y)==="stats"?B(ze):B(De,!1)})}e(yt);var We=s(yt,2),tt=t(We);tt.__click=function(...B){o.onClose?.apply(this,B)};var ut=t(tt,!0);e(tt);var ae=s(tt,2);ae.__click=()=>o.onSave(a(n));var Pe=t(ae);Ls(Pe,{size:18});var q=s(Pe);e(ae),e(We),e(Ke);var $e=s(Ke,2),je=t($e),Me=t(je),Te=t(Me);Us(Te,{size:14});var dt=s(Te);e(Me),e(je);var Ze=s(je,2),at=t(Ze),xt=t(at),$t=t(xt);e(xt);var St=s(xt,2),It=t(St);{var I=B=>{var Q=Un(),ve=t(Q);ps(ve,{get hash(){return a(n).imageUrl},get alt(){return a(n).name},size:"custom"}),e(Q),v(B,Q)};w(It,B=>{a(n).imageUrl&&B(I)})}var L=s(It,2),ge=t(L),st=t(ge,!0);e(ge),Ca(2),e(L),e(St);var mt=s(St,2),vt=t(mt),ct=t(vt),Bt=t(ct,!0);e(ct);var Xt=s(ct,2),Yt=t(Xt,!0);e(Xt),e(vt);var Kt=s(vt,2),Gt=t(Kt),ea=t(Gt,!0);e(Gt);var ia=s(Gt,2),Ut=t(ia,!0);e(ia),e(Kt);var wt=s(Kt,2),Jt=t(wt),Rt=t(Jt,!0);e(Jt);var Wt=s(Jt,2),rt=t(Wt,!0);e(Wt),e(wt);var Ct=s(wt,2),Le=t(Ct),Ot=t(Le,!0);e(Le);var ta=s(Le,2),Ht=t(ta,!0);e(ta),e(Ct),e(mt);var Nt=s(mt,2);Se(Nt,20,()=>["str","agi","int","wil"],ot,(B,Q)=>{var ve=Hn(),Fe=t(ve),l=t(Fe,!0);e(Fe);var d=s(Fe,2),c=t(d),g=s(c),D=t(g);e(g),e(d),e(ve),b(()=>{r(l,Q),r(c,`${a(n).stats[Q]??""} `),Ue(g,1,`text-xs ${a(n).stats[Q]-10>=0?"text-green-500":"text-red-500"}`),r(D,`(${a(n).stats[Q]-10>=0?"+":""}${a(n).stats[Q]-10})`)}),v(B,ve)}),e(Nt);var At=s(Nt,2),sa=t(At);{var aa=B=>{var Q=Ln(),ve=t(Q),Fe=t(ve);e(ve);var l=s(ve,2),d=t(l,!0);e(l),e(Q),b(c=>{r(Fe,`${c??""}:`),r(d,a(n).senses)},[()=>i()("session.enemy_modal.senses")]),v(B,Q)};w(sa,B=>{a(n).senses&&B(aa)})}var na=s(sa,2);{var pa=B=>{var Q=Fn(),ve=t(Q),Fe=t(ve);e(ve);var l=s(ve,2),d=t(l,!0);e(l),e(Q),b(c=>{r(Fe,`${c??""}:`),r(d,a(n).languages)},[()=>i()("session.enemy_modal.languages")]),v(B,Q)};w(na,B=>{a(n).languages&&B(pa)})}var Ia=s(na,2);{var h=B=>{var Q=qn(),ve=t(Q),Fe=t(ve);e(ve);var l=s(ve,2),d=t(l,!0);e(l),e(Q),b(c=>{r(Fe,`${c??""}:`),r(d,a(n).immune)},[()=>i()("session.enemy_modal.immunities")]),v(B,Q)};w(Ia,B=>{a(n).immune&&B(h)})}e(At);var E=s(At,2),_e=t(E);{var he=B=>{var Q=Jn(),ve=t(Q),Fe=t(ve,!0);e(ve);var l=s(ve,2);Se(l,17,()=>a(n).traits,ot,(d,c,g,D)=>{var C=Bn(),k=t(C),R=t(k);e(k);var j=s(k,2),z=t(j,!0);e(j),e(C),b(()=>{r(R,`${a(c).name??""}:`),r(z,a(c).desc)}),v(d,C)}),e(Q),b(d=>r(Fe,d),[()=>i()("session.enemy_modal.traits")]),v(B,Q)};w(_e,B=>{a(n).traits.length>0&&B(he)})}var Ye=s(_e,2);{var jt=B=>{var Q=Qn(),ve=t(Q),Fe=t(ve,!0);e(ve);var l=s(ve,2);Se(l,17,()=>a(n).actions,ot,(d,c,g,D)=>{var C=Wn(),k=t(C),R=t(k);e(k);var j=s(k,2),z=t(j,!0);e(j),e(C),b(()=>{r(R,`${a(c).name??""}:`),r(z,a(c).desc)}),v(d,C)}),e(Q),b(d=>r(Fe,d),[()=>i()("session.enemy_modal.actions")]),v(B,Q)};w(Ye,B=>{a(n).actions.length>0&&B(jt)})}var Qt=s(Ye,2);{var ma=B=>{var Q=Gn(),ve=t(Q),Fe=t(ve,!0);e(ve);var l=s(ve,2);Se(l,17,()=>a(n).reactions,ot,(d,c,g,D)=>{var C=Vn(),k=t(C),R=t(k);e(k);var j=s(k,2),z=t(j,!0);e(j),e(C),b(()=>{r(R,`${a(c).name??""}:`),r(z,a(c).desc)}),v(d,C)}),e(Q),b(d=>r(Fe,d),[()=>i()("session.enemy_modal.reactions")]),v(B,Q)};w(Qt,B=>{a(n).reactions.length>0&&B(ma)})}var _a=s(Qt,2);{var xa=B=>{var Q=Xn(),ve=t(Q),Fe=t(ve,!0);e(ve);var l=s(ve,2);Se(l,17,()=>a(n).endOfRound,ot,(d,c,g,D)=>{var C=Zn(),k=t(C),R=t(k);e(k);var j=s(k,2),z=t(j,!0);e(j),e(C),b(()=>{r(R,`${a(c).name??""}:`),r(z,a(c).desc)}),v(d,C)}),e(Q),b(d=>r(Fe,d),[()=>i()("session.enemy_modal.end_of_round")]),v(B,Q)};w(_a,B=>{a(n).endOfRound.length>0&&B(xa)})}e(E),e(at),e(Ze),e($e),e(Je),e(He);var va=s(He,2);va.__change=we,or(va,B=>O(ye,B),()=>a(ye));var ka=s(va,2);ar(ka,{get isOpen(){return a(M)},get imageUrl(){return a(X)},onClose:()=>O(M,!1),onCrop:Ie}),b((B,Q,ve,Fe,l,d,c,g,D,C,k,R,j,z)=>{se(He,"aria-label",B),r(te,Q),Ue(Ve,1,`flex-1 py-3 text-sm font-bold border-b-2 transition-colors ${a(y)==="stats"?"border-indigo-500 text-indigo-400 bg-slate-800":"border-transparent text-slate-500 hover:text-white"}`),r(et,ve),Ue(Ge,1,`flex-1 py-3 text-sm font-bold border-b-2 transition-colors ${a(y)==="attributes"?"border-indigo-500 text-indigo-400 bg-slate-800":"border-transparent text-slate-500 hover:text-white"}`),r(Pt,Fe),Ue(lt,1,`flex-1 py-3 text-sm font-bold border-b-2 transition-colors ${a(y)==="abilities"?"border-indigo-500 text-indigo-400 bg-slate-800":"border-transparent text-slate-500 hover:text-white"}`),r(zt,l),r(ut,d),r(q,` ${c??""}`),r(dt,` ${g??""}`),r($t,`${D??""} ${a(n).difficulty??""}`),r(st,C),r(Bt,k),r(Yt,a(n).defense),r(ea,R),r(Ut,a(n).health),r(Rt,j),r(rt,a(n).size),r(Ot,z),r(Ht,a(n).speed)},[()=>i()("session.enemy_modal.close"),()=>i()("session.enemy_modal.title"),()=>i()("session.enemy_modal.tab_general"),()=>i()("session.enemy_modal.tab_attributes"),()=>i()("session.enemy_modal.tab_abilities"),()=>i()("common.buttons.cancel"),()=>i()("common.buttons.save"),()=>i()("session.enemy_modal.preview"),()=>i()("session.enemy_modal.difficulty"),()=>a(n).name||i()("session.enemy_modal.enemy_default"),()=>i()("session.enemy_modal.defense"),()=>i()("session.enemy_modal.health"),()=>i()("session.enemy_modal.size"),()=>i()("session.enemy_modal.speed")]),v(Ce,Re)};w(_t,Ce=>{p()&&Ce(it)})}v(F,ie),Ea(),P()}Ma(["click","change"]);var eo=u('<div class="flex justify-between items-center bg-slate-800 p-2 rounded border border-slate-700"><div class="flex-1"><div class="text-sm font-bold text-white"> </div> <div class="text-[10px] text-slate-400"> </div></div> <div class="flex items-center gap-2"><input type="number" min="1" class="w-12 bg-slate-900 border border-slate-600 rounded text-center text-white"/> <button class="text-red-400 hover:text-red-300"><!></button></div></div>'),to=u('<div class="text-center text-slate-600 italic text-sm py-4"> </div>'),ao=u('<div class="flex justify-between items-center bg-slate-950 p-2 rounded border border-slate-800 hover:border-indigo-500/30 transition-colors"><div><div class="text-sm font-bold text-white max-w-[120px] truncate"> </div> <div class="text-[10px] text-slate-500"> </div></div> <button class="text-indigo-400 hover:text-white p-1 bg-slate-900 rounded border border-slate-800"><!></button></div>'),so=u('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/80 p-4" role="button" tabindex="-1"><div class="bg-slate-800 rounded-xl w-full max-w-2xl p-6 border border-slate-700 shadow-2xl flex flex-col max-h-[90vh]" role="dialog" aria-modal="true" aria-labelledby="encounter-modal-title"><div class="flex justify-between items-center mb-6"><h3 id="encounter-modal-title" class="text-xl font-bold text-white"> </h3> <button class="text-slate-400 hover:text-white"><!></button></div> <div class="space-y-4 mb-6"><div><label for="encounter-name" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="encounter-name" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white outline-hidden focus:border-indigo-500"/></div></div> <div class="flex-1 flex gap-4 min-h-0"><div class="flex-1 bg-slate-900 border border-slate-800 rounded-lg p-3 flex flex-col"><h4 class="text-xs text-slate-500 uppercase font-bold mb-2"> </h4> <div class="flex-1 overflow-y-auto space-y-2 custom-scrollbar"><!> <!></div></div> <div class="flex-1 bg-slate-900 border border-slate-800 rounded-lg p-3 flex flex-col"><h4 class="text-xs text-slate-500 uppercase font-bold mb-2"> </h4> <div class="flex-1 overflow-y-auto space-y-2 custom-scrollbar"></div></div></div> <div class="flex gap-3 mt-6 pt-4 border-t border-slate-700"><button class="flex-1 bg-slate-700 hover:bg-slate-600 text-white py-2 rounded font-bold"> </button> <button class="flex-1 bg-indigo-600 hover:bg-indigo-500 text-white py-2 rounded font-bold flex items-center justify-center gap-2"><!> </button></div></div></div>');function ro(F,o){ja(o,!0);const i=()=>kt(ba,"$t",P),Z=()=>kt(Ps,"$liveEnemies",P),[P,p]=Sa();let U=ra(o,"isOpen",3,!1),n=ra(o,"initialData",3,"{}"),y=Qe(Oa({name:"",enemies:[]}));$s(()=>{if(U()&&n())try{const le=JSON.parse(n());O(y,{name:le.name||"",enemies:le.enemies||[]},!0)}catch{O(y,{name:"",enemies:[]},!0)}});function M(le){a(y).enemies.find(ie=>ie.enemyId===le)?a(y).enemies=a(y).enemies.map(ie=>ie.enemyId===le?{...ie,count:ie.count+1}:ie):a(y).enemies=[...a(y).enemies,{enemyId:le,count:1}]}function X(le){a(y).enemies=a(y).enemies.filter((ke,ie)=>ie!==le)}function ye(le,ke){const ie=Math.max(1,parseInt(ke)||1);a(y).enemies[le].count=ie}function we(le){}var Ie=ht(),ee=Ae(Ie);{var me=le=>{var ke=so();ke.__click=we;var ie=t(ke),_t=t(ie),it=t(_t),Ce=t(it,!0);e(it);var Re=s(it,2);Re.__click=function(...q){o.onClose?.apply(this,q)};var He=t(Re);Ra(He,{size:20}),e(Re),e(_t);var Je=s(_t,2),Ke=t(Je),fe=t(Ke),Oe=t(fe,!0);e(fe);var te=s(fe,2);Xe(te),e(Ke),e(Je);var Y=s(Je,2),de=t(Y),K=t(de),Ve=t(K,!0);e(K);var et=s(K,2),Ge=t(et);Se(Ge,17,()=>a(y).enemies,ot,(q,$e,je)=>{const Me=ue(()=>Z().find(ge=>ge.id===a($e).enemyId));var Te=eo(),dt=t(Te),Ze=t(dt),at=t(Ze,!0);e(Ze);var xt=s(Ze,2),$t=t(xt);e(xt),e(dt);var St=s(dt,2),It=t(St);Xe(It),It.__input=ge=>ye(je,ge.target.value);var I=s(It,2);I.__click=()=>X(je);var L=t(I);fa(L,{size:16}),e(I),e(St),e(Te),b(ge=>{r(at,ge),r($t,`Dif ${(a(Me)?a(Me).difficulty:"?")??""}`),Ns(It,a($e).count)},[()=>a(Me)?a(Me).name:i()("session.encounter_modal.unknown")]),v(q,Te)});var Pt=s(Ge,2);{var lt=q=>{var $e=to(),je=t($e,!0);e($e),b(Me=>r(je,Me),[()=>i()("session.encounter_modal.none_added")]),v(q,$e)};w(Pt,q=>{a(y).enemies.length===0&&q(lt)})}e(et),e(de);var zt=s(de,2),yt=t(zt),W=t(yt,!0);e(yt);var ze=s(yt,2);Se(ze,5,Z,q=>q.id,(q,$e)=>{var je=ao(),Me=t(je),Te=t(Me),dt=t(Te,!0);e(Te);var Ze=s(Te,2),at=t(Ze);e(Ze),e(Me);var xt=s(Me,2);xt.__click=()=>M(a($e).id);var $t=t(xt);da($t,{size:16}),e(xt),e(je),b(()=>{r(dt,a($e).name),r(at,`Dif ${a($e).difficulty??""}`)}),v(q,je)}),e(ze),e(zt),e(Y);var De=s(Y,2),We=t(De);We.__click=function(...q){o.onClose?.apply(this,q)};var tt=t(We,!0);e(We);var ut=s(We,2);ut.__click=()=>o.onSave(a(y));var ae=t(ut);Ls(ae,{size:18});var Pe=s(ae);e(ut),e(De),e(ie),e(ke),b((q,$e,je,Me,Te,dt,Ze,at)=>{se(ke,"aria-label",q),r(Ce,$e),r(Oe,je),se(te,"placeholder",Me),r(Ve,Te),r(W,dt),r(tt,Ze),r(Pe,` ${at??""}`)},[()=>i()("session.encounter_modal.close"),()=>i()("session.encounter_modal.title"),()=>i()("session.encounter_modal.name"),()=>i()("session.encounter_modal.name_placeholder"),()=>i()("session.encounter_modal.enemies_in_encounter"),()=>i()("session.encounter_modal.add_enemies"),()=>i()("common.buttons.cancel"),()=>i()("session.encounter_modal.save_encounter")]),Be(te,()=>a(y).name,q=>a(y).name=q),v(le,ke)};w(ee,le=>{U()&&le(me)})}v(F,Ie),Ea(),p()}Ma(["click","input"]);var io=u('<div class="text-[10px] text-slate-400 flex items-center gap-1.5 bg-slate-950 p-1 px-1.5 rounded-lg border border-slate-800/50"><span class="text-indigo-400 font-black"> </span> <span class="font-medium truncate max-w-[80px]"> </span></div>'),no=u('<div class="text-[10px] text-slate-600 italic"> </div>'),oo=u('<div class="bg-slate-900 border border-slate-800 rounded-2xl p-4 transition-all hover:border-indigo-500/30 group relative flex flex-col justify-between shadow-lg hover:shadow-indigo-500/10" role="region"><div class="flex-1"><div class="flex items-center gap-2 mb-2"><div class="font-bold text-white text-base group-hover:text-indigo-400 transition-colors uppercase tracking-tight truncate"> </div> <!></div> <div class="flex flex-wrap gap-1"><!> <!></div></div> <div class="flex gap-2 mt-3 pt-3 border-t border-slate-800/50"><button class="flex-1 bg-indigo-600 hover:bg-indigo-500 text-white py-1.5 rounded-lg text-xs font-bold flex items-center justify-center gap-2 transition-all active:scale-95 shadow-lg shadow-indigo-900/20"><!> </button> <button class="p-1.5 text-slate-400 hover:text-white bg-slate-800/50 rounded-lg border border-slate-800 transition-all" title="Editar"><!></button> <button class="p-1.5 text-slate-400 hover:text-red-400 bg-slate-800/50 rounded-lg border border-slate-800 hover:border-red-900/30 transition-all"><!></button></div></div>'),lo=u('<button class="text-[10px] font-bold text-indigo-400 hover:text-indigo-300 mt-1 uppercase tracking-wider"> </button>'),vo=u('<div class="mb-4 flex-1"><p> </p> <!></div>'),co=u('<div class="mb-4 flex-1 text-[10px] text-slate-600 italic"> </div>'),uo=u('<div class="bg-slate-900 border border-slate-800 rounded-2xl p-5 hover:border-indigo-500/30 transition-all relative group cursor-move hover:shadow-lg hover:shadow-indigo-500/10 active:scale-[0.98] flex flex-col" draggable="true" role="listitem"><div class="flex justify-between items-start mb-3"><div class="flex items-center gap-2"><h3 class="font-bold text-lg text-white group-hover:text-indigo-400 transition-colors"> </h3> <!></div> <span class="text-[10px] font-black bg-indigo-500/10 text-indigo-400 border border-indigo-400/20 px-2 py-1 rounded-lg uppercase"> </span></div> <!> <div class="mt-auto flex gap-2 pt-4 border-t border-slate-800/50"><button class="flex-1 bg-slate-800/50 hover:bg-slate-800 text-white py-2 rounded-xl text-xs font-bold border border-slate-800 transition-all"> </button> <button class="bg-slate-800/50 hover:bg-red-900/20 text-slate-500 hover:text-red-400 px-3 rounded-xl border border-slate-800 hover:border-red-900/30 transition-all"><!></button></div></div>'),bo=u('<div class="text-center text-slate-500 italic col-span-3"> </div>'),_o=u('<div><div class="mb-12"><div class="flex justify-between items-center mb-6"><h3 class="text-sm font-black text-indigo-400 uppercase tracking-widest flex items-center gap-2"><!> </h3></div> <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"><button class="min-h-[120px] border-2 border-dashed border-slate-800 rounded-2xl flex flex-col items-center justify-center text-slate-500 hover:border-indigo-500 hover:text-indigo-400 transition-all hover:bg-indigo-500/5 gap-2 group"><!> <span class="font-bold text-sm"> </span></button> <!></div></div> <div class="mb-6"><h3 class="text-sm font-black text-indigo-400 uppercase tracking-widest flex items-center gap-2 mb-6"><!> </h3></div> <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"><button class="min-h-[180px] border-2 border-dashed border-slate-800 rounded-2xl flex flex-col items-center justify-center text-slate-500 hover:border-indigo-500 hover:text-indigo-400 transition-all hover:bg-indigo-500/5 gap-2 group"><!> <span class="font-bold text-sm"> </span></button> <!> <!></div> <!> <!> <!></div>');function xo(F,o){ja(o,!0);const i=()=>kt(Ps,"$liveEnemies",p),Z=()=>kt(Zs,"$liveEncounters",p),P=()=>kt(ba,"$t",p),[p,U]=Sa();let n=Qe(!1),y=Qe(null),M=Qe("{}"),X=Qe(!1),ye=Qe(null),we=Qe("{}"),Ie=Qe(Oa({isOpen:!1,title:"",message:"",onConfirm:()=>{}}));function ee(){return{name:"",difficulty:1,defense:10,health:10,damage:0,size:1,speed:10,description:"",senses:"",languages:"",immune:"",stats:{str:10,agi:10,int:10,wil:10},traits:[],actions:[],reactions:[],endOfRound:[]}}function me(I=null){O(y,I?I.id:null,!0),I?O(M,JSON.stringify(I),!0):a(Oe)==="sofdl"?O(M,"{}"):O(M,JSON.stringify(ee()),!0),O(n,!0)}let le=Oa(new Set);function ke(I){le.has(I)?le.delete(I):le.add(I)}function ie(I){const L=a(y)||xs(),ge=Vt.get(o.campId);Js.set(L,{...I,id:L,campaignId:o.campId,system:ge?.system||"sofww"}),O(n,!1)}function _t(I){const L=i().find(ge=>ge.id===I);O(Ie,{isOpen:!0,title:"Excluir Inimigo",message:`Tem certeza que deseja excluir permanentemente o inimigo "${L?.name||"este inimigo"}"?`,onConfirm:()=>{Js.delete(I),a(Ie).isOpen=!1}},!0)}function it(I=null){O(ye,I?I.id:null,!0),O(we,JSON.stringify(I||{name:"",enemies:[]}),!0),O(X,!0)}function Ce(I){const L=a(ye)||xs();Is.set(L,{...I,id:L,system:a(Oe)}),O(X,!1)}function Re(I){const L=Z().find(ge=>ge.id===I);O(Ie,{isOpen:!0,title:"Excluir Encontro",message:`Tem certeza que deseja excluir permanentemente o encontro "${L?.name||"este encontro"}"?`,onConfirm:()=>{Is.delete(I),a(Ie).isOpen=!1}},!0)}function He(I){const L=Vt.get(o.campId);if(!L)return;const ge=L.activeEnemies||[];let st=[];I.enemies.forEach(mt=>{const vt=i().find(ct=>ct.id===mt.enemyId);if(vt)for(let ct=0;ct<mt.count;ct++)st.push({...vt,instanceId:xs(),damage:0,currentHealth:vt.health,afflictions:[],acted:!1,initiative:!1})}),Vt.set(o.campId,{...L,activeEnemies:[...ge,...st]})}function Je(I,L){I.dataTransfer.setData("text/plain",L.id),I.dataTransfer.effectAllowed="copy"}function Ke(I){return I.preventDefault(),!1}function fe(I,L){I.preventDefault();const ge=I.dataTransfer.getData("text/plain");if(!ge)return;const st=L.enemies||[],mt=st.find(ct=>ct.enemyId===ge);let vt;mt?vt=st.map(ct=>ct.enemyId===ge?{...ct,count:ct.count+1}:ct):vt=[...st,{enemyId:ge,count:1}],Is.set(L.id,{...L,enemies:vt})}let Oe=ue(()=>Vt.get(o.campId)?.system||"sofww"),te=ue(()=>i().filter(I=>(I.system||"sofww")===a(Oe))),Y=ue(()=>Z().filter(I=>(I.system||"sofww")===a(Oe)));var de=_o(),K=t(de),Ve=t(K),et=t(Ve),Ge=t(et);Ts(Ge,{size:16});var Pt=s(Ge);e(et),e(Ve);var lt=s(Ve,2),zt=t(lt);zt.__click=()=>it();var yt=t(zt);da(yt,{size:28,class:"group-hover:scale-110 transition-transform"});var W=s(yt,2),ze=t(W,!0);e(W),e(zt);var De=s(zt,2);Se(De,17,()=>a(Y),I=>I.id,(I,L)=>{var ge=oo(),st=t(ge),mt=t(st),vt=t(mt),ct=t(vt,!0);e(vt);var Bt=s(vt,2);{var Xt=Le=>{$a(Le,{size:12,class:"text-indigo-400"})};w(Bt,Le=>{a(L).global&&Le(Xt)})}e(mt);var Yt=s(mt,2),Kt=t(Yt);Se(Kt,17,()=>a(L).enemies||[],ot,(Le,Ot)=>{const ta=ue(()=>i().find(na=>na.id===a(Ot).enemyId));var Ht=io(),Nt=t(Ht),At=t(Nt);e(Nt);var sa=s(Nt,2),aa=t(sa,!0);e(sa),e(Ht),b(()=>{r(At,`${a(Ot).count??""}x`),r(aa,a(ta)?a(ta).name:"...")}),v(Le,Ht)});var Gt=s(Kt,2);{var ea=Le=>{var Ot=no(),ta=t(Ot,!0);e(Ot),b(Ht=>r(ta,Ht),[()=>P()("session.bestiary.empty_encounter")]),v(Le,Ot)};w(Gt,Le=>{a(L).enemies?.length||Le(ea)})}e(Yt),e(st);var ia=s(st,2),Ut=t(ia);Ut.__click=()=>He(a(L));var wt=t(Ut);Ds(wt,{size:12,fill:"currentColor"});var Jt=s(wt);e(Ut);var Rt=s(Ut,2);Rt.__click=()=>it(a(L));var Wt=t(Rt);Ar(Wt,{size:14}),e(Rt);var rt=s(Rt,2);rt.__click=()=>Re(a(L).id);var Ct=t(rt);fa(Ct,{size:14}),e(rt),e(ia),e(ge),b(Le=>{se(ge,"aria-label",`Encontro ${a(L).name??""}`),r(ct,a(L).name),r(Jt,` ${Le??""}`)},[()=>P()("session.bestiary.start")]),Ha("dragover",ge,Ke),Ha("drop",ge,Le=>fe(Le,a(L))),v(I,ge)}),e(lt),e(K);var We=s(K,2),tt=t(We),ut=t(tt);Pa(ut,{size:16});var ae=s(ut);e(tt),e(We);var Pe=s(We,2),q=t(Pe);q.__click=()=>me();var $e=t(q);da($e,{size:32,class:"group-hover:scale-110 transition-transform"});var je=s($e,2),Me=t(je,!0);e(je),e(q);var Te=s(q,2);Se(Te,17,()=>a(te),I=>I.id,(I,L)=>{var ge=uo(),st=t(ge),mt=t(st),vt=t(mt),ct=t(vt,!0);e(vt);var Bt=s(vt,2);{var Xt=rt=>{$a(rt,{size:14,class:"text-indigo-400"})};w(Bt,rt=>{a(L).global&&rt(Xt)})}e(mt);var Yt=s(mt,2),Kt=t(Yt);e(Yt),e(st);var Gt=s(st,2);{var ea=rt=>{var Ct=vo(),Le=t(Ct),Ot=t(Le,!0);e(Le);var ta=s(Le,2);{var Ht=Nt=>{var At=lo();At.__click=()=>ke(a(L).id);var sa=t(At,!0);e(At),b(aa=>r(sa,aa),[()=>le.has(a(L).id)?P()("session.bestiary.see_less"):P()("session.bestiary.see_more")]),v(Nt,At)};w(ta,Nt=>{a(L).description.length>120&&Nt(Ht)})}e(Ct),b(Nt=>{Ue(Le,1,`text-xs text-slate-400 leading-relaxed ${Nt??""}`),r(Ot,a(L).description)},[()=>le.has(a(L).id)?"":"line-clamp-3"]),v(rt,Ct)},ia=rt=>{var Ct=co(),Le=t(Ct,!0);e(Ct),b(Ot=>r(Le,Ot),[()=>P()("session.bestiary.no_description")]),v(rt,Ct)};w(Gt,rt=>{a(L).description?rt(ea):rt(ia,!1)})}var Ut=s(Gt,2),wt=t(Ut);wt.__click=()=>me(a(L));var Jt=t(wt,!0);e(wt);var Rt=s(wt,2);Rt.__click=()=>_t(a(L).id);var Wt=t(Rt);fa(Wt,{size:14}),e(Rt),e(Ut),e(ge),b((rt,Ct)=>{r(ct,a(L).name),r(Kt,`${rt??""} ${a(L).difficulty??""}`),r(Jt,Ct)},[()=>P()("session.bestiary.level"),()=>P()("common.buttons.edit")]),Ha("dragstart",ge,rt=>Je(rt,a(L))),v(I,ge)});var dt=s(Te,2);{var Ze=I=>{var L=bo(),ge=t(L,!0);e(L),b(st=>r(ge,st),[()=>P()("session.bestiary.no_enemies")]),v(I,L)};w(dt,I=>{a(te).length===0&&I(Ze)})}e(Pe);var at=s(Pe,2);{var xt=I=>{Sn(I,{get isOpen(){return a(n)},get initialData(){return a(M)},onClose:()=>O(n,!1),onSave:ie})},$t=I=>{Kn(I,{get isOpen(){return a(n)},get initialData(){return a(M)},onClose:()=>O(n,!1),onSave:ie})};w(at,I=>{a(Oe)==="sofdl"?I(xt):I($t,!1)})}var St=s(at,2);ro(St,{get isOpen(){return a(X)},get initialData(){return a(we)},onClose:()=>O(X,!1),onSave:Ce});var It=s(St,2);Gs(It,{get isOpen(){return a(Ie).isOpen},get title(){return a(Ie).title},get message(){return a(Ie).message},get onConfirm(){return a(Ie).onConfirm},onCancel:()=>a(Ie).isOpen=!1}),e(de),b((I,L,ge,st)=>{r(Pt,` ${I??""}`),r(ze,L),r(ae,` ${ge??""}`),r(Me,st)},[()=>P()("session.bestiary.encounters_title"),()=>P()("session.bestiary.new_encounter"),()=>P()("session.bestiary.title"),()=>P()("session.bestiary.new_enemy")]),v(F,de),Ea(),U()}Ma(["click"]);var po=u('<div class="flex items-center gap-1 text-slate-400 ml-1"><!> <span class="text-xs"> </span></div>'),mo=u('<div class="flex items-center gap-1 text-emerald-400"><!> <span class="text-xs font-bold hidden sm:block"> </span></div> <!>',1),fo=u('<div class="flex items-center gap-1 text-slate-500"><!> <span class="text-xs hidden sm:block"> </span></div>'),go=u('<span class="absolute -top-1 -right-1 flex h-3 w-3"><span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-red-400 opacity-75"></span> <span class="relative inline-flex rounded-full h-3 w-3 bg-red-500 border border-slate-900"></span></span>'),ho=u('<header class="bg-slate-900/80 backdrop-blur-md border-b border-white/5 sticky top-0 z-40 shadow-2xl"><div class="max-w-7xl mx-auto px-2 sm:px-4 py-4 sm:py-3"><div class="flex items-center justify-between gap-2 sm:gap-4"><div class="flex items-center gap-1 sm:gap-3 shrink-0"><button class="p-2 text-slate-400 hover:text-white hover:bg-white/5 rounded-full transition-all flex items-center gap-1 group"><!> <!></button> <div class="flex flex-col"><h1 class="text-base sm:text-lg font-black text-white leading-tight truncate max-w-[140px] sm:max-w-none"> </h1> <span class="text-xs text-indigo-400 font-mono font-black uppercase tracking-wider"> </span></div></div> <div class="hidden md:flex bg-slate-950/50 p-1 rounded-xl border border-white/5"><button><!> <span class="hidden min-[400px]:block"> </span></button> <button><!> <span class="hidden min-[400px]:block"> </span></button></div> <div class="flex items-center gap-1 sm:gap-2"><div class="flex items-center gap-2 mr-2 border-r border-white/10 pr-2"><!></div> <button class="p-2 sm:p-2.5 text-slate-400 hover:text-white hover:bg-white/5 rounded-lg transition-all"><!></button> <button class="p-2 sm:p-2.5 bg-indigo-600/10 text-indigo-400 border border-indigo-400/20 rounded-lg hover:bg-indigo-600 hover:text-white transition-all relative"><!> <!></button></div></div></div></header>');function yo(F,o){ja(o,!0);const i=()=>kt(ba,"$t",U),Z=()=>kt(mr,"$syncState",U),P=()=>kt(La,"$isHistoryOpen",U),p=()=>kt(fr,"$hasUnreadRolls",U),[U,n]=Sa();let y=ra(o,"campaignName",3,""),M=ra(o,"gmName",3,"Mestre"),X=ra(o,"activeSubTab",3,"session"),ye=ra(o,"onTabChange",3,()=>{}),we=ra(o,"onOpenSettings",3,()=>{});var Ie=ho(),ee=t(Ie),me=t(ee),le=t(me),ke=t(le);ke.__click=()=>Pr(Ks("/"));var ie=t(ke);tr(ie,{size:20,class:"group-hover:-translate-x-0.5 transition-transform"});var _t=s(ie,2);Mr(_t,{size:18,class:"hidden sm:block opacity-50"}),e(ke);var it=s(ke,2),Ce=t(it),Re=t(Ce,!0);e(Ce);var He=s(Ce,2),Je=t(He,!0);e(He),e(it),e(le);var Ke=s(le,2),fe=t(Ke);fe.__click=()=>ye()("session");var Oe=t(fe);{let ae=ue(()=>X()==="session"?"opacity-100":"opacity-50");ir(Oe,{size:14,get class(){return a(ae)}})}var te=s(Oe,2),Y=t(te,!0);e(te),e(fe);var de=s(fe,2);de.__click=()=>ye()("bestiary");var K=t(de);{let ae=ue(()=>X()==="bestiary"?"opacity-100":"opacity-50");lr(K,{size:14,get class(){return a(ae)}})}var Ve=s(K,2),et=t(Ve,!0);e(Ve),e(de),e(Ke);var Ge=s(Ke,2),Pt=t(Ge),lt=t(Pt);{var zt=ae=>{var Pe=mo(),q=Ae(Pe),$e=t(q);Ys($e,{size:16});var je=s($e,2),Me=t(je,!0);e(je),e(q);var Te=s(q,2);{var dt=Ze=>{var at=po(),xt=t(at);Xs(xt,{size:14});var $t=s(xt,2),St=t($t,!0);e($t),e(at),b(It=>{se(at,"title",It),r(St,Z().peers.length)},[()=>i()("common.status.peers",{values:{count:Z().peers.length}})]),v(Ze,at)};w(Te,Ze=>{Z().peers.length>0&&Ze(dt)})}b((Ze,at)=>{se(q,"title",Ze),r(Me,at)},[()=>i()("common.status.connected"),()=>i()("common.status.connected")]),v(ae,Pe)},yt=ae=>{var Pe=fo(),q=t(Pe);Ur(q,{size:16});var $e=s(q,2),je=t($e,!0);e($e),e(Pe),b((Me,Te)=>{se(Pe,"title",Me),r(je,Te)},[()=>i()("common.status.offline"),()=>i()("common.status.offline")]),v(ae,Pe)};w(lt,ae=>{Z().isConnected?ae(zt):ae(yt,!1)})}e(Pt);var W=s(Pt,2);W.__click=function(...ae){we()?.apply(this,ae)};var ze=t(W);Dr(ze,{size:20}),e(W);var De=s(W,2);De.__click=()=>La.update(ae=>!ae);var We=t(De);Sr(We,{size:20});var tt=s(We,2);{var ut=ae=>{var Pe=go();v(ae,Pe)};w(tt,ae=>{p()&&ae(ut)})}e(De),e(Ge),e(me),e(ee),e(Ie),b((ae,Pe,q,$e,je,Me,Te,dt)=>{se(ke,"aria-label",ae),se(ke,"title",Pe),r(Re,y()),r(Je,M()),Ue(fe,1,`flex items-center gap-2 px-3 sm:px-4 py-1.5 rounded-lg text-xs font-black transition-all ${X()==="session"?"bg-indigo-600 text-white shadow-lg shadow-indigo-500/20":"text-slate-500 hover:text-slate-300"}`),se(fe,"aria-pressed",X()==="session"),r(Y,q),Ue(de,1,`flex items-center gap-2 px-3 sm:px-4 py-1.5 rounded-lg text-xs font-black transition-all ${X()==="bestiary"?"bg-indigo-600 text-white shadow-lg shadow-indigo-500/20":"text-slate-500 hover:text-slate-300"}`),se(de,"aria-pressed",X()==="bestiary"),r(et,$e),se(W,"aria-label",je),se(W,"title",Me),se(De,"aria-label",Te),se(De,"title",dt),se(De,"aria-pressed",P())},[()=>i()("character.header.back_dashboard"),()=>i()("character.header.back_dashboard"),()=>i()("common.labels.session"),()=>i()("common.labels.bestiary"),()=>i()("common.buttons.settings"),()=>i()("common.buttons.settings"),()=>i()("character.header.history"),()=>i()("character.header.history")]),v(F,Ie),Ea(),n()}Ma(["click"]);var wo=u('<!> <!> <main class="max-w-7xl mx-auto p-4 md:p-8 animate-in slide-in-from-bottom-4 duration-500"><!></main>',1),ko=u('<div class="flex flex-col items-center justify-center min-h-screen p-4 text-center"><div class="w-20 h-20 bg-slate-800 rounded-full flex items-center justify-center mx-auto mb-6 text-slate-600"><svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-ghost"><path d="M9 10h.01"></path><path d="M15 10h.01"></path><path d="M12 2a8 8 0 0 0-8 8v12l3-3 2.5 2.5L12 19l2.5 2.5L17 19l3 3V10a8 8 0 0 0-8-8z"></path></svg></div> <h1 class="text-2xl font-black text-white mb-2 uppercase tracking-tight"> </h1> <p class="text-slate-400 mb-8 max-w-md"> </p> <button class="bg-indigo-600 hover:bg-indigo-500 text-white px-8 py-3 rounded-xl font-bold transition-all flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-arrow-left"><path d="m12 19-7-7 7-7"></path><path d="19 12H5"></path></svg> </button></div>'),zo=u('<div class="flex items-center justify-center min-h-screen"><div class="relative w-16 h-16"><div class="absolute inset-0 border-4 border-indigo-500/20 rounded-full"></div> <div class="absolute inset-0 border-4 border-indigo-500 border-t-transparent rounded-full animate-spin"></div></div></div>'),$o=u('<div class="fixed bottom-24 left-1/2 -translate-x-1/2 md:left-8 md:translate-x-0 z-[60] flex flex-col items-center gap-2"><div class="bg-slate-900/95 backdrop-blur-md border border-white/10 rounded-2xl p-2 flex items-center gap-2 shadow-2xl animate-in zoom-in-95 slide-in-from-bottom-4 duration-200"><button class="bg-indigo-600/20 hover:bg-indigo-600 text-indigo-400 hover:text-white font-bold w-12 h-12 rounded-xl flex flex-col items-center justify-center transition-all active:scale-95 shadow-lg border border-indigo-500/20"><span class="text-[10px] opacity-70">d20</span> <!></button> <button class="bg-slate-800 hover:bg-slate-700 text-white font-bold w-12 h-12 rounded-xl flex flex-col items-center justify-center transition-all active:scale-95 shadow-lg border border-white/5"><span class="text-[10px] opacity-70">1d6</span> <!></button> <button class="bg-slate-800 hover:bg-slate-700 text-white font-bold w-12 h-12 rounded-xl flex flex-col items-center justify-center transition-all active:scale-95 shadow-lg border border-white/5"><span class="text-[10px] opacity-70">2d6</span> <!></button> <button class="bg-slate-800 hover:bg-slate-700 text-white font-bold w-12 h-12 rounded-xl flex flex-col items-center justify-center transition-all active:scale-95 shadow-lg border border-white/5"><span class="text-[10px] opacity-70">3d6</span> <!></button> <div class="w-px h-8 bg-white/10 mx-1"></div> <button class="w-10 h-10 flex items-center justify-center text-slate-500 hover:text-white transition-colors"><!></button></div></div>  <div class="fixed inset-0 bg-black/40 z-[55]"></div>',1),Co=u('<div class="min-h-screen bg-slate-950 text-slate-100 font-sans pb-20"><!> <!> <!> <div class="hidden md:block fixed bottom-8 left-8 z-[60]"><button class="w-16 h-16 bg-indigo-600 hover:bg-indigo-500 text-white rounded-full shadow-[0_0_20px_rgba(79,70,229,0.4)] flex items-center justify-center transition-all active:scale-90 border-2 border-white/10 group" title="Rolagens Rápidas"><!></button></div> <nav class="md:hidden fixed bottom-0 left-0 right-0 z-50 px-4 pb-6 pt-2 pointer-events-none"><div class="max-w-md mx-auto relative h-16 pointer-events-auto"><div class="absolute inset-0 bg-slate-900 border border-white/10 rounded-2xl shadow-2xl overflow-hidden"><div class="absolute inset-x-0 top-0 h-px bg-gradient-to-r from-transparent via-indigo-500/30 to-transparent"></div></div> <div class="relative h-full flex items-center justify-around px-2"><button><!> <span class="text-[9px] font-black uppercase tracking-widest leading-none">Sessão</span></button> <div class="relative w-16 h-16 -mt-10 flex items-center justify-center"><div class="absolute inset-0 bg-indigo-600/20 rounded-full blur-xl animate-pulse"></div> <button class="relative w-14 h-14 bg-indigo-600 rounded-full flex items-center justify-center shadow-[0_0_20px_rgba(79,70,229,0.5)] border-4 border-slate-900 transition-all active:scale-90 hover:bg-indigo-500 z-10" aria-label="Rolar Dados"><!></button></div> <button><!> <span class="text-[9px] font-black uppercase tracking-widest leading-none">Bestiário</span></button></div></div></nav> <!></div>');function Qo(F,o){ja(o,!0);const i=()=>kt(_r,"$page",U),Z=()=>kt(yr,"$liveCampaigns",U),P=()=>kt(ba,"$t",U),p=()=>kt(La,"$isHistoryOpen",U),[U,n]=Sa();let y=Qe("session"),M=Qe(!1),X=ue(()=>i().params.id),ye=ue(()=>Z().find(W=>W.id===a(X))),we=ue(()=>!!a(ye));function Ie(W){if(!a(X)||!a(ye))return;const ze={...a(ye),...W};Vt.set(a(X),ze),As(a(X),{name:ze.name,gmName:ze.gmName}),O(M,!1)}let ee=Qe(!1),me=Qe(Oa({isOpen:!1,sides:20,count:1,modifier:0}));function le(W,ze=1){O(me,{isOpen:!0,sides:W,count:ze,modifier:0},!0)}function ke(W){if(!a(ye))return;const ze=wi(a(me).sides,a(me).count,W);let De="";a(me).count>1&&(De+=`Dados: [${ze.results.join(", ")}] `),ze.bonusRolls?.length>0&&(De+=`Bonus Rolls: [${ze.bonusRolls.join(", ")}] -> ${Math.abs(ze.modifierTotal)}`);const We=a(ye).gmName||Rs(ba)("common.labels.master");gr.addToHistory({source:"GM",charName:We,name:`${a(me).count}d${a(me).sides} ${W?W>0?`+${W}`:W:""}`,description:De.trim()||null,total:ze.total,formula:ze.formula,crit:ze.crit}),La.set(!0),a(me).isOpen=!1}var ie=Co(),_t=t(ie);{var it=W=>{var ze=wo(),De=Ae(ze);yo(De,{get campaignName(){return a(ye).name},get gmName(){return a(ye).gmName},get activeSubTab(){return a(y)},onTabChange:q=>O(y,q,!0),onOpenSettings:()=>O(M,!0)});var We=s(De,2);{let q=ue(()=>JSON.stringify(a(ye)));Tr(We,{get isOpen(){return a(M)},get initialData(){return a(q)},onClose:()=>O(M,!1),onSave:Ie})}var tt=s(We,2),ut=t(tt);{var ae=q=>{rn(q,{get campaign(){return a(ye)}})},Pe=q=>{var $e=ht(),je=Ae($e);{var Me=Te=>{xo(Te,{get campId(){return a(X)}})};w(je,Te=>{a(y)==="bestiary"&&Te(Me)},!0)}v(q,$e)};w(ut,q=>{a(y)==="session"?q(ae):q(Pe,!1)})}e(tt),v(W,ze)},Ce=W=>{var ze=ht(),De=Ae(ze);{var We=ut=>{var ae=ko(),Pe=s(t(ae),2),q=t(Pe,!0);e(Pe);var $e=s(Pe,2),je=t($e,!0);e($e);var Me=s($e,2);Me.__click=()=>window.history.back();var Te=s(t(Me));e(Me),e(ae),b((dt,Ze,at)=>{r(q,dt),r(je,Ze),r(Te,` ${at??""}`)},[()=>P()("campaign.not_found.title"),()=>P()("campaign.not_found.message"),()=>P()("common.buttons.back")]),v(ut,ae)},tt=ut=>{var ae=zo();v(ut,ae)};w(De,ut=>{a(we)&&!a(ye)?ut(We):ut(tt,!1)},!0)}v(W,ze)};w(_t,W=>{a(we)&&a(ye)?W(it):W(Ce,!1)})}var Re=s(_t,2);er(Re,{get isOpen(){return p()},onClose:()=>La.set(!1)});var He=s(Re,2);{var Je=W=>{var ze=$o(),De=Ae(ze),We=t(De),tt=t(We);tt.__click=()=>{le(20),O(ee,!1)};var ut=s(t(tt),2);Xa(ut,{size:16}),e(tt);var ae=s(tt,2);ae.__click=()=>{le(6),O(ee,!1)};var Pe=s(t(ae),2);Xa(Pe,{size:16}),e(ae);var q=s(ae,2);q.__click=()=>{le(6,2),O(ee,!1)};var $e=s(t(q),2);Xa($e,{size:16}),e(q);var je=s(q,2);je.__click=()=>{le(6,3),O(ee,!1)};var Me=s(t(je),2);Xa(Me,{size:16}),e(je);var Te=s(je,4);Te.__click=()=>O(ee,!1);var dt=t(Te);Ra(dt,{size:20}),e(Te),e(We),e(De);var Ze=s(De,2);Ze.__click=()=>O(ee,!1),v(W,ze)};w(He,W=>{a(ee)&&W(Je)})}var Ke=s(He,2),fe=t(Ke);fe.__click=()=>O(ee,!a(ee));var Oe=t(fe);Xa(Oe,{size:32,class:"group-hover:rotate-12 transition-transform"}),e(fe),e(Ke);var te=s(Ke,2),Y=t(te),de=s(t(Y),2),K=t(de);K.__click=()=>{O(y,"session"),O(ee,!1)};var Ve=t(K);{let W=ue(()=>a(y)==="session"?"animate-in zoom-in-75 duration-300":"");ir(Ve,{size:20,get class(){return a(W)}})}Ca(2),e(K);var et=s(K,2),Ge=s(t(et),2);Ge.__click=()=>O(ee,!a(ee));var Pt=t(Ge);{let W=ue(()=>a(ee)?"rotate-90":"rotate-0");Xa(Pt,{size:28,get class(){return`text-white ${a(W)??""} transition-transform duration-300`}})}e(Ge),e(et);var lt=s(et,2);lt.__click=()=>{O(y,"bestiary"),O(ee,!1)};var zt=t(lt);{let W=ue(()=>a(y)==="bestiary"?"animate-in zoom-in-75 duration-300":"");lr(zt,{size:20,get class(){return a(W)}})}Ca(2),e(lt),e(de),e(Y),e(te);var yt=s(te,2);{let W=ue(()=>`${P()("session.quick.roll_title")} (${a(me).count}d${a(me).sides})`),ze=ue(()=>a(me).sides===20?P()("session.quick.boons_banes"):P()("session.quick.fixed_modifier"));Ir(yt,{get isOpen(){return a(me).isOpen},get title(){return a(W)},get label(){return a(ze)},onClose:()=>a(me).isOpen=!1,onRoll:ke,initialModifier:0})}e(ie),b(()=>{Ue(K,1,`flex flex-col items-center justify-center gap-1 flex-1 transition-all ${a(y)==="session"?"text-indigo-400":"text-slate-500 hover:text-slate-300"}`),Ue(lt,1,`flex flex-col items-center justify-center gap-1 flex-1 transition-all ${a(y)==="bestiary"?"text-indigo-400":"text-slate-500 hover:text-slate-300"}`)}),v(F,ie),Ea(),n()}Ma(["click"]);export{Qo as component};
