import"../chunks/DsnmJJEf.js";import{B as ht,o as Ae,k as v,p as ja,v as Ea,j as u,q as t,x as a,u as s,z as be,A as e,t as b,O as $s,w as O,y as Qe,n as Ca,a2 as Oa,at as Ua}from"../chunks/CeF9Pysg.js";import{d as Ma,s as r,o as Fs,g as Rs,e as Ha}from"../chunks/s5ZUjNrT.js";import{l as ga,s as ha,i as w,p as ra}from"../chunks/BO4Hk4Jc.js";import{e as Ie,s as Ue,i as ot,$ as ba,r as Ye,a as se,h as Ns,g as ur,j as br}from"../chunks/L5xVHH7A.js";import{a as Ia,s as kt}from"../chunks/BuEkqW-1.js";import{p as _r}from"../chunks/c14IY9v5.js";import{d as qs,m as zs,j as xr,c as Bs,e as Qt,n as As,o as pr,q as La,t as ks,u as xs,b as Je,v as Qs,f as Js,g as Ss,x as mr,y as fr,z as gr}from"../chunks/COofWgfh.js";import{C as Vs,D as Za,l as hr,b as Ps,c as Zs,a as yr}from"../chunks/BO5uUsVl.js";import{b as wr}from"../chunks/DzIHbexc.js";import{U as Xs,C as Gs,W as Ys,r as Ks}from"../chunks/CKwNSF78.js";import{A as kr,a as zr,b as ps,B as $r,T as Cr,E as Us,M as Or,G as Pa,H as er,C as tr,R as jr,c as Er,I as ar,s as sr,d as rr,L as Mr,S as ir,e as Ir,D as Xa,f as Sr}from"../chunks/C4KQCi_K.js";import{k as Hs}from"../chunks/53slW3xx.js";import{M as Rr,X as Ra,P as da,a as Ws,c as Nr,T as fa,b as Ar}from"../chunks/B9mfT_8k.js";import{C as nr,G as $a,P as Ds,S as Dr,a as Tr}from"../chunks/DbSKv2P5.js";import"../chunks/C3FPqVk7.js";import{I as ya,s as wa}from"../chunks/axHpSoOd.js";import{b as or}from"../chunks/CWVXqVlC.js";import{g as Pr}from"../chunks/D8jwWkXD.js";import{W as Ur}from"../chunks/7Z-uDSBK.js";function Hr(F,o){const i=ga(o,["children","$$slots","$$events","$$legacy"]);const Z=[["path",{d:"m6 9 6 6 6-6"}]];ya(F,ha({name:"chevron-down"},()=>i,{get iconNode(){return Z},children:(P,p)=>{var U=ht(),n=Ae(U);wa(n,o,"default",{}),v(P,U)},$$slots:{default:!0}}))}function Lr(F,o){const i=ga(o,["children","$$slots","$$events","$$legacy"]);const Z=[["path",{d:"m18 15-6-6-6 6"}]];ya(F,ha({name:"chevron-up"},()=>i,{get iconNode(){return Z},children:(P,p)=>{var U=ht(),n=Ae(U);wa(n,o,"default",{}),v(P,U)},$$slots:{default:!0}}))}function Fr(F,o){const i=ga(o,["children","$$slots","$$events","$$legacy"]);const Z=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"}]];ya(F,ha({name:"copy"},()=>i,{get iconNode(){return Z},children:(P,p)=>{var U=ht(),n=Ae(U);wa(n,o,"default",{}),v(P,U)},$$slots:{default:!0}}))}function qr(F,o){const i=ga(o,["children","$$slots","$$events","$$legacy"]);const Z=[["path",{d:"M12 3q1 4 4 6.5t3 5.5a1 1 0 0 1-14 0 5 5 0 0 1 1-3 1 1 0 0 0 5 0c0-2-1.5-3-1.5-5q0-2 2.5-4"}]];ya(F,ha({name:"flame"},()=>i,{get iconNode(){return Z},children:(P,p)=>{var U=ht(),n=Ae(U);wa(n,o,"default",{}),v(P,U)},$$slots:{default:!0}}))}function Br(F,o){const i=ga(o,["children","$$slots","$$events","$$legacy"]);const Z=[["circle",{cx:"9",cy:"12",r:"1"}],["circle",{cx:"9",cy:"5",r:"1"}],["circle",{cx:"9",cy:"19",r:"1"}],["circle",{cx:"15",cy:"12",r:"1"}],["circle",{cx:"15",cy:"5",r:"1"}],["circle",{cx:"15",cy:"19",r:"1"}]];ya(F,ha({name:"grip-vertical"},()=>i,{get iconNode(){return Z},children:(P,p)=>{var U=ht(),n=Ae(U);wa(n,o,"default",{}),v(P,U)},$$slots:{default:!0}}))}function Ts(F,o){const i=ga(o,["children","$$slots","$$events","$$legacy"]);const Z=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17"}]];ya(F,ha({name:"layers"},()=>i,{get iconNode(){return Z},children:(P,p)=>{var U=ht(),n=Ae(U);wa(n,o,"default",{}),v(P,U)},$$slots:{default:!0}}))}function lr(F,o){const i=ga(o,["children","$$slots","$$events","$$legacy"]);const Z=[["path",{d:"m16 6 4 14"}],["path",{d:"M12 6v14"}],["path",{d:"M8 8v12"}],["path",{d:"M4 4v16"}]];ya(F,ha({name:"library"},()=>i,{get iconNode(){return Z},children:(P,p)=>{var U=ht(),n=Ae(U);wa(n,o,"default",{}),v(P,U)},$$slots:{default:!0}}))}function Jr(F,o){const i=ga(o,["children","$$slots","$$events","$$legacy"]);const Z=[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3"}],["path",{d:"M21 21v.01"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7"}],["path",{d:"M3 12h.01"}],["path",{d:"M12 3h.01"}],["path",{d:"M12 16v.01"}],["path",{d:"M16 12h1"}],["path",{d:"M21 12v.01"}],["path",{d:"M12 21v-1"}]];ya(F,ha({name:"qr-code"},()=>i,{get iconNode(){return Z},children:(P,p)=>{var U=ht(),n=Ae(U);wa(n,o,"default",{}),v(P,U)},$$slots:{default:!0}}))}function Ls(F,o){const i=ga(o,["children","$$slots","$$events","$$legacy"]);const Z=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7"}]];ya(F,ha({name:"save"},()=>i,{get iconNode(){return Z},children:(P,p)=>{var U=ht(),n=Ae(U);wa(n,o,"default",{}),v(P,U)},$$slots:{default:!0}}))}function dr(F,o){const i=ga(o,["children","$$slots","$$events","$$legacy"]);const Z=[["polyline",{points:"14.5 17.5 3 6 3 3 6 3 17.5 14.5"}],["line",{x1:"13",x2:"19",y1:"19",y2:"13"}],["line",{x1:"16",x2:"20",y1:"16",y2:"20"}],["line",{x1:"19",x2:"21",y1:"21",y2:"19"}],["polyline",{points:"14.5 6.5 18 3 21 3 21 6 17.5 9.5"}],["line",{x1:"5",x2:"9",y1:"14",y2:"18"}],["line",{x1:"7",x2:"4",y1:"17",y2:"20"}],["line",{x1:"3",x2:"5",y1:"19",y2:"21"}]];ya(F,ha({name:"swords"},()=>i,{get iconNode(){return Z},children:(P,p)=>{var U=ht(),n=Ae(U);wa(n,o,"default",{}),v(P,U)},$$slots:{default:!0}}))}function Gr(F){let o=!1;return document.body&&(document.body.appendChild(F),o=!0),{destroy(){o&&F.parentNode&&F.parentNode.removeChild(F)}}}var Wr=u("<button> <!></button>"),Qr=u('<p class="text-xs text-slate-600 italic"> </p>'),Vr=u('<div class="text-xs leading-tight"><span class="text-red-400 font-bold"> </span> <span class="text-slate-400"> </span></div>'),Zr=u('<div class="space-y-1"></div>'),Xr=u('<div class="grid grid-cols-2 gap-2 max-h-[60vh] overflow-y-auto custom-scrollbar p-1"></div> <div class="mt-4 pt-3 border-t border-slate-800 flex flex-col gap-2"><div class="p-3 bg-slate-900/50 rounded-lg border border-slate-700/50 min-h-[60px]"><p class="text-[10px] text-slate-500 uppercase font-bold mb-1"> </p> <!></div> <div class="flex justify-end mt-2"><button class="bg-indigo-600 text-white px-4 py-2 rounded-xl font-bold text-sm shadow hover:bg-indigo-500 transition-colors w-full sm:w-auto"> </button></div></div>',1),Yr=u("<div><!></div>");function Kr(F,o){ja(o,!0);const i=()=>kt(ba,"$t",Z),[Z,P]=Ia();var p=ht(),U=Ae(p);{var n=y=>{var I=Yr(),X=t(I);{let ye=be(()=>i()("session.affliction_modal.title"));Rr(X,{get isOpen(){return o.isOpen},get onClose(){return o.onClose},get title(){return a(ye)},maxWidth:"max-w-md",children:(we,Se)=>{var ee=Xr(),fe=Ae(ee);Ie(fe,21,()=>Object.keys(kr),ot,(ge,Oe)=>{const te=be(()=>o.afflictions.includes(a(Oe)));var Y=Wr();Y.__click=()=>o.onToggle(a(Oe));var de=t(Y),K=s(de);{var Ve=tt=>{nr(tt,{size:14,class:"text-red-400"})};w(K,tt=>{a(te)&&tt(Ve)})}e(Y),b(tt=>{Ue(Y,1,`flex items-center justify-between px-3 py-2 rounded-lg border text-xs font-bold transition-all ${a(te)?"bg-red-500/20 border-red-500 text-red-100":"bg-slate-800 border-slate-700 text-slate-400 hover:bg-slate-750"}`),r(de,`${tt??""} `)},[()=>i()(`character.afflictions.${a(Oe)}`)]),v(ge,Y)}),e(fe);var le=s(fe,2),ke=t(le),ie=t(ke),xt=t(ie,!0);e(ie);var it=s(ie,2);{var Ce=ge=>{var Oe=Qr(),te=t(Oe,!0);e(Oe),b(Y=>r(te,Y),[()=>i()("session.affliction_modal.none_selected")]),v(ge,Oe)},Re=ge=>{var Oe=Zr();Ie(Oe,21,()=>o.afflictions,ot,(te,Y)=>{var de=Vr(),K=t(de),Ve=t(K);e(K);var tt=s(K,2),Ze=t(tt,!0);e(tt),e(de),b((Pt,lt)=>{r(Ve,`${Pt??""}:`),r(Ze,lt)},[()=>i()(`character.afflictions.${a(Y)}`),()=>i()(`sofww.afflictions.${a(Y).toLowerCase().replace(" ","_")}.effect`)]),v(te,de)}),e(Oe),v(ge,Oe)};w(it,ge=>{o.afflictions.length===0?ge(Ce):ge(Re,!1)})}e(ke);var He=s(ke,2),Ge=t(He);Ge.__click=function(...ge){o.onClose?.apply(this,ge)};var et=t(Ge,!0);e(Ge),e(He),e(le),b((ge,Oe)=>{r(xt,ge),r(et,Oe)},[()=>i()("session.affliction_modal.effects"),()=>i()("session.affliction_modal.done")]),v(we,ee)},$$slots:{default:!0}})}e(I),zr(I,ye=>Gr?.(ye)),v(y,I)};w(U,y=>{o.isOpen&&y(n)})}v(F,p),Ea(),P()}Ma(["click"]);var ei=u('<div class="absolute top-0 right-0 bg-gradient-to-l from-yellow-600/20 to-transparent border-l border-b border-yellow-500/30 text-yellow-500 text-[9px] font-black tracking-widest px-3 py-1 rounded-bl-xl z-20 uppercase shadow-[0_0_10px_rgba(234,179,8,0.2)]"> </div>'),ti=u('<div class="absolute inset-0 bg-red-950/40 animate-pulse z-0 pointer-events-none"></div>'),ai=u('<span class="text-[9px] font-black bg-red-950/40 text-red-500 px-1.5 py-0.5 rounded border border-red-900/30 uppercase tracking-wider flex-shrink-0"> </span>'),si=u("<button><!></button>"),ri=u('<button class="w-7 h-7 flex items-center justify-center rounded bg-slate-800/50 text-slate-600 hover:text-red-400 hover:bg-red-950/30 border border-slate-700/50 transition-colors"><!></button>'),ii=u('<div><div class="absolute inset-0 bg-gradient-to-b from-white/20 to-transparent"></div></div>'),ni=u('<div class="absolute inset-0 bg-gradient-to-r from-emerald-500/20 via-emerald-400/30 to-emerald-500/20 z-10"><div class="absolute inset-0 bg-gradient-to-b from-white/10 to-transparent"></div></div>'),oi=u('<div class="absolute inset-0 flex items-center justify-center pointer-events-none z-20"><span class="text-[9px] font-black uppercase text-white drop-shadow-[0_1px_1px_rgba(0,0,0,0.8)] tracking-widest leading-none mt-0.5"> </span></div>'),li=u('<div class="absolute inset-0 flex items-center justify-center pointer-events-none z-20"><span class="text-[9px] font-black uppercase text-white drop-shadow-[0_1px_1px_rgba(0,0,0,0.8)] tracking-widest leading-none mt-0.5"> </span></div>'),di=u('<div class="flex flex-col items-center justify-between bg-cyan-950/20 border border-cyan-500/30 rounded-lg p-1.5 w-[4.5rem] h-[3.75rem] shadow-sm"><span class="text-[9px] font-black text-cyan-400 uppercase tracking-wider mb-0.5"> </span> <span class="text-xl font-bold text-white font-mono leading-none"> </span></div>'),vi=u('<button class="text-[9px] bg-red-500/10 text-red-400 px-1.5 py-0.5 rounded border border-red-500/20 hover:bg-red-500/20 hover:border-red-500/40 transition-all flex items-center gap-1 group/btn"> <!></button>'),ci=u('<div class="bg-slate-900/50 p-2 rounded border border-slate-800/50 text-center"><span class="text-[9px] text-slate-500 uppercase font-black block mb-0.5"> </span> <div class="text-white font-bold font-mono text-lg leading-none"> </div> <div> </div></div>'),ui=u('<div class="grid grid-cols-2 gap-4 mb-4"><div class="p-3 rounded-xl bg-purple-950/20 border border-purple-500/30 flex justify-between items-center group/ins"><div><span class="text-[9px] text-purple-400 uppercase font-black block"> </span> <span class="text-white font-bold text-lg font-mono leading-none"> </span></div> <!></div> <div class="p-3 rounded-xl bg-red-950/20 border border-red-500/30 flex justify-between items-center group/cor"><div><span class="text-[9px] text-red-400 uppercase font-black block"> </span> <span class="text-white font-bold text-lg font-mono leading-none"> </span></div> <!></div></div>'),bi=u("<!> ",1),_i=u('<div><div class="text-emerald-500 text-[10px] font-black uppercase mb-2 flex items-center gap-2"> <span class="h-px flex-1 bg-current opacity-20"></span></div> <div class="flex flex-wrap gap-2"></div></div>'),xi=u('<div class="text-sm bg-slate-900/30 p-2 rounded border border-slate-800/30"><span class="font-bold text-slate-300"> </span> <span class="text-slate-400 text-xs block mt-1 leading-relaxed"> </span></div>'),pi=u('<div><div> <span class="h-px flex-1 bg-current opacity-20"></span></div> <div class="grid gap-2"></div></div>'),mi=u('<div class="border-t border-slate-800/50 bg-slate-950/30 p-4"><div class="mb-4"><div class="text-slate-500 font-bold uppercase text-[10px] mb-2 flex items-center gap-2"><span> </span> <div class="h-px flex-1 bg-slate-800"></div></div> <div class="grid grid-cols-4 gap-2"></div></div> <!> <div class="grid grid-cols-2 gap-4 mb-4"><div class="p-2 rounded bg-slate-900/50 border border-slate-800/50 flex flex-col items-center"><span class="text-[9px] text-slate-500 uppercase font-black"> </span> <span class="text-white font-bold"> </span></div> <div class="p-2 rounded bg-slate-900/50 border border-slate-800/50 flex flex-col items-center"><span class="text-[9px] text-slate-500 uppercase font-black"> </span> <span class="text-white font-bold"> </span></div></div> <div class="space-y-4"><!> <!></div></div>'),fi=u('<div><!> <!> <div class="relative z-10 p-4"><div class="flex items-start gap-4 mb-3"><div class="relative flex-shrink-0"><div><!></div> <button><!></button></div> <div class="flex-1 min-w-0"><div class="flex justify-between items-start mb-1"><div class="flex flex-col min-w-0 mr-2"><div class="flex items-center gap-2"><h3> </h3> <!></div></div> <div class="flex gap-1 flex-shrink-0"><button class="w-7 h-7 flex items-center justify-center rounded bg-slate-800 text-slate-500 hover:text-white hover:bg-slate-700 border border-slate-700/50 transition-colors"><!></button> <!></div></div>  <div class="relative w-full h-3.5 sm:h-4 bg-slate-950 rounded-full border border-white/5 overflow-hidden shadow-inner group-hover:border-white/20 transition-all mb-2"><div></div> <!> <!> <!></div> <div class="flex flex-col sm:flex-row gap-3"><div class="flex items-start gap-1.5"><div class="flex flex-col items-center justify-between bg-slate-900 border border-slate-700 rounded-lg p-1.5 w-[4.5rem] h-[3.75rem] shadow-sm"><span class="text-[9px] font-black text-slate-400 uppercase tracking-wider mb-0.5"> </span> <span class="text-xl font-bold text-white font-mono leading-none"> </span></div> <div class="flex flex-col items-center justify-between bg-red-950/30 border border-red-900/50 rounded-lg p-1.5 w-[4.5rem] h-[3.75rem] shadow-sm relative group/dmg"><span class="text-[9px] font-black text-red-400 uppercase tracking-wider mb-0.5"> </span> <input type="number" class="w-full bg-transparent text-center text-white font-mono font-bold text-xl focus:outline-none p-0 leading-none placeholder-red-800"/> <span class="absolute -top-1 -right-1 flex h-2 w-2 opacity-0 group-hover/dmg:opacity-100 transition-opacity"><span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-red-400 opacity-75"></span> <span class="relative inline-flex rounded-full h-2 w-2 bg-red-500"></span></span></div> <div><span> </span> <div class="flex items-baseline gap-0.5 justify-center w-full"><input type="number" class="w-full bg-transparent text-right text-white font-mono font-bold text-xl focus:outline-none p-0 leading-none"/> <span class="text-[10px] text-slate-500 font-mono self-end mb-0.5 opacity-70"> </span></div></div> <!></div> <div class="flex flex-wrap gap-1.5 items-center flex-1"><!> <button class="text-[10px] sm:text-[9px] font-bold text-slate-500 hover:text-indigo-400 px-1.5 py-0.5 rounded border border-transparent hover:border-indigo-500/30 hover:bg-indigo-500/10 transition-all flex items-center gap-1 whitespace-nowrap"><!> </button></div></div></div></div></div>  <!> <!></div>');function gi(F,o){ja(o,!0);const i=()=>kt(ba,"$t",Z),[Z,P]=Ia();let p=ra(o,"updateEnemy",3,(h,E)=>{}),U=ra(o,"updatePlayer",3,(h,E)=>{}),n=ra(o,"removeFromCombat",3,h=>{}),y=be(()=>o.entity.type==="player"),I=be(()=>o.entity.system==="sofdl"),X=be(()=>o.entity.damage||0),ye=be(()=>o.entity.normalHealth||o.entity.health||10),we=be(()=>o.entity.currentHealth??a(ye)),Se=be(()=>a(X)>=a(we)),ee=be(()=>a(X)>=a(we)/2&&!a(Se)),fe=be(()=>a(we)>0?Math.min(100,Math.max(0,a(X)/a(we)*100)):100),le=Qe(!1),ke=Qe(!1);$s(()=>{const h=o.entity.afflictions||[],E=h.includes("Incapacitated");if(a(Se)&&!E){const he={afflictions:[...h,"Incapacitated"]};o.entity.type==="player"?ie(he):p()(o.entity.instanceId,he)}else if(!a(Se)&&E){const he={afflictions:h.filter(Ke=>Ke!=="Incapacitated")};o.entity.type==="player"?ie(he):p()(o.entity.instanceId,he)}});function ie(h){if(o.entity.type!=="player")return;const E=qs.get(o.entity.id);E&&qs.set(o.entity.id,{...E,...h}),U()(o.entity.id,h),zs({id:o.entity.id,...h})}function xt(h){const E=parseInt(h.target.value);if(isNaN(E))return;const he={damage:Math.max(0,E)};o.entity.type==="player"?ie(he):p()(o.entity.instanceId,he)}function it(h){const E=parseInt(h.target.value);if(isNaN(E))return;const xe=Math.max(0,E);let he=a(X);xe<a(X)&&(he=xe);const Ke={currentHealth:xe,damage:he};o.entity.type==="player"?ie(Ke):p()(o.entity.instanceId,Ke)}function Ce(){const h=!o.entity.acted;o.entity.type==="player"?ie({acted:h}):p()(o.entity.instanceId,{acted:h})}function Re(){o.entity.type==="player"&&ie({initiative:!o.entity.initiative})}function He(h){const E=o.entity.afflictions||[],he={afflictions:E.includes(h)?E.filter(Ke=>Ke!==h):[...E,h]};o.entity.type==="player"?ie(he):p()(o.entity.instanceId,he)}var Ge=fi(),et=t(Ge);{var ge=h=>{var E=ei(),xe=t(E,!0);e(E),b(he=>r(xe,he),[()=>i()("session.combat_card.initiative")]),v(h,E)};w(et,h=>{a(y)&&o.entity.initiative&&h(ge)})}var Oe=s(et,2);{var te=h=>{var E=ti();v(h,E)};w(Oe,h=>{a(Se)&&h(te)})}var Y=s(Oe,2),de=t(Y),K=t(de),Ve=t(K),tt=t(Ve);Hs(tt,()=>o.entity.imageUrl,h=>{{let E=be(()=>o.entity.name.charAt(0));ps(h,{get hash(){return o.entity.imageUrl},get alt(){return o.entity.name},size:"custom",get fallbackText(){return a(E)}})}}),e(Ve);var Ze=s(Ve,2);Ze.__click=Ce;var Pt=t(Ze);{var lt=h=>{Ws(h,{size:14,class:""})},zt=h=>{var E=ht(),xe=Ae(E);{var he=jt=>{nr(jt,{size:14})},Ke=jt=>{dr(jt,{size:14})};w(xe,jt=>{o.entity.acted?jt(he):jt(Ke,!1)},!0)}v(h,E)};w(Pt,h=>{a(Se)?h(lt):h(zt,!1)})}e(Ze),e(K);var yt=s(K,2),G=t(yt),ze=t(G),De=t(ze),We=t(De),at=t(We,!0);e(We);var bt=s(We,2);{var ae=h=>{var E=ai(),xe=t(E);e(E),b(()=>r(xe,`Dif ${o.entity.difficulty??""}`)),v(h,E)};w(bt,h=>{a(y)||h(ae)})}e(De),e(ze);var Pe=s(ze,2),q=t(Pe);q.__click=()=>O(le,!a(le));var $e=t(q);{var je=h=>{Lr(h,{size:14})},Me=h=>{Hr(h,{size:14})};w($e,h=>{a(le)?h(je):h(Me,!1)})}e(q);var Te=s(q,2);{var dt=h=>{var E=si();E.__click=Re;var xe=t(E);qr(xe,{size:14}),e(E),b(he=>{Ue(E,1,`w-7 h-7 flex items-center justify-center rounded transition-all ${o.entity.initiative?"bg-yellow-500 text-yellow-950 shadow-lg shadow-yellow-500/20":"bg-slate-800 text-slate-500 hover:text-white hover:bg-slate-700"}`),se(E,"title",he)},[()=>i()("session.combat_card.initiative")]),v(h,E)},Xe=h=>{var E=ri();E.__click=()=>n()(o.entity.instanceId);var xe=t(E);Ra(xe,{size:14}),e(E),v(h,E)};w(Te,h=>{a(y)?h(dt):h(Xe,!1)})}e(Pe),e(G);var st=s(G,2),pt=t(st),$t=s(pt,2);{var It=h=>{var E=ii();b(()=>{Ue(E,1,`absolute top-0 left-0 h-full transition-all duration-500 ease-out z-10
                            ${a(Se)?"bg-gradient-to-r from-red-600 via-red-500 to-rose-500 animate-pulse":a(fe)>=80?"bg-gradient-to-r from-red-600 to-rose-500":a(ee)?"bg-gradient-to-r from-amber-600 to-orange-500":"bg-gradient-to-r from-orange-500 to-amber-400"}`),ur(E,`width: ${a(fe)??""}%`)}),v(h,E)};w($t,h=>{a(fe)>0&&h(It)})}var St=s($t,2);{var M=h=>{var E=ni();v(h,E)};w(St,h=>{a(X)===0&&h(M)})}var L=s(St,2);{var ve=h=>{var E=oi(),xe=t(E),he=t(xe,!0);e(xe),e(E),b(Ke=>r(he,Ke),[()=>i()("session.combat_card.incapacitated")]),v(h,E)},qe=h=>{var E=ht(),xe=Ae(E);{var he=Ke=>{var jt=li(),Wt=t(jt),ma=t(Wt,!0);e(Wt),e(jt),b(_a=>r(ma,_a),[()=>i()("session.combat_card.injured")]),v(Ke,jt)};w(xe,Ke=>{a(ee)&&Ke(he)},!0)}v(h,E)};w(L,h=>{a(Se)?h(ve):h(qe,!1)})}e(st);var vt=s(st,2),ct=t(vt),ut=t(ct),Bt=t(ut),Xt=t(Bt,!0);e(Bt);var Yt=s(Bt,2),Kt=t(Yt,!0);e(Yt),e(ut);var Vt=s(ut,2),ea=t(Vt),ia=t(ea,!0);e(ea);var Ut=s(ea,2);Ye(Ut),Ut.__input=xt,Ca(2),e(Vt);var wt=s(Vt,2),Jt=t(wt),Rt=t(Jt,!0);e(Jt);var Gt=s(Jt,2),rt=t(Gt);Ye(rt),rt.__input=it;var Ct=s(rt,2),Le=t(Ct);e(Ct),e(Gt),e(wt);var Ot=s(wt,2);{var ta=h=>{var E=di(),xe=t(E),he=t(xe,!0);e(xe);var Ke=s(xe,2),jt=t(Ke,!0);e(Ke),e(E),b(Wt=>{r(he,Wt),r(jt,o.entity.perception||10)},[()=>i()("sofdl.attributes.perception")]),v(h,E)};w(Ot,h=>{a(I)&&h(ta)})}e(ct);var Ht=s(ct,2),Nt=t(Ht);Ie(Nt,17,()=>o.entity.afflictions||[],ot,(h,E)=>{var xe=vi();xe.__click=()=>He(a(E));var he=t(xe),Ke=s(he);Ra(Ke,{size:8,class:"opacity-50 group-hover/btn:opacity-100"}),e(xe),b(()=>r(he,`${a(E)??""} `)),v(h,xe)});var At=s(Nt,2);At.__click=()=>O(ke,!0);var sa=t(At);da(sa,{size:10});var aa=s(sa);e(At),e(Ht),e(vt),e(yt),e(de),e(Y);var na=s(Y,2);{var pa=h=>{var E=mi(),xe=t(E),he=t(xe),Ke=t(he),jt=t(Ke,!0);e(Ke),Ca(2),e(he);var Wt=s(he,2);Ie(Wt,21,()=>a(I)?["strength","agility","intellect","will"]:["str","agi","int","wil"],ot,(j,z)=>{const Q=be(()=>a(I)?o.entity.attributes?.[a(z)]??10:o.entity.stats?.[a(z)]??o.entity.attributes?.[a(z)]??10),re=be(()=>a(Q)-10);var ue=ci(),J=t(ue),pe=t(J,!0);e(J);var _=s(J,2),$=t(_,!0);e(_);var f=s(_,2),T=t(f);e(f),e(ue),b(S=>{r(pe,S),r($,a(Q)),Ue(f,1,`text-[9px] font-bold ${a(re)>=0?"text-emerald-500":"text-red-500"}`),r(T,`${a(re)>=0?"+":""}${a(re)??""}`)},[()=>a(I)?a(z).slice(0,3):a(z)]),v(j,ue)}),e(Wt),e(xe);var ma=s(xe,2);{var _a=j=>{var z=ui(),Q=t(z),re=t(Q),ue=t(re),J=t(ue,!0);e(ue);var pe=s(ue,2),_=t(pe,!0);e(pe),e(re);var $=s(re,2);$r($,{size:20,class:"text-purple-500/30 group-hover/ins:text-purple-500 transition-colors"}),e(Q);var f=s(Q,2),T=t(f),S=t(T),m=t(S,!0);e(S);var x=s(S,2),N=t(x,!0);e(x),e(T);var A=s(T,2);Ws(A,{size:20,class:"text-red-500/30 group-hover/cor:text-red-500 transition-colors"}),e(f),e(z),b((ne,H)=>{r(J,ne),r(_,o.entity.insanity||0),r(m,H),r(N,o.entity.corruption||0)},[()=>i()("sofdl.attributes.insanity"),()=>i()("sofdl.attributes.corruption")]),v(j,z)};w(ma,j=>{a(I)&&j(_a)})}var xa=s(ma,2),va=t(xa),ka=t(va),B=t(ka,!0);e(ka);var W=s(ka,2),ce=t(W,!0);e(W),e(va);var Fe=s(va,2),l=t(Fe),d=t(l,!0);e(l);var c=s(l,2),g=t(c,!0);e(c),e(Fe),e(xa);var D=s(xa,2),C=t(D);{var k=j=>{var z=_i(),Q=t(z),re=t(Q);Ca(),e(Q);var ue=s(Q,2);Ie(ue,21,()=>o.entity.senses,ot,(J,pe)=>{const _=be(()=>{const[T,S]=a(pe).split(":");return{key:T,val:S}}),$=be(()=>i()(`character.senses.list.${a(_).key}`)+(a(_).val?` ${a(_).val}`:"")),f=be(()=>i()(`character.senses.descriptions.${a(_).key}`));Cr(J,{get text(){return a(f)},class:"text-xs bg-emerald-950/30 text-emerald-200 px-3 py-1.5 rounded border border-emerald-900/50 font-bold flex items-center gap-2 cursor-help whitespace-nowrap",children:(T,S)=>{var m=bi(),x=Ae(m);Us(x,{size:12,class:"text-emerald-500 flex-shrink-0"});var N=s(x);b(()=>r(N,` ${a($)??""}`)),v(T,m)},$$slots:{default:!0}})}),e(ue),e(z),b(J=>r(re,`${J??""} `),[()=>i()("character.senses.title")]),v(j,z)};w(C,j=>{o.entity.senses&&o.entity.senses.length>0&&j(k)})}var R=s(C,2);Ie(R,16,()=>[{key:"traits",label:"Traços",color:"text-amber-500"},{key:"actions",label:"Ações",color:"text-red-400"},{key:"reactions",label:"Reações",color:"text-indigo-400"},{key:"end_of_round",label:"Fim da Rodada",color:"text-emerald-400"}],ot,(j,z)=>{var Q=ht(),re=Ae(Q);{var ue=J=>{var pe=pi(),_=t(pe),$=t(_);Ca(),e(_);var f=s(_,2);Ie(f,21,()=>o.entity[z.key],ot,(T,S)=>{var m=xi(),x=t(m),N=t(x,!0);e(x);var A=s(x,2),ne=t(A,!0);e(A),e(m),b(()=>{r(N,a(S).name),r(ne,a(S).description||a(S).effect)}),v(T,m)}),e(f),e(pe),b(()=>{Ue(_,1,`${z.color??""} text-[10px] font-black uppercase mb-2 flex items-center gap-2`),r($,`${z.label??""} `)}),v(J,pe)};w(re,J=>{o.entity[z.key]&&o.entity[z.key].length>0&&J(ue)})}v(j,Q)}),e(D),e(E),b((j,z,Q)=>{r(jt,j),r(B,z),r(ce,o.entity.size||1),r(d,Q),r(g,o.entity.speed||10)},[()=>i()("session.combat_card.attributes"),()=>i()("session.combat_card.size"),()=>i()("session.combat_card.speed")]),v(h,E)};w(na,h=>{a(le)&&h(pa)})}var Sa=s(na,2);{let h=be(()=>o.entity.afflictions||[]);Kr(Sa,{get isOpen(){return a(ke)},onClose:()=>O(ke,!1),get afflictions(){return a(h)},onToggle:He})}e(Ge),b((h,E,xe,he,Ke)=>{Ue(Ge,1,`group relative overflow-hidden transition-all duration-300 rounded-2xl border ${a(y)?"bg-slate-900/80 border-indigo-500/30 hover:border-indigo-500/50 hover:shadow-indigo-900/20":"bg-slate-950/80 border-red-900/30 hover:border-red-800/50 hover:shadow-red-900/10"} shadow-lg backdrop-blur-sm`),Ue(Ve,1,`w-14 h-14 rounded-2xl overflow-hidden border-2 shadow-xl transition-transform group-hover:scale-105 ${a(Se)?"border-red-600 grayscale brightness-50":a(y)?"border-indigo-500/50":"border-red-900/50"}`),Ue(Ze,1,`absolute -bottom-2 -right-2 w-7 h-7 rounded-lg flex items-center justify-center border shadow-lg transition-all hover:scale-110 z-20 ${o.entity.acted?"bg-slate-800 border-slate-600 text-slate-500":a(y)?"bg-indigo-600 border-indigo-400 text-white":"bg-red-600 border-red-400 text-white"}`),se(Ze,"title",h),Ue(We,1,`text-base font-bold truncate leading-snug ${a(y)?"text-white":"text-red-100 font-serif tracking-wide"}`),r(at,o.entity.name),Ue(pt,1,`absolute inset-0 w-full ${a(X)===0?"bg-emerald-900/20":"bg-slate-900/50"}`),r(Xt,E),r(Kt,o.entity.defense||10),r(ia,xe),Ns(Ut,a(X)),Ue(wt,1,`flex flex-col items-center justify-between border rounded-lg p-1.5 w-[5.5rem] h-[3.75rem] shadow-sm relative transition-colors ${a(Se)?"bg-red-950/50 border-red-500":a(ee)?"bg-orange-950/30 border-orange-500":"bg-emerald-950/30 border-emerald-900/50"}`),Ue(Jt,1,`text-[9px] font-black uppercase tracking-wider mb-0.5 ${a(Se)?"text-red-400":a(ee)?"text-orange-400":"text-emerald-400"}`),r(Rt,he),Ns(rt,a(we)),r(Le,`/${a(ye)??""}`),r(aa,` ${Ke??""}`)},[()=>o.entity.acted?i()("session.combat_card.acted"):i()("session.combat_card.act"),()=>i()("session.combat_card.defense"),()=>i()("session.combat_card.damage"),()=>i()("session.combat_card.health"),()=>i()("session.combat_card.add_affliction")]),v(F,Ge),Ea(),P()}Ma(["click","input"]);function hi(F,{from:o,to:i},Z={}){var{delay:P=0,duration:p=Re=>Math.sqrt(Re)*120,easing:U=Nr}=Z,n=getComputedStyle(F),y=n.transform==="none"?"":n.transform,[I,X]=n.transformOrigin.split(" ").map(parseFloat);I/=F.clientWidth,X/=F.clientHeight;var ye=yi(F),we=F.clientWidth/i.width/ye,Se=F.clientHeight/i.height/ye,ee=o.left+o.width*I,fe=o.top+o.height*X,le=i.left+i.width*I,ke=i.top+i.height*X,ie=(ee-le)*we,xt=(fe-ke)*Se,it=o.width/i.width,Ce=o.height/i.height;return{delay:P,duration:typeof p=="function"?p(Math.sqrt(ie*ie+xt*xt)):p,easing:U,css:(Re,He)=>{var Ge=He*ie,et=He*xt,ge=Re+He*it,Oe=Re+He*Ce;return`transform: ${y} translate(${Ge}px, ${et}px) scale(${ge}, ${Oe});`}}}function yi(F){if("currentCSSZoom"in F)return F.currentCSSZoom;for(var o=F,i=1;o!==null;)i*=+getComputedStyle(o).zoom,o=o.parentElement;return i}function wi(F,o=1,i=0){const Z=[];let P=0;for(let y=0;y<o;y++){const I=Math.floor(Math.random()*F)+1;Z.push(I),P+=I}let p=`${o}d${F}`,U=[],n=0;if(i!==0)if(F===20){const y=Math.abs(i);for(let X=0;X<y;X++)U.push(Math.floor(Math.random()*6)+1);const I=Math.max(...U);i>0?(n=I,P+=I,p+=` + ${I} [Boon]`):(n=-I,P-=I,p+=` - ${I} [Bane]`)}else n=i,P+=i,p+=i>0?` + ${i}`:` - ${Math.abs(i)}`;return{total:P,results:Z,bonusRolls:U,formula:p,crit:F===20&&Z.includes(20),modifierTotal:n}}function ki(F,o,i){const Z=i.map(y=>({...y,type:"enemy"}));if(F==="standard"){const y=o.filter(we=>we.initiative).map(we=>({...we,type:"player",isFast:!0})),I=o.filter(we=>!we.initiative).map(we=>({...we,type:"player",isFast:!1})),X=Z.filter(we=>we.initiative).map(we=>({...we,isFast:!0})),ye=Z.filter(we=>!we.initiative).map(we=>({...we,isFast:!1}));return[...y,...X,...I,...ye]}if(F==="individual")return[...o.map(I=>({...I,type:"player",totalInit:(I.initiativeRoll||0)+(I.attributes?.agility||10)-10})),...Z.map(I=>({...I,type:"enemy",totalInit:(I.initiativeRoll||0)+(I.attributes?.agility||10)-10}))].sort((I,X)=>X.totalInit-I.totalInit);const P=o.filter(y=>y&&y.initiative).map(y=>({...y,type:"player"})),p=o.filter(y=>y&&!y.initiative).map(y=>({...y,type:"player"})),U=[...P,...Z,...p],n=new Set;return U.filter(y=>{if(!y)return!1;const I=y.type==="player"?y.id:y.instanceId;return n.has(I)?!1:(n.add(I),!0)})}var zi=u('<span class="text-[10px] bg-slate-800 text-slate-400 px-1.5 py-0.5 rounded-full"> </span>'),$i=u('<div class="p-3 rounded-xl border border-amber-500/30 bg-amber-500/5 flex items-center gap-3 transition-all hover:bg-amber-500/10 shadow-sm"><div class="flex-1"><div class="font-bold text-sm text-amber-200 leading-none"> </div> <div class="text-[9px] text-amber-500/60 font-medium mt-1 uppercase tracking-tighter"> </div></div> <div class="flex items-center gap-1.5"><button class="p-2 rounded-lg bg-green-600/20 text-green-400 hover:bg-green-600 hover:text-white transition-all shadow-lg active:scale-90" title="Aprovar"><!></button> <button class="p-2 rounded-lg bg-red-600/20 text-red-400 hover:bg-red-600 hover:text-white transition-all shadow-lg active:scale-90" title="Recusar"><!></button></div></div>'),Ci=u('<div class="space-y-2 animate-in fade-in slide-in-from-top-2"><div class="flex items-center gap-2 px-1"><div class="w-1.5 h-1.5 rounded-full bg-amber-500 animate-pulse"></div> <span class="text-[10px] font-black text-amber-500 uppercase tracking-wider"> </span></div> <!> <div class="h-px bg-slate-800/50 mx-2 my-2"></div></div>'),Oi=u('<span class="text-indigo-400 font-bold uppercase tracking-tighter mr-1"> </span>'),ji=u('<div><div></div> <div class="flex-1"><div> </div> <div class="text-[10px] text-slate-500 font-medium"><!> </div></div> <div class="flex items-center gap-1"><button><!></button> <button class="text-slate-600 hover:text-red-400 p-1.5 hover:bg-red-400/10 rounded-lg transition-all"><!></button></div></div>'),Ei=u('<div class="text-xs text-slate-600 italic p-6 border-2 border-dashed border-slate-800 rounded-xl text-center"> </div>'),Mi=u('<button class="w-full bg-indigo-600 hover:bg-indigo-500 text-white py-3 rounded-xl font-black uppercase text-[10px] tracking-[0.2em] shadow-lg shadow-indigo-900/20 transition-all active:scale-[0.98] flex items-center justify-center gap-2"><!> </button> <p class="text-[9px] text-slate-600 text-center font-bold uppercase tracking-tighter"> </p>',1),Ii=u('<div class="flex justify-center p-3 bg-white rounded-xl mb-2 animate-in zoom-in-95 duration-200 shadow-xl mx-auto w-32 h-32"><img class="w-24 h-24"/></div>'),Si=u('<div class="absolute bottom-full left-1/2 -translate-x-1/2 mb-2 px-2 py-1 bg-green-500 text-white text-[10px] font-bold rounded shadow-lg animate-in fade-in slide-in-from-bottom-1 whitespace-nowrap"><!> </div>'),Ri=u('<div class="flex items-center justify-between"><div class="flex items-center gap-2"><span class="text-[10px] font-black text-indigo-400 uppercase tracking-widest flex items-center gap-1"><!> </span></div> <button class="text-slate-500 hover:text-white transition-colors p-1"><!></button></div> <!> <div class="relative group"><div class="flex gap-1"><div class="flex-1 bg-slate-950 border border-slate-800 rounded-lg p-2 text-[10px] text-slate-400 font-mono truncate cursor-pointer hover:border-slate-700 transition-colors flex items-center"> </div> <button class="bg-indigo-600 hover:bg-indigo-500 text-white p-2 rounded-lg transition-all active:scale-95 shadow-lg shadow-indigo-900/20 relative"><!> <!></button></div></div> <button class="w-full text-[9px] text-slate-600 hover:text-red-400 font-bold uppercase tracking-widest transition-colors mt-1"> </button>',1),Ni=u('<div class="flex justify-between items-center bg-slate-950 p-2 rounded border border-slate-800 group hover:border-indigo-500/30 transition-all cursor-move hover:bg-slate-800/50" draggable="true"><div class="truncate flex-1 flex items-center gap-2"><!> <div class="min-w-0 flex-1"><div class="text-sm font-bold text-white truncate flex items-center gap-1"> <!></div> <div class="text-[10px] text-slate-500"> </div></div></div> <button class="text-slate-500 hover:text-indigo-400 p-1 ml-2 bg-slate-900 rounded border border-slate-800 hover:bg-slate-800"><!></button></div>'),Ai=u('<div class="text-center text-slate-600 italic text-xs mt-4"> </div>'),Di=u("<!> <!>",1),Ti=u('<div class="flex justify-between items-center bg-slate-950 p-2 rounded border border-slate-800 group hover:border-indigo-500/30 transition-all cursor-move hover:bg-slate-800/50" draggable="true"><div class="truncate flex-1"><div class="text-sm font-bold text-white truncate flex items-center gap-1"> <!></div> <div class="text-[10px] text-slate-500"> </div></div> <button class="text-slate-500 hover:text-indigo-400 p-1 ml-2 bg-slate-900 rounded border border-slate-800 hover:bg-slate-800"><!></button></div>'),Pi=u('<div class="text-center text-slate-600 italic text-xs mt-4"> </div>'),Ui=u("<!> <!>",1),Hi=u('<button class="bg-green-600 hover:bg-green-500 text-white px-6 py-2 rounded-lg font-bold flex items-center gap-2 shadow-lg shadow-green-900/20"><!> </button>'),Li=u('<div class="flex items-center gap-4"><button class="p-2 hover:bg-slate-700 rounded text-slate-400"><!></button> <div class="text-center"><div class="text-[10px] font-bold text-slate-500 uppercase"> </div><div class="text-3xl font-mono font-bold text-white leading-none"> </div></div> <button class="bg-indigo-600 hover:bg-indigo-500 text-white px-4 py-2 rounded font-bold flex items-center gap-2"><!> </button> <div class="h-8 w-px bg-slate-700 mx-2"></div> <button class="text-red-400 hover:text-red-300 text-xs font-bold px-3 py-2 border border-red-900/30 rounded bg-red-900/10"> </button></div>'),Fi=u("<div><!></div>"),qi=u('<div class="text-center text-slate-500 italic py-10"> </div>'),Bi=u('<div class="text-sm"><span class="font-bold text-yellow-500"> </span> <span class="text-slate-300"> </span></div>'),Ji=u('<div class="bg-slate-900 border border-slate-700 rounded-lg p-4"><h4 class="font-bold text-white mb-2 pb-2 border-b border-slate-800 flex items-center gap-2"><!> </h4> <div class="space-y-2"></div></div>'),Gi=u('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/80 p-4" role="button" aria-label="Fechar" tabindex="-1"><div class="bg-slate-800 rounded-xl w-full max-w-lg border border-slate-700 shadow-2xl p-6 relative" role="dialog" aria-modal="true"><div class="flex items-center gap-3 mb-6"><div class="p-3 bg-yellow-900/20 rounded-full border border-yellow-500/30 text-yellow-500"><!></div> <div><h3 class="font-bold text-white text-xl"> </h3> <p class="text-slate-400 text-sm"> </p></div></div> <div class="space-y-4 mb-8 max-h-[60vh] overflow-y-auto custom-scrollbar"></div> <div class="flex gap-3"><button class="flex-1 py-1.5 rounded bg-slate-700 hover:bg-slate-600 text-white font-bold text-sm"> </button> <button class="flex-1 py-1.5 rounded bg-indigo-600 hover:bg-indigo-500 text-white font-bold text-sm"> </button></div></div></div>'),Wi=u('<button class="w-full text-left flex items-center gap-3 p-3 bg-slate-900 border border-slate-700 hover:border-indigo-500 hover:bg-indigo-500/10 rounded-xl group transition-all"><div class="w-10 h-10 rounded-full bg-slate-800 flex items-center justify-center text-sm font-bold text-slate-500 group-hover:text-indigo-400 border border-slate-700 group-hover:border-indigo-500/30"> </div> <div class="flex-1"><div class="font-bold text-white group-hover:text-indigo-300"> </div> <div class="text-[10px] text-slate-500"> </div></div> <div class="bg-slate-800 p-2 rounded-lg text-slate-500 group-hover:bg-indigo-500 group-hover:text-white transition-colors"><!></div></button>'),Qi=u('<div class="text-center py-8"><div class="w-12 h-12 bg-slate-700/50 rounded-full flex items-center justify-center mx-auto mb-3 text-slate-500"><!></div> <p class="text-slate-500 text-sm font-bold"> </p> <p class="text-[10px] text-slate-600 mt-1"> </p></div>'),Vi=u('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/80 p-4" role="button" aria-label="Fechar" tabindex="-1"><div class="bg-slate-800 rounded-xl w-full max-w-md border border-slate-700 shadow-2xl p-6" role="dialog" aria-modal="true"><div class="flex justify-between items-center mb-6"><div><h3 class="font-bold text-white text-lg"> </h3> <p class="text-xs text-slate-400"> </p></div> <button class="bg-slate-700 hover:bg-slate-600 p-2 rounded-lg text-white transition-colors"><!></button></div> <div class="space-y-3 max-h-[60vh] overflow-y-auto custom-scrollbar pr-2"><!> <!></div></div></div>'),Zi=u('<div class="flex justify-between items-center bg-slate-950 p-3 rounded-xl border border-slate-800 group active:border-indigo-500/50 transition-all"><div class="truncate flex-1 flex flex-col"><div class="text-sm font-bold text-white truncate flex items-center gap-1"> <!></div> <div class="text-[10px] text-slate-500"> </div></div> <button class="text-white hover:bg-indigo-600 p-2 bg-slate-800 rounded-lg border border-slate-700"><!></button></div>'),Xi=u('<div class="text-center text-slate-600 italic text-xs mt-4"> </div>'),Yi=u("<!> <!>",1),Ki=u('<div class="flex justify-between items-center bg-slate-950 p-3 rounded-xl border border-slate-800 group active:border-indigo-500/50 transition-all"><div class="truncate flex-1"><div class="text-sm font-bold text-white truncate flex items-center gap-1"> <!></div> <div class="text-[10px] text-slate-500"> </div></div> <button class="text-white hover:bg-indigo-600 p-2 bg-slate-800 rounded-lg border border-slate-700"><!></button></div>'),en=u('<div class="text-center text-slate-600 italic text-xs mt-4"> </div>'),tn=u("<!> <!>",1),an=u('<div class="fixed inset-0 z-50 flex justify-end bg-black/60"><div class="w-full max-w-[300px] h-full bg-slate-900 border-l border-slate-800 p-4 shadow-2xl animate-in slide-in-from-right duration-300"><div class="flex justify-between items-center mb-4"><h3 class="font-bold text-white uppercase tracking-widest text-sm flex items-center gap-2"><!> </h3> <button class="bg-slate-800 p-2 rounded-lg text-slate-400 hover:text-white"><!></button></div> <div class="flex items-center gap-2 mb-3 bg-slate-950 p-1 rounded-lg border border-slate-800"><button><!> </button> <button><!> </button></div> <div class="h-[calc(100%-100px)] overflow-y-auto custom-scrollbar space-y-2"><!></div></div></div>'),sn=u('<div class="grid grid-cols-1 lg:grid-cols-4 gap-6 h-full relative"><div class="space-y-6"><div class="bg-slate-900 border border-slate-800 rounded-xl p-4 flex flex-col gap-4"><div class="flex justify-between items-center bg-slate-950/50 p-2 rounded-lg border border-slate-800"><h3 class="text-xs font-black text-slate-500 uppercase tracking-widest flex items-center gap-2"><!> <!></h3> <button class="text-[10px] bg-slate-800 hover:bg-slate-700 text-white px-2.5 py-1.5 rounded-md font-bold transition-all border border-slate-700 active:scale-95"> </button></div> <!> <div class="space-y-2 flex-1 overflow-y-auto max-h-[300px] custom-scrollbar pr-1"><div class="space-y-2"><!> <!></div></div> <div class="pt-4 border-t border-slate-800 space-y-3"><!></div></div> <div class="hidden lg:flex flex-col h-[400px] bg-slate-900 border border-slate-800 rounded-xl p-4"><div class="flex items-center gap-2 mb-3 bg-slate-950 p-1 rounded-lg border border-slate-800"><button><!> </button> <button><!> </button></div> <div class="flex-1 overflow-y-auto pr-1 custom-scrollbar space-y-2"><!></div></div></div> <div class="lg:col-span-2 space-y-4" role="region" aria-label="Combat Zone"><div class="bg-slate-900 border border-slate-800 rounded-xl p-4 flex justify-between items-center shadow-lg sticky top-0 z-20"><div class="flex items-center gap-4"><!></div></div> <div class="space-y-3 pb-20"><!> <!></div></div> <div class="hidden lg:flex flex-col gap-4"></div></div> <!> <!> <!> <button class="lg:hidden fixed bottom-24 right-4 bg-slate-800 text-white p-3 rounded-full shadow-lg border border-slate-700 z-40 active:scale-90 transition-transform" aria-label="Add Enemy"><!></button> <!> <!>',1);function rn(F,o){ja(o,!0);const i=()=>kt(hr,"$liveCharacters",n),Z=()=>kt(Ps,"$liveEnemies",n),P=()=>kt(Zs,"$liveEncounters",n),p=()=>kt(ba,"$t",n),U=()=>kt(La,"$isHistoryOpen",n),[n,y]=Ia();let I=Qe(!1),X=Qe(!1),ye=Qe(!1),we=Qe(!1);const Se={active:!1,round:1};let ee=Qe("enemies"),fe=Qe(!1),le=Qe(Oa([])),ke=Qe(Oa({isOpen:!1,title:"",message:"",onConfirm:()=>{}}));Fs(()=>{if(o.campaign?.id){xr(o.campaign.id,!0);const l=Rs(ba)("common.labels.master");Bs.update(c=>({...c,campaignId:o.campaign.id,name:o.campaign.gmName||l}));const d=setInterval(()=>{const c=Qt.get(o.campaign.id)||o.campaign,g=Rs(ba)("common.labels.master");As(o.campaign.id,{name:c.name,gmName:c.gmName||g})},3e4);return()=>{clearInterval(d),pr(),Bs.update(c=>({...c,campaignId:null}))}}});const ie=be(()=>typeof window<"u"?`${window.location.origin}${Ks("/campaigns/[id]/invite",{id:o.campaign?.id})}`:"");function xt(){a(ie)&&(navigator.clipboard.writeText(a(ie)),O(ye,!0),setTimeout(()=>{O(ye,!1)},2e3))}let it=be(()=>o.campaign?.sessionRoster||[]),Ce=be(()=>o.campaign?.combat||Se),Re=be(()=>o.campaign?.activeEnemies||[]),He=be(()=>o.campaign?.members||[]),Ge=be(()=>o.campaign?.initiativeStyle||"dle"),et=be(()=>Array.from(new Set([...a(it),...a(He).map(d=>d.id)])).map(d=>{const c=i().find(D=>D.id===d),g=a(He).find(D=>D.id===d);return c&&g?{...c,...g,lastUpdate:g.lastUpdate}:c||g}).filter(Boolean)),ge=be(()=>a(et).filter(l=>!l.campaignApproval||l.campaignApproval==="approved")),Oe=be(()=>a(et).filter(l=>l.campaignApproval==="pending")),te=be(()=>i().filter(l=>!a(it).includes(l.id)&&!a(He).some(d=>d.id===l.id)&&(l.system||Za)===(o.campaign?.system||Za))),Y=be(()=>Z().filter(l=>{const d=(l.system||Za)===(o.campaign?.system||Za),c=l.campaignId===o.campaign?.id||l.global;return d&&c})),de=be(()=>P().filter(l=>(l.system||Za)===(o.campaign?.system||Za)&&!0));function K(l){if(!o.campaign?.id)return;const c={...Qt.get(o.campaign.id)||o.campaign,...l};Qt.set(o.campaign.id,c),l.combat&&ks(o.campaign.id,l.combat),(l.name||l.gmName)&&As(o.campaign.id,{name:c.name,gmName:c.gmName})}function Ve(l){if(a(it).includes(l)){const d=a(it).filter(c=>c!==l);K({sessionRoster:d})}else{const d=[...a(it),l];K({sessionRoster:d})}}function tt(l){$e(l,{campaignApproval:"approved"}),zs({id:l,campaignApproval:"approved"})}function Ze(l){zs({id:l,campaignApproval:"rejected",campaignId:null});const c=((Qt.get(o.campaign.id)||o.campaign).members||[]).filter(g=>g.id!==l);K({members:c})}function Pt(l){const d=a(et).find(c=>c.id===l);O(ke,{isOpen:!0,title:p()("session.players.remove_title"),message:p()("session.players.remove_message",{values:{name:d?.name||"este personagem"}}),onConfirm:()=>{const c=Qt.get(o.campaign.id)||o.campaign;zs({id:l,campaignId:null});const g=(c.sessionRoster||[]).filter(k=>k!==l),D=(c.members||[]).filter(k=>k.id!==l),C=(c.activeEnemies||[]).filter(k=>k.type!=="player"||k.id!==l);K({sessionRoster:g,members:D,activeEnemies:C}),a(ke).isOpen=!1}},!0)}function lt(l){const c=(Qt.get(o.campaign.id)||o.campaign).activeEnemies||[],g={...l,instanceId:xs(),damage:0,currentHealth:l.health,afflictions:[],acted:!1,initiative:!1};K({activeEnemies:[...c,g]})}function zt(l){const c=(Qt.get(o.campaign.id)||o.campaign).activeEnemies||[];let g=[];l.enemies.forEach(D=>{const C=Z().find(k=>k.id===D.enemyId);if(C)for(let k=0;k<D.count;k++)g.push({...C,instanceId:xs(),damage:0,currentHealth:C.health,afflictions:[],acted:!1,initiative:!1})}),K({activeEnemies:[...c,...g]})}function yt(){K({combat:{active:!0,round:1}}),ks(o.campaign.id,{active:!0,round:1})}function G(){const l=a(Re).filter(d=>d.damage<(d.currentHealth??d.health)&&d.endOfRound&&d.endOfRound.length>0).map(d=>({name:d.name,effects:d.endOfRound}));if(l.length>0){O(le,l,!0),O(fe,!0);return}ze()}function ze(){const l=Qt.get(o.campaign.id)||o.campaign,d=(l.combat?.round||1)+1,c=(l.activeEnemies||[]).map(g=>({...g,acted:!1}));K({combat:{...l.combat,round:d},activeEnemies:c}),ks(o.campaign.id,{active:!0,round:d}),O(fe,!1)}function De(l){K({combat:{active:!1,round:1}}),ks(o.campaign.id,{active:!1,round:1})}function We(l){const d=Qt.get(o.campaign.id)||o.campaign;K({activeEnemies:(d.activeEnemies||[]).filter(c=>c.instanceId!==l)})}function at(l,d){const c=Qt.get(o.campaign.id)||o.campaign;K({activeEnemies:(c.activeEnemies||[]).map(g=>g.instanceId===l?{...g,...d}:g)})}function bt(){const l=Qt.get(o.campaign.id)||o.campaign,d=l.combat?.round||1;d>1&&K({combat:{...l.combat,round:d-1}})}let ae=Qe(Oa(Date.now()));Fs(()=>{const l=setInterval(()=>{O(ae,Date.now(),!0)},1e4);return()=>clearInterval(l)});let Pe=be(()=>(()=>{const l=a(ge).filter(d=>a(it).includes(d.id));return ki(a(Ge),l,a(Re))})());function q(l){return l.lastUpdate?a(ae)-l.lastUpdate<6e4:!1}function $e(l,d){const c=Qt.get(o.campaign.id)||o.campaign,g=c.members||[],D=g.findIndex(z=>z.id===l);let C=g;D!==-1&&(C=[...g],C[D]={...C[D],...d});const k=c.activeEnemies||[],R=k.findIndex(z=>z.id===l&&z.type==="player");let j=k;R!==-1&&(j=[...k],j[R]={...j[R],...d}),K({members:C,activeEnemies:j})}function je(l,d,c){l.dataTransfer&&(l.dataTransfer.setData("application/json",JSON.stringify({item:d,type:c})),l.dataTransfer.effectAllowed="copy")}function Me(l){return l.preventDefault(),!1}function Te(l){l.preventDefault();const d=l.dataTransfer?.getData("application/json");if(d)try{const{item:c,type:g}=JSON.parse(d);g==="enemy"?lt(c):g==="encounter"&&zt(c)}catch(c){console.error("Drop error",c)}}var dt=sn(),Xe=Ae(dt),st=t(Xe),pt=t(st),$t=t(pt),It=t($t),St=t(It);Xs(St,{size:14,class:"text-indigo-500"});var M=s(St),L=s(M);{var ve=l=>{var d=zi(),c=t(d,!0);e(d),b(()=>r(c,a(ge).length)),v(l,d)};w(L,l=>{a(ge).length>0&&l(ve)})}e(It);var qe=s(It,2);qe.__click=()=>O(I,!a(I));var vt=t(qe,!0);e(qe),e($t);var ct=s($t,2);{var ut=l=>{var d=Ci(),c=t(d),g=s(t(c),2),D=t(g);e(g),e(c);var C=s(c,2);Ie(C,17,()=>a(Oe),k=>k.id,(k,R)=>{var j=$i(),z=t(j),Q=t(z),re=t(Q,!0);e(Q);var ue=s(Q,2),J=t(ue,!0);e(ue),e(z);var pe=s(z,2),_=t(pe);_.__click=()=>tt(a(R).id);var $=t(_);Gs($,{size:14}),e(_);var f=s(_,2);f.__click=()=>Ze(a(R).id);var T=t(f);fa(T,{size:14}),e(f),e(pe),e(j),b(S=>{r(re,a(R).name),r(J,S)},[()=>p()("session.players.new_request")]),v(k,j)}),Ca(2),e(d),b(k=>r(D,`${k??""} (${a(Oe).length??""})`),[()=>p()("session.players.waiting_approval")]),v(l,d)};w(ct,l=>{a(Oe).length>0&&l(ut)})}var Bt=s(ct,2),Xt=t(Bt),Yt=t(Xt);Ie(Yt,17,()=>a(ge),l=>l.id,(l,d)=>{const c=be(()=>q(a(d))),g=be(()=>a(it).includes(a(d).id));var D=ji(),C=t(D),k=s(C,2),R=t(k),j=t(R,!0);e(R);var z=s(R,2),Q=t(z);{var re=m=>{var x=Oi(),N=t(x,!0);e(x),b(A=>r(N,A),[()=>p()("common.labels.session")]),v(m,x)};w(Q,m=>{a(g)&&m(re)})}var ue=s(Q);e(z),e(k);var J=s(k,2),pe=t(J);pe.__click=()=>Ve(a(d).id);var _=t(pe);{var $=m=>{Or(m,{size:14})},f=m=>{da(m,{size:14})};w(_,m=>{a(g)?m($):m(f,!1)})}e(pe);var T=s(pe,2);T.__click=()=>Pt(a(d).id);var S=t(T);fa(S,{size:14}),e(T),e(J),e(D),b((m,x,N)=>{Ue(D,1,`p-2.5 rounded-xl border flex items-center gap-3 transition-all ${a(c)?"bg-indigo-900/10 border-indigo-500/20":"bg-slate-900/50 border-slate-800"} ${a(c)||a(g)?"opacity-100":"opacity-40"} hover:border-indigo-500/40 group shadow-sm`),Ue(C,1,`w-2 h-2 rounded-full ${a(c)?"bg-green-500 shadow-[0_0_8px_rgba(74,222,128,0.4)]":"bg-slate-700"}`),Ue(R,1,`font-bold text-sm ${a(c)?"text-white":"text-slate-500"} group-hover:text-indigo-300 transition-colors`),r(j,a(d).name),r(ue,` ${m??""} ${a(d).level??""} • ${a(d).ancestry??""}`),Ue(pe,1,`p-1.5 rounded-lg transition-all ${a(g)?"text-amber-400 hover:bg-amber-400/10":"text-slate-500 hover:text-indigo-400 hover:bg-indigo-400/10"}`),se(pe,"title",x),se(T,"title",N)},[()=>p()("common.labels.level"),()=>a(g)?p()("session.players.remove_from_session"):p()("session.players.add_to_session"),()=>p()("session.players.kick_from_campaign")]),v(l,D)});var Kt=s(Yt,2);{var Vt=l=>{var d=Ei(),c=t(d,!0);e(d),b(g=>r(c,g),[()=>p()("session.players.none")]),v(l,d)};w(Kt,l=>{a(ge).length===0&&l(Vt)})}e(Xt),e(Bt);var ea=s(Bt,2),ia=t(ea);{var Ut=l=>{var d=Mi(),c=Ae(d);c.__click=()=>K({isPublished:!0});var g=t(c);$a(g,{size:14});var D=s(g);e(c);var C=s(c,2),k=t(C,!0);e(C),b((R,j)=>{r(D,` ${R??""}`),r(k,j)},[()=>p()("session.publish.publish_session"),()=>p()("session.publish.make_visible")]),v(l,d)},wt=l=>{var d=Ri(),c=Ae(d),g=t(c),D=t(g),C=t(D);Ys(C,{size:10,class:"animate-pulse"});var k=s(C);e(D),e(g);var R=s(g,2);R.__click=()=>O(we,!a(we));var j=t(R);Jr(j,{size:14}),e(R),e(c);var z=s(c,2);{var Q=x=>{var N=Ii(),A=t(N);e(N),b((ne,H)=>{se(A,"src",ne),se(A,"alt",H)},[()=>`https://api.qrserver.com/v1/create-qr-code/?size=100x100&data=${encodeURIComponent(a(ie))}`,()=>p()("session.publish.qr_alt")]),v(x,N)};w(z,x=>{a(we)&&x(Q)})}var re=s(z,2),ue=t(re),J=t(ue);J.__click=xt;var pe=t(J,!0);e(J);var _=s(J,2);_.__click=xt;var $=t(_);{var f=x=>{var N=Si(),A=t(N);Gs(A,{size:10,class:"inline mr-1"});var ne=s(A);e(N),b(H=>r(ne,` ${H??""}`),[()=>p()("common.buttons.copied")]),v(x,N)};w($,x=>{a(ye)&&x(f)})}var T=s($,2);Fr(T,{size:14}),e(_),e(ue),e(re);var S=s(re,2);S.__click=()=>K({isPublished:!1});var m=t(S,!0);e(S),b((x,N,A,ne)=>{r(k,` ${x??""}`),se(R,"title",N),r(pe,a(ie)),se(_,"aria-label",A),r(m,ne)},[()=>p()("session.publish.public_session"),()=>p()("session.publish.qr_code"),()=>p()("session.publish.copy_link"),()=>p()("session.publish.remove_public")]),v(l,d)};w(ia,l=>{o.campaign?.isPublished?l(wt,!1):l(Ut)})}e(ea),e(pt);var Jt=s(pt,2),Rt=t(Jt),Gt=t(Rt);Gt.__click=()=>O(ee,"enemies");var rt=t(Gt);Pa(rt,{size:14});var Ct=s(rt);e(Gt);var Le=s(Gt,2);Le.__click=()=>O(ee,"encounters");var Ot=t(Le);Ts(Ot,{size:14});var ta=s(Ot);e(Le),e(Rt);var Ht=s(Rt,2),Nt=t(Ht);{var At=l=>{var d=Di(),c=Ae(d);Ie(c,17,()=>a(Y),C=>C.id,(C,k)=>{var R=Ni(),j=t(R),z=t(j);Br(z,{size:12,class:"text-slate-600 cursor-grab"});var Q=s(z,2),re=t(Q),ue=t(re),J=s(ue);{var pe=S=>{$a(S,{size:10,class:"text-indigo-400"})};w(J,S=>{a(k).global&&S(pe)})}e(re);var _=s(re,2),$=t(_);e(_),e(Q),e(j);var f=s(j,2);f.__click=()=>lt(a(k));var T=t(f);da(T,{size:16}),e(f),e(R),b(S=>{r(ue,`${a(k).name??""} `),r($,`${S??""} ${a(k).difficulty??""}`)},[()=>p()("session.enemies.difficulty")]),Ha("dragstart",R,S=>je(S,a(k),"enemy")),v(C,R)});var g=s(c,2);{var D=C=>{var k=Ai(),R=t(k,!0);e(k),b(j=>r(R,j),[()=>p()("session.enemies.none")]),v(C,k)};w(g,C=>{a(Y).length===0&&C(D)})}v(l,d)},sa=l=>{var d=Ui(),c=Ae(d);Ie(c,17,()=>a(de),C=>C.id,(C,k)=>{var R=Ti(),j=t(R),z=t(j),Q=t(z),re=s(Q);{var ue=f=>{$a(f,{size:10,class:"text-indigo-400"})};w(re,f=>{a(k).global&&f(ue)})}e(z);var J=s(z,2),pe=t(J);e(J),e(j);var _=s(j,2);_.__click=()=>zt(a(k));var $=t(_);Ds($,{size:14}),e(_),e(R),b((f,T)=>{r(Q,`${a(k).name??""} `),r(pe,`${f??""} ${T??""}`)},[()=>a(k).enemies?.reduce((f,T)=>f+T.count,0)||0,()=>p()("session.enemies.title")]),Ha("dragstart",R,f=>je(f,a(k),"encounter")),v(C,R)});var g=s(c,2);{var D=C=>{var k=Pi(),R=t(k,!0);e(k),b(j=>r(R,j),[()=>p()("session.enemies.no_encounters")]),v(C,k)};w(g,C=>{a(de).length===0&&C(D)})}v(l,d)};w(Nt,l=>{a(ee)==="enemies"?l(At):l(sa,!1)})}e(Ht),e(Jt),e(st);var aa=s(st,2),na=t(aa),pa=t(na),Sa=t(pa);{var h=l=>{var d=Hi();d.__click=yt;var c=t(d);dr(c,{size:20});var g=s(c);e(d),b(D=>r(g,` ${D??""}`),[()=>p()("session.combat.start")]),v(l,d)},E=l=>{var d=Li(),c=t(d);c.__click=bt;var g=t(c);tr(g,{size:20}),e(c);var D=s(c,2),C=t(D),k=t(C,!0);e(C);var R=s(C),j=t(R,!0);e(R),e(D);var z=s(D,2);z.__click=G;var Q=t(z);jr(Q,{size:16});var re=s(Q);e(z);var ue=s(z,4);ue.__click=()=>De();var J=t(ue,!0);e(ue),e(d),b((pe,_,$,f,T)=>{se(c,"title",pe),r(k,_),r(j,a(Ce).round),se(z,"title",$),r(re,` ${f??""}`),r(J,T)},[()=>p()("session.combat.previous"),()=>p()("session.combat.round"),()=>p()("session.combat.next"),()=>p()("session.combat.next"),()=>p()("session.combat.end")]),v(l,d)};w(Sa,l=>{a(Ce).active?l(E,!1):l(h)})}e(pa),e(na);var xe=s(na,2),he=t(xe);Ie(he,25,()=>a(Pe),l=>l.type==="player"?l.id:l.instanceId,(l,d)=>{var c=Fi(),g=t(c);gi(g,{get entity(){return a(d)},updateEnemy:at,removeFromCombat:We,updatePlayer:$e}),e(c),wr(c,()=>hi,()=>({duration:300})),v(l,c)});var Ke=s(he,2);{var jt=l=>{var d=qi(),c=t(d,!0);e(d),b(g=>r(c,g),[()=>p()("session.combat.empty")]),v(l,d)};w(Ke,l=>{a(Pe).length===0&&l(jt)})}e(xe),e(aa),Ca(2),e(Xe);var Wt=s(Xe,2);{var ma=l=>{var d=Gi();d.__click=f=>{f.target===f.currentTarget&&O(fe,!1)};var c=t(d),g=t(c),D=t(g),C=t(D);Er(C,{size:24}),e(D);var k=s(D,2),R=t(k),j=t(R,!0);e(R);var z=s(R,2),Q=t(z,!0);e(z),e(k),e(g);var re=s(g,2);Ie(re,21,()=>a(le),ot,(f,T)=>{var S=Ji(),m=t(S),x=t(m);Pa(x,{size:14,class:"text-slate-500"});var N=s(x);e(m);var A=s(m,2);Ie(A,21,()=>a(T).effects,ot,(ne,H)=>{var V=Bi(),oe=t(V),Ee=t(oe);e(oe);var Be=s(oe,2),ft=t(Be,!0);e(Be),e(V),b(()=>{r(Ee,`${a(H).name??""}:`),r(ft,a(H).desc)}),v(ne,V)}),e(A),e(S),b(()=>r(N,` ${a(T).name??""}`)),v(f,S)}),e(re);var ue=s(re,2),J=t(ue);J.__click=()=>O(fe,!1);var pe=t(J,!0);e(J);var _=s(J,2);_.__click=ze;var $=t(_,!0);e(_),e(ue),e(c),e(d),b((f,T,S,m)=>{r(j,f),r(Q,T),r(pe,S),r($,m)},[()=>p()("session.end_of_round.title"),()=>p()("session.end_of_round.summary"),()=>p()("common.buttons.cancel"),()=>p()("session.end_of_round.advance")]),v(l,d)};w(Wt,l=>{a(fe)&&l(ma)})}var _a=s(Wt,2);{var xa=l=>{var d=Vi();d.__click=_=>{_.target===_.currentTarget&&O(I,!1)};var c=t(d),g=t(c),D=t(g),C=t(D),k=t(C,!0);e(C);var R=s(C,2),j=t(R,!0);e(R),e(D);var z=s(D,2);z.__click=()=>O(I,!1);var Q=t(z);Ra(Q,{size:16}),e(z),e(g);var re=s(g,2),ue=t(re);Ie(ue,17,()=>a(te),ot,(_,$)=>{var f=Wi();f.__click=()=>Ve(a($).id);var T=t(f),S=t(T,!0);e(T);var m=s(T,2),x=t(m),N=t(x,!0);e(x);var A=s(x,2),ne=t(A);e(A),e(m);var H=s(m,2),V=t(H);da(V,{size:16}),e(H),e(f),b((oe,Ee)=>{r(S,oe),r(N,a($).name),r(ne,`${Ee??""} ${a($).level??""} • ${a($).ancestry??""}`)},[()=>a($).name.charAt(0),()=>p()("common.labels.level")]),v(_,f)});var J=s(ue,2);{var pe=_=>{var $=Qi(),f=t($),T=t(f);Pa(T,{size:24}),e(f);var S=s(f,2),m=t(S,!0);e(S);var x=s(S,2),N=t(x,!0);e(x),e($),b((A,ne)=>{r(m,A),r(N,ne)},[()=>p()("session.manage_session.no_available"),()=>p()("session.manage_session.all_in_session")]),v(_,$)};w(J,_=>{a(te).length===0&&_(pe)})}e(re),e(c),e(d),b((_,$)=>{r(k,_),r(j,$)},[()=>p()("session.manage_session.title"),()=>p()("session.manage_session.description")]),v(l,d)};w(_a,l=>{a(I)&&l(xa)})}var va=s(_a,2);{var ka=l=>{var d=an();d.__click=m=>{m.target===m.currentTarget&&O(X,!1)};var c=t(d),g=t(c),D=t(g),C=t(D);Pa(C,{size:16});var k=s(C);e(D);var R=s(D,2);R.__click=()=>O(X,!1);var j=t(R);Ra(j,{size:18}),e(R),e(g);var z=s(g,2),Q=t(z);Q.__click=()=>O(ee,"enemies");var re=t(Q);Pa(re,{size:14});var ue=s(re);e(Q);var J=s(Q,2);J.__click=()=>O(ee,"encounters");var pe=t(J);Ts(pe,{size:14});var _=s(pe);e(J),e(z);var $=s(z,2),f=t($);{var T=m=>{var x=Yi(),N=Ae(x);Ie(N,17,()=>a(Y),H=>H.id,(H,V)=>{var oe=Zi(),Ee=t(oe),Be=t(Ee),ft=t(Be),Ne=s(ft);{var Et=mt=>{$a(mt,{size:10,class:"text-indigo-400"})};w(Ne,mt=>{a(V).global&&mt(Et)})}e(Be);var Dt=s(Be,2),Zt=t(Dt);e(Dt),e(Ee);var qt=s(Ee,2);qt.__click=()=>{lt(a(V)),O(X,!1)};var ca=t(qt);da(ca,{size:16}),e(qt),e(oe),b(mt=>{r(ft,`${a(V).name??""} `),r(Zt,`${mt??""} ${a(V).difficulty??""}`)},[()=>p()("session.enemies.difficulty")]),v(H,oe)});var A=s(N,2);{var ne=H=>{var V=Xi(),oe=t(V,!0);e(V),b(Ee=>r(oe,Ee),[()=>p()("session.enemies.none")]),v(H,V)};w(A,H=>{a(Y).length===0&&H(ne)})}v(m,x)},S=m=>{var x=tn(),N=Ae(x);Ie(N,17,()=>a(de),H=>H.id,(H,V)=>{var oe=Ki(),Ee=t(oe),Be=t(Ee),ft=t(Be),Ne=s(ft);{var Et=mt=>{$a(mt,{size:10,class:"text-indigo-400"})};w(Ne,mt=>{a(V).global&&mt(Et)})}e(Be);var Dt=s(Be,2),Zt=t(Dt);e(Dt),e(Ee);var qt=s(Ee,2);qt.__click=()=>{zt(a(V)),O(X,!1)};var ca=t(qt);Ds(ca,{size:16}),e(qt),e(oe),b((mt,za)=>{r(ft,`${a(V).name??""} `),r(Zt,`${mt??""} ${za??""}`)},[()=>a(V).enemies?.reduce((mt,za)=>mt+za.count,0)||0,()=>p()("session.enemies.title")]),v(H,oe)});var A=s(N,2);{var ne=H=>{var V=en(),oe=t(V,!0);e(V),b(Ee=>r(oe,Ee),[()=>p()("session.enemies.no_encounters")]),v(H,V)};w(A,H=>{a(de).length===0&&H(ne)})}v(m,x)};w(f,m=>{a(ee)==="enemies"?m(T):m(S,!1)})}e($),e(c),e(d),b((m,x,N)=>{r(k,` ${m??""}`),Ue(Q,1,`flex-1 text-xs font-bold py-2 rounded flex items-center justify-center gap-2 transition-colors ${a(ee)==="enemies"?"bg-indigo-600 text-white":"text-slate-500 hover:text-white"}`),r(ue,` ${x??""}`),Ue(J,1,`flex-1 text-xs font-bold py-2 rounded flex items-center justify-center gap-2 transition-colors ${a(ee)==="encounters"?"bg-indigo-600 text-white":"text-slate-500 hover:text-white"}`),r(_,` ${N??""}`)},[()=>p()("session.enemies.title"),()=>p()("session.enemies.title"),()=>p()("session.enemies.encounters")]),v(l,d)};w(va,l=>{a(X)&&l(ka)})}var B=s(va,2);B.__click=()=>O(X,!0);var W=t(B);Pa(W,{size:24}),e(B);var ce=s(B,2);er(ce,{get isOpen(){return U()},onClose:()=>La.set(!1)});var Fe=s(ce,2);Vs(Fe,{get isOpen(){return a(ke).isOpen},get title(){return a(ke).title},get message(){return a(ke).message},get onConfirm(){return a(ke).onConfirm},onCancel:()=>a(ke).isOpen=!1}),b((l,d,c,g)=>{r(M,` ${l??""} `),r(vt,d),Ue(Gt,1,`flex-1 text-xs font-bold py-1.5 rounded flex items-center justify-center gap-2 transition-colors ${a(ee)==="enemies"?"bg-indigo-600 text-white":"text-slate-500 hover:text-white"}`),r(Ct,` ${c??""}`),Ue(Le,1,`flex-1 text-xs font-bold py-1.5 rounded flex items-center justify-center gap-2 transition-colors ${a(ee)==="encounters"?"bg-indigo-600 text-white":"text-slate-500 hover:text-white"}`),r(ta,` ${g??""}`)},[()=>p()("session.players.title"),()=>a(I)?p()("session.players.close"):p()("session.players.add"),()=>p()("session.enemies.title"),()=>p()("session.enemies.encounters")]),Ha("dragover",aa,Me),Ha("drop",aa,Te),v(F,dt),Ea(),y()}Ma(["click"]);var nn=u('<div class="space-y-4"><div class="flex items-center gap-4"><div class="relative group cursor-pointer"><div class="w-16 h-16 rounded-xl overflow-hidden border border-slate-700"><!></div> <div class="absolute inset-0 bg-black/50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity rounded-xl"><!></div></div> <div class="flex-1"><label for="enemy-name" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-name" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white font-bold text-lg"/></div></div> <div class="grid grid-cols-3 gap-4"><div><label for="enemy-diff" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-diff" type="number" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div> <div><label for="enemy-size" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-size" type="text" placeholder="1/2, 1, 2..." class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div> <div><label for="enemy-desc" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-desc" type="text" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white text-sm"/></div></div> <div class="flex items-center gap-2 mt-4"><input id="enemy-global" type="checkbox" class="w-4 h-4 bg-slate-900 border-slate-700 rounded focus:ring-indigo-500"/> <label for="enemy-global" class="text-sm font-bold text-slate-400 select-none cursor-pointer flex items-center gap-2"><!> </label></div> <div class="grid grid-cols-2 gap-4"><div><label for="enemy-perception" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-perception" type="number" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div> <div><label for="enemy-senses" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-senses" type="text" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white text-sm"/></div></div> <div class="grid grid-cols-2 gap-4"><div><label for="enemy-defense" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-defense" type="number" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div> <div><label for="enemy-health" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-health" type="number" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div></div> <div class="grid grid-cols-2 gap-4"><div><label for="enemy-speed" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-speed" type="number" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div> <div><label for="enemy-speed-notes" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-speed-notes" type="text" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white text-sm"/></div></div> <div><label for="enemy-immune" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <textarea id="enemy-immune" class="w-full bg-slate-900 border border-slate-700 rounded p-3 text-white text-sm min-h-[80px] resize-none focus:border-indigo-500 focus:outline-none transition-colors"></textarea></div></div>'),on=u('<div class="bg-slate-900 p-3 rounded border border-slate-700 text-center"><label class="text-[10px] text-slate-500 uppercase font-bold block mb-1 text-ellipsis overflow-hidden whitespace-nowrap"> </label> <input type="number" class="w-full bg-transparent text-center font-bold text-white text-xl focus:outline-none mb-1"/> <div> </div></div>'),ln=u('<div class="space-y-6"><div><h4 class="text-indigo-400 font-bold text-sm uppercase mb-3"> </h4> <div class="grid grid-cols-4 gap-3"></div></div></div>'),dn=u('<div class="flex gap-2 items-start"><div class="flex-1 space-y-1"><input class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm font-bold placeholder-slate-600"/> <textarea class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm placeholder-slate-600 resize-none" rows="2"></textarea></div> <button class="mt-1 text-slate-600 hover:text-red-400 p-2 hover:bg-slate-800 rounded"><!></button></div>'),vn=u('<div class="text-xs text-slate-600 italic text-center py-4 border-2 border-dashed border-slate-800 rounded"> </div>'),cn=u('<div class="flex gap-2 items-start"><div class="flex-1 space-y-2"><div class="grid grid-cols-2 gap-2"><input class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm font-bold placeholder-slate-600"/> <select class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm"><option> </option><option> </option></select></div> <div class="grid grid-cols-2 gap-2"><input class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm placeholder-slate-600"/> <input class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm placeholder-slate-600"/></div> <textarea class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm placeholder-slate-600 resize-none" rows="2"></textarea></div> <button class="mt-1 text-slate-600 hover:text-red-400 p-2 hover:bg-slate-800 rounded"><!></button></div>'),un=u('<div class="text-xs text-slate-600 italic text-center py-4 border-2 border-dashed border-slate-800 rounded"> </div>'),bn=u('<div class="flex gap-2 items-start"><div class="flex-1 space-y-1"><input class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm font-bold placeholder-slate-600"/> <textarea class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm placeholder-slate-600 resize-none" rows="2"></textarea></div> <button class="mt-1 text-slate-600 hover:text-red-400 p-2 hover:bg-slate-800 rounded"><!></button></div>'),_n=u('<div class="text-xs text-slate-600 italic text-center py-4 border-2 border-dashed border-slate-800 rounded"> </div>'),xn=u('<div class="flex gap-2 items-start"><div class="flex-1 space-y-1"><input class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm font-bold placeholder-slate-600"/> <textarea class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm placeholder-slate-600 resize-none" rows="2"></textarea></div> <button class="mt-1 text-slate-600 hover:text-red-400 p-2 hover:bg-slate-800 rounded"><!></button></div>'),pn=u('<div class="text-xs text-slate-600 italic text-center py-4 border-2 border-dashed border-slate-800 rounded"> </div>'),mn=u('<div class="space-y-6"><div class="p-4 bg-slate-900 rounded border border-indigo-500/30"><div class="flex justify-between items-center mb-3"><h4 class="font-bold text-sm uppercase text-indigo-400"> </h4> <button class="text-xs bg-slate-800 px-2 py-1 rounded hover:bg-slate-700 text-white flex items-center gap-1 border border-slate-700"><!> </button></div> <div class="space-y-3"><!> <!></div></div> <div class="p-4 bg-slate-900 rounded border border-red-500/30"><div class="flex justify-between items-center mb-3"><h4 class="font-bold text-sm uppercase text-red-400"> </h4> <button class="text-xs bg-slate-800 px-2 py-1 rounded hover:bg-slate-700 text-white flex items-center gap-1 border border-slate-700"><!> </button></div> <div class="space-y-3"><!> <!></div></div> <div class="p-4 bg-slate-900 rounded border border-orange-500/30"><div class="flex justify-between items-center mb-3"><h4 class="font-bold text-sm uppercase text-orange-400"> </h4> <button class="text-xs bg-slate-800 px-2 py-1 rounded hover:bg-slate-700 text-white flex items-center gap-1 border border-slate-700"><!> </button></div> <div class="space-y-3"><!> <!></div></div> <div class="p-4 bg-slate-900 rounded border border-yellow-500/30"><div class="flex justify-between items-center mb-3"><h4 class="font-bold text-sm uppercase text-yellow-400"> </h4> <button class="text-xs bg-slate-800 px-2 py-1 rounded hover:bg-slate-700 text-white flex items-center gap-1 border border-slate-700"><!> </button></div> <div class="space-y-3"><!> <!></div></div></div>'),fn=u('<div class="w-16 h-16 rounded-lg overflow-hidden border border-slate-700 shadow-lg flex-shrink-0"><!></div>'),gn=u('<span class="text-slate-400"> </span>'),hn=u('<span class="text-slate-400"> </span>'),yn=u('<div class="text-sm mb-4"><span class="text-slate-500 font-bold"> </span> <span class="text-white ml-1"> </span></div>'),wn=u('<div class="mb-3 text-sm"><span class="font-bold text-indigo-400"> </span> <span class="text-slate-300 ml-1"> </span></div>'),kn=u('<span class="text-slate-300"> </span>'),zn=u('<div class="mb-2 text-sm"><span class="font-bold text-white"> </span> <span class="text-slate-400"> </span> <span class="text-white ml-1"> </span> <!></div>'),$n=u('<div class="mt-4"><h4 class="text-red-500 font-bold text-xs uppercase mb-2 tracking-wider"> </h4> <!></div>'),Cn=u('<div class="mb-2 text-sm"><span class="font-bold text-white"> </span> <span class="text-slate-300 ml-1"> </span></div>'),On=u('<div class="mt-4"><h4 class="text-orange-500 font-bold text-xs uppercase mb-2 tracking-wider"> </h4> <!></div>'),jn=u('<div class="mb-2 text-sm"><span class="font-bold text-white"> </span> <span class="text-slate-300 ml-1"> </span></div>'),En=u('<div class="mt-4"><h4 class="text-yellow-500 font-bold text-xs uppercase mb-2 tracking-wider"> </h4> <!></div>'),Mn=u('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/80 p-4" role="button" aria-label="Close" tabindex="-1"><div class="bg-slate-800 rounded-xl w-full max-w-6xl h-[90vh] border border-slate-700 shadow-2xl overflow-hidden flex flex-col lg:flex-row" role="dialog" aria-modal="true" aria-labelledby="modal-title"><div class="w-full lg:w-1/2 flex flex-col h-full border-r border-slate-700"><div class="p-4 border-b border-slate-700 bg-slate-900 flex justify-between items-center"><h3 id="modal-title" class="font-bold text-white text-lg"> </h3> <button class="lg:hidden text-slate-400 hover:text-white"><!></button></div> <div class="flex border-b border-slate-700 bg-slate-900/50"><button> </button> <button> </button> <button> </button></div> <div class="flex-1 overflow-y-auto p-6 custom-scrollbar bg-slate-800/50"><!></div> <div class="p-4 border-t border-slate-700 bg-slate-900 flex justify-end gap-3"><button class="px-6 py-2 rounded bg-slate-800 hover:bg-slate-700 text-white font-bold transition-colors"> </button> <button class="px-6 py-2 rounded bg-indigo-600 hover:bg-indigo-500 text-white font-bold flex items-center gap-2 transition-colors"><!> </button></div></div> <div class="hidden lg:flex w-1/2 bg-slate-950 flex-col border-l border-slate-800"><div class="p-4 border-b border-slate-800 bg-slate-950"><h3 class="font-bold text-slate-500 text-xs uppercase flex items-center gap-2"><!> </h3></div> <div class="flex-1 p-8 overflow-y-auto flex items-start justify-center bg-[radial-gradient(ellipse_at_top,_var(--tw-gradient-stops))] from-slate-900 via-slate-950 to-slate-950"><div class="w-full max-w-md bg-slate-900 border border-slate-700 rounded-xl p-5 shadow-2xl"><div class="flex items-start gap-3 mb-4"><!> <div class="flex-1 min-w-0"><div class="flex items-baseline gap-2"><h2 class="text-xl font-bold text-white font-serif tracking-wide"> </h2> <span class="text-red-500 font-bold text-sm"> </span></div> <div class="text-sm text-slate-400 mt-1"> </div></div></div> <div class="text-sm mb-3"><span class="text-slate-500 font-bold"> </span> <span class="text-white ml-1"> </span> <!></div> <div class="text-sm mb-3"><span class="text-slate-500 font-bold"> </span> <span class="text-white ml-1"> </span> <span class="text-slate-500 font-bold ml-3"> </span> <span class="text-white ml-1"> </span></div> <div class="text-sm mb-3"><span class="text-white"><span class="text-slate-500 font-bold"> </span> <span class="text-slate-500 font-bold"> </span> <span class="text-slate-500 font-bold"> </span> <span class="text-slate-500 font-bold"> </span> </span></div> <div class="text-sm mb-3"><span class="text-slate-500 font-bold"> </span> <span class="text-white ml-1"> </span> <!></div> <!> <div class="border-t border-slate-700 my-4"></div> <!> <!> <!> <!></div></div></div></div></div> <input type="file" hidden="" accept="image/*"/> <!>',1);function In(F,o){ja(o,!0);const i=()=>kt(ba,"$t",Z),[Z,P]=Ia();let p=ra(o,"isOpen",3,!1),U=ra(o,"initialData",3,"{}"),n=Qe(Oa(ee())),y=Qe("stats"),I=Qe(!1),X=Qe(""),ye=Qe(void 0);function we(te){const Y=te.target.files;if(Y&&Y.length>0){const de=Y[0],K=new FileReader;K.onload=()=>{O(X,K.result,!0),O(I,!0)},K.readAsDataURL(de)}te.target&&(te.target.value="")}async function Se(te){try{const Y=await sr(te);a(n).imageUrl=Y,O(I,!1)}catch(Y){console.error(Y),alert(Y.message||"Erro ao salvar imagem")}}function ee(){return{name:"",difficulty:1,size:"1",descriptors:"",perception:10,senses:"",defense:10,health:10,attributes:{strength:10,agility:10,intellect:10,will:10},speed:10,speedNotes:"",immunities:"",traits:[],attackOptions:[],specialAttacks:[],endOfRound:[],imageUrl:"",global:!1}}function fe(te){const Y=te-10;return Y>=0?`+${Y}`:`${Y}`}$s(()=>{if(p()&&U())try{const te=JSON.parse(U());Object.keys(te).length===0?O(n,ee(),!0):O(n,{...ee(),...te},!0)}catch{O(n,ee(),!0)}});function le(){a(n).traits=[...a(n).traits,{name:"",desc:""}]}function ke(te){a(n).traits=a(n).traits.filter((Y,de)=>de!==te)}function ie(){a(n).attackOptions=[...a(n).attackOptions,{name:"",type:"melee",attackRoll:"+0",damage:"1d6",desc:""}]}function xt(te){a(n).attackOptions=a(n).attackOptions.filter((Y,de)=>de!==te)}function it(){a(n).specialAttacks=[...a(n).specialAttacks,{name:"",desc:""}]}function Ce(te){a(n).specialAttacks=a(n).specialAttacks.filter((Y,de)=>de!==te)}function Re(){a(n).endOfRound=[...a(n).endOfRound,{name:"",desc:""}]}function He(te){a(n).endOfRound=a(n).endOfRound.filter((Y,de)=>de!==te)}function Ge(te){}var et=ht(),ge=Ae(et);{var Oe=te=>{var Y=Mn(),de=Ae(Y);de.__click=Ge;var K=t(de),Ve=t(K),tt=t(Ve),Ze=t(tt),Pt=t(Ze,!0);e(Ze);var lt=s(Ze,2);lt.__click=function(..._){o.onClose?.apply(this,_)};var zt=t(lt);Ra(zt,{size:20}),e(lt),e(tt);var yt=s(tt,2),G=t(yt);G.__click=()=>O(y,"stats");var ze=t(G,!0);e(G);var De=s(G,2);De.__click=()=>O(y,"attributes");var We=t(De,!0);e(De);var at=s(De,2);at.__click=()=>O(y,"abilities");var bt=t(at,!0);e(at),e(yt);var ae=s(yt,2),Pe=t(ae);{var q=_=>{var $=nn(),f=t($),T=t(f);T.__click=()=>a(ye)?.click();var S=t(T),m=t(S);Hs(m,()=>a(n).imageUrl,me=>{ps(me,{get hash(){return a(n).imageUrl},get alt(){return a(n).name},size:"custom",fallbackText:"?"})}),e(S);var x=s(S,2),N=t(x);rr(N,{size:20,class:"text-white"}),e(x),e(T);var A=s(T,2),ne=t(A),H=t(ne,!0);e(ne);var V=s(ne,2);Ye(V),e(A),e(f);var oe=s(f,2),Ee=t(oe),Be=t(Ee),ft=t(Be,!0);e(Be);var Ne=s(Be,2);Ye(Ne),e(Ee);var Et=s(Ee,2),Dt=t(Et),Zt=t(Dt,!0);e(Dt);var qt=s(Dt,2);Ye(qt),e(Et);var ca=s(Et,2),mt=t(ca),za=t(mt,!0);e(mt);var Na=s(mt,2);Ye(Na),e(ca),e(oe);var Ya=s(oe,2),Aa=t(Ya);Ye(Aa);var Ka=s(Aa,2),ms=t(Ka);$a(ms,{size:14});var fs=s(ms);e(Ka),e(Ya);var Fa=s(Ya,2),es=t(Fa),ts=t(es),as=t(ts,!0);e(ts);var qa=s(ts,2);Ye(qa),e(es);var Ba=s(es,2),ss=t(Ba),rs=t(ss,!0);e(ss);var Ja=s(ss,2);Ye(Ja),e(Ba),e(Fa);var is=s(Fa,2),Ga=t(is),Wa=t(Ga),Cs=t(Wa,!0);e(Wa);var gs=s(Wa,2);Ye(gs),e(Ga);var ns=s(Ga,2),Da=t(ns),os=t(Da,!0);e(Da);var hs=s(Da,2);Ye(hs),e(ns),e(is);var Ta=s(is,2),Qa=t(Ta),ls=t(Qa),ys=t(ls,!0);e(ls);var ds=s(ls,2);Ye(ds),e(Qa);var ws=s(Qa,2),vs=t(ws),_t=t(vs,!0);e(vs);var _e=s(vs,2);Ye(_e),e(ws),e(Ta);var Tt=s(Ta,2),nt=t(Tt),Lt=t(nt,!0);e(nt);var gt=s(nt,2);Ua(gt),e(Tt),e($),b((me,Ft,oa,Mt,ua,Os,cs,Va,us,bs,_s,js,la,Es,Ms,Is)=>{r(H,me),r(ft,Ft),r(Zt,oa),r(za,Mt),se(Na,"placeholder",ua),r(fs,` ${Os??""}`),r(as,cs),r(rs,Va),se(Ja,"placeholder",us),r(Cs,bs),r(os,_s),r(ys,js),r(_t,la),se(_e,"placeholder",Es),r(Lt,Ms),se(gt,"placeholder",Is)},[()=>i()("session.enemy_modal.name"),()=>i()("session.enemy_modal.difficulty"),()=>i()("session.enemy_modal.size"),()=>i()("session.enemy_modal.descriptors"),()=>i()("session.enemy_modal.descriptors_placeholder"),()=>i()("session.enemy_modal.global_enemy"),()=>i()("sofdl.attributes.perception"),()=>i()("session.enemy_modal.senses"),()=>i()("session.enemy_modal.senses_placeholder_sotdl"),()=>i()("session.enemy_modal.defense"),()=>i()("session.enemy_modal.health"),()=>i()("session.enemy_modal.speed"),()=>i()("session.enemy_modal.speed_notes"),()=>i()("session.enemy_modal.speed_notes_placeholder"),()=>i()("session.enemy_modal.immunities"),()=>i()("session.enemy_modal.immunities_placeholder_sotdl")]),Je(V,()=>a(n).name,me=>a(n).name=me),Je(Ne,()=>a(n).difficulty,me=>a(n).difficulty=me),Je(qt,()=>a(n).size,me=>a(n).size=me),Je(Na,()=>a(n).descriptors,me=>a(n).descriptors=me),Qs(Aa,()=>a(n).global,me=>a(n).global=me),Je(qa,()=>a(n).perception,me=>a(n).perception=me),Je(Ja,()=>a(n).senses,me=>a(n).senses=me),Je(gs,()=>a(n).defense,me=>a(n).defense=me),Je(hs,()=>a(n).health,me=>a(n).health=me),Je(ds,()=>a(n).speed,me=>a(n).speed=me),Je(_e,()=>a(n).speedNotes,me=>a(n).speedNotes=me),Je(gt,()=>a(n).immunities,me=>a(n).immunities=me),v(_,$)},$e=_=>{var $=ht(),f=Ae($);{var T=m=>{var x=ln(),N=t(x),A=t(N),ne=t(A,!0);e(A);var H=s(A,2);Ie(H,5,()=>[{key:"strength",label:i()("sofdl.attributes.strength")},{key:"agility",label:i()("sofdl.attributes.agility")},{key:"intellect",label:i()("sofdl.attributes.intellect")},{key:"will",label:i()("sofdl.attributes.will")}],ot,(V,oe)=>{var Ee=on(),Be=t(Ee),ft=t(Be,!0);e(Be);var Ne=s(Be,2);Ye(Ne);var Et=s(Ne,2),Dt=t(Et,!0);e(Et),e(Ee),b((Zt,qt)=>{se(Be,"for",`attr-${a(oe).key??""}`),se(Be,"title",a(oe).label),r(ft,Zt),se(Ne,"id",`attr-${a(oe).key??""}`),Ue(Et,1,`text-xs font-bold ${a(n).attributes[a(oe).key]-10>=0?"text-green-500":"text-red-500"}`),r(Dt,qt)},[()=>a(oe).label.substring(0,3),()=>fe(a(n).attributes[a(oe).key])]),Je(Ne,()=>a(n).attributes[a(oe).key],Zt=>a(n).attributes[a(oe).key]=Zt),v(V,Ee)}),e(H),e(N),e(x),b(V=>r(ne,V),[()=>i()("session.enemy_modal.main_attributes")]),v(m,x)},S=m=>{var x=ht(),N=Ae(x);{var A=ne=>{var H=mn(),V=t(H),oe=t(V),Ee=t(oe),Be=t(Ee,!0);e(Ee);var ft=s(Ee,2);ft.__click=le;var Ne=t(ft);da(Ne,{size:12});var Et=s(Ne);e(ft),e(oe);var Dt=s(oe,2),Zt=t(Dt);Ie(Zt,17,()=>a(n).traits,ot,(_t,_e,Tt)=>{var nt=dn(),Lt=t(nt),gt=t(Lt);Ye(gt);var me=s(gt,2);Ua(me),e(Lt);var Ft=s(Lt,2);Ft.__click=()=>ke(Tt);var oa=t(Ft);fa(oa,{size:16}),e(Ft),e(nt),b((Mt,ua)=>{se(gt,"placeholder",Mt),se(me,"placeholder",ua)},[()=>i()("session.enemy_modal.name_placeholder"),()=>i()("session.enemy_modal.desc_placeholder")]),Je(gt,()=>a(_e).name,Mt=>a(_e).name=Mt),Je(me,()=>a(_e).desc,Mt=>a(_e).desc=Mt),v(_t,nt)});var qt=s(Zt,2);{var ca=_t=>{var _e=vn(),Tt=t(_e,!0);e(_e),b(nt=>r(Tt,nt),[()=>i()("session.enemy_modal.empty")]),v(_t,_e)};w(qt,_t=>{a(n).traits.length===0&&_t(ca)})}e(Dt),e(V);var mt=s(V,2),za=t(mt),Na=t(za),Ya=t(Na,!0);e(Na);var Aa=s(Na,2);Aa.__click=ie;var Ka=t(Aa);da(Ka,{size:12});var ms=s(Ka);e(Aa),e(za);var fs=s(za,2),Fa=t(fs);Ie(Fa,17,()=>a(n).attackOptions,ot,(_t,_e,Tt)=>{var nt=cn(),Lt=t(nt),gt=t(Lt),me=t(gt);Ye(me);var Ft=s(me,2),oa=t(Ft),Mt=t(oa,!0);e(oa),oa.value=oa.__value="melee";var ua=s(oa),Os=t(ua,!0);e(ua),ua.value=ua.__value="ranged",e(Ft),e(gt);var cs=s(gt,2),Va=t(cs);Ye(Va);var us=s(Va,2);Ye(us),e(cs);var bs=s(cs,2);Ua(bs),e(Lt);var _s=s(Lt,2);_s.__click=()=>xt(Tt);var js=t(_s);fa(js,{size:16}),e(_s),e(nt),b((la,Es,Ms,Is,vr,cr)=>{se(me,"placeholder",la),r(Mt,Es),r(Os,Ms),se(Va,"placeholder",Is),se(us,"placeholder",vr),se(bs,"placeholder",cr)},[()=>i()("session.enemy_modal.name_placeholder"),()=>i()("session.enemy_modal.melee"),()=>i()("session.enemy_modal.ranged"),()=>i()("session.enemy_modal.attack_placeholder"),()=>i()("session.enemy_modal.damage_placeholder"),()=>i()("session.enemy_modal.desc_effects_placeholder")]),Je(me,()=>a(_e).name,la=>a(_e).name=la),br(Ft,()=>a(_e).type,la=>a(_e).type=la),Je(Va,()=>a(_e).attackRoll,la=>a(_e).attackRoll=la),Je(us,()=>a(_e).damage,la=>a(_e).damage=la),Je(bs,()=>a(_e).desc,la=>a(_e).desc=la),v(_t,nt)});var es=s(Fa,2);{var ts=_t=>{var _e=un(),Tt=t(_e,!0);e(_e),b(nt=>r(Tt,nt),[()=>i()("session.enemy_modal.empty")]),v(_t,_e)};w(es,_t=>{a(n).attackOptions.length===0&&_t(ts)})}e(fs),e(mt);var as=s(mt,2),qa=t(as),Ba=t(qa),ss=t(Ba,!0);e(Ba);var rs=s(Ba,2);rs.__click=it;var Ja=t(rs);da(Ja,{size:12});var is=s(Ja);e(rs),e(qa);var Ga=s(qa,2),Wa=t(Ga);Ie(Wa,17,()=>a(n).specialAttacks,ot,(_t,_e,Tt)=>{var nt=bn(),Lt=t(nt),gt=t(Lt);Ye(gt);var me=s(gt,2);Ua(me),e(Lt);var Ft=s(Lt,2);Ft.__click=()=>Ce(Tt);var oa=t(Ft);fa(oa,{size:16}),e(Ft),e(nt),b((Mt,ua)=>{se(gt,"placeholder",Mt),se(me,"placeholder",ua)},[()=>i()("session.enemy_modal.name_placeholder"),()=>i()("session.enemy_modal.desc_placeholder")]),Je(gt,()=>a(_e).name,Mt=>a(_e).name=Mt),Je(me,()=>a(_e).desc,Mt=>a(_e).desc=Mt),v(_t,nt)});var Cs=s(Wa,2);{var gs=_t=>{var _e=_n(),Tt=t(_e,!0);e(_e),b(nt=>r(Tt,nt),[()=>i()("session.enemy_modal.empty")]),v(_t,_e)};w(Cs,_t=>{a(n).specialAttacks.length===0&&_t(gs)})}e(Ga),e(as);var ns=s(as,2),Da=t(ns),os=t(Da),hs=t(os,!0);e(os);var Ta=s(os,2);Ta.__click=Re;var Qa=t(Ta);da(Qa,{size:12});var ls=s(Qa);e(Ta),e(Da);var ys=s(Da,2),ds=t(ys);Ie(ds,17,()=>a(n).endOfRound,ot,(_t,_e,Tt)=>{var nt=xn(),Lt=t(nt),gt=t(Lt);Ye(gt);var me=s(gt,2);Ua(me),e(Lt);var Ft=s(Lt,2);Ft.__click=()=>He(Tt);var oa=t(Ft);fa(oa,{size:16}),e(Ft),e(nt),b((Mt,ua)=>{se(gt,"placeholder",Mt),se(me,"placeholder",ua)},[()=>i()("session.enemy_modal.name_placeholder"),()=>i()("session.enemy_modal.desc_placeholder")]),Je(gt,()=>a(_e).name,Mt=>a(_e).name=Mt),Je(me,()=>a(_e).desc,Mt=>a(_e).desc=Mt),v(_t,nt)});var ws=s(ds,2);{var vs=_t=>{var _e=pn(),Tt=t(_e,!0);e(_e),b(nt=>r(Tt,nt),[()=>i()("session.enemy_modal.empty")]),v(_t,_e)};w(ws,_t=>{a(n).endOfRound.length===0&&_t(vs)})}e(ys),e(ns),e(H),b((_t,_e,Tt,nt,Lt,gt,me,Ft)=>{r(Be,_t),r(Et,` ${_e??""}`),r(Ya,Tt),r(ms,` ${nt??""}`),r(ss,Lt),r(is,` ${gt??""}`),r(hs,me),r(ls,` ${Ft??""}`)},[()=>i()("session.enemy_modal.traits"),()=>i()("common.buttons.add"),()=>i()("session.enemy_modal.attack_options"),()=>i()("common.buttons.add"),()=>i()("session.enemy_modal.special_attacks"),()=>i()("common.buttons.add"),()=>i()("session.enemy_modal.end_of_round"),()=>i()("common.buttons.add")]),v(ne,H)};w(N,ne=>{a(y)==="abilities"&&ne(A)},!0)}v(m,x)};w(f,m=>{a(y)==="attributes"?m(T):m(S,!1)},!0)}v(_,$)};w(Pe,_=>{a(y)==="stats"?_(q):_($e,!1)})}e(ae);var je=s(ae,2),Me=t(je);Me.__click=function(..._){o.onClose?.apply(this,_)};var Te=t(Me,!0);e(Me);var dt=s(Me,2);dt.__click=()=>o.onSave(a(n));var Xe=t(dt);Ls(Xe,{size:18});var st=s(Xe);e(dt),e(je),e(Ve);var pt=s(Ve,2),$t=t(pt),It=t($t),St=t(It);Us(St,{size:14});var M=s(St);e(It),e($t);var L=s($t,2),ve=t(L),qe=t(ve),vt=t(qe);{var ct=_=>{var $=fn(),f=t($);ps(f,{get hash(){return a(n).imageUrl},get alt(){return a(n).name},size:"custom"}),e($),v(_,$)};w(vt,_=>{a(n).imageUrl&&_(ct)})}var ut=s(vt,2),Bt=t(ut),Xt=t(Bt),Yt=t(Xt,!0);e(Xt);var Kt=s(Xt,2),Vt=t(Kt);e(Kt),e(Bt);var ea=s(Bt,2),ia=t(ea);e(ea),e(ut),e(qe);var Ut=s(qe,2),wt=t(Ut),Jt=t(wt,!0);e(wt);var Rt=s(wt,2),Gt=t(Rt);e(Rt);var rt=s(Rt,2);{var Ct=_=>{var $=gn(),f=t($);e($),b(()=>r(f,`; ${a(n).senses??""}`)),v(_,$)};w(rt,_=>{a(n).senses&&_(Ct)})}e(Ut);var Le=s(Ut,2),Ot=t(Le),ta=t(Ot,!0);e(Ot);var Ht=s(Ot,2),Nt=t(Ht,!0);e(Ht);var At=s(Ht,2),sa=t(At,!0);e(At);var aa=s(At,2),na=t(aa,!0);e(aa),e(Le);var pa=s(Le,2),Sa=t(pa),h=t(Sa),E=t(h,!0);e(h);var xe=s(h),he=s(xe),Ke=t(he,!0);e(he);var jt=s(he),Wt=s(jt),ma=t(Wt,!0);e(Wt);var _a=s(Wt),xa=s(_a),va=t(xa,!0);e(xa);var ka=s(xa);e(Sa),e(pa);var B=s(pa,2),W=t(B),ce=t(W,!0);e(W);var Fe=s(W,2),l=t(Fe,!0);e(Fe);var d=s(Fe,2);{var c=_=>{var $=hn(),f=t($);e($),b(()=>r(f,`; ${a(n).speedNotes??""}`)),v(_,$)};w(d,_=>{a(n).speedNotes&&_(c)})}e(B);var g=s(B,2);{var D=_=>{var $=yn(),f=t($),T=t(f,!0);e(f);var S=s(f,2),m=t(S,!0);e(S),e($),b(x=>{r(T,x),r(m,a(n).immunities)},[()=>i()("session.enemy_modal.immunities")]),v(_,$)};w(g,_=>{a(n).immunities&&_(D)})}var C=s(g,4);{var k=_=>{var $=ht(),f=Ae($);Ie(f,17,()=>a(n).traits,ot,(T,S)=>{var m=wn(),x=t(m),N=t(x,!0);e(x);var A=s(x,2),ne=t(A,!0);e(A),e(m),b(()=>{r(N,a(S).name),r(ne,a(S).desc)}),v(T,m)}),v(_,$)};w(C,_=>{a(n).traits.length>0&&_(k)})}var R=s(C,2);{var j=_=>{var $=$n(),f=t($),T=t(f,!0);e(f);var S=s(f,2);Ie(S,17,()=>a(n).attackOptions,ot,(m,x)=>{var N=zn(),A=t(N),ne=t(A,!0);e(A);var H=s(A,2),V=t(H);e(H);var oe=s(H,2),Ee=t(oe);e(oe);var Be=s(oe,2);{var ft=Ne=>{var Et=kn(),Dt=t(Et);e(Et),b(()=>r(Dt,`; ${a(x).desc??""}`)),v(Ne,Et)};w(Be,Ne=>{a(x).desc&&Ne(ft)})}e(N),b(Ne=>{r(ne,a(x).name),r(V,`(${Ne??""})`),r(Ee,`${a(x).attackRoll??""} (${a(x).damage??""})`)},[()=>a(x).type==="melee"?i()("session.enemy_modal.melee").toLowerCase():i()("session.enemy_modal.ranged").toLowerCase()]),v(m,N)}),e($),b(m=>r(T,m),[()=>i()("session.enemy_modal.attack_options")]),v(_,$)};w(R,_=>{a(n).attackOptions.length>0&&_(j)})}var z=s(R,2);{var Q=_=>{var $=On(),f=t($),T=t(f,!0);e(f);var S=s(f,2);Ie(S,17,()=>a(n).specialAttacks,ot,(m,x)=>{var N=Cn(),A=t(N),ne=t(A,!0);e(A);var H=s(A,2),V=t(H,!0);e(H),e(N),b(()=>{r(ne,a(x).name),r(V,a(x).desc)}),v(m,N)}),e($),b(m=>r(T,m),[()=>i()("session.enemy_modal.special_attacks")]),v(_,$)};w(z,_=>{a(n).specialAttacks.length>0&&_(Q)})}var re=s(z,2);{var ue=_=>{var $=En(),f=t($),T=t(f,!0);e(f);var S=s(f,2);Ie(S,17,()=>a(n).endOfRound,ot,(m,x)=>{var N=jn(),A=t(N),ne=t(A,!0);e(A);var H=s(A,2),V=t(H,!0);e(H),e(N),b(()=>{r(ne,a(x).name),r(V,a(x).desc)}),v(m,N)}),e($),b(m=>r(T,m),[()=>i()("session.enemy_modal.end_of_round")]),v(_,$)};w(re,_=>{a(n).endOfRound.length>0&&_(ue)})}e(ve),e(L),e(pt),e(K),e(de);var J=s(de,2);J.__change=we,or(J,_=>O(ye,_),()=>a(ye));var pe=s(J,2);ar(pe,{get isOpen(){return a(I)},get imageUrl(){return a(X)},onClose:()=>O(I,!1),onCrop:Se}),b((_,$,f,T,S,m,x,N,A,ne,H,V,oe,Ee,Be,ft,Ne,Et,Dt,Zt,qt,ca,mt)=>{r(Pt,_),Ue(G,1,`flex-1 py-3 text-sm font-bold border-b-2 transition-colors ${a(y)==="stats"?"border-indigo-500 text-indigo-400 bg-slate-800":"border-transparent text-slate-500 hover:text-white"}`),r(ze,$),Ue(De,1,`flex-1 py-3 text-sm font-bold border-b-2 transition-colors ${a(y)==="attributes"?"border-indigo-500 text-indigo-400 bg-slate-800":"border-transparent text-slate-500 hover:text-white"}`),r(We,f),Ue(at,1,`flex-1 py-3 text-sm font-bold border-b-2 transition-colors ${a(y)==="abilities"?"border-indigo-500 text-indigo-400 bg-slate-800":"border-transparent text-slate-500 hover:text-white"}`),r(bt,T),r(Te,S),r(st,` ${m??""}`),r(M,` ${x??""}`),r(Yt,N),r(Vt,`${A??""} ${a(n).difficulty??""}`),r(ia,`${ne??""} ${a(n).size??""} ${a(n).descriptors??""}`),r(Jt,H),r(Gt,`${a(n).perception??""} (${V??""})`),r(ta,oe),r(Nt,a(n).defense),r(sa,Ee),r(na,a(n).health),r(E,Be),r(xe,` ${a(n).attributes.strength??""} (${ft??""}), `),r(Ke,Ne),r(jt,` ${a(n).attributes.agility??""} (${Et??""}), `),r(ma,Dt),r(_a,` ${a(n).attributes.intellect??""} (${Zt??""}), `),r(va,qt),r(ka,` ${a(n).attributes.will??""} (${ca??""})`),r(ce,mt),r(l,a(n).speed)},[()=>i()("session.enemy_modal.title_sotdl"),()=>i()("session.enemy_modal.tab_general"),()=>i()("session.enemy_modal.tab_attributes"),()=>i()("session.enemy_modal.tab_abilities"),()=>i()("common.buttons.cancel"),()=>i()("common.buttons.save"),()=>i()("session.enemy_modal.preview"),()=>a(n).name||i()("session.enemy_modal.enemy_default"),()=>i()("session.enemies.difficulty").toUpperCase(),()=>i()("session.enemy_modal.size"),()=>i()("sofdl.attributes.perception"),()=>fe(a(n).perception),()=>i()("session.enemy_modal.defense"),()=>i()("session.enemy_modal.health"),()=>i()("sofdl.attributes.strength"),()=>fe(a(n).attributes.strength),()=>i()("sofdl.attributes.agility"),()=>fe(a(n).attributes.agility),()=>i()("sofdl.attributes.intellect"),()=>fe(a(n).attributes.intellect),()=>i()("sofdl.attributes.will"),()=>fe(a(n).attributes.will),()=>i()("session.enemy_modal.speed")]),v(te,Y)};w(ge,te=>{p()&&te(Oe)})}v(F,et),Ea(),P()}Ma(["click","change"]);var Sn=u('<div class="space-y-4"><div class="flex items-center gap-4"><div class="relative group cursor-pointer"><div class="w-16 h-16 rounded-xl overflow-hidden border border-slate-700"><!></div> <div class="absolute inset-0 bg-black/50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity rounded-xl"><!></div></div> <div class="flex-1"><label for="enemy-name" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-name" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white font-bold text-lg"/></div></div> <div class="grid grid-cols-2 gap-4"><div><label for="enemy-diff" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label><input id="enemy-diff" type="number" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div> <div><label for="enemy-size" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label><input id="enemy-size" type="number" step="0.5" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div></div> <div class="flex items-center gap-2"><input id="enemy-global" type="checkbox" class="w-4 h-4 bg-slate-900 border-slate-700 rounded focus:ring-indigo-500"/> <label for="enemy-global" class="text-sm font-bold text-slate-400 select-none cursor-pointer flex items-center gap-2"><!> </label></div> <div><label for="enemy-desc" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <textarea id="enemy-desc" class="w-full bg-slate-900 border border-slate-700 rounded p-3 text-white text-sm min-h-[100px] resize-none focus:border-indigo-500 focus:outline-none transition-colors"></textarea></div> <div class="grid grid-cols-1"><div><label for="enemy-speed" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label><input id="enemy-speed" type="number" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div></div></div>'),Rn=u('<div class="bg-slate-900 p-2 rounded border border-slate-700 text-center"><label class="text-[10px] text-slate-500 uppercase font-bold block mb-1"> </label> <input type="number" class="w-full bg-transparent text-center font-bold text-white text-xl focus:outline-none mb-1"/> <div> </div></div>'),Nn=u('<div class="space-y-6"><div><h4 class="text-indigo-400 font-bold text-sm uppercase mb-3"> </h4> <div class="grid grid-cols-4 gap-3"></div></div> <div class="space-y-3"><div><label for="enemy-senses" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label><input id="enemy-senses" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white text-sm"/></div> <div><label for="enemy-langs" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label><input id="enemy-langs" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white text-sm"/></div> <div><label for="enemy-immune" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label><input id="enemy-immune" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white text-sm"/></div></div></div>'),An=u('<div class="flex gap-2 items-start animate-in fade-in slide-in-from-left-2"><div class="flex-1 space-y-1"><input class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm font-bold placeholder-slate-600 focus:border-indigo-500 focus:outline-none"/> <textarea class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm placeholder-slate-600 resize-none focus:border-indigo-500 focus:outline-none" rows="2"></textarea></div> <button class="mt-1 text-slate-600 hover:text-red-400 p-2 hover:bg-slate-800 rounded"><!></button></div>'),Dn=u('<div class="text-xs text-slate-600 italic text-center py-4 border-2 border-dashed border-slate-800 rounded"> </div>'),Tn=u('<div><div class="flex justify-between items-center mb-3"><h4> </h4> <button class="text-xs bg-slate-800 px-2 py-1 rounded hover:bg-slate-700 text-white flex items-center gap-1 border border-slate-700"><!> </button></div> <div class="space-y-3"><!> <!></div></div>'),Pn=u('<div class="space-y-6"></div>'),Un=u('<div class="w-16 h-16 rounded-lg overflow-hidden border border-slate-700 shadow-lg flex-shrink-0"><!></div>'),Hn=u('<div class="bg-slate-950 p-2 rounded border border-slate-800"><div class="text-[10px] text-slate-500 uppercase font-bold mb-1"> </div> <div class="text-white font-bold"> <span> </span></div></div>'),Ln=u('<div class="flex gap-2"><span class="font-bold text-slate-500 uppercase"> </span> <span class="text-white"> </span></div>'),Fn=u('<div class="flex gap-2"><span class="font-bold text-slate-500 uppercase"> </span> <span class="text-white"> </span></div>'),qn=u('<div class="flex gap-2"><span class="font-bold text-slate-500 uppercase"> </span> <span class="text-white"> </span></div>'),Bn=u('<div class="mb-2 pl-3 border-l-2 border-indigo-900"><span class="font-bold text-white"> </span> <span class="text-slate-300"> </span></div>'),Jn=u('<div><h4 class="font-bold text-indigo-400 uppercase text-xs mb-2 tracking-wider"> </h4> <!></div>'),Gn=u('<div class="mb-2 pl-3 border-l-2 border-red-900/50"><span class="font-bold text-white"> </span> <span class="text-slate-300"> </span></div>'),Wn=u('<div><h4 class="font-bold text-red-500 uppercase text-xs mb-2 tracking-wider"> </h4> <!></div>'),Qn=u('<div class="mb-2 pl-3 border-l-2 border-orange-900/50"><span class="font-bold text-white"> </span> <span class="text-slate-300"> </span></div>'),Vn=u('<div><h4 class="font-bold text-orange-400 uppercase text-xs mb-2 tracking-wider"> </h4> <!></div>'),Zn=u('<div class="mb-2 pl-3 border-l-2 border-yellow-900/50"><span class="font-bold text-white"> </span> <span class="text-slate-300"> </span></div>'),Xn=u('<div><h4 class="font-bold text-yellow-500 uppercase text-xs mb-2 tracking-wider"> </h4> <!></div>'),Yn=u('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/80 p-4" role="button" tabindex="-1"><div class="bg-slate-800 rounded-xl w-full max-w-6xl h-[90vh] border border-slate-700 shadow-2xl overflow-hidden flex flex-col lg:flex-row" role="dialog" aria-modal="true" aria-labelledby="modal-title"><div class="w-full lg:w-1/2 flex flex-col h-full border-r border-slate-700"><div class="p-4 border-b border-slate-700 bg-slate-900 flex justify-between items-center"><h3 id="modal-title" class="font-bold text-white text-lg"> </h3> <button class="lg:hidden text-slate-400 hover:text-white"><!></button></div> <div class="flex border-b border-slate-700 bg-slate-900/50"><button> </button> <button> </button> <button> </button></div> <div class="flex-1 overflow-y-auto p-6 custom-scrollbar bg-slate-800/50"><!></div> <div class="p-4 border-t border-slate-700 bg-slate-900 flex justify-end gap-3"><button class="px-6 py-2 rounded bg-slate-800 hover:bg-slate-700 text-white font-bold transition-colors"> </button> <button class="px-6 py-2 rounded bg-indigo-600 hover:bg-indigo-500 text-white font-bold flex items-center gap-2 transition-colors"><!> </button></div></div> <div class="hidden lg:flex w-1/2 bg-slate-950 flex-col border-l border-slate-800"><div class="p-4 border-b border-slate-800 bg-slate-950"><h3 class="font-bold text-slate-500 text-xs uppercase flex items-center gap-2"><!> </h3></div> <div class="flex-1 p-8 overflow-y-auto flex items-center justify-center bg-[radial-gradient(ellipse_at_top,_var(--tw-gradient-stops))] from-slate-900 via-slate-950 to-slate-950"><div class="w-full max-w-md bg-slate-900 border border-slate-700 rounded-xl p-5 shadow-2xl relative"><div class="absolute -top-3 -right-3 bg-red-600 text-white text-xs font-bold px-3 py-1 rounded-full shadow-lg border border-red-400"> </div> <div class="flex items-center gap-3 mb-4"><!> <div class="flex-1 min-w-0"><h2 class="text-2xl font-bold text-white mb-1 font-serif tracking-wide truncate"> </h2> <div class="h-1 w-20 bg-red-600 rounded-full"></div></div></div> <div class="grid grid-cols-2 gap-4 mb-4 text-sm"><div class="bg-slate-950 p-2 rounded border border-slate-800 flex justify-between items-center"><span class="text-slate-500 uppercase font-bold text-[10px]"> </span> <span class="text-white font-mono font-bold text-lg"> </span></div> <div class="bg-slate-950 p-2 rounded border border-slate-800 flex justify-between items-center"><span class="text-slate-500 uppercase font-bold text-[10px]"> </span> <span class="text-white font-mono font-bold text-lg"> </span></div> <div class="bg-slate-950 p-2 rounded border border-slate-800 flex justify-between items-center"><span class="text-slate-500 uppercase font-bold text-[10px]"> </span> <span class="text-white font-mono font-bold"> </span></div> <div class="bg-slate-950 p-2 rounded border border-slate-800 flex justify-between items-center"><span class="text-slate-500 uppercase font-bold text-[10px]"> </span> <span class="text-white font-mono font-bold"> </span></div></div> <div class="grid grid-cols-4 gap-2 mb-6 text-center font-mono text-slate-300"></div> <div class="mb-6 space-y-2 text-xs"><!> <!> <!></div> <div class="space-y-5 text-sm"><!> <!> <!> <!></div></div></div></div></div></div> <input type="file" hidden="" accept="image/*"/> <!>',1);function Kn(F,o){ja(o,!0);const i=()=>kt(ba,"$t",Z),[Z,P]=Ia();let p=ra(o,"isOpen",3,!1),U=ra(o,"initialData",3,"{}"),n=Qe(Oa(ee())),y=Qe("stats"),I=Qe(!1),X=Qe(""),ye=Qe(void 0);function we(Ce){const Re=Ce.target.files;if(Re&&Re.length>0){const He=Re[0],Ge=new FileReader;Ge.onload=()=>{O(X,Ge.result,!0),O(I,!0)},Ge.readAsDataURL(He)}Ce.target&&(Ce.target.value="")}async function Se(Ce){try{const Re=await sr(Ce);a(n).imageUrl=Re,O(I,!1)}catch(Re){console.error(Re),alert(Re.message||"Erro ao salvar imagem")}}function ee(){return{name:"",difficulty:1,defense:10,health:10,damage:0,size:1,speed:10,description:"",senses:"",languages:"",immune:"",imageUrl:"",stats:{str:10,agi:10,int:10,wil:10},traits:[],actions:[],reactions:[],endOfRound:[],global:!1}}$s(()=>{if(p()&&U())try{const Ce=JSON.parse(U());Object.keys(Ce).length===0?O(n,ee(),!0):O(n,{...ee(),...Ce},!0)}catch{O(n,ee(),!0)}});function fe(Ce){a(n)[Ce]=[...a(n)[Ce],{name:"",desc:""}]}function le(Ce,Re){a(n)[Ce]=a(n)[Ce].filter((He,Ge)=>Ge!==Re)}function ke(Ce){}var ie=ht(),xt=Ae(ie);{var it=Ce=>{var Re=Yn(),He=Ae(Re);He.__click=ke;var Ge=t(He),et=t(Ge),ge=t(et),Oe=t(ge),te=t(Oe,!0);e(Oe);var Y=s(Oe,2);Y.__click=function(...B){o.onClose?.apply(this,B)};var de=t(Y);Ra(de,{size:20}),e(Y),e(ge);var K=s(ge,2),Ve=t(K);Ve.__click=()=>O(y,"stats");var tt=t(Ve,!0);e(Ve);var Ze=s(Ve,2);Ze.__click=()=>O(y,"attributes");var Pt=t(Ze,!0);e(Ze);var lt=s(Ze,2);lt.__click=()=>O(y,"abilities");var zt=t(lt,!0);e(lt),e(K);var yt=s(K,2),G=t(yt);{var ze=B=>{var W=Sn(),ce=t(W),Fe=t(ce);Fe.__click=()=>a(ye)?.click();var l=t(Fe),d=t(l);Hs(d,()=>a(n).imageUrl,Ne=>{ps(Ne,{get hash(){return a(n).imageUrl},get alt(){return a(n).name},size:"custom",fallbackText:"?"})}),e(l);var c=s(l,2),g=t(c);rr(g,{size:20,class:"text-white"}),e(c),e(Fe);var D=s(Fe,2),C=t(D),k=t(C,!0);e(C);var R=s(C,2);Ye(R),e(D),e(ce);var j=s(ce,2),z=t(j),Q=t(z),re=t(Q,!0);e(Q);var ue=s(Q);Ye(ue),e(z);var J=s(z,2),pe=t(J),_=t(pe,!0);e(pe);var $=s(pe);Ye($),e(J),e(j);var f=s(j,2),T=t(f);Ye(T);var S=s(T,2),m=t(S);$a(m,{size:14});var x=s(m);e(S),e(f);var N=s(f,2),A=t(N),ne=t(A,!0);e(A);var H=s(A,2);Ua(H),e(N);var V=s(N,2),oe=t(V),Ee=t(oe),Be=t(Ee,!0);e(Ee);var ft=s(Ee);Ye(ft),e(oe),e(V),e(W),b((Ne,Et,Dt,Zt,qt,ca,mt)=>{r(k,Ne),r(re,Et),r(_,Dt),r(x,` ${Zt??""}`),r(ne,qt),se(H,"placeholder",ca),r(Be,mt)},[()=>i()("session.enemy_modal.name"),()=>i()("session.enemy_modal.difficulty"),()=>i()("session.enemy_modal.size"),()=>i()("session.enemy_modal.global_enemy"),()=>i()("session.enemy_modal.description"),()=>i()("session.enemy_modal.description_placeholder"),()=>i()("session.enemy_modal.speed")]),Je(R,()=>a(n).name,Ne=>a(n).name=Ne),Je(ue,()=>a(n).difficulty,Ne=>a(n).difficulty=Ne),Je($,()=>a(n).size,Ne=>a(n).size=Ne),Qs(T,()=>a(n).global,Ne=>a(n).global=Ne),Je(H,()=>a(n).description,Ne=>a(n).description=Ne),Je(ft,()=>a(n).speed,Ne=>a(n).speed=Ne),v(B,W)},De=B=>{var W=ht(),ce=Ae(W);{var Fe=d=>{var c=Nn(),g=t(c),D=t(g),C=t(D,!0);e(D);var k=s(D,2);Ie(k,20,()=>["str","agi","int","wil"],ot,(m,x)=>{var N=Rn(),A=t(N),ne=t(A,!0);e(A);var H=s(A,2);Ye(H);var V=s(H,2),oe=t(V);e(V),e(N),b(Ee=>{se(A,"for",`attr-${x??""}`),r(ne,Ee),se(H,"id",`attr-${x??""}`),Ue(V,1,`text-xs font-bold ${a(n).stats[x]-10>=0?"text-green-500":"text-red-500"}`),r(oe,`${a(n).stats[x]-10>=0?"+":""}${a(n).stats[x]-10}`)},[()=>i()("sofww.attributes."+x).substring(0,3)]),Je(H,()=>a(n).stats[x],Ee=>a(n).stats[x]=Ee),v(m,N)}),e(k),e(g);var R=s(g,2),j=t(R),z=t(j),Q=t(z,!0);e(z);var re=s(z);Ye(re),e(j);var ue=s(j,2),J=t(ue),pe=t(J,!0);e(J);var _=s(J);Ye(_),e(ue);var $=s(ue,2),f=t($),T=t(f,!0);e(f);var S=s(f);Ye(S),e($),e(R),e(c),b((m,x,N,A,ne,H,V)=>{r(C,m),r(Q,x),se(re,"placeholder",N),r(pe,A),se(_,"placeholder",ne),r(T,H),se(S,"placeholder",V)},[()=>i()("session.enemy_modal.main_attributes"),()=>i()("session.enemy_modal.senses"),()=>i()("session.enemy_modal.senses_placeholder"),()=>i()("session.enemy_modal.languages"),()=>i()("session.enemy_modal.languages_placeholder"),()=>i()("session.enemy_modal.immunities"),()=>i()("session.enemy_modal.immunities_placeholder")]),Je(re,()=>a(n).senses,m=>a(n).senses=m),Je(_,()=>a(n).languages,m=>a(n).languages=m),Je(S,()=>a(n).immune,m=>a(n).immune=m),v(d,c)},l=d=>{var c=ht(),g=Ae(c);{var D=C=>{var k=Pn();Ie(k,20,()=>[{key:"traits",label:"traits",color:"text-indigo-400",border:"border-indigo-500/30"},{key:"actions",label:"actions",color:"text-red-400",border:"border-red-500/30"},{key:"reactions",label:"reactions",color:"text-orange-400",border:"border-orange-500/30"},{key:"endOfRound",label:"end_of_round",color:"text-yellow-400",border:"border-yellow-500/30"}],ot,(R,j)=>{var z=Tn(),Q=t(z),re=t(Q),ue=t(re,!0);e(re);var J=s(re,2);J.__click=()=>fe(j.key);var pe=t(J);da(pe,{size:12});var _=s(pe);e(J),e(Q);var $=s(Q,2),f=t($);Ie(f,17,()=>a(n)[j.key],ot,(m,x,N)=>{var A=An(),ne=t(A),H=t(ne);Ye(H);var V=s(H,2);Ua(V),e(ne);var oe=s(ne,2);oe.__click=()=>le(j.key,N);var Ee=t(oe);fa(Ee,{size:16}),e(oe),e(A),b((Be,ft)=>{se(H,"placeholder",Be),se(V,"placeholder",ft)},[()=>i()("session.enemy_modal.name_placeholder"),()=>i()("session.enemy_modal.desc_placeholder")]),Je(H,()=>a(x).name,Be=>a(x).name=Be),Je(V,()=>a(x).desc,Be=>a(x).desc=Be),v(m,A)});var T=s(f,2);{var S=m=>{var x=Dn(),N=t(x,!0);e(x),b(A=>r(N,A),[()=>i()("session.enemy_modal.empty")]),v(m,x)};w(T,m=>{a(n)[j.key].length===0&&m(S)})}e($),e(z),b((m,x)=>{Ue(z,1,`p-4 bg-slate-900 rounded border ${j.border??""}`),Ue(re,1,`font-bold text-sm uppercase ${j.color??""}`),r(ue,m),r(_,` ${x??""}`)},[()=>i()("session.enemy_modal."+j.label),()=>i()("session.enemy_modal.add")]),v(R,z)}),e(k),v(C,k)};w(g,C=>{a(y)==="abilities"&&C(D)},!0)}v(d,c)};w(ce,d=>{a(y)==="attributes"?d(Fe):d(l,!1)},!0)}v(B,W)};w(G,B=>{a(y)==="stats"?B(ze):B(De,!1)})}e(yt);var We=s(yt,2),at=t(We);at.__click=function(...B){o.onClose?.apply(this,B)};var bt=t(at,!0);e(at);var ae=s(at,2);ae.__click=()=>o.onSave(a(n));var Pe=t(ae);Ls(Pe,{size:18});var q=s(Pe);e(ae),e(We),e(et);var $e=s(et,2),je=t($e),Me=t(je),Te=t(Me);Us(Te,{size:14});var dt=s(Te);e(Me),e(je);var Xe=s(je,2),st=t(Xe),pt=t(st),$t=t(pt);e(pt);var It=s(pt,2),St=t(It);{var M=B=>{var W=Un(),ce=t(W);ps(ce,{get hash(){return a(n).imageUrl},get alt(){return a(n).name},size:"custom"}),e(W),v(B,W)};w(St,B=>{a(n).imageUrl&&B(M)})}var L=s(St,2),ve=t(L),qe=t(ve,!0);e(ve),Ca(2),e(L),e(It);var vt=s(It,2),ct=t(vt),ut=t(ct),Bt=t(ut,!0);e(ut);var Xt=s(ut,2),Yt=t(Xt,!0);e(Xt),e(ct);var Kt=s(ct,2),Vt=t(Kt),ea=t(Vt,!0);e(Vt);var ia=s(Vt,2),Ut=t(ia,!0);e(ia),e(Kt);var wt=s(Kt,2),Jt=t(wt),Rt=t(Jt,!0);e(Jt);var Gt=s(Jt,2),rt=t(Gt,!0);e(Gt),e(wt);var Ct=s(wt,2),Le=t(Ct),Ot=t(Le,!0);e(Le);var ta=s(Le,2),Ht=t(ta,!0);e(ta),e(Ct),e(vt);var Nt=s(vt,2);Ie(Nt,20,()=>["str","agi","int","wil"],ot,(B,W)=>{var ce=Hn(),Fe=t(ce),l=t(Fe,!0);e(Fe);var d=s(Fe,2),c=t(d),g=s(c),D=t(g);e(g),e(d),e(ce),b(()=>{r(l,W),r(c,`${a(n).stats[W]??""} `),Ue(g,1,`text-xs ${a(n).stats[W]-10>=0?"text-green-500":"text-red-500"}`),r(D,`(${a(n).stats[W]-10>=0?"+":""}${a(n).stats[W]-10})`)}),v(B,ce)}),e(Nt);var At=s(Nt,2),sa=t(At);{var aa=B=>{var W=Ln(),ce=t(W),Fe=t(ce);e(ce);var l=s(ce,2),d=t(l,!0);e(l),e(W),b(c=>{r(Fe,`${c??""}:`),r(d,a(n).senses)},[()=>i()("session.enemy_modal.senses")]),v(B,W)};w(sa,B=>{a(n).senses&&B(aa)})}var na=s(sa,2);{var pa=B=>{var W=Fn(),ce=t(W),Fe=t(ce);e(ce);var l=s(ce,2),d=t(l,!0);e(l),e(W),b(c=>{r(Fe,`${c??""}:`),r(d,a(n).languages)},[()=>i()("session.enemy_modal.languages")]),v(B,W)};w(na,B=>{a(n).languages&&B(pa)})}var Sa=s(na,2);{var h=B=>{var W=qn(),ce=t(W),Fe=t(ce);e(ce);var l=s(ce,2),d=t(l,!0);e(l),e(W),b(c=>{r(Fe,`${c??""}:`),r(d,a(n).immune)},[()=>i()("session.enemy_modal.immunities")]),v(B,W)};w(Sa,B=>{a(n).immune&&B(h)})}e(At);var E=s(At,2),xe=t(E);{var he=B=>{var W=Jn(),ce=t(W),Fe=t(ce,!0);e(ce);var l=s(ce,2);Ie(l,17,()=>a(n).traits,ot,(d,c,g,D)=>{var C=Bn(),k=t(C),R=t(k);e(k);var j=s(k,2),z=t(j,!0);e(j),e(C),b(()=>{r(R,`${a(c).name??""}:`),r(z,a(c).desc)}),v(d,C)}),e(W),b(d=>r(Fe,d),[()=>i()("session.enemy_modal.traits")]),v(B,W)};w(xe,B=>{a(n).traits.length>0&&B(he)})}var Ke=s(xe,2);{var jt=B=>{var W=Wn(),ce=t(W),Fe=t(ce,!0);e(ce);var l=s(ce,2);Ie(l,17,()=>a(n).actions,ot,(d,c,g,D)=>{var C=Gn(),k=t(C),R=t(k);e(k);var j=s(k,2),z=t(j,!0);e(j),e(C),b(()=>{r(R,`${a(c).name??""}:`),r(z,a(c).desc)}),v(d,C)}),e(W),b(d=>r(Fe,d),[()=>i()("session.enemy_modal.actions")]),v(B,W)};w(Ke,B=>{a(n).actions.length>0&&B(jt)})}var Wt=s(Ke,2);{var ma=B=>{var W=Vn(),ce=t(W),Fe=t(ce,!0);e(ce);var l=s(ce,2);Ie(l,17,()=>a(n).reactions,ot,(d,c,g,D)=>{var C=Qn(),k=t(C),R=t(k);e(k);var j=s(k,2),z=t(j,!0);e(j),e(C),b(()=>{r(R,`${a(c).name??""}:`),r(z,a(c).desc)}),v(d,C)}),e(W),b(d=>r(Fe,d),[()=>i()("session.enemy_modal.reactions")]),v(B,W)};w(Wt,B=>{a(n).reactions.length>0&&B(ma)})}var _a=s(Wt,2);{var xa=B=>{var W=Xn(),ce=t(W),Fe=t(ce,!0);e(ce);var l=s(ce,2);Ie(l,17,()=>a(n).endOfRound,ot,(d,c,g,D)=>{var C=Zn(),k=t(C),R=t(k);e(k);var j=s(k,2),z=t(j,!0);e(j),e(C),b(()=>{r(R,`${a(c).name??""}:`),r(z,a(c).desc)}),v(d,C)}),e(W),b(d=>r(Fe,d),[()=>i()("session.enemy_modal.end_of_round")]),v(B,W)};w(_a,B=>{a(n).endOfRound.length>0&&B(xa)})}e(E),e(st),e(Xe),e($e),e(Ge),e(He);var va=s(He,2);va.__change=we,or(va,B=>O(ye,B),()=>a(ye));var ka=s(va,2);ar(ka,{get isOpen(){return a(I)},get imageUrl(){return a(X)},onClose:()=>O(I,!1),onCrop:Se}),b((B,W,ce,Fe,l,d,c,g,D,C,k,R,j,z)=>{se(He,"aria-label",B),r(te,W),Ue(Ve,1,`flex-1 py-3 text-sm font-bold border-b-2 transition-colors ${a(y)==="stats"?"border-indigo-500 text-indigo-400 bg-slate-800":"border-transparent text-slate-500 hover:text-white"}`),r(tt,ce),Ue(Ze,1,`flex-1 py-3 text-sm font-bold border-b-2 transition-colors ${a(y)==="attributes"?"border-indigo-500 text-indigo-400 bg-slate-800":"border-transparent text-slate-500 hover:text-white"}`),r(Pt,Fe),Ue(lt,1,`flex-1 py-3 text-sm font-bold border-b-2 transition-colors ${a(y)==="abilities"?"border-indigo-500 text-indigo-400 bg-slate-800":"border-transparent text-slate-500 hover:text-white"}`),r(zt,l),r(bt,d),r(q,` ${c??""}`),r(dt,` ${g??""}`),r($t,`${D??""} ${a(n).difficulty??""}`),r(qe,C),r(Bt,k),r(Yt,a(n).defense),r(ea,R),r(Ut,a(n).health),r(Rt,j),r(rt,a(n).size),r(Ot,z),r(Ht,a(n).speed)},[()=>i()("session.enemy_modal.close"),()=>i()("session.enemy_modal.title"),()=>i()("session.enemy_modal.tab_general"),()=>i()("session.enemy_modal.tab_attributes"),()=>i()("session.enemy_modal.tab_abilities"),()=>i()("common.buttons.cancel"),()=>i()("common.buttons.save"),()=>i()("session.enemy_modal.preview"),()=>i()("session.enemy_modal.difficulty"),()=>a(n).name||i()("session.enemy_modal.enemy_default"),()=>i()("session.enemy_modal.defense"),()=>i()("session.enemy_modal.health"),()=>i()("session.enemy_modal.size"),()=>i()("session.enemy_modal.speed")]),v(Ce,Re)};w(xt,Ce=>{p()&&Ce(it)})}v(F,ie),Ea(),P()}Ma(["click","change"]);var eo=u('<div class="flex justify-between items-center bg-slate-800 p-2 rounded border border-slate-700"><div class="flex-1"><div class="text-sm font-bold text-white"> </div> <div class="text-[10px] text-slate-400"> </div></div> <div class="flex items-center gap-2"><input type="number" min="1" class="w-12 bg-slate-900 border border-slate-600 rounded text-center text-white"/> <button class="text-red-400 hover:text-red-300"><!></button></div></div>'),to=u('<div class="text-center text-slate-600 italic text-sm py-4"> </div>'),ao=u('<div class="flex justify-between items-center bg-slate-950 p-2 rounded border border-slate-800 hover:border-indigo-500/30 transition-colors"><div><div class="text-sm font-bold text-white max-w-[120px] truncate"> </div> <div class="text-[10px] text-slate-500"> </div></div> <button class="text-indigo-400 hover:text-white p-1 bg-slate-900 rounded border border-slate-800"><!></button></div>'),so=u('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/80 p-4" role="button" tabindex="-1"><div class="bg-slate-800 rounded-xl w-full max-w-2xl p-6 border border-slate-700 shadow-2xl flex flex-col max-h-[90vh]" role="dialog" aria-modal="true" aria-labelledby="encounter-modal-title"><div class="flex justify-between items-center mb-6"><h3 id="encounter-modal-title" class="text-xl font-bold text-white"> </h3> <button class="text-slate-400 hover:text-white"><!></button></div> <div class="space-y-4 mb-6"><div><label for="encounter-name" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="encounter-name" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white outline-hidden focus:border-indigo-500"/></div></div> <div class="flex-1 flex gap-4 min-h-0"><div class="flex-1 bg-slate-900 border border-slate-800 rounded-lg p-3 flex flex-col"><h4 class="text-xs text-slate-500 uppercase font-bold mb-2"> </h4> <div class="flex-1 overflow-y-auto space-y-2 custom-scrollbar"><!> <!></div></div> <div class="flex-1 bg-slate-900 border border-slate-800 rounded-lg p-3 flex flex-col"><h4 class="text-xs text-slate-500 uppercase font-bold mb-2"> </h4> <div class="flex-1 overflow-y-auto space-y-2 custom-scrollbar"></div></div></div> <div class="flex gap-3 mt-6 pt-4 border-t border-slate-700"><button class="flex-1 bg-slate-700 hover:bg-slate-600 text-white py-2 rounded font-bold"> </button> <button class="flex-1 bg-indigo-600 hover:bg-indigo-500 text-white py-2 rounded font-bold flex items-center justify-center gap-2"><!> </button></div></div></div>');function ro(F,o){ja(o,!0);const i=()=>kt(ba,"$t",P),Z=()=>kt(Ps,"$liveEnemies",P),[P,p]=Ia();let U=ra(o,"isOpen",3,!1),n=ra(o,"initialData",3,"{}"),y=Qe(Oa({name:"",enemies:[]}));$s(()=>{if(U()&&n())try{const le=JSON.parse(n());O(y,{name:le.name||"",enemies:le.enemies||[]},!0)}catch{O(y,{name:"",enemies:[]},!0)}});function I(le){a(y).enemies.find(ie=>ie.enemyId===le)?a(y).enemies=a(y).enemies.map(ie=>ie.enemyId===le?{...ie,count:ie.count+1}:ie):a(y).enemies=[...a(y).enemies,{enemyId:le,count:1}]}function X(le){a(y).enemies=a(y).enemies.filter((ke,ie)=>ie!==le)}function ye(le,ke){const ie=Math.max(1,parseInt(ke)||1);a(y).enemies[le].count=ie}function we(le){}var Se=ht(),ee=Ae(Se);{var fe=le=>{var ke=so();ke.__click=we;var ie=t(ke),xt=t(ie),it=t(xt),Ce=t(it,!0);e(it);var Re=s(it,2);Re.__click=function(...q){o.onClose?.apply(this,q)};var He=t(Re);Ra(He,{size:20}),e(Re),e(xt);var Ge=s(xt,2),et=t(Ge),ge=t(et),Oe=t(ge,!0);e(ge);var te=s(ge,2);Ye(te),e(et),e(Ge);var Y=s(Ge,2),de=t(Y),K=t(de),Ve=t(K,!0);e(K);var tt=s(K,2),Ze=t(tt);Ie(Ze,17,()=>a(y).enemies,ot,(q,$e,je)=>{const Me=be(()=>Z().find(ve=>ve.id===a($e).enemyId));var Te=eo(),dt=t(Te),Xe=t(dt),st=t(Xe,!0);e(Xe);var pt=s(Xe,2),$t=t(pt);e(pt),e(dt);var It=s(dt,2),St=t(It);Ye(St),St.__input=ve=>ye(je,ve.target.value);var M=s(St,2);M.__click=()=>X(je);var L=t(M);fa(L,{size:16}),e(M),e(It),e(Te),b(ve=>{r(st,ve),r($t,`Dif ${(a(Me)?a(Me).difficulty:"?")??""}`),Ns(St,a($e).count)},[()=>a(Me)?a(Me).name:i()("session.encounter_modal.unknown")]),v(q,Te)});var Pt=s(Ze,2);{var lt=q=>{var $e=to(),je=t($e,!0);e($e),b(Me=>r(je,Me),[()=>i()("session.encounter_modal.none_added")]),v(q,$e)};w(Pt,q=>{a(y).enemies.length===0&&q(lt)})}e(tt),e(de);var zt=s(de,2),yt=t(zt),G=t(yt,!0);e(yt);var ze=s(yt,2);Ie(ze,5,Z,q=>q.id,(q,$e)=>{var je=ao(),Me=t(je),Te=t(Me),dt=t(Te,!0);e(Te);var Xe=s(Te,2),st=t(Xe);e(Xe),e(Me);var pt=s(Me,2);pt.__click=()=>I(a($e).id);var $t=t(pt);da($t,{size:16}),e(pt),e(je),b(()=>{r(dt,a($e).name),r(st,`Dif ${a($e).difficulty??""}`)}),v(q,je)}),e(ze),e(zt),e(Y);var De=s(Y,2),We=t(De);We.__click=function(...q){o.onClose?.apply(this,q)};var at=t(We,!0);e(We);var bt=s(We,2);bt.__click=()=>o.onSave(a(y));var ae=t(bt);Ls(ae,{size:18});var Pe=s(ae);e(bt),e(De),e(ie),e(ke),b((q,$e,je,Me,Te,dt,Xe,st)=>{se(ke,"aria-label",q),r(Ce,$e),r(Oe,je),se(te,"placeholder",Me),r(Ve,Te),r(G,dt),r(at,Xe),r(Pe,` ${st??""}`)},[()=>i()("session.encounter_modal.close"),()=>i()("session.encounter_modal.title"),()=>i()("session.encounter_modal.name"),()=>i()("session.encounter_modal.name_placeholder"),()=>i()("session.encounter_modal.enemies_in_encounter"),()=>i()("session.encounter_modal.add_enemies"),()=>i()("common.buttons.cancel"),()=>i()("session.encounter_modal.save_encounter")]),Je(te,()=>a(y).name,q=>a(y).name=q),v(le,ke)};w(ee,le=>{U()&&le(fe)})}v(F,Se),Ea(),p()}Ma(["click","input"]);var io=u('<div class="text-[10px] text-slate-400 flex items-center gap-1.5 bg-slate-950 p-1 px-1.5 rounded-lg border border-slate-800/50"><span class="text-indigo-400 font-black"> </span> <span class="font-medium truncate max-w-[80px]"> </span></div>'),no=u('<div class="text-[10px] text-slate-600 italic"> </div>'),oo=u('<div class="bg-slate-900 border border-slate-800 rounded-2xl p-4 transition-all hover:border-indigo-500/30 group relative flex flex-col justify-between shadow-lg hover:shadow-indigo-500/10" role="region"><div class="flex-1"><div class="flex items-center gap-2 mb-2"><div class="font-bold text-white text-base group-hover:text-indigo-400 transition-colors uppercase tracking-tight truncate"> </div> <!></div> <div class="flex flex-wrap gap-1"><!> <!></div></div> <div class="flex gap-2 mt-3 pt-3 border-t border-slate-800/50"><button class="flex-1 bg-indigo-600 hover:bg-indigo-500 text-white py-1.5 rounded-lg text-xs font-bold flex items-center justify-center gap-2 transition-all active:scale-95 shadow-lg shadow-indigo-900/20"><!> </button> <button class="p-1.5 text-slate-400 hover:text-white bg-slate-800/50 rounded-lg border border-slate-800 transition-all" title="Editar"><!></button> <button class="p-1.5 text-slate-400 hover:text-red-400 bg-slate-800/50 rounded-lg border border-slate-800 hover:border-red-900/30 transition-all"><!></button></div></div>'),lo=u('<button class="text-[10px] font-bold text-indigo-400 hover:text-indigo-300 mt-1 uppercase tracking-wider"> </button>'),vo=u('<div class="mb-4 flex-1"><p> </p> <!></div>'),co=u('<div class="mb-4 flex-1 text-[10px] text-slate-600 italic"> </div>'),uo=u('<div class="bg-slate-900 border border-slate-800 rounded-2xl p-5 hover:border-indigo-500/30 transition-all relative group cursor-move hover:shadow-lg hover:shadow-indigo-500/10 active:scale-[0.98] flex flex-col" draggable="true" role="listitem"><div class="flex justify-between items-start mb-3"><div class="flex items-center gap-2"><h3 class="font-bold text-lg text-white group-hover:text-indigo-400 transition-colors"> </h3> <!></div> <span class="text-[10px] font-black bg-indigo-500/10 text-indigo-400 border border-indigo-400/20 px-2 py-1 rounded-lg uppercase"> </span></div> <!> <div class="mt-auto flex gap-2 pt-4 border-t border-slate-800/50"><button class="flex-1 bg-slate-800/50 hover:bg-slate-800 text-white py-2 rounded-xl text-xs font-bold border border-slate-800 transition-all"> </button> <button class="bg-slate-800/50 hover:bg-red-900/20 text-slate-500 hover:text-red-400 px-3 rounded-xl border border-slate-800 hover:border-red-900/30 transition-all"><!></button></div></div>'),bo=u('<div class="text-center text-slate-500 italic col-span-3"> </div>'),_o=u('<div><div class="mb-12"><div class="flex justify-between items-center mb-6"><h3 class="text-sm font-black text-indigo-400 uppercase tracking-widest flex items-center gap-2"><!> </h3></div> <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"><button class="min-h-[120px] border-2 border-dashed border-slate-800 rounded-2xl flex flex-col items-center justify-center text-slate-500 hover:border-indigo-500 hover:text-indigo-400 transition-all hover:bg-indigo-500/5 gap-2 group"><!> <span class="font-bold text-sm"> </span></button> <!></div></div> <div class="mb-6"><h3 class="text-sm font-black text-indigo-400 uppercase tracking-widest flex items-center gap-2 mb-6"><!> </h3></div> <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"><button class="min-h-[180px] border-2 border-dashed border-slate-800 rounded-2xl flex flex-col items-center justify-center text-slate-500 hover:border-indigo-500 hover:text-indigo-400 transition-all hover:bg-indigo-500/5 gap-2 group"><!> <span class="font-bold text-sm"> </span></button> <!> <!></div> <!> <!> <!></div>');function xo(F,o){ja(o,!0);const i=()=>kt(Ps,"$liveEnemies",p),Z=()=>kt(Zs,"$liveEncounters",p),P=()=>kt(ba,"$t",p),[p,U]=Ia();let n=Qe(!1),y=Qe(null),I=Qe("{}"),X=Qe(!1),ye=Qe(null),we=Qe("{}"),Se=Qe(Oa({isOpen:!1,title:"",message:"",onConfirm:()=>{}}));function ee(){return{name:"",difficulty:1,defense:10,health:10,damage:0,size:1,speed:10,description:"",senses:"",languages:"",immune:"",stats:{str:10,agi:10,int:10,wil:10},traits:[],actions:[],reactions:[],endOfRound:[]}}function fe(M=null){O(y,M?M.id:null,!0),M?O(I,JSON.stringify(M),!0):a(Oe)==="sofdl"?O(I,"{}"):O(I,JSON.stringify(ee()),!0),O(n,!0)}let le=Oa(new Set);function ke(M){le.has(M)?le.delete(M):le.add(M)}function ie(M){const L=a(y)||xs(),ve=Qt.get(o.campId);Js.set(L,{...M,id:L,campaignId:o.campId,system:ve?.system||"sofww"}),O(n,!1)}function xt(M){const L=i().find(ve=>ve.id===M);O(Se,{isOpen:!0,title:"Excluir Inimigo",message:`Tem certeza que deseja excluir permanentemente o inimigo "${L?.name||"este inimigo"}"?`,onConfirm:()=>{Js.delete(M),a(Se).isOpen=!1}},!0)}function it(M=null){O(ye,M?M.id:null,!0),O(we,JSON.stringify(M||{name:"",enemies:[]}),!0),O(X,!0)}function Ce(M){const L=a(ye)||xs();Ss.set(L,{...M,id:L,system:a(Oe)}),O(X,!1)}function Re(M){const L=Z().find(ve=>ve.id===M);O(Se,{isOpen:!0,title:"Excluir Encontro",message:`Tem certeza que deseja excluir permanentemente o encontro "${L?.name||"este encontro"}"?`,onConfirm:()=>{Ss.delete(M),a(Se).isOpen=!1}},!0)}function He(M){const L=Qt.get(o.campId);if(!L)return;const ve=L.activeEnemies||[];let qe=[];M.enemies.forEach(vt=>{const ct=i().find(ut=>ut.id===vt.enemyId);if(ct)for(let ut=0;ut<vt.count;ut++)qe.push({...ct,instanceId:xs(),damage:0,currentHealth:ct.health,afflictions:[],acted:!1,initiative:!1})}),Qt.set(o.campId,{...L,activeEnemies:[...ve,...qe]})}function Ge(M,L){M.dataTransfer.setData("text/plain",L.id),M.dataTransfer.effectAllowed="copy"}function et(M){return M.preventDefault(),!1}function ge(M,L){M.preventDefault();const ve=M.dataTransfer.getData("text/plain");if(!ve)return;const qe=L.enemies||[],vt=qe.find(ut=>ut.enemyId===ve);let ct;vt?ct=qe.map(ut=>ut.enemyId===ve?{...ut,count:ut.count+1}:ut):ct=[...qe,{enemyId:ve,count:1}],Ss.set(L.id,{...L,enemies:ct})}let Oe=be(()=>Qt.get(o.campId)?.system||"sofww"),te=be(()=>i().filter(M=>{const ve=(M.system||"sofww")===a(Oe),qe=M.global===!0,vt=M.campaignId===o.campId;return ve&&(qe||vt)})),Y=be(()=>Z().filter(M=>{const ve=(M.system||"sofww")===a(Oe),qe=M.global===!0,vt=M.campaignId===o.campId;return ve&&(qe||vt)}));var de=_o(),K=t(de),Ve=t(K),tt=t(Ve),Ze=t(tt);Ts(Ze,{size:16});var Pt=s(Ze);e(tt),e(Ve);var lt=s(Ve,2),zt=t(lt);zt.__click=()=>it();var yt=t(zt);da(yt,{size:28,class:"group-hover:scale-110 transition-transform"});var G=s(yt,2),ze=t(G,!0);e(G),e(zt);var De=s(zt,2);Ie(De,17,()=>a(Y),M=>M.id,(M,L)=>{var ve=oo(),qe=t(ve),vt=t(qe),ct=t(vt),ut=t(ct,!0);e(ct);var Bt=s(ct,2);{var Xt=Le=>{$a(Le,{size:12,class:"text-indigo-400"})};w(Bt,Le=>{a(L).global&&Le(Xt)})}e(vt);var Yt=s(vt,2),Kt=t(Yt);Ie(Kt,17,()=>a(L).enemies||[],ot,(Le,Ot)=>{const ta=be(()=>i().find(na=>na.id===a(Ot).enemyId));var Ht=io(),Nt=t(Ht),At=t(Nt);e(Nt);var sa=s(Nt,2),aa=t(sa,!0);e(sa),e(Ht),b(()=>{r(At,`${a(Ot).count??""}x`),r(aa,a(ta)?a(ta).name:"...")}),v(Le,Ht)});var Vt=s(Kt,2);{var ea=Le=>{var Ot=no(),ta=t(Ot,!0);e(Ot),b(Ht=>r(ta,Ht),[()=>P()("session.bestiary.empty_encounter")]),v(Le,Ot)};w(Vt,Le=>{a(L).enemies?.length||Le(ea)})}e(Yt),e(qe);var ia=s(qe,2),Ut=t(ia);Ut.__click=()=>He(a(L));var wt=t(Ut);Ds(wt,{size:12,fill:"currentColor"});var Jt=s(wt);e(Ut);var Rt=s(Ut,2);Rt.__click=()=>it(a(L));var Gt=t(Rt);Ar(Gt,{size:14}),e(Rt);var rt=s(Rt,2);rt.__click=()=>Re(a(L).id);var Ct=t(rt);fa(Ct,{size:14}),e(rt),e(ia),e(ve),b(Le=>{se(ve,"aria-label",`Encontro ${a(L).name??""}`),r(ut,a(L).name),r(Jt,` ${Le??""}`)},[()=>P()("session.bestiary.start")]),Ha("dragover",ve,et),Ha("drop",ve,Le=>ge(Le,a(L))),v(M,ve)}),e(lt),e(K);var We=s(K,2),at=t(We),bt=t(at);Pa(bt,{size:16});var ae=s(bt);e(at),e(We);var Pe=s(We,2),q=t(Pe);q.__click=()=>fe();var $e=t(q);da($e,{size:32,class:"group-hover:scale-110 transition-transform"});var je=s($e,2),Me=t(je,!0);e(je),e(q);var Te=s(q,2);Ie(Te,17,()=>a(te),M=>M.id,(M,L)=>{var ve=uo(),qe=t(ve),vt=t(qe),ct=t(vt),ut=t(ct,!0);e(ct);var Bt=s(ct,2);{var Xt=rt=>{$a(rt,{size:14,class:"text-indigo-400"})};w(Bt,rt=>{a(L).global&&rt(Xt)})}e(vt);var Yt=s(vt,2),Kt=t(Yt);e(Yt),e(qe);var Vt=s(qe,2);{var ea=rt=>{var Ct=vo(),Le=t(Ct),Ot=t(Le,!0);e(Le);var ta=s(Le,2);{var Ht=Nt=>{var At=lo();At.__click=()=>ke(a(L).id);var sa=t(At,!0);e(At),b(aa=>r(sa,aa),[()=>le.has(a(L).id)?P()("session.bestiary.see_less"):P()("session.bestiary.see_more")]),v(Nt,At)};w(ta,Nt=>{a(L).description.length>120&&Nt(Ht)})}e(Ct),b(Nt=>{Ue(Le,1,`text-xs text-slate-400 leading-relaxed ${Nt??""}`),r(Ot,a(L).description)},[()=>le.has(a(L).id)?"":"line-clamp-3"]),v(rt,Ct)},ia=rt=>{var Ct=co(),Le=t(Ct,!0);e(Ct),b(Ot=>r(Le,Ot),[()=>P()("session.bestiary.no_description")]),v(rt,Ct)};w(Vt,rt=>{a(L).description?rt(ea):rt(ia,!1)})}var Ut=s(Vt,2),wt=t(Ut);wt.__click=()=>fe(a(L));var Jt=t(wt,!0);e(wt);var Rt=s(wt,2);Rt.__click=()=>xt(a(L).id);var Gt=t(Rt);fa(Gt,{size:14}),e(Rt),e(Ut),e(ve),b((rt,Ct)=>{r(ut,a(L).name),r(Kt,`${rt??""} ${a(L).difficulty??""}`),r(Jt,Ct)},[()=>P()("session.bestiary.level"),()=>P()("common.buttons.edit")]),Ha("dragstart",ve,rt=>Ge(rt,a(L))),v(M,ve)});var dt=s(Te,2);{var Xe=M=>{var L=bo(),ve=t(L,!0);e(L),b(qe=>r(ve,qe),[()=>P()("session.bestiary.no_enemies")]),v(M,L)};w(dt,M=>{a(te).length===0&&M(Xe)})}e(Pe);var st=s(Pe,2);{var pt=M=>{In(M,{get isOpen(){return a(n)},get initialData(){return a(I)},onClose:()=>O(n,!1),onSave:ie})},$t=M=>{Kn(M,{get isOpen(){return a(n)},get initialData(){return a(I)},onClose:()=>O(n,!1),onSave:ie})};w(st,M=>{a(Oe)==="sofdl"?M(pt):M($t,!1)})}var It=s(st,2);ro(It,{get isOpen(){return a(X)},get initialData(){return a(we)},onClose:()=>O(X,!1),onSave:Ce});var St=s(It,2);Vs(St,{get isOpen(){return a(Se).isOpen},get title(){return a(Se).title},get message(){return a(Se).message},get onConfirm(){return a(Se).onConfirm},onCancel:()=>a(Se).isOpen=!1}),e(de),b((M,L,ve,qe)=>{r(Pt,` ${M??""}`),r(ze,L),r(ae,` ${ve??""}`),r(Me,qe)},[()=>P()("session.bestiary.encounters_title"),()=>P()("session.bestiary.new_encounter"),()=>P()("session.bestiary.title"),()=>P()("session.bestiary.new_enemy")]),v(F,de),Ea(),U()}Ma(["click"]);var po=u('<div class="flex items-center gap-1 text-slate-400 ml-1"><!> <span class="text-xs"> </span></div>'),mo=u('<div class="flex items-center gap-1 text-emerald-400"><!> <span class="text-xs font-bold hidden sm:block"> </span></div> <!>',1),fo=u('<div class="flex items-center gap-1 text-slate-500"><!> <span class="text-xs hidden sm:block"> </span></div>'),go=u('<span class="absolute -top-1 -right-1 flex h-3 w-3"><span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-red-400 opacity-75"></span> <span class="relative inline-flex rounded-full h-3 w-3 bg-red-500 border border-slate-900"></span></span>'),ho=u('<header class="bg-slate-900/80 backdrop-blur-md border-b border-white/5 sticky top-0 z-40 shadow-2xl"><div class="max-w-7xl mx-auto px-2 sm:px-4 py-4 sm:py-3"><div class="flex items-center justify-between gap-2 sm:gap-4"><div class="flex items-center gap-1 sm:gap-3 shrink-0"><button class="p-2 text-slate-400 hover:text-white hover:bg-white/5 rounded-full transition-all flex items-center gap-1 group"><!> <!></button> <div class="flex flex-col"><h1 class="text-base sm:text-lg font-black text-white leading-tight truncate max-w-[140px] sm:max-w-none"> </h1> <span class="text-xs text-indigo-400 font-mono font-black uppercase tracking-wider"> </span></div></div> <div class="hidden md:flex bg-slate-950/50 p-1 rounded-xl border border-white/5"><button><!> <span class="hidden min-[400px]:block"> </span></button> <button><!> <span class="hidden min-[400px]:block"> </span></button></div> <div class="flex items-center gap-1 sm:gap-2"><div class="flex items-center gap-2 mr-2 border-r border-white/10 pr-2"><!></div> <button class="p-2 sm:p-2.5 text-slate-400 hover:text-white hover:bg-white/5 rounded-lg transition-all"><!></button> <button class="p-2 sm:p-2.5 bg-indigo-600/10 text-indigo-400 border border-indigo-400/20 rounded-lg hover:bg-indigo-600 hover:text-white transition-all relative"><!> <!></button></div></div></div></header>');function yo(F,o){ja(o,!0);const i=()=>kt(ba,"$t",U),Z=()=>kt(mr,"$syncState",U),P=()=>kt(La,"$isHistoryOpen",U),p=()=>kt(fr,"$hasUnreadRolls",U),[U,n]=Ia();let y=ra(o,"campaignName",3,""),I=ra(o,"gmName",3,"Mestre"),X=ra(o,"activeSubTab",3,"session"),ye=ra(o,"onTabChange",3,()=>{}),we=ra(o,"onOpenSettings",3,()=>{});var Se=ho(),ee=t(Se),fe=t(ee),le=t(fe),ke=t(le);ke.__click=()=>Pr(Ks("/"));var ie=t(ke);tr(ie,{size:20,class:"group-hover:-translate-x-0.5 transition-transform"});var xt=s(ie,2);Mr(xt,{size:18,class:"hidden sm:block opacity-50"}),e(ke);var it=s(ke,2),Ce=t(it),Re=t(Ce,!0);e(Ce);var He=s(Ce,2),Ge=t(He,!0);e(He),e(it),e(le);var et=s(le,2),ge=t(et);ge.__click=()=>ye()("session");var Oe=t(ge);{let ae=be(()=>X()==="session"?"opacity-100":"opacity-50");ir(Oe,{size:14,get class(){return a(ae)}})}var te=s(Oe,2),Y=t(te,!0);e(te),e(ge);var de=s(ge,2);de.__click=()=>ye()("bestiary");var K=t(de);{let ae=be(()=>X()==="bestiary"?"opacity-100":"opacity-50");lr(K,{size:14,get class(){return a(ae)}})}var Ve=s(K,2),tt=t(Ve,!0);e(Ve),e(de),e(et);var Ze=s(et,2),Pt=t(Ze),lt=t(Pt);{var zt=ae=>{var Pe=mo(),q=Ae(Pe),$e=t(q);Ys($e,{size:16});var je=s($e,2),Me=t(je,!0);e(je),e(q);var Te=s(q,2);{var dt=Xe=>{var st=po(),pt=t(st);Xs(pt,{size:14});var $t=s(pt,2),It=t($t,!0);e($t),e(st),b(St=>{se(st,"title",St),r(It,Z().peers.length)},[()=>i()("common.status.peers",{values:{count:Z().peers.length}})]),v(Xe,st)};w(Te,Xe=>{Z().peers.length>0&&Xe(dt)})}b((Xe,st)=>{se(q,"title",Xe),r(Me,st)},[()=>i()("common.status.connected"),()=>i()("common.status.connected")]),v(ae,Pe)},yt=ae=>{var Pe=fo(),q=t(Pe);Ur(q,{size:16});var $e=s(q,2),je=t($e,!0);e($e),e(Pe),b((Me,Te)=>{se(Pe,"title",Me),r(je,Te)},[()=>i()("common.status.offline"),()=>i()("common.status.offline")]),v(ae,Pe)};w(lt,ae=>{Z().isConnected?ae(zt):ae(yt,!1)})}e(Pt);var G=s(Pt,2);G.__click=function(...ae){we()?.apply(this,ae)};var ze=t(G);Dr(ze,{size:20}),e(G);var De=s(G,2);De.__click=()=>La.update(ae=>!ae);var We=t(De);Ir(We,{size:20});var at=s(We,2);{var bt=ae=>{var Pe=go();v(ae,Pe)};w(at,ae=>{p()&&ae(bt)})}e(De),e(Ze),e(fe),e(ee),e(Se),b((ae,Pe,q,$e,je,Me,Te,dt)=>{se(ke,"aria-label",ae),se(ke,"title",Pe),r(Re,y()),r(Ge,I()),Ue(ge,1,`flex items-center gap-2 px-3 sm:px-4 py-1.5 rounded-lg text-xs font-black transition-all ${X()==="session"?"bg-indigo-600 text-white shadow-lg shadow-indigo-500/20":"text-slate-500 hover:text-slate-300"}`),se(ge,"aria-pressed",X()==="session"),r(Y,q),Ue(de,1,`flex items-center gap-2 px-3 sm:px-4 py-1.5 rounded-lg text-xs font-black transition-all ${X()==="bestiary"?"bg-indigo-600 text-white shadow-lg shadow-indigo-500/20":"text-slate-500 hover:text-slate-300"}`),se(de,"aria-pressed",X()==="bestiary"),r(tt,$e),se(G,"aria-label",je),se(G,"title",Me),se(De,"aria-label",Te),se(De,"title",dt),se(De,"aria-pressed",P())},[()=>i()("character.header.back_dashboard"),()=>i()("character.header.back_dashboard"),()=>i()("common.labels.session"),()=>i()("common.labels.bestiary"),()=>i()("common.buttons.settings"),()=>i()("common.buttons.settings"),()=>i()("character.header.history"),()=>i()("character.header.history")]),v(F,Se),Ea(),n()}Ma(["click"]);var wo=u('<!> <!> <main class="max-w-7xl mx-auto p-4 md:p-8 animate-in slide-in-from-bottom-4 duration-500"><!></main>',1),ko=u('<div class="flex flex-col items-center justify-center min-h-screen p-4 text-center"><div class="w-20 h-20 bg-slate-800 rounded-full flex items-center justify-center mx-auto mb-6 text-slate-600"><svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-ghost"><path d="M9 10h.01"></path><path d="M15 10h.01"></path><path d="M12 2a8 8 0 0 0-8 8v12l3-3 2.5 2.5L12 19l2.5 2.5L17 19l3 3V10a8 8 0 0 0-8-8z"></path></svg></div> <h1 class="text-2xl font-black text-white mb-2 uppercase tracking-tight"> </h1> <p class="text-slate-400 mb-8 max-w-md"> </p> <button class="bg-indigo-600 hover:bg-indigo-500 text-white px-8 py-3 rounded-xl font-bold transition-all flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-arrow-left"><path d="m12 19-7-7 7-7"></path><path d="19 12H5"></path></svg> </button></div>'),zo=u('<div class="flex items-center justify-center min-h-screen"><div class="relative w-16 h-16"><div class="absolute inset-0 border-4 border-indigo-500/20 rounded-full"></div> <div class="absolute inset-0 border-4 border-indigo-500 border-t-transparent rounded-full animate-spin"></div></div></div>'),$o=u('<div class="fixed bottom-24 left-1/2 -translate-x-1/2 md:left-8 md:translate-x-0 z-[60] flex flex-col items-center gap-2"><div class="bg-slate-900/95 backdrop-blur-md border border-white/10 rounded-2xl p-2 flex items-center gap-2 shadow-2xl animate-in zoom-in-95 slide-in-from-bottom-4 duration-200"><button class="bg-indigo-600/20 hover:bg-indigo-600 text-indigo-400 hover:text-white font-bold w-12 h-12 rounded-xl flex flex-col items-center justify-center transition-all active:scale-95 shadow-lg border border-indigo-500/20"><span class="text-[10px] opacity-70">d20</span> <!></button> <button class="bg-slate-800 hover:bg-slate-700 text-white font-bold w-12 h-12 rounded-xl flex flex-col items-center justify-center transition-all active:scale-95 shadow-lg border border-white/5"><span class="text-[10px] opacity-70">1d6</span> <!></button> <button class="bg-slate-800 hover:bg-slate-700 text-white font-bold w-12 h-12 rounded-xl flex flex-col items-center justify-center transition-all active:scale-95 shadow-lg border border-white/5"><span class="text-[10px] opacity-70">2d6</span> <!></button> <button class="bg-slate-800 hover:bg-slate-700 text-white font-bold w-12 h-12 rounded-xl flex flex-col items-center justify-center transition-all active:scale-95 shadow-lg border border-white/5"><span class="text-[10px] opacity-70">3d6</span> <!></button> <div class="w-px h-8 bg-white/10 mx-1"></div> <button class="w-10 h-10 flex items-center justify-center text-slate-500 hover:text-white transition-colors"><!></button></div></div>  <div class="fixed inset-0 bg-black/40 z-[55]"></div>',1),Co=u('<div class="min-h-screen bg-slate-950 text-slate-100 font-sans pb-20"><!> <!> <!> <div class="hidden md:block fixed bottom-8 left-8 z-[60]"><button class="w-16 h-16 bg-indigo-600 hover:bg-indigo-500 text-white rounded-full shadow-[0_0_20px_rgba(79,70,229,0.4)] flex items-center justify-center transition-all active:scale-90 border-2 border-white/10 group" title="Rolagens Rápidas"><!></button></div> <nav class="md:hidden fixed bottom-0 left-0 right-0 z-50 px-4 pb-6 pt-2 pointer-events-none"><div class="max-w-md mx-auto relative h-16 pointer-events-auto"><div class="absolute inset-0 bg-slate-900 border border-white/10 rounded-2xl shadow-2xl overflow-hidden"><div class="absolute inset-x-0 top-0 h-px bg-gradient-to-r from-transparent via-indigo-500/30 to-transparent"></div></div> <div class="relative h-full flex items-center justify-around px-2"><button><!> <span class="text-[9px] font-black uppercase tracking-widest leading-none">Sessão</span></button> <div class="relative w-16 h-16 -mt-10 flex items-center justify-center"><div class="absolute inset-0 bg-indigo-600/20 rounded-full blur-xl animate-pulse"></div> <button class="relative w-14 h-14 bg-indigo-600 rounded-full flex items-center justify-center shadow-[0_0_20px_rgba(79,70,229,0.5)] border-4 border-slate-900 transition-all active:scale-90 hover:bg-indigo-500 z-10" aria-label="Rolar Dados"><!></button></div> <button><!> <span class="text-[9px] font-black uppercase tracking-widest leading-none">Bestiário</span></button></div></div></nav> <!></div>');function Wo(F,o){ja(o,!0);const i=()=>kt(_r,"$page",U),Z=()=>kt(yr,"$liveCampaigns",U),P=()=>kt(ba,"$t",U),p=()=>kt(La,"$isHistoryOpen",U),[U,n]=Ia();let y=Qe("session"),I=Qe(!1),X=be(()=>i().params.id),ye=be(()=>Z().find(G=>G.id===a(X))),we=be(()=>!!a(ye));function Se(G){if(!a(X)||!a(ye))return;const ze={...a(ye),...G};Qt.set(a(X),ze),As(a(X),{name:ze.name,gmName:ze.gmName}),O(I,!1)}let ee=Qe(!1),fe=Qe(Oa({isOpen:!1,sides:20,count:1,modifier:0}));function le(G,ze=1){O(fe,{isOpen:!0,sides:G,count:ze,modifier:0},!0)}function ke(G){if(!a(ye))return;const ze=wi(a(fe).sides,a(fe).count,G);let De="";a(fe).count>1&&(De+=`Dados: [${ze.results.join(", ")}] `),ze.bonusRolls?.length>0&&(De+=`Bonus Rolls: [${ze.bonusRolls.join(", ")}] -> ${Math.abs(ze.modifierTotal)}`);const We=a(ye).gmName||Rs(ba)("common.labels.master");gr.addToHistory({source:"GM",charName:We,name:`${a(fe).count}d${a(fe).sides} ${G?G>0?`+${G}`:G:""}`,description:De.trim()||null,total:ze.total,formula:ze.formula,crit:ze.crit}),La.set(!0),a(fe).isOpen=!1}var ie=Co(),xt=t(ie);{var it=G=>{var ze=wo(),De=Ae(ze);yo(De,{get campaignName(){return a(ye).name},get gmName(){return a(ye).gmName},get activeSubTab(){return a(y)},onTabChange:q=>O(y,q,!0),onOpenSettings:()=>O(I,!0)});var We=s(De,2);{let q=be(()=>JSON.stringify(a(ye)));Tr(We,{get isOpen(){return a(I)},get initialData(){return a(q)},onClose:()=>O(I,!1),onSave:Se})}var at=s(We,2),bt=t(at);{var ae=q=>{rn(q,{get campaign(){return a(ye)}})},Pe=q=>{var $e=ht(),je=Ae($e);{var Me=Te=>{xo(Te,{get campId(){return a(X)}})};w(je,Te=>{a(y)==="bestiary"&&Te(Me)},!0)}v(q,$e)};w(bt,q=>{a(y)==="session"?q(ae):q(Pe,!1)})}e(at),v(G,ze)},Ce=G=>{var ze=ht(),De=Ae(ze);{var We=bt=>{var ae=ko(),Pe=s(t(ae),2),q=t(Pe,!0);e(Pe);var $e=s(Pe,2),je=t($e,!0);e($e);var Me=s($e,2);Me.__click=()=>window.history.back();var Te=s(t(Me));e(Me),e(ae),b((dt,Xe,st)=>{r(q,dt),r(je,Xe),r(Te,` ${st??""}`)},[()=>P()("campaign.not_found.title"),()=>P()("campaign.not_found.message"),()=>P()("common.buttons.back")]),v(bt,ae)},at=bt=>{var ae=zo();v(bt,ae)};w(De,bt=>{a(we)&&!a(ye)?bt(We):bt(at,!1)},!0)}v(G,ze)};w(xt,G=>{a(we)&&a(ye)?G(it):G(Ce,!1)})}var Re=s(xt,2);er(Re,{get isOpen(){return p()},onClose:()=>La.set(!1)});var He=s(Re,2);{var Ge=G=>{var ze=$o(),De=Ae(ze),We=t(De),at=t(We);at.__click=()=>{le(20),O(ee,!1)};var bt=s(t(at),2);Xa(bt,{size:16}),e(at);var ae=s(at,2);ae.__click=()=>{le(6),O(ee,!1)};var Pe=s(t(ae),2);Xa(Pe,{size:16}),e(ae);var q=s(ae,2);q.__click=()=>{le(6,2),O(ee,!1)};var $e=s(t(q),2);Xa($e,{size:16}),e(q);var je=s(q,2);je.__click=()=>{le(6,3),O(ee,!1)};var Me=s(t(je),2);Xa(Me,{size:16}),e(je);var Te=s(je,4);Te.__click=()=>O(ee,!1);var dt=t(Te);Ra(dt,{size:20}),e(Te),e(We),e(De);var Xe=s(De,2);Xe.__click=()=>O(ee,!1),v(G,ze)};w(He,G=>{a(ee)&&G(Ge)})}var et=s(He,2),ge=t(et);ge.__click=()=>O(ee,!a(ee));var Oe=t(ge);Xa(Oe,{size:32,class:"group-hover:rotate-12 transition-transform"}),e(ge),e(et);var te=s(et,2),Y=t(te),de=s(t(Y),2),K=t(de);K.__click=()=>{O(y,"session"),O(ee,!1)};var Ve=t(K);{let G=be(()=>a(y)==="session"?"animate-in zoom-in-75 duration-300":"");ir(Ve,{size:20,get class(){return a(G)}})}Ca(2),e(K);var tt=s(K,2),Ze=s(t(tt),2);Ze.__click=()=>O(ee,!a(ee));var Pt=t(Ze);{let G=be(()=>a(ee)?"rotate-90":"rotate-0");Xa(Pt,{size:28,get class(){return`text-white ${a(G)??""} transition-transform duration-300`}})}e(Ze),e(tt);var lt=s(tt,2);lt.__click=()=>{O(y,"bestiary"),O(ee,!1)};var zt=t(lt);{let G=be(()=>a(y)==="bestiary"?"animate-in zoom-in-75 duration-300":"");lr(zt,{size:20,get class(){return a(G)}})}Ca(2),e(lt),e(de),e(Y),e(te);var yt=s(te,2);{let G=be(()=>`${P()("session.quick.roll_title")} (${a(fe).count}d${a(fe).sides})`),ze=be(()=>a(fe).sides===20?P()("session.quick.boons_banes"):P()("session.quick.fixed_modifier"));Sr(yt,{get isOpen(){return a(fe).isOpen},get title(){return a(G)},get label(){return a(ze)},onClose:()=>a(fe).isOpen=!1,onRoll:ke,initialModifier:0})}e(ie),b(()=>{Ue(K,1,`flex flex-col items-center justify-center gap-1 flex-1 transition-all ${a(y)==="session"?"text-indigo-400":"text-slate-500 hover:text-slate-300"}`),Ue(lt,1,`flex flex-col items-center justify-center gap-1 flex-1 transition-all ${a(y)==="bestiary"?"text-indigo-400":"text-slate-500 hover:text-slate-300"}`)}),v(F,ie),Ea(),n()}Ma(["click"]);export{Wo as component};
