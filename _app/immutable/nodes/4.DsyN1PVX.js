import"../chunks/DsnmJJEf.js";import{v as Ze,w as ye,k as c,x as Yt,z as ea,j as _,B as t,y as a,A as r,T as pe,I as e,t as g,L as za,F as P,R as Le,n as Xt,a2 as Zt,at as Ea}from"../chunks/DzRT0qSm.js";import{d as ta,s as n,o as Ma,g as ga,e as ha}from"../chunks/9QvhKPlK.js";import{l as jt,s as It,i as M,p as Ot}from"../chunks/DV-HjJ0V.js";import{s as aa,a as et}from"../chunks/FHgTlLI2.js";import{e as Se,s as Ie,i as nt,$ as Lt,r as Ct,a as qe,h as wa,f as Ja}from"../chunks/DmTIwYKB.js";import{p as Qa}from"../chunks/BJ_-t_s-.js";import{A as Oa,d as ja,k as fa,a as Za,c as Ia,e as wt,l as ka,m as Xa,n as sa,o as Ka,q as _a,u as ba,b as Mt,f as Na,g as ya,t as Ya,v as er}from"../chunks/X4NrN1r0.js";import{C as Ra,b as Ca,c as Ta,l as tr,a as ar}from"../chunks/D2me_ZW1.js";import{b as rr}from"../chunks/5J4TPCGy.js";import{U as Pa,W as Da,r as Ha}from"../chunks/CjPCTWfV.js";import{a as sr,A as $a,M as ir,G as pa,D as nr,b as or,H as Aa,C as La,c as lr,I as dr,s as vr,d as cr,L as ur,S as br,e as xr}from"../chunks/L7udz8me.js";import{k as qa}from"../chunks/EXkVLeJy.js";import{M as mr,X as xa,P as Kt,c as _r,T as va,b as fr,a as pr}from"../chunks/BJHf1IjA.js";import{C as Ua,S as gr,G as hr,P as Fa,a as yr}from"../chunks/rVZK7Kok.js";import"../chunks/DdC0RNGD.js";import{I as Nt,s as St}from"../chunks/Byjcbj0b.js";import{C as Sa}from"../chunks/B42Mvk0m.js";import{b as wr}from"../chunks/DoXFKFJ1.js";import{g as kr}from"../chunks/BZQ3suj6.js";import{W as $r}from"../chunks/Cf2wkrTz.js";function zr(C,s){const l=jt(s,["children","$$slots","$$events","$$legacy"]);const x=[["path",{d:"m6 9 6 6 6-6"}]];Nt(C,It({name:"chevron-down"},()=>l,{get iconNode(){return x},children:(k,D)=>{var w=Ze(),v=ye(w);St(v,s,"default",{}),c(k,w)},$$slots:{default:!0}}))}function Cr(C,s){const l=jt(s,["children","$$slots","$$events","$$legacy"]);const x=[["path",{d:"m18 15-6-6-6 6"}]];Nt(C,It({name:"chevron-up"},()=>l,{get iconNode(){return x},children:(k,D)=>{var w=Ze(),v=ye(w);St(v,s,"default",{}),c(k,w)},$$slots:{default:!0}}))}function Er(C,s){const l=jt(s,["children","$$slots","$$events","$$legacy"]);const x=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"}]];Nt(C,It({name:"copy"},()=>l,{get iconNode(){return x},children:(k,D)=>{var w=Ze(),v=ye(w);St(v,s,"default",{}),c(k,w)},$$slots:{default:!0}}))}function Mr(C,s){const l=jt(s,["children","$$slots","$$events","$$legacy"]);const x=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0"}],["circle",{cx:"12",cy:"12",r:"3"}]];Nt(C,It({name:"eye"},()=>l,{get iconNode(){return x},children:(k,D)=>{var w=Ze(),v=ye(w);St(v,s,"default",{}),c(k,w)},$$slots:{default:!0}}))}function Or(C,s){const l=jt(s,["children","$$slots","$$events","$$legacy"]);const x=[["path",{d:"M12 3q1 4 4 6.5t3 5.5a1 1 0 0 1-14 0 5 5 0 0 1 1-3 1 1 0 0 0 5 0c0-2-1.5-3-1.5-5q0-2 2.5-4"}]];Nt(C,It({name:"flame"},()=>l,{get iconNode(){return x},children:(k,D)=>{var w=Ze(),v=ye(w);St(v,s,"default",{}),c(k,w)},$$slots:{default:!0}}))}function jr(C,s){const l=jt(s,["children","$$slots","$$events","$$legacy"]);const x=[["circle",{cx:"9",cy:"12",r:"1"}],["circle",{cx:"9",cy:"5",r:"1"}],["circle",{cx:"9",cy:"19",r:"1"}],["circle",{cx:"15",cy:"12",r:"1"}],["circle",{cx:"15",cy:"5",r:"1"}],["circle",{cx:"15",cy:"19",r:"1"}]];Nt(C,It({name:"grip-vertical"},()=>l,{get iconNode(){return x},children:(k,D)=>{var w=Ze(),v=ye(w);St(v,s,"default",{}),c(k,w)},$$slots:{default:!0}}))}function Ba(C,s){const l=jt(s,["children","$$slots","$$events","$$legacy"]);const x=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17"}]];Nt(C,It({name:"layers"},()=>l,{get iconNode(){return x},children:(k,D)=>{var w=Ze(),v=ye(w);St(v,s,"default",{}),c(k,w)},$$slots:{default:!0}}))}function Ir(C,s){const l=jt(s,["children","$$slots","$$events","$$legacy"]);const x=[["path",{d:"m16 6 4 14"}],["path",{d:"M12 6v14"}],["path",{d:"M8 8v12"}],["path",{d:"M4 4v16"}]];Nt(C,It({name:"library"},()=>l,{get iconNode(){return x},children:(k,D)=>{var w=Ze(),v=ye(w);St(v,s,"default",{}),c(k,w)},$$slots:{default:!0}}))}function Nr(C,s){const l=jt(s,["children","$$slots","$$events","$$legacy"]);const x=[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3"}],["path",{d:"M21 21v.01"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7"}],["path",{d:"M3 12h.01"}],["path",{d:"M12 3h.01"}],["path",{d:"M12 16v.01"}],["path",{d:"M16 12h1"}],["path",{d:"M21 12v.01"}],["path",{d:"M12 21v-1"}]];Nt(C,It({name:"qr-code"},()=>l,{get iconNode(){return x},children:(k,D)=>{var w=Ze(),v=ye(w);St(v,s,"default",{}),c(k,w)},$$slots:{default:!0}}))}function Sr(C,s){const l=jt(s,["children","$$slots","$$events","$$legacy"]);const x=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"}],["path",{d:"M3 3v5h5"}]];Nt(C,It({name:"rotate-ccw"},()=>l,{get iconNode(){return x},children:(k,D)=>{var w=Ze(),v=ye(w);St(v,s,"default",{}),c(k,w)},$$slots:{default:!0}}))}function Va(C,s){const l=jt(s,["children","$$slots","$$events","$$legacy"]);const x=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7"}]];Nt(C,It({name:"save"},()=>l,{get iconNode(){return x},children:(k,D)=>{var w=Ze(),v=ye(w);St(v,s,"default",{}),c(k,w)},$$slots:{default:!0}}))}function Wa(C,s){const l=jt(s,["children","$$slots","$$events","$$legacy"]);const x=[["polyline",{points:"14.5 17.5 3 6 3 3 6 3 17.5 14.5"}],["line",{x1:"13",x2:"19",y1:"19",y2:"13"}],["line",{x1:"16",x2:"20",y1:"16",y2:"20"}],["line",{x1:"19",x2:"21",y1:"21",y2:"19"}],["polyline",{points:"14.5 6.5 18 3 21 3 21 6 17.5 9.5"}],["line",{x1:"5",x2:"9",y1:"14",y2:"18"}],["line",{x1:"7",x2:"4",y1:"17",y2:"20"}],["line",{x1:"3",x2:"5",y1:"19",y2:"21"}]];Nt(C,It({name:"swords"},()=>l,{get iconNode(){return x},children:(k,D)=>{var w=Ze(),v=ye(w);St(v,s,"default",{}),c(k,w)},$$slots:{default:!0}}))}function Rr(C){let s=!1;return document.body&&(document.body.appendChild(C),s=!0),{destroy(){s&&C.parentNode&&C.parentNode.removeChild(C)}}}var Tr=_("<button> <!></button>"),Pr=_('<p class="text-xs text-slate-600 italic"> </p>'),Dr=_('<div class="text-xs leading-tight"><span class="text-red-400 font-bold"> </span> <span class="text-slate-400"> </span></div>'),Hr=_('<div class="space-y-1"></div>'),Ar=_('<div class="grid grid-cols-2 gap-2 max-h-[60vh] overflow-y-auto custom-scrollbar p-1"></div> <div class="mt-4 pt-3 border-t border-slate-800 flex flex-col gap-2"><div class="p-3 bg-slate-900/50 rounded-lg border border-slate-700/50 min-h-[60px]"><p class="text-[10px] text-slate-500 uppercase font-bold mb-1"> </p> <!></div> <div class="flex justify-end mt-2"><button class="bg-indigo-600 text-white px-4 py-2 rounded-xl font-bold text-sm shadow hover:bg-indigo-500 transition-colors w-full sm:w-auto"> </button></div></div>',1),Lr=_("<div><!></div>");function qr(C,s){Yt(s,!0);const l=()=>et(Lt,"$t",x),[x,k]=aa();var D=Ze(),w=ye(D);{var v=O=>{var N=Lr(),K=t(N);{let Y=pe(()=>l()("session.affliction_modal.title"));mr(K,{get isOpen(){return s.isOpen},get onClose(){return s.onClose},get title(){return a(Y)},maxWidth:"max-w-md",children:(je,ce)=>{var we=Ar(),Re=ye(we);Se(Re,21,()=>Object.keys(Oa),nt,(U,E)=>{const de=pe(()=>s.afflictions.includes(a(E)));var xe=Tr();xe.__click=()=>s.onToggle(a(E));var ze=t(xe),me=r(ze);{var Xe=Te=>{Ua(Te,{size:14,class:"text-red-400"})};M(me,Te=>{a(de)&&Te(Xe)})}e(xe),g(()=>{Ie(xe,1,`flex items-center justify-between px-3 py-2 rounded-lg border text-xs font-bold transition-all ${a(de)?"bg-red-500/20 border-red-500 text-red-100":"bg-slate-800 border-slate-700 text-slate-400 hover:bg-slate-750"}`),n(ze,`${a(E)??""} `)}),c(U,xe)}),e(Re);var H=r(Re,2),Q=t(H),oe=t(Q),le=t(oe,!0);e(oe);var ke=r(oe,2);{var F=U=>{var E=Pr(),de=t(E,!0);e(E),g(xe=>n(de,xe),[()=>l()("session.affliction_modal.none_selected")]),c(U,E)},W=U=>{var E=Hr();Se(E,21,()=>s.afflictions,nt,(de,xe)=>{var ze=Dr(),me=t(ze),Xe=t(me);e(me);var Te=r(me,2),We=t(Te,!0);e(Te),e(ze),g(()=>{n(Xe,`${a(xe)??""}:`),n(We,Oa[a(xe)]?.effect)}),c(de,ze)}),e(E),c(U,E)};M(ke,U=>{s.afflictions.length===0?U(F):U(W,!1)})}e(Q);var se=r(Q,2),G=t(se);G.__click=function(...U){s.onClose?.apply(this,U)};var $e=t(G,!0);e(G),e(se),e(H),g((U,E)=>{n(le,U),n($e,E)},[()=>l()("session.affliction_modal.effects"),()=>l()("session.affliction_modal.done")]),c(je,we)},$$slots:{default:!0}})}e(N),sr(N,Y=>Rr?.(Y)),c(O,N)};M(w,O=>{s.isOpen&&O(v)})}c(C,D),ea(),k()}ta(["click"]);var Ur=_('<div class="absolute top-0 right-0 bg-gradient-to-l from-yellow-600/20 to-transparent border-l border-b border-yellow-500/30 text-yellow-500 text-[9px] font-black tracking-widest px-3 py-1 rounded-bl-xl z-20 uppercase shadow-[0_0_10px_rgba(234,179,8,0.2)]"> </div>'),Fr=_('<div class="absolute inset-0 bg-red-950/40 animate-pulse z-0 pointer-events-none"></div>'),Br=_('<span class="text-[9px] font-black bg-red-950/40 text-red-500 px-1.5 py-0.5 rounded border border-red-900/30 uppercase tracking-wider flex-shrink-0"> </span>'),Vr=_("<button><!></button>"),Wr=_('<button class="w-7 h-7 flex items-center justify-center rounded bg-slate-800/50 text-slate-600 hover:text-red-400 hover:bg-red-950/30 border border-slate-700/50 transition-colors"><!></button>'),Gr=_('<div><div class="absolute inset-0 bg-gradient-to-b from-white/20 to-transparent"></div></div>'),Jr=_('<div class="absolute inset-0 bg-gradient-to-r from-emerald-500/20 via-emerald-400/30 to-emerald-500/20 z-10"><div class="absolute inset-0 bg-gradient-to-b from-white/10 to-transparent"></div></div>'),Qr=_('<div class="absolute inset-0 flex items-center justify-center pointer-events-none z-20"><span class="text-[9px] font-black uppercase text-white drop-shadow-[0_1px_1px_rgba(0,0,0,0.8)] tracking-widest leading-none mt-0.5"> </span></div>'),Zr=_('<div class="absolute inset-0 flex items-center justify-center pointer-events-none z-20"><span class="text-[9px] font-black uppercase text-white drop-shadow-[0_1px_1px_rgba(0,0,0,0.8)] tracking-widest leading-none mt-0.5"> </span></div>'),Xr=_('<button class="text-[9px] bg-red-500/10 text-red-400 px-1.5 py-0.5 rounded border border-red-500/20 hover:bg-red-500/20 hover:border-red-500/40 transition-all flex items-center gap-1 group/btn"> <!></button>'),Kr=_('<div class="bg-slate-900/50 p-2 rounded border border-slate-800/50 text-center"><span class="text-[9px] text-slate-500 uppercase font-black block mb-0.5"> </span> <div class="text-white font-bold font-mono text-lg leading-none"> </div> <div> </div></div>'),Yr=_('<div class="text-sm bg-slate-900/30 p-2 rounded border border-slate-800/30"><span class="font-bold text-slate-300"> </span> <span class="text-slate-400 text-xs block mt-1 leading-relaxed"> </span></div>'),es=_('<div><div> <span class="h-px flex-1 bg-current opacity-20"></span></div> <div class="grid gap-2"></div></div>'),ts=_('<div class="border-t border-slate-800/50 bg-slate-950/30 p-4"><div class="mb-4"><div class="text-slate-500 font-bold uppercase text-[10px] mb-2 flex items-center gap-2"><span> </span> <div class="h-px flex-1 bg-slate-800"></div></div> <div class="grid grid-cols-4 gap-2"></div></div> <div class="grid grid-cols-3 gap-4 mb-4"><div class="p-2 rounded bg-slate-900/50 border border-slate-800/50 flex flex-col items-center"><span class="text-[9px] text-slate-500 uppercase font-black"> </span> <span class="text-white font-bold"> </span></div> <div class="p-2 rounded bg-slate-900/50 border border-slate-800/50 flex flex-col items-center"><span class="text-[9px] text-slate-500 uppercase font-black"> </span> <span class="text-white font-bold"> </span></div> <div class="p-2 rounded bg-slate-900/50 border border-slate-800/50 flex flex-col items-center"><span class="text-[9px] text-slate-500 uppercase font-black"> </span> <span class="text-white font-bold"> </span></div></div> <div class="space-y-4"></div></div>'),as=_('<div><!> <!> <div class="relative z-10 p-4"><div class="flex items-start gap-4 mb-3"><div class="relative flex-shrink-0"><div><!></div> <button><!></button></div> <div class="flex-1 min-w-0"><div class="flex justify-between items-start mb-1"><div class="flex flex-col min-w-0 mr-2"><div class="flex items-center gap-2"><h3> </h3> <!></div></div> <div class="flex gap-1 flex-shrink-0"><button class="w-7 h-7 flex items-center justify-center rounded bg-slate-800 text-slate-500 hover:text-white hover:bg-slate-700 border border-slate-700/50 transition-colors"><!></button> <!></div></div>  <div class="relative w-full h-3.5 sm:h-4 bg-slate-950 rounded-full border border-white/5 overflow-hidden shadow-inner group-hover:border-white/20 transition-all mb-2"><div></div> <!> <!> <!></div> <div class="flex flex-col sm:flex-row gap-3"><div class="flex items-start gap-1.5"><div class="flex flex-col items-center justify-between bg-slate-900 border border-slate-700 rounded-lg p-1.5 w-[4.5rem] h-[3.75rem] shadow-sm"><span class="text-[9px] font-black text-slate-400 uppercase tracking-wider mb-0.5"> </span> <span class="text-xl font-bold text-white font-mono leading-none"> </span></div> <div class="flex flex-col items-center justify-between bg-red-950/30 border border-red-900/50 rounded-lg p-1.5 w-[4.5rem] h-[3.75rem] shadow-sm relative group/dmg"><span class="text-[9px] font-black text-red-400 uppercase tracking-wider mb-0.5"> </span> <input type="number" class="w-full bg-transparent text-center text-white font-mono font-bold text-xl focus:outline-none p-0 leading-none placeholder-red-800"/> <span class="absolute -top-1 -right-1 flex h-2 w-2 opacity-0 group-hover/dmg:opacity-100 transition-opacity"><span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-red-400 opacity-75"></span> <span class="relative inline-flex rounded-full h-2 w-2 bg-red-500"></span></span></div> <div><span> </span> <div class="flex items-baseline gap-0.5 justify-center w-full"><input type="number" class="w-full bg-transparent text-right text-white font-mono font-bold text-xl focus:outline-none p-0 leading-none"/> <span class="text-[10px] text-slate-500 font-mono self-end mb-0.5 opacity-70"> </span></div></div></div> <div class="flex flex-wrap gap-1.5 items-center flex-1"><!> <button class="text-[10px] sm:text-[9px] font-bold text-slate-500 hover:text-indigo-400 px-1.5 py-0.5 rounded border border-transparent hover:border-indigo-500/30 hover:bg-indigo-500/10 transition-all flex items-center gap-1 whitespace-nowrap"><!> </button></div></div></div></div></div>  <!> <!></div>');function rs(C,s){Yt(s,!0);const l=()=>et(Lt,"$t",x),[x,k]=aa();let D=Ot(s,"updateEnemy",3,(f,y)=>{}),w=Ot(s,"updatePlayer",3,(f,y)=>{}),v=Ot(s,"removeFromCombat",3,f=>{}),O=pe(()=>s.entity.type==="player"),N=pe(()=>s.entity.damage||0),K=pe(()=>s.entity.normalHealth||s.entity.health||10),Y=pe(()=>s.entity.currentHealth??a(K)),je=pe(()=>a(N)>=a(Y)),ce=pe(()=>a(N)>=a(Y)/2&&!a(je)),we=pe(()=>a(Y)>0?Math.min(100,Math.max(0,a(N)/a(Y)*100)):100),Re=Le(!1),H=Le(!1);za(()=>{const f=s.entity.afflictions||[],y=f.includes("Incapacitated");if(a(je)&&!y){const te={afflictions:[...f,"Incapacitated"]};s.entity.type==="player"?Q(te):D()(s.entity.instanceId,te)}else if(!a(je)&&y){const te={afflictions:f.filter(Ae=>Ae!=="Incapacitated")};s.entity.type==="player"?Q(te):D()(s.entity.instanceId,te)}});function Q(f){if(s.entity.type!=="player")return;const y=ja.get(s.entity.id);y&&ja.set(s.entity.id,{...y,...f}),w()(s.entity.id,f),fa({id:s.entity.id,...f})}function oe(f){const y=parseInt(f.target.value);if(isNaN(y))return;const te={damage:Math.max(0,y)};s.entity.type==="player"?Q(te):D()(s.entity.instanceId,te)}function le(f){const y=parseInt(f.target.value);if(isNaN(y))return;const ee=Math.max(0,y);let te=a(N);ee<a(N)&&(te=ee);const Ae={currentHealth:ee,damage:te};s.entity.type==="player"?Q(Ae):D()(s.entity.instanceId,Ae)}function ke(){const f=!s.entity.acted;s.entity.type==="player"?Q({acted:f}):D()(s.entity.instanceId,{acted:f})}function F(){s.entity.type==="player"&&Q({initiative:!s.entity.initiative})}function W(f){const y=s.entity.afflictions||[],te={afflictions:y.includes(f)?y.filter(Ae=>Ae!==f):[...y,f]};s.entity.type==="player"?Q(te):D()(s.entity.instanceId,te)}var se=as(),G=t(se);{var $e=f=>{var y=Ur(),ee=t(y,!0);e(y),g(te=>n(ee,te),[()=>l()("session.combat_card.initiative")]),c(f,y)};M(G,f=>{a(O)&&s.entity.initiative&&f($e)})}var U=r(G,2);{var E=f=>{var y=Fr();c(f,y)};M(U,f=>{a(je)&&f(E)})}var de=r(U,2),xe=t(de),ze=t(xe),me=t(ze),Xe=t(me);qa(Xe,()=>s.entity.imageUrl,f=>{{let y=pe(()=>s.entity.name.charAt(0));$a(f,{get hash(){return s.entity.imageUrl},get alt(){return s.entity.name},size:"custom",get fallbackText(){return a(y)}})}}),e(me);var Te=r(me,2);Te.__click=ke;var We=t(Te);{var ft=f=>{gr(f,{size:14,class:""})},bt=f=>{var y=Ze(),ee=ye(y);{var te=ct=>{Ua(ct,{size:14})},Ae=ct=>{Wa(ct,{size:14})};M(ee,ct=>{s.entity.acted?ct(te):ct(Ae,!1)},!0)}c(f,y)};M(We,f=>{a(je)?f(ft):f(bt,!1)})}e(Te),e(ze);var xt=r(ze,2),ot=t(xt),pt=t(ot),kt=t(pt),V=t(kt),Pe=t(V,!0);e(V);var Qe=r(V,2);{var tt=f=>{var y=Br(),ee=t(y);e(y),g(()=>n(ee,`Dif ${s.entity.difficulty??""}`)),c(f,y)};M(Qe,f=>{a(O)||f(tt)})}e(kt),e(pt);var at=r(pt,2),st=t(at);st.__click=()=>P(Re,!a(Re));var Me=t(st);{var Ue=f=>{Cr(f,{size:14})},Ne=f=>{zr(f,{size:14})};M(Me,f=>{a(Re)?f(Ue):f(Ne,!1)})}e(st);var Ce=r(st,2);{var Fe=f=>{var y=Vr();y.__click=F;var ee=t(y);Or(ee,{size:14}),e(y),g(te=>{Ie(y,1,`w-7 h-7 flex items-center justify-center rounded transition-all ${s.entity.initiative?"bg-yellow-500 text-yellow-950 shadow-lg shadow-yellow-500/20":"bg-slate-800 text-slate-500 hover:text-white hover:bg-slate-700"}`),qe(y,"title",te)},[()=>l()("session.combat_card.initiative")]),c(f,y)},Ke=f=>{var y=Wr();y.__click=()=>v()(s.entity.instanceId);var ee=t(y);xa(ee,{size:14}),e(y),c(f,y)};M(Ce,f=>{a(O)?f(Fe):f(Ke,!1)})}e(at),e(ot);var Ge=r(ot,2),$=t(Ge),z=r($,2);{var ie=f=>{var y=Gr();g(()=>{Ie(y,1,`absolute top-0 left-0 h-full transition-all duration-500 ease-out z-10 
                            ${a(je)?"bg-gradient-to-r from-red-600 via-red-500 to-rose-500 animate-pulse":a(we)>=80?"bg-gradient-to-r from-red-600 to-rose-500":a(ce)?"bg-gradient-to-r from-amber-600 to-orange-500":"bg-gradient-to-r from-orange-500 to-amber-400"}`),Ja(y,`width: ${a(we)??""}%`)}),c(f,y)};M(z,f=>{a(we)>0&&f(ie)})}var Ee=r(z,2);{var Be=f=>{var y=Jr();c(f,y)};M(Ee,f=>{a(N)===0&&f(Be)})}var Je=r(Ee,2);{var De=f=>{var y=Qr(),ee=t(y),te=t(ee,!0);e(ee),e(y),g(Ae=>n(te,Ae),[()=>l()("session.combat_card.incapacitated")]),c(f,y)},lt=f=>{var y=Ze(),ee=ye(y);{var te=Ae=>{var ct=Zr(),Ft=t(ct),Bt=t(Ft,!0);e(Ft),e(ct),g(Dt=>n(Bt,Dt),[()=>l()("session.combat_card.injured")]),c(Ae,ct)};M(ee,Ae=>{a(ce)&&Ae(te)},!0)}c(f,y)};M(Je,f=>{a(je)?f(De):f(lt,!1)})}e(Ge);var Rt=r(Ge,2),gt=t(Rt),ht=t(gt),dt=t(ht),$t=t(dt,!0);e(dt);var Tt=r(dt,2),yt=t(Tt,!0);e(Tt),e(ht);var zt=r(ht,2),Ve=t(zt),vt=t(Ve,!0);e(Ve);var He=r(Ve,2);Ct(He),He.__input=oe,Xt(2),e(zt);var rt=r(zt,2),Ye=t(rt),mt=t(Ye,!0);e(Ye);var _t=r(Ye,2),it=t(_t);Ct(it),it.__input=le;var Et=r(it,2),qt=t(Et);e(Et),e(_t),e(rt),e(gt);var Pt=r(gt,2),ia=t(Pt);Se(ia,17,()=>s.entity.afflictions||[],nt,(f,y)=>{var ee=Xr();ee.__click=()=>W(a(y));var te=t(ee),Ae=r(te);xa(Ae,{size:8,class:"opacity-50 group-hover/btn:opacity-100"}),e(ee),g(()=>n(te,`${a(y)??""} `)),c(f,ee)});var Gt=r(ia,2);Gt.__click=()=>P(H,!0);var na=t(Gt);Kt(na,{size:10});var Jt=r(na);e(Gt),e(Pt),e(Rt),e(xt),e(xe),e(de);var Ut=r(de,2);{var ra=f=>{var y=ts(),ee=t(y),te=t(ee),Ae=t(te),ct=t(Ae,!0);e(Ae),Xt(2),e(te);var Ft=r(te,2);Se(Ft,20,()=>["str","agi","int","wil"],nt,(u,m)=>{var p=Kr(),b=t(p),h=t(b,!0);e(b);var T=r(b,2),S=t(T,!0);e(T);var ae=r(T,2),re=t(ae);e(ae),e(p),g(()=>{n(h,m),n(S,s.entity.stats?.[m]??s.entity.attributes?.[m]??10),Ie(ae,1,`text-[9px] font-bold ${(s.entity.stats?.[m]??s.entity.attributes?.[m]??10)-10>=0?"text-emerald-500":"text-red-500"}`),n(re,`${(s.entity.stats?.[m]??s.entity.attributes?.[m]??10)-10>=0?"+":""}${(s.entity.stats?.[m]??s.entity.attributes?.[m]??10)-10}`)}),c(u,p)}),e(Ft),e(ee);var Bt=r(ee,2),Dt=t(Bt),Vt=t(Dt),oa=t(Vt,!0);e(Vt);var la=r(Vt,2),da=t(la,!0);e(la),e(Dt);var Wt=r(Dt,2),Qt=t(Wt),j=t(Qt,!0);e(Qt);var I=r(Qt,2),A=t(I,!0);e(I),e(Wt);var ge=r(Wt,2),_e=t(ge),Z=t(_e,!0);e(_e);var i=r(_e,2),o=t(i,!0);e(i),e(ge),e(Bt);var d=r(Bt,2);Se(d,20,()=>[{key:"traits",label:"Traços",color:"text-amber-500"},{key:"actions",label:"Ações",color:"text-red-400"},{key:"reactions",label:"Reações",color:"text-indigo-400"},{key:"end_of_round",label:"Fim da Rodada",color:"text-emerald-400"}],nt,(u,m)=>{var p=Ze(),b=ye(p);{var h=T=>{var S=es(),ae=t(S),re=t(ae);Xt(),e(ae);var fe=r(ae,2);Se(fe,21,()=>s.entity[m.key],nt,(ve,ue)=>{var R=Yr(),J=t(R),ne=t(J,!0);e(J);var L=r(J,2),q=t(L,!0);e(L),e(R),g(()=>{n(ne,a(ue).name),n(q,a(ue).description||a(ue).effect)}),c(ve,R)}),e(fe),e(S),g(()=>{Ie(ae,1,`${m.color??""} text-[10px] font-black uppercase mb-2 flex items-center gap-2`),n(re,`${m.label??""} `)}),c(T,S)};M(b,T=>{s.entity[m.key]&&s.entity[m.key].length>0&&T(h)})}c(u,p)}),e(d),e(y),g((u,m,p,b)=>{n(ct,u),n(oa,m),n(da,s.entity.size||1),n(j,p),n(A,s.entity.speed||10),n(Z,b),n(o,s.entity.defense||10)},[()=>l()("session.combat_card.attributes"),()=>l()("session.combat_card.size"),()=>l()("session.combat_card.speed"),()=>l()("session.combat_card.defense")]),c(f,y)};M(Ut,f=>{a(Re)&&f(ra)})}var ca=r(Ut,2);{let f=pe(()=>s.entity.afflictions||[]);qr(ca,{get isOpen(){return a(H)},onClose:()=>P(H,!1),get afflictions(){return a(f)},onToggle:W})}e(se),g((f,y,ee,te,Ae)=>{Ie(se,1,`group relative overflow-hidden transition-all duration-300 rounded-2xl border ${a(O)?"bg-slate-900/80 border-indigo-500/30 hover:border-indigo-500/50 hover:shadow-indigo-900/20":"bg-slate-950/80 border-red-900/30 hover:border-red-800/50 hover:shadow-red-900/10"} shadow-lg backdrop-blur-sm`),Ie(me,1,`w-14 h-14 rounded-2xl overflow-hidden border-2 shadow-xl transition-transform group-hover:scale-105 ${a(je)?"border-red-600 grayscale brightness-50":a(O)?"border-indigo-500/50":"border-red-900/50"}`),Ie(Te,1,`absolute -bottom-2 -right-2 w-7 h-7 rounded-lg flex items-center justify-center border shadow-lg transition-all hover:scale-110 z-20 ${s.entity.acted?"bg-slate-800 border-slate-600 text-slate-500":a(O)?"bg-indigo-600 border-indigo-400 text-white":"bg-red-600 border-red-400 text-white"}`),qe(Te,"title",f),Ie(V,1,`text-base font-bold truncate leading-snug ${a(O)?"text-white":"text-red-100 font-serif tracking-wide"}`),n(Pe,s.entity.name),Ie($,1,`absolute inset-0 w-full ${a(N)===0?"bg-emerald-900/20":"bg-slate-900/50"}`),n($t,y),n(yt,s.entity.defense||10),n(vt,ee),wa(He,a(N)),Ie(rt,1,`flex flex-col items-center justify-between border rounded-lg p-1.5 w-[5.5rem] h-[3.75rem] shadow-sm relative transition-colors ${a(je)?"bg-red-950/50 border-red-500":a(ce)?"bg-orange-950/30 border-orange-500":"bg-emerald-950/30 border-emerald-900/50"}`),Ie(Ye,1,`text-[9px] font-black uppercase tracking-wider mb-0.5 ${a(je)?"text-red-400":a(ce)?"text-orange-400":"text-emerald-400"}`),n(mt,te),wa(it,a(Y)),n(qt,`/${a(K)??""}`),n(Jt,` ${Ae??""}`)},[()=>s.entity.acted?l()("session.combat_card.acted"):l()("session.combat_card.act"),()=>l()("session.combat_card.defense"),()=>l()("session.combat_card.damage"),()=>l()("session.combat_card.health"),()=>l()("session.combat_card.add_affliction")]),c(C,se),ea(),k()}ta(["click","input"]);function ss(C,{from:s,to:l},x={}){var{delay:k=0,duration:D=W=>Math.sqrt(W)*120,easing:w=_r}=x,v=getComputedStyle(C),O=v.transform==="none"?"":v.transform,[N,K]=v.transformOrigin.split(" ").map(parseFloat);N/=C.clientWidth,K/=C.clientHeight;var Y=is(C),je=C.clientWidth/l.width/Y,ce=C.clientHeight/l.height/Y,we=s.left+s.width*N,Re=s.top+s.height*K,H=l.left+l.width*N,Q=l.top+l.height*K,oe=(we-H)*je,le=(Re-Q)*ce,ke=s.width/l.width,F=s.height/l.height;return{delay:k,duration:typeof D=="function"?D(Math.sqrt(oe*oe+le*le)):D,easing:w,css:(W,se)=>{var G=se*oe,$e=se*le,U=W+se*ke,E=W+se*F;return`transform: ${O} translate(${G}px, ${$e}px) scale(${U}, ${E});`}}}function is(C){if("currentCSSZoom"in C)return C.currentCSSZoom;for(var s=C,l=1;s!==null;)l*=+getComputedStyle(s).zoom,s=s.parentElement;return l}function ns(C,s=1,l=0){const x=[];let k=0;for(let O=0;O<s;O++){const N=Math.floor(Math.random()*C)+1;x.push(N),k+=N}let D=`${s}d${C}`,w=[],v=0;if(l!==0)if(C===20){const O=Math.abs(l);for(let K=0;K<O;K++)w.push(Math.floor(Math.random()*6)+1);const N=Math.max(...w);l>0?(v=N,k+=N,D+=` + ${N} [Boon]`):(v=-N,k-=N,D+=` - ${N} [Bane]`)}else v=l,k+=l,D+=l>0?` + ${l}`:` - ${Math.abs(l)}`;return{total:k,results:x,bonusRolls:w,formula:D,crit:C===20&&x.includes(20),modifierTotal:v}}var os=_('<span class="text-[10px] bg-slate-800 text-slate-400 px-1.5 py-0.5 rounded-full"> </span>'),ls=_('<div class="p-3 rounded-xl border border-amber-500/30 bg-amber-500/5 flex items-center gap-3 transition-all hover:bg-amber-500/10 shadow-sm"><div class="flex-1"><div class="font-bold text-sm text-amber-200 leading-none"> </div> <div class="text-[9px] text-amber-500/60 font-medium mt-1 uppercase tracking-tighter"> </div></div> <div class="flex items-center gap-1.5"><button class="p-2 rounded-lg bg-green-600/20 text-green-400 hover:bg-green-600 hover:text-white transition-all shadow-lg active:scale-90" title="Aprovar"><!></button> <button class="p-2 rounded-lg bg-red-600/20 text-red-400 hover:bg-red-600 hover:text-white transition-all shadow-lg active:scale-90" title="Recusar"><!></button></div></div>'),ds=_('<div class="space-y-2 animate-in fade-in slide-in-from-top-2"><div class="flex items-center gap-2 px-1"><div class="w-1.5 h-1.5 rounded-full bg-amber-500 animate-pulse"></div> <span class="text-[10px] font-black text-amber-500 uppercase tracking-wider"> </span></div> <!> <div class="h-px bg-slate-800/50 mx-2 my-2"></div></div>'),vs=_('<span class="text-indigo-400 font-bold uppercase tracking-tighter mr-1"> </span>'),cs=_('<div><div></div> <div class="flex-1"><div> </div> <div class="text-[10px] text-slate-500 font-medium"><!> </div></div> <div class="flex items-center gap-1"><button><!></button> <button class="text-slate-600 hover:text-red-400 p-1.5 hover:bg-red-400/10 rounded-lg transition-all"><!></button></div></div>'),us=_('<div class="text-xs text-slate-600 italic p-6 border-2 border-dashed border-slate-800 rounded-xl text-center"> </div>'),bs=_('<button class="w-full bg-indigo-600 hover:bg-indigo-500 text-white py-3 rounded-xl font-black uppercase text-[10px] tracking-[0.2em] shadow-lg shadow-indigo-900/20 transition-all active:scale-[0.98] flex items-center justify-center gap-2"><!> </button> <p class="text-[9px] text-slate-600 text-center font-bold uppercase tracking-tighter"> </p>',1),xs=_('<div class="flex justify-center p-3 bg-white rounded-xl mb-2 animate-in zoom-in-95 duration-200 shadow-xl mx-auto w-32 h-32"><img class="w-24 h-24"/></div>'),ms=_('<div class="absolute bottom-full left-1/2 -translate-x-1/2 mb-2 px-2 py-1 bg-green-500 text-white text-[10px] font-bold rounded shadow-lg animate-in fade-in slide-in-from-bottom-1 whitespace-nowrap"><!> </div>'),_s=_('<div class="flex items-center justify-between"><div class="flex items-center gap-2"><span class="text-[10px] font-black text-indigo-400 uppercase tracking-widest flex items-center gap-1"><!> </span></div> <button class="text-slate-500 hover:text-white transition-colors p-1"><!></button></div> <!> <div class="relative group"><div class="flex gap-1"><div class="flex-1 bg-slate-950 border border-slate-800 rounded-lg p-2 text-[10px] text-slate-400 font-mono truncate cursor-pointer hover:border-slate-700 transition-colors flex items-center"> </div> <button class="bg-indigo-600 hover:bg-indigo-500 text-white p-2 rounded-lg transition-all active:scale-95 shadow-lg shadow-indigo-900/20 relative"><!> <!></button></div></div> <button class="w-full text-[9px] text-slate-600 hover:text-red-400 font-bold uppercase tracking-widest transition-colors mt-1"> </button>',1),fs=_('<div class="flex justify-between items-center bg-slate-950 p-2 rounded border border-slate-800 group hover:border-indigo-500/30 transition-all"><div class="truncate flex-1 flex items-center gap-2"><!> <div><div class="text-sm font-bold text-white truncate"> </div> <div class="text-[10px] text-slate-500"> </div></div></div> <button class="text-slate-500 hover:text-indigo-400 p-1 ml-2 bg-slate-900 rounded border border-slate-800"><!></button></div>'),ps=_('<div class="text-center text-slate-600 italic text-xs mt-4"> </div>'),gs=_("<!> <!>",1),hs=_('<div class="flex justify-between items-center bg-slate-950 p-2 rounded border border-slate-800 group hover:border-indigo-500/30 transition-all"><div class="truncate flex-1"><div class="text-sm font-bold text-white truncate"> </div> <div class="text-[10px] text-slate-500"> </div></div> <button class="text-slate-500 hover:text-indigo-400 p-1 ml-2 bg-slate-900 rounded border border-slate-800"><!></button></div>'),ys=_('<div class="text-center text-slate-600 italic text-xs mt-4"> </div>'),ws=_("<!> <!>",1),ks=_('<button class="bg-green-600 hover:bg-green-500 text-white px-6 py-2 rounded-lg font-bold flex items-center gap-2 shadow-lg shadow-green-900/20"><!> </button>'),$s=_('<div class="flex items-center gap-4"><button class="p-2 hover:bg-slate-700 rounded text-slate-400"><!></button> <div class="text-center"><div class="text-[10px] font-bold text-slate-500 uppercase"> </div><div class="text-3xl font-mono font-bold text-white leading-none"> </div></div> <button class="bg-indigo-600 hover:bg-indigo-500 text-white px-4 py-2 rounded font-bold flex items-center gap-2"><!> </button> <div class="h-8 w-px bg-slate-700 mx-2"></div> <button class="text-red-400 hover:text-red-300 text-xs font-bold px-3 py-2 border border-red-900/30 rounded bg-red-900/10"> </button></div>'),zs=_("<div><!></div>"),Cs=_('<div class="text-center text-slate-500 italic py-10"> </div>'),Es=_('<div class="text-sm"><span class="font-bold text-yellow-500"> </span> <span class="text-slate-300"> </span></div>'),Ms=_('<div class="bg-slate-900 border border-slate-700 rounded-lg p-4"><h4 class="font-bold text-white mb-2 pb-2 border-b border-slate-800 flex items-center gap-2"><!> </h4> <div class="space-y-2"></div></div>'),Os=_('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/80 p-4" role="button" aria-label="Fechar" tabindex="-1"><div class="bg-slate-800 rounded-xl w-full max-w-lg border border-slate-700 shadow-2xl p-6 relative" role="dialog" aria-modal="true"><div class="flex items-center gap-3 mb-6"><div class="p-3 bg-yellow-900/20 rounded-full border border-yellow-500/30 text-yellow-500"><!></div> <div><h3 class="font-bold text-white text-xl"> </h3> <p class="text-slate-400 text-sm"> </p></div></div> <div class="space-y-4 mb-8 max-h-[60vh] overflow-y-auto custom-scrollbar"></div> <div class="flex gap-3"><button class="flex-1 py-1.5 rounded bg-slate-700 hover:bg-slate-600 text-white font-bold text-sm"> </button> <button class="flex-1 py-1.5 rounded bg-indigo-600 hover:bg-indigo-500 text-white font-bold text-sm"> </button></div></div></div>'),js=_('<button class="w-full text-left flex items-center gap-3 p-3 bg-slate-900 border border-slate-700 hover:border-indigo-500 hover:bg-indigo-500/10 rounded-xl group transition-all"><div class="w-10 h-10 rounded-full bg-slate-800 flex items-center justify-center text-sm font-bold text-slate-500 group-hover:text-indigo-400 border border-slate-700 group-hover:border-indigo-500/30"> </div> <div class="flex-1"><div class="font-bold text-white group-hover:text-indigo-300"> </div> <div class="text-[10px] text-slate-500"> </div></div> <div class="bg-slate-800 p-2 rounded-lg text-slate-500 group-hover:bg-indigo-500 group-hover:text-white transition-colors"><!></div></button>'),Is=_('<div class="text-center py-8"><div class="w-12 h-12 bg-slate-700/50 rounded-full flex items-center justify-center mx-auto mb-3 text-slate-500"><!></div> <p class="text-slate-500 text-sm font-bold"> </p> <p class="text-[10px] text-slate-600 mt-1"> </p></div>'),Ns=_('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/80 p-4" role="button" aria-label="Fechar" tabindex="-1"><div class="bg-slate-800 rounded-xl w-full max-w-md border border-slate-700 shadow-2xl p-6" role="dialog" aria-modal="true"><div class="flex justify-between items-center mb-6"><div><h3 class="font-bold text-white text-lg"> </h3> <p class="text-xs text-slate-400"> </p></div> <button class="bg-slate-700 hover:bg-slate-600 p-2 rounded-lg text-white transition-colors"><!></button></div> <div class="space-y-3 max-h-[60vh] overflow-y-auto custom-scrollbar pr-2"><!> <!></div></div></div>'),Ss=_('<div class="grid grid-cols-1 lg:grid-cols-4 gap-6 h-full relative"><div class="space-y-6"><div class="bg-slate-900 border border-slate-800 rounded-xl p-4 flex flex-col gap-4"><div class="flex justify-between items-center bg-slate-950/50 p-2 rounded-lg border border-slate-800"><h3 class="text-xs font-black text-slate-500 uppercase tracking-widest flex items-center gap-2"><!> <!></h3> <button class="text-[10px] bg-slate-800 hover:bg-slate-700 text-white px-2.5 py-1.5 rounded-md font-bold transition-all border border-slate-700 active:scale-95"> </button></div> <!> <div class="space-y-2 flex-1 overflow-y-auto max-h-[300px] custom-scrollbar pr-1"><div class="space-y-2"><!> <!></div></div> <div class="pt-4 border-t border-slate-800 space-y-3"><!></div></div> <div class="bg-slate-900 border border-slate-800 rounded-xl p-4 flex flex-col h-[400px]"><div class="flex items-center gap-2 mb-3 bg-slate-950 p-1 rounded-lg border border-slate-800"><button><!> </button> <button><!> </button></div> <div class="flex-1 overflow-y-auto pr-1 custom-scrollbar space-y-2"><!></div></div></div> <div class="lg:col-span-2 space-y-4"><div class="bg-slate-900 border border-slate-800 rounded-xl p-4 flex justify-between items-center shadow-lg sticky top-0 z-20"><div class="flex items-center gap-4"><!></div></div> <div class="space-y-3 pb-20"><!> <!></div></div> <div class="hidden lg:flex flex-col gap-4"></div></div> <!> <div class="fixed bottom-6 left-1/2 -translate-x-1/2 bg-slate-900/90 backdrop-blur-md border border-slate-700 rounded-2xl p-2 flex items-center gap-2 shadow-2xl z-40 animate-in slide-in-from-bottom-4"><div class="px-3 border-r border-slate-700 flex items-center gap-2 text-slate-400 font-bold text-xs uppercase"><!> </div> <button class="bg-slate-800 hover:bg-indigo-600 text-white font-bold w-10 h-10 rounded-xl flex items-center justify-center transition-all hover:-translate-y-1 shadow-lg">d20</button> <button class="bg-slate-800 hover:bg-indigo-600 text-white font-bold w-10 h-10 rounded-xl flex items-center justify-center transition-all hover:-translate-y-1 shadow-lg">d6</button> <button class="bg-slate-800 hover:bg-indigo-600 text-white font-bold w-10 h-10 rounded-xl flex items-center justify-center transition-all hover:-translate-y-1 shadow-lg text-xs">2d6</button> <button class="bg-slate-800 hover:bg-indigo-600 text-white font-bold w-10 h-10 rounded-xl flex items-center justify-center transition-all hover:-translate-y-1 shadow-lg text-xs">3d6</button></div> <!> <!> <!> <!>',1);function Rs(C,s){Yt(s,!0);const l=()=>et(tr,"$liveCharacters",v),x=()=>et(Lt,"$t",v),k=()=>et(Ca,"$liveEnemies",v),D=()=>et(Ta,"$liveEncounters",v),w=()=>et(sa,"$isHistoryOpen",v),[v,O]=aa();let N=Le(!1),K=Le(!1),Y=Le(!1);const je={active:!1,round:1};let ce=Le("enemies"),we=Le(!1),Re=Le(Zt([])),H=Le(Zt({isOpen:!1,title:"",message:"",onConfirm:()=>{}}));Ma(()=>{if(s.campaign?.id){Za(s.campaign.id,!0);const i=ga(Lt)("common.labels.master");Ia.update(d=>({...d,campaignId:s.campaign.id,name:s.campaign.gmName||i}));const o=setInterval(()=>{const d=wt.get(s.campaign.id)||s.campaign,u=ga(Lt)("common.labels.master");ka(s.campaign.id,{name:d.name,gmName:d.gmName||u})},3e4);return()=>{clearInterval(o),Xa(),Ia.update(d=>({...d,campaignId:null}))}}});const Q=pe(()=>typeof window<"u"?`${window.location.origin}${Ha("/campaigns/[id]/invite",{id:s.campaign?.id})}`:"");function oe(){a(Q)&&(navigator.clipboard.writeText(a(Q)),P(K,!0),setTimeout(()=>{P(K,!1)},2e3))}let le=pe(()=>s.campaign?.sessionRoster||[]),ke=pe(()=>s.campaign?.combat||je),F=pe(()=>s.campaign?.activeEnemies||[]),W=pe(()=>s.campaign?.members||[]),se=pe(()=>Array.from(new Set([...a(le),...a(W).map(o=>o.id)])).map(o=>{const d=l().find(m=>m.id===o),u=a(W).find(m=>m.id===o);return d&&u?{...d,...u,lastUpdate:u.lastUpdate}:d||u}).filter(Boolean)),G=pe(()=>a(se).filter(i=>!i.campaignApproval||i.campaignApproval==="approved")),$e=pe(()=>a(se).filter(i=>i.campaignApproval==="pending")),U=pe(()=>l().filter(i=>!a(le).includes(i.id)&&!a(W).some(o=>o.id===i.id)));function E(i){if(!s.campaign?.id)return;const d={...wt.get(s.campaign.id)||s.campaign,...i};wt.set(s.campaign.id,d),i.combat&&_a(s.campaign.id,i.combat),(i.name||i.gmName)&&ka(s.campaign.id,{name:d.name,gmName:d.gmName})}function de(i){if(a(le).includes(i)){const o=a(le).filter(d=>d!==i);E({sessionRoster:o})}else{const o=[...a(le),i];E({sessionRoster:o})}}function xe(i){Ue(i,{campaignApproval:"approved"}),fa({id:i,campaignApproval:"approved"})}function ze(i){fa({id:i,campaignApproval:"rejected",campaignId:null});const d=((wt.get(s.campaign.id)||s.campaign).members||[]).filter(u=>u.id!==i);E({members:d})}function me(i){const o=a(se).find(d=>d.id===i);P(H,{isOpen:!0,title:x()("session.players.remove_title"),message:x()("session.players.remove_message",{values:{name:o?.name||"este personagem"}}),onConfirm:()=>{const d=wt.get(s.campaign.id)||s.campaign;fa({id:i,campaignId:null});const u=(d.sessionRoster||[]).filter(b=>b!==i),m=(d.members||[]).filter(b=>b.id!==i),p=(d.activeEnemies||[]).filter(b=>b.type!=="player"||b.id!==i);E({sessionRoster:u,members:m,activeEnemies:p}),a(H).isOpen=!1}},!0)}function Xe(i){const d=(wt.get(s.campaign.id)||s.campaign).activeEnemies||[],u={...i,instanceId:ba(),damage:0,currentHealth:i.health,afflictions:[],acted:!1,initiative:!1};E({activeEnemies:[...d,u]})}function Te(i){const d=(wt.get(s.campaign.id)||s.campaign).activeEnemies||[];let u=[];i.enemies.forEach(m=>{const p=k().find(b=>b.id===m.enemyId);if(p)for(let b=0;b<m.count;b++)u.push({...p,instanceId:ba(),damage:0,currentHealth:p.health,afflictions:[],acted:!1,initiative:!1})}),E({activeEnemies:[...d,...u]})}function We(){E({combat:{active:!0,round:1}}),_a(s.campaign.id,{active:!0,round:1})}function ft(){const i=a(F).filter(o=>o.damage<(o.currentHealth??o.health)&&o.endOfRound&&o.endOfRound.length>0).map(o=>({name:o.name,effects:o.endOfRound}));if(i.length>0){P(Re,i,!0),P(we,!0);return}bt()}function bt(){const i=wt.get(s.campaign.id)||s.campaign,o=(i.combat?.round||1)+1,d=(i.activeEnemies||[]).map(u=>({...u,acted:!1}));E({combat:{...i.combat,round:o},activeEnemies:d}),_a(s.campaign.id,{active:!0,round:o}),P(we,!1)}function xt(i){E({combat:{active:!1,round:1}}),_a(s.campaign.id,{active:!1,round:1})}function ot(i){const o=wt.get(s.campaign.id)||s.campaign;E({activeEnemies:(o.activeEnemies||[]).filter(d=>d.instanceId!==i)})}function pt(i,o){const d=wt.get(s.campaign.id)||s.campaign;E({activeEnemies:(d.activeEnemies||[]).map(u=>u.instanceId===i?{...u,...o}:u)})}function kt(){const i=wt.get(s.campaign.id)||s.campaign,o=i.combat?.round||1;o>1&&E({combat:{...i.combat,round:o-1}})}let V=Le(Zt({isOpen:!1,sides:20,count:1,modifier:0}));function Pe(i,o=1){P(V,{isOpen:!0,sides:i,count:o,modifier:0},!0)}function Qe(i){tt(a(V).sides,a(V).count,i),a(V).isOpen=!1}function tt(i,o=1,d=0){const u=ns(i,o,d);let m="";o>1&&(m+=`Dados: [${u.results.join(", ")}] `),u.bonusRolls?.length>0&&(m+=`Bonus Rolls: [${u.bonusRolls.join(", ")}] -> ${Math.abs(u.modifierTotal)}`);const p=s.campaign?.gmName||ga(Lt)("common.labels.master");Ka.addToHistory({source:"GM",charName:p,name:`${o}d${i} ${d?d>0?`+${d}`:d:""}`,description:m.trim()||null,total:u.total,formula:u.formula,crit:u.crit}),sa.set(!0)}let at=Le(Zt(Date.now()));Ma(()=>{const i=setInterval(()=>{P(at,Date.now(),!0)},1e4);return()=>clearInterval(i)});let st=pe(()=>(()=>{const i=a(G).filter(b=>a(le).includes(b.id)),o=i.filter(b=>b&&b.initiative).map(b=>({...b,type:"player"})),d=a(F).map(b=>({...b,type:"enemy"})),u=i.filter(b=>b&&!b.initiative).map(b=>({...b,type:"player"})),m=[...o,...d,...u],p=new Set;return m.filter(b=>{if(!b)return!1;const h=b.type==="player"?b.id:b.instanceId;return p.has(h)?!1:(p.add(h),!0)})})());function Me(i){return i.lastUpdate?a(at)-i.lastUpdate<6e4:!1}function Ue(i,o){const d=wt.get(s.campaign.id)||s.campaign,u=d.members||[],m=u.findIndex(S=>S.id===i);let p=u;m!==-1&&(p=[...u],p[m]={...p[m],...o});const b=d.activeEnemies||[],h=b.findIndex(S=>S.id===i&&S.type==="player");let T=b;h!==-1&&(T=[...b],T[h]={...T[h],...o}),E({members:p,activeEnemies:T})}var Ne=Ss(),Ce=ye(Ne),Fe=t(Ce),Ke=t(Fe),Ge=t(Ke),$=t(Ge),z=t($);Pa(z,{size:14,class:"text-indigo-500"});var ie=r(z),Ee=r(ie);{var Be=i=>{var o=os(),d=t(o,!0);e(o),g(()=>n(d,a(G).length)),c(i,o)};M(Ee,i=>{a(G).length>0&&i(Be)})}e($);var Je=r($,2);Je.__click=()=>P(N,!a(N));var De=t(Je,!0);e(Je),e(Ge);var lt=r(Ge,2);{var Rt=i=>{var o=ds(),d=t(o),u=r(t(d),2),m=t(u);e(u),e(d);var p=r(d,2);Se(p,17,()=>a($e),b=>b.id,(b,h)=>{var T=ls(),S=t(T),ae=t(S),re=t(ae,!0);e(ae);var fe=r(ae,2),ve=t(fe,!0);e(fe),e(S);var ue=r(S,2),R=t(ue);R.__click=()=>xe(a(h).id);var J=t(R);Sa(J,{size:14}),e(R);var ne=r(R,2);ne.__click=()=>ze(a(h).id);var L=t(ne);va(L,{size:14}),e(ne),e(ue),e(T),g(q=>{n(re,a(h).name),n(ve,q)},[()=>x()("session.players.new_request")]),c(b,T)}),Xt(2),e(o),g(b=>n(m,`${b??""} (${a($e).length??""})`),[()=>x()("session.players.waiting_approval")]),c(i,o)};M(lt,i=>{a($e).length>0&&i(Rt)})}var gt=r(lt,2),ht=t(gt),dt=t(ht);Se(dt,17,()=>a(G),i=>i.id,(i,o)=>{const d=pe(()=>Me(a(o))),u=pe(()=>a(le).includes(a(o).id));var m=cs(),p=t(m),b=r(p,2),h=t(b),T=t(h,!0);e(h);var S=r(h,2),ae=t(S);{var re=X=>{var B=vs(),Oe=t(B,!0);e(B),g(he=>n(Oe,he),[()=>x()("common.labels.session")]),c(X,B)};M(ae,X=>{a(u)&&X(re)})}var fe=r(ae);e(S),e(b);var ve=r(b,2),ue=t(ve);ue.__click=()=>de(a(o).id);var R=t(ue);{var J=X=>{ir(X,{size:14})},ne=X=>{Kt(X,{size:14})};M(R,X=>{a(u)?X(J):X(ne,!1)})}e(ue);var L=r(ue,2);L.__click=()=>me(a(o).id);var q=t(L);va(q,{size:14}),e(L),e(ve),e(m),g((X,B,Oe)=>{Ie(m,1,`p-2.5 rounded-xl border flex items-center gap-3 transition-all ${a(d)?"bg-indigo-900/10 border-indigo-500/20":"bg-slate-900/50 border-slate-800"} ${a(d)||a(u)?"opacity-100":"opacity-40"} hover:border-indigo-500/40 group shadow-sm`),Ie(p,1,`w-2 h-2 rounded-full ${a(d)?"bg-green-500 shadow-[0_0_8px_rgba(74,222,128,0.4)]":"bg-slate-700"}`),Ie(h,1,`font-bold text-sm ${a(d)?"text-white":"text-slate-500"} group-hover:text-indigo-300 transition-colors`),n(T,a(o).name),n(fe,` ${X??""} ${a(o).level??""} • ${a(o).ancestry??""}`),Ie(ue,1,`p-1.5 rounded-lg transition-all ${a(u)?"text-amber-400 hover:bg-amber-400/10":"text-slate-500 hover:text-indigo-400 hover:bg-indigo-400/10"}`),qe(ue,"title",B),qe(L,"title",Oe)},[()=>x()("common.labels.level"),()=>a(u)?x()("session.players.remove_from_session"):x()("session.players.add_to_session"),()=>x()("session.players.kick_from_campaign")]),c(i,m)});var $t=r(dt,2);{var Tt=i=>{var o=us(),d=t(o,!0);e(o),g(u=>n(d,u),[()=>x()("session.players.none")]),c(i,o)};M($t,i=>{a(G).length===0&&i(Tt)})}e(ht),e(gt);var yt=r(gt,2),zt=t(yt);{var Ve=i=>{var o=bs(),d=ye(o);d.__click=()=>E({isPublished:!0});var u=t(d);hr(u,{size:14});var m=r(u);e(d);var p=r(d,2),b=t(p,!0);e(p),g((h,T)=>{n(m,` ${h??""}`),n(b,T)},[()=>x()("session.publish.publish_session"),()=>x()("session.publish.make_visible")]),c(i,o)},vt=i=>{var o=_s(),d=ye(o),u=t(d),m=t(u),p=t(m);Da(p,{size:10,class:"animate-pulse"});var b=r(p);e(m),e(u);var h=r(u,2);h.__click=()=>P(Y,!a(Y));var T=t(h);Nr(T,{size:14}),e(h),e(d);var S=r(d,2);{var ae=B=>{var Oe=xs(),he=t(Oe);e(Oe),g((be,ut)=>{qe(he,"src",be),qe(he,"alt",ut)},[()=>`https://api.qrserver.com/v1/create-qr-code/?size=100x100&data=${encodeURIComponent(a(Q))}`,()=>x()("session.publish.qr_alt")]),c(B,Oe)};M(S,B=>{a(Y)&&B(ae)})}var re=r(S,2),fe=t(re),ve=t(fe);ve.__click=oe;var ue=t(ve,!0);e(ve);var R=r(ve,2);R.__click=oe;var J=t(R);{var ne=B=>{var Oe=ms(),he=t(Oe);Sa(he,{size:10,class:"inline mr-1"});var be=r(he);e(Oe),g(ut=>n(be,` ${ut??""}`),[()=>x()("common.buttons.copied")]),c(B,Oe)};M(J,B=>{a(K)&&B(ne)})}var L=r(J,2);Er(L,{size:14}),e(R),e(fe),e(re);var q=r(re,2);q.__click=()=>E({isPublished:!1});var X=t(q,!0);e(q),g((B,Oe,he,be)=>{n(b,` ${B??""}`),qe(h,"title",Oe),n(ue,a(Q)),qe(R,"aria-label",he),n(X,be)},[()=>x()("session.publish.public_session"),()=>x()("session.publish.qr_code"),()=>x()("session.publish.copy_link"),()=>x()("session.publish.remove_public")]),c(i,o)};M(zt,i=>{s.campaign?.isPublished?i(vt,!1):i(Ve)})}e(yt),e(Ke);var He=r(Ke,2),rt=t(He),Ye=t(rt);Ye.__click=()=>P(ce,"enemies");var mt=t(Ye);pa(mt,{size:14});var _t=r(mt);e(Ye);var it=r(Ye,2);it.__click=()=>P(ce,"encounters");var Et=t(it);Ba(Et,{size:14});var qt=r(Et);e(it),e(rt);var Pt=r(rt,2),ia=t(Pt);{var Gt=i=>{var o=gs(),d=ye(o);Se(d,1,k,p=>p.id,(p,b)=>{var h=fs(),T=t(h),S=t(T);jr(S,{size:12,class:"text-slate-600 cursor-grab"});var ae=r(S,2),re=t(ae),fe=t(re,!0);e(re);var ve=r(re,2),ue=t(ve);e(ve),e(ae),e(T);var R=r(T,2);R.__click=()=>Xe(a(b));var J=t(R);Kt(J,{size:16}),e(R),e(h),g(ne=>{n(fe,a(b).name),n(ue,`${ne??""} ${a(b).difficulty??""}`)},[()=>x()("session.enemies.difficulty")]),c(p,h)});var u=r(d,2);{var m=p=>{var b=ps(),h=t(b,!0);e(b),g(T=>n(h,T),[()=>x()("session.enemies.none")]),c(p,b)};M(u,p=>{k().length===0&&p(m)})}c(i,o)},na=i=>{var o=ws(),d=ye(o);Se(d,1,D,p=>p.id,(p,b)=>{var h=hs(),T=t(h),S=t(T),ae=t(S,!0);e(S);var re=r(S,2),fe=t(re);e(re),e(T);var ve=r(T,2);ve.__click=()=>Te(a(b));var ue=t(ve);Fa(ue,{size:14}),e(ve),e(h),g((R,J)=>{n(ae,a(b).name),n(fe,`${R??""} ${J??""}`)},[()=>a(b).enemies?.reduce((R,J)=>R+J.count,0)||0,()=>x()("session.enemies.title")]),c(p,h)});var u=r(d,2);{var m=p=>{var b=ys(),h=t(b,!0);e(b),g(T=>n(h,T),[()=>x()("session.enemies.no_encounters")]),c(p,b)};M(u,p=>{D().length===0&&p(m)})}c(i,o)};M(ia,i=>{a(ce)==="enemies"?i(Gt):i(na,!1)})}e(Pt),e(He),e(Fe);var Jt=r(Fe,2),Ut=t(Jt),ra=t(Ut),ca=t(ra);{var f=i=>{var o=ks();o.__click=We;var d=t(o);Wa(d,{size:20});var u=r(d);e(o),g(m=>n(u,` ${m??""}`),[()=>x()("session.combat.start")]),c(i,o)},y=i=>{var o=$s(),d=t(o);d.__click=kt;var u=t(d);La(u,{size:20}),e(d);var m=r(d,2),p=t(m),b=t(p,!0);e(p);var h=r(p),T=t(h,!0);e(h),e(m);var S=r(m,2);S.__click=ft;var ae=t(S);Sr(ae,{size:16});var re=r(ae);e(S);var fe=r(S,4);fe.__click=()=>xt();var ve=t(fe,!0);e(fe),e(o),g((ue,R,J,ne,L)=>{qe(d,"title",ue),n(b,R),n(T,a(ke).round),qe(S,"title",J),n(re,` ${ne??""}`),n(ve,L)},[()=>x()("session.combat.previous"),()=>x()("session.combat.round"),()=>x()("session.combat.next"),()=>x()("session.combat.next"),()=>x()("session.combat.end")]),c(i,o)};M(ca,i=>{a(ke).active?i(y,!1):i(f)})}e(ra),e(Ut);var ee=r(Ut,2),te=t(ee);Se(te,25,()=>a(st),i=>i.type==="player"?i.id:i.instanceId,(i,o)=>{var d=zs(),u=t(d);rs(u,{get entity(){return a(o)},updateEnemy:pt,removeFromCombat:ot,updatePlayer:Ue}),e(d),rr(d,()=>ss,()=>({duration:300})),c(i,d)});var Ae=r(te,2);{var ct=i=>{var o=Cs(),d=t(o,!0);e(o),g(u=>n(d,u),[()=>x()("session.combat.empty")]),c(i,o)};M(Ae,i=>{a(st).length===0&&i(ct)})}e(ee),e(Jt),Xt(2),e(Ce);var Ft=r(Ce,2);{var Bt=i=>{var o=Os();o.__click=ne=>{ne.target===ne.currentTarget&&P(we,!1)};var d=t(o),u=t(d),m=t(u),p=t(m);lr(p,{size:24}),e(m);var b=r(m,2),h=t(b),T=t(h,!0);e(h);var S=r(h,2),ae=t(S,!0);e(S),e(b),e(u);var re=r(u,2);Se(re,21,()=>a(Re),nt,(ne,L)=>{var q=Ms(),X=t(q),B=t(X);pa(B,{size:14,class:"text-slate-500"});var Oe=r(B);e(X);var he=r(X,2);Se(he,21,()=>a(L).effects,nt,(be,ut)=>{var Ht=Es(),At=t(Ht),ua=t(At);e(At);var ma=r(At,2),Ga=t(ma,!0);e(ma),e(Ht),g(()=>{n(ua,`${a(ut).name??""}:`),n(Ga,a(ut).desc)}),c(be,Ht)}),e(he),e(q),g(()=>n(Oe,` ${a(L).name??""}`)),c(ne,q)}),e(re);var fe=r(re,2),ve=t(fe);ve.__click=()=>P(we,!1);var ue=t(ve,!0);e(ve);var R=r(ve,2);R.__click=bt;var J=t(R,!0);e(R),e(fe),e(d),e(o),g((ne,L,q,X)=>{n(T,ne),n(ae,L),n(ue,q),n(J,X)},[()=>x()("session.end_of_round.title"),()=>x()("session.end_of_round.summary"),()=>x()("common.buttons.cancel"),()=>x()("session.end_of_round.advance")]),c(i,o)};M(Ft,i=>{a(we)&&i(Bt)})}var Dt=r(Ft,2),Vt=t(Dt),oa=t(Vt);nr(oa,{size:16});var la=r(oa);e(Vt);var da=r(Vt,2);da.__click=()=>Pe(20);var Wt=r(da,2);Wt.__click=()=>Pe(6);var Qt=r(Wt,2);Qt.__click=()=>Pe(6,2);var j=r(Qt,2);j.__click=()=>Pe(6,3),e(Dt);var I=r(Dt,2);{let i=pe(()=>`${x()("session.quick.roll_title")} (${a(V).count}d${a(V).sides})`),o=pe(()=>a(V).sides===20?x()("session.quick.boons_banes"):x()("session.quick.fixed_modifier"));or(I,{get isOpen(){return a(V).isOpen},get title(){return a(i)},get label(){return a(o)},onClose:()=>a(V).isOpen=!1,onRoll:Qe,initialModifier:0})}var A=r(I,2);{var ge=i=>{var o=Ns();o.__click=R=>{R.target===R.currentTarget&&P(N,!1)};var d=t(o),u=t(d),m=t(u),p=t(m),b=t(p,!0);e(p);var h=r(p,2),T=t(h,!0);e(h),e(m);var S=r(m,2);S.__click=()=>P(N,!1);var ae=t(S);xa(ae,{size:16}),e(S),e(u);var re=r(u,2),fe=t(re);Se(fe,17,()=>a(U),nt,(R,J)=>{var ne=js();ne.__click=()=>de(a(J).id);var L=t(ne),q=t(L,!0);e(L);var X=r(L,2),B=t(X),Oe=t(B,!0);e(B);var he=r(B,2),be=t(he);e(he),e(X);var ut=r(X,2),Ht=t(ut);Kt(Ht,{size:16}),e(ut),e(ne),g((At,ua)=>{n(q,At),n(Oe,a(J).name),n(be,`${ua??""} ${a(J).level??""} • ${a(J).ancestry??""}`)},[()=>a(J).name.charAt(0),()=>x()("common.labels.level")]),c(R,ne)});var ve=r(fe,2);{var ue=R=>{var J=Is(),ne=t(J),L=t(ne);pa(L,{size:24}),e(ne);var q=r(ne,2),X=t(q,!0);e(q);var B=r(q,2),Oe=t(B,!0);e(B),e(J),g((he,be)=>{n(X,he),n(Oe,be)},[()=>x()("session.manage_session.no_available"),()=>x()("session.manage_session.all_in_session")]),c(R,J)};M(ve,R=>{a(U).length===0&&R(ue)})}e(re),e(d),e(o),g((R,J)=>{n(b,R),n(T,J)},[()=>x()("session.manage_session.title"),()=>x()("session.manage_session.description")]),c(i,o)};M(A,i=>{a(N)&&i(ge)})}var _e=r(A,2);Aa(_e,{get isOpen(){return w()},onClose:()=>sa.set(!1)});var Z=r(_e,2);Ra(Z,{get isOpen(){return a(H).isOpen},get title(){return a(H).title},get message(){return a(H).message},get onConfirm(){return a(H).onConfirm},onCancel:()=>a(H).isOpen=!1}),g((i,o,d,u,m)=>{n(ie,` ${i??""} `),n(De,o),Ie(Ye,1,`flex-1 text-xs font-bold py-1.5 rounded flex items-center justify-center gap-2 transition-colors ${a(ce)==="enemies"?"bg-indigo-600 text-white":"text-slate-500 hover:text-white"}`),n(_t,` ${d??""}`),Ie(it,1,`flex-1 text-xs font-bold py-1.5 rounded flex items-center justify-center gap-2 transition-colors ${a(ce)==="encounters"?"bg-indigo-600 text-white":"text-slate-500 hover:text-white"}`),n(qt,` ${u??""}`),n(la,` ${m??""}`)},[()=>x()("session.players.title"),()=>a(N)?x()("session.players.close"):x()("session.players.add"),()=>x()("session.enemies.title"),()=>x()("session.enemies.encounters"),()=>x()("session.quick.title")]),c(C,Ne),ea(),O()}ta(["click"]);var Ts=_('<div class="space-y-4"><div class="flex items-center gap-4"><div class="relative group cursor-pointer"><div class="w-16 h-16 rounded-xl overflow-hidden border border-slate-700"><!></div> <div class="absolute inset-0 bg-black/50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity rounded-xl"><!></div></div> <div class="flex-1"><label for="enemy-name" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-name" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white font-bold text-lg"/></div></div> <div class="grid grid-cols-2 gap-4"><div><label for="enemy-diff" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label><input id="enemy-diff" type="number" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div> <div><label for="enemy-size" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label><input id="enemy-size" type="number" step="0.5" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div></div> <div><label for="enemy-desc" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <textarea id="enemy-desc" class="w-full bg-slate-900 border border-slate-700 rounded p-3 text-white text-sm min-h-[100px] resize-none focus:border-indigo-500 focus:outline-none transition-colors"></textarea></div> <div class="grid grid-cols-1"><div><label for="enemy-speed" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label><input id="enemy-speed" type="number" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div></div></div>'),Ps=_('<div class="bg-slate-900 p-2 rounded border border-slate-700 text-center"><label class="text-[10px] text-slate-500 uppercase font-bold block mb-1"> </label> <input type="number" class="w-full bg-transparent text-center font-bold text-white text-xl focus:outline-none mb-1"/> <div> </div></div>'),Ds=_('<div class="space-y-6"><div><h4 class="text-indigo-400 font-bold text-sm uppercase mb-3"> </h4> <div class="grid grid-cols-4 gap-3"></div></div> <div class="space-y-3"><div><label for="enemy-senses" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label><input id="enemy-senses" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white text-sm"/></div> <div><label for="enemy-langs" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label><input id="enemy-langs" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white text-sm"/></div> <div><label for="enemy-immune" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label><input id="enemy-immune" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white text-sm"/></div></div></div>'),Hs=_('<div class="flex gap-2 items-start animate-in fade-in slide-in-from-left-2"><div class="flex-1 space-y-1"><input class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm font-bold placeholder-slate-600 focus:border-indigo-500 focus:outline-none" placeholder="Nome"/> <textarea class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm placeholder-slate-600 resize-none focus:border-indigo-500 focus:outline-none" rows="2" placeholder="Descrição..."></textarea></div> <button class="mt-1 text-slate-600 hover:text-red-400 p-2 hover:bg-slate-800 rounded"><!></button></div>'),As=_('<div class="text-xs text-slate-600 italic text-center py-4 border-2 border-dashed border-slate-800 rounded"> </div>'),Ls=_('<div><div class="flex justify-between items-center mb-3"><h4> </h4> <button class="text-xs bg-slate-800 px-2 py-1 rounded hover:bg-slate-700 text-white flex items-center gap-1 border border-slate-700"><!> </button></div> <div class="space-y-3"><!> <!></div></div>'),qs=_('<div class="space-y-6"></div>'),Us=_('<div class="w-16 h-16 rounded-lg overflow-hidden border border-slate-700 shadow-lg flex-shrink-0"><!></div>'),Fs=_('<div class="bg-slate-950 p-2 rounded border border-slate-800"><div class="text-[10px] text-slate-500 uppercase font-bold mb-1"> </div> <div class="text-white font-bold"> <span> </span></div></div>'),Bs=_('<div class="flex gap-2"><span class="font-bold text-slate-500 uppercase"> </span> <span class="text-white"> </span></div>'),Vs=_('<div class="flex gap-2"><span class="font-bold text-slate-500 uppercase"> </span> <span class="text-white"> </span></div>'),Ws=_('<div class="flex gap-2"><span class="font-bold text-slate-500 uppercase"> </span> <span class="text-white"> </span></div>'),Gs=_('<div class="mb-2 pl-3 border-l-2 border-indigo-900"><span class="font-bold text-white"> </span> <span class="text-slate-300"> </span></div>'),Js=_('<div><h4 class="font-bold text-indigo-400 uppercase text-xs mb-2 tracking-wider"> </h4> <!></div>'),Qs=_('<div class="mb-2 pl-3 border-l-2 border-red-900/50"><span class="font-bold text-white"> </span> <span class="text-slate-300"> </span></div>'),Zs=_('<div><h4 class="font-bold text-red-500 uppercase text-xs mb-2 tracking-wider"> </h4> <!></div>'),Xs=_('<div class="mb-2 pl-3 border-l-2 border-orange-900/50"><span class="font-bold text-white"> </span> <span class="text-slate-300"> </span></div>'),Ks=_('<div><h4 class="font-bold text-orange-400 uppercase text-xs mb-2 tracking-wider"> </h4> <!></div>'),Ys=_('<div class="mb-2 pl-3 border-l-2 border-yellow-900/50"><span class="font-bold text-white"> </span> <span class="text-slate-300"> </span></div>'),ei=_('<div><h4 class="font-bold text-yellow-500 uppercase text-xs mb-2 tracking-wider"> </h4> <!></div>'),ti=_('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/80 p-4" role="button" tabindex="-1"><div class="bg-slate-800 rounded-xl w-full max-w-6xl h-[90vh] border border-slate-700 shadow-2xl overflow-hidden flex flex-col lg:flex-row" role="dialog" aria-modal="true" aria-labelledby="modal-title"><div class="w-full lg:w-1/2 flex flex-col h-full border-r border-slate-700"><div class="p-4 border-b border-slate-700 bg-slate-900 flex justify-between items-center"><h3 id="modal-title" class="font-bold text-white text-lg"> </h3> <button class="lg:hidden text-slate-400 hover:text-white"><!></button></div> <div class="flex border-b border-slate-700 bg-slate-900/50"><button> </button> <button> </button> <button> </button></div> <div class="flex-1 overflow-y-auto p-6 custom-scrollbar bg-slate-800/50"><!></div> <div class="p-4 border-t border-slate-700 bg-slate-900 flex justify-end gap-3"><button class="px-6 py-2 rounded bg-slate-800 hover:bg-slate-700 text-white font-bold transition-colors"> </button> <button class="px-6 py-2 rounded bg-indigo-600 hover:bg-indigo-500 text-white font-bold flex items-center gap-2 transition-colors"><!> </button></div></div> <div class="hidden lg:flex w-1/2 bg-slate-950 flex-col border-l border-slate-800"><div class="p-4 border-b border-slate-800 bg-slate-950"><h3 class="font-bold text-slate-500 text-xs uppercase flex items-center gap-2"><!> </h3></div> <div class="flex-1 p-8 overflow-y-auto flex items-center justify-center bg-[radial-gradient(ellipse_at_top,_var(--tw-gradient-stops))] from-slate-900 via-slate-950 to-slate-950"><div class="w-full max-w-md bg-slate-900 border border-slate-700 rounded-xl p-5 shadow-2xl relative"><div class="absolute -top-3 -right-3 bg-red-600 text-white text-xs font-bold px-3 py-1 rounded-full shadow-lg border border-red-400"> </div> <div class="flex items-center gap-3 mb-4"><!> <div class="flex-1 min-w-0"><h2 class="text-2xl font-bold text-white mb-1 font-serif tracking-wide truncate"> </h2> <div class="h-1 w-20 bg-red-600 rounded-full"></div></div></div> <div class="grid grid-cols-2 gap-4 mb-4 text-sm"><div class="bg-slate-950 p-2 rounded border border-slate-800 flex justify-between items-center"><span class="text-slate-500 uppercase font-bold text-[10px]"> </span> <span class="text-white font-mono font-bold text-lg"> </span></div> <div class="bg-slate-950 p-2 rounded border border-slate-800 flex justify-between items-center"><span class="text-slate-500 uppercase font-bold text-[10px]"> </span> <span class="text-white font-mono font-bold text-lg"> </span></div> <div class="bg-slate-950 p-2 rounded border border-slate-800 flex justify-between items-center"><span class="text-slate-500 uppercase font-bold text-[10px]"> </span> <span class="text-white font-mono font-bold"> </span></div> <div class="bg-slate-950 p-2 rounded border border-slate-800 flex justify-between items-center"><span class="text-slate-500 uppercase font-bold text-[10px]"> </span> <span class="text-white font-mono font-bold"> </span></div></div> <div class="grid grid-cols-4 gap-2 mb-6 text-center font-mono text-slate-300"></div> <div class="mb-6 space-y-2 text-xs"><!> <!> <!></div> <div class="space-y-5 text-sm"><!> <!> <!> <!></div></div></div></div></div></div> <input type="file" hidden="" accept="image/*"/> <!>',1);function ai(C,s){Yt(s,!0);const l=()=>et(Lt,"$t",x),[x,k]=aa();let D=Ot(s,"isOpen",3,!1),w=Ot(s,"initialData",3,"{}"),v=Le(Zt(we())),O=Le("stats"),N=Le(!1),K=Le(""),Y=Le(void 0);function je(F){const W=F.target.files;if(W&&W.length>0){const se=W[0],G=new FileReader;G.onload=()=>{P(K,G.result,!0),P(N,!0)},G.readAsDataURL(se)}F.target&&(F.target.value="")}async function ce(F){try{const W=await vr(F);a(v).imageUrl=W,P(N,!1)}catch(W){console.error(W),alert(W.message||"Erro ao salvar imagem")}}function we(){return{name:"",difficulty:1,defense:10,health:10,damage:0,size:1,speed:10,description:"",senses:"",languages:"",immune:"",imageUrl:"",stats:{str:10,agi:10,int:10,wil:10},traits:[],actions:[],reactions:[],endOfRound:[]}}za(()=>{if(D()&&w())try{const F=JSON.parse(w());Object.keys(F).length===0?P(v,we(),!0):P(v,{...we(),...F},!0)}catch{P(v,we(),!0)}});function Re(F){a(v)[F]=[...a(v)[F],{name:"",desc:""}]}function H(F,W){a(v)[F]=a(v)[F].filter((se,G)=>G!==W)}function Q(F){}var oe=Ze(),le=ye(oe);{var ke=F=>{var W=ti(),se=ye(W);se.__click=Q;var G=t(se),$e=t(G),U=t($e),E=t(U),de=t(E,!0);e(E);var xe=r(E,2);xe.__click=function(...j){s.onClose?.apply(this,j)};var ze=t(xe);xa(ze,{size:20}),e(xe),e(U);var me=r(U,2),Xe=t(me);Xe.__click=()=>P(O,"stats");var Te=t(Xe,!0);e(Xe);var We=r(Xe,2);We.__click=()=>P(O,"attributes");var ft=t(We,!0);e(We);var bt=r(We,2);bt.__click=()=>P(O,"abilities");var xt=t(bt,!0);e(bt),e(me);var ot=r(me,2),pt=t(ot);{var kt=j=>{var I=Ts(),A=t(I),ge=t(A);ge.__click=()=>a(Y)?.click();var _e=t(ge),Z=t(_e);qa(Z,()=>a(v).imageUrl,be=>{$a(be,{get hash(){return a(v).imageUrl},get alt(){return a(v).name},size:"custom",fallbackText:"?"})}),e(_e);var i=r(_e,2),o=t(i);cr(o,{size:20,class:"text-white"}),e(i),e(ge);var d=r(ge,2),u=t(d),m=t(u,!0);e(u);var p=r(u,2);Ct(p),e(d),e(A);var b=r(A,2),h=t(b),T=t(h),S=t(T,!0);e(T);var ae=r(T);Ct(ae),e(h);var re=r(h,2),fe=t(re),ve=t(fe,!0);e(fe);var ue=r(fe);Ct(ue),e(re),e(b);var R=r(b,2),J=t(R),ne=t(J,!0);e(J);var L=r(J,2);Ea(L),e(R);var q=r(R,2),X=t(q),B=t(X),Oe=t(B,!0);e(B);var he=r(B);Ct(he),e(X),e(q),e(I),g((be,ut,Ht,At,ua,ma)=>{n(m,be),n(S,ut),n(ve,Ht),n(ne,At),qe(L,"placeholder",ua),n(Oe,ma)},[()=>l()("session.enemy_modal.name"),()=>l()("session.enemy_modal.difficulty"),()=>l()("session.enemy_modal.size"),()=>l()("session.enemy_modal.description"),()=>l()("session.enemy_modal.description_placeholder"),()=>l()("session.enemy_modal.speed")]),Mt(p,()=>a(v).name,be=>a(v).name=be),Mt(ae,()=>a(v).difficulty,be=>a(v).difficulty=be),Mt(ue,()=>a(v).size,be=>a(v).size=be),Mt(L,()=>a(v).description,be=>a(v).description=be),Mt(he,()=>a(v).speed,be=>a(v).speed=be),c(j,I)},V=j=>{var I=Ze(),A=ye(I);{var ge=Z=>{var i=Ds(),o=t(i),d=t(o),u=t(d,!0);e(d);var m=r(d,2);Se(m,20,()=>["str","agi","int","wil"],nt,(L,q)=>{var X=Ps(),B=t(X),Oe=t(B,!0);e(B);var he=r(B,2);Ct(he);var be=r(he,2),ut=t(be);e(be),e(X),g(()=>{qe(B,"for",`attr-${q??""}`),n(Oe,q),qe(he,"id",`attr-${q??""}`),Ie(be,1,`text-xs font-bold ${a(v).stats[q]-10>=0?"text-green-500":"text-red-500"}`),n(ut,`${a(v).stats[q]-10>=0?"+":""}${a(v).stats[q]-10}`)}),Mt(he,()=>a(v).stats[q],Ht=>a(v).stats[q]=Ht),c(L,X)}),e(m),e(o);var p=r(o,2),b=t(p),h=t(b),T=t(h,!0);e(h);var S=r(h);Ct(S),e(b);var ae=r(b,2),re=t(ae),fe=t(re,!0);e(re);var ve=r(re);Ct(ve),e(ae);var ue=r(ae,2),R=t(ue),J=t(R,!0);e(R);var ne=r(R);Ct(ne),e(ue),e(p),e(i),g((L,q,X,B,Oe,he,be)=>{n(u,L),n(T,q),qe(S,"placeholder",X),n(fe,B),qe(ve,"placeholder",Oe),n(J,he),qe(ne,"placeholder",be)},[()=>l()("session.enemy_modal.main_attributes"),()=>l()("session.enemy_modal.senses"),()=>l()("session.enemy_modal.senses_placeholder"),()=>l()("session.enemy_modal.languages"),()=>l()("session.enemy_modal.languages_placeholder"),()=>l()("session.enemy_modal.immunities"),()=>l()("session.enemy_modal.immunities_placeholder")]),Mt(S,()=>a(v).senses,L=>a(v).senses=L),Mt(ve,()=>a(v).languages,L=>a(v).languages=L),Mt(ne,()=>a(v).immune,L=>a(v).immune=L),c(Z,i)},_e=Z=>{var i=Ze(),o=ye(i);{var d=u=>{var m=qs();Se(m,20,()=>[{key:"traits",title:"Traços (Traits)",color:"text-indigo-400",border:"border-indigo-500/30"},{key:"actions",title:"Ações",color:"text-red-400",border:"border-red-500/30"},{key:"reactions",title:"Reações",color:"text-orange-400",border:"border-orange-500/30"},{key:"endOfRound",title:"Fim da Rodada",color:"text-yellow-400",border:"border-yellow-500/30"}],nt,(p,b)=>{var h=Ls(),T=t(h),S=t(T),ae=t(S,!0);e(S);var re=r(S,2);re.__click=()=>Re(b.key);var fe=t(re);Kt(fe,{size:12});var ve=r(fe);e(re),e(T);var ue=r(T,2),R=t(ue);Se(R,17,()=>a(v)[b.key],nt,(L,q,X)=>{var B=Hs(),Oe=t(B),he=t(Oe);Ct(he);var be=r(he,2);Ea(be),e(Oe);var ut=r(Oe,2);ut.__click=()=>H(b.key,X);var Ht=t(ut);va(Ht,{size:16}),e(ut),e(B),Mt(he,()=>a(q).name,At=>a(q).name=At),Mt(be,()=>a(q).desc,At=>a(q).desc=At),c(L,B)});var J=r(R,2);{var ne=L=>{var q=As(),X=t(q,!0);e(q),g(B=>n(X,B),[()=>l()("session.enemy_modal.empty")]),c(L,q)};M(J,L=>{a(v)[b.key].length===0&&L(ne)})}e(ue),e(h),g(L=>{Ie(h,1,`p-4 bg-slate-900 rounded border ${b.border??""}`),Ie(S,1,`font-bold text-sm uppercase ${b.color??""}`),n(ae,b.title),n(ve,` ${L??""}`)},[()=>l()("session.enemy_modal.add")]),c(p,h)}),e(m),c(u,m)};M(o,u=>{a(O)==="abilities"&&u(d)},!0)}c(Z,i)};M(A,Z=>{a(O)==="attributes"?Z(ge):Z(_e,!1)},!0)}c(j,I)};M(pt,j=>{a(O)==="stats"?j(kt):j(V,!1)})}e(ot);var Pe=r(ot,2),Qe=t(Pe);Qe.__click=function(...j){s.onClose?.apply(this,j)};var tt=t(Qe,!0);e(Qe);var at=r(Qe,2);at.__click=()=>s.onSave(a(v));var st=t(at);Va(st,{size:18});var Me=r(st);e(at),e(Pe),e($e);var Ue=r($e,2),Ne=t(Ue),Ce=t(Ne),Fe=t(Ce);Mr(Fe,{size:14});var Ke=r(Fe);e(Ce),e(Ne);var Ge=r(Ne,2),$=t(Ge),z=t($),ie=t(z);e(z);var Ee=r(z,2),Be=t(Ee);{var Je=j=>{var I=Us(),A=t(I);$a(A,{get hash(){return a(v).imageUrl},get alt(){return a(v).name},size:"custom"}),e(I),c(j,I)};M(Be,j=>{a(v).imageUrl&&j(Je)})}var De=r(Be,2),lt=t(De),Rt=t(lt,!0);e(lt),Xt(2),e(De),e(Ee);var gt=r(Ee,2),ht=t(gt),dt=t(ht),$t=t(dt,!0);e(dt);var Tt=r(dt,2),yt=t(Tt,!0);e(Tt),e(ht);var zt=r(ht,2),Ve=t(zt),vt=t(Ve,!0);e(Ve);var He=r(Ve,2),rt=t(He,!0);e(He),e(zt);var Ye=r(zt,2),mt=t(Ye),_t=t(mt,!0);e(mt);var it=r(mt,2),Et=t(it,!0);e(it),e(Ye);var qt=r(Ye,2),Pt=t(qt),ia=t(Pt,!0);e(Pt);var Gt=r(Pt,2),na=t(Gt,!0);e(Gt),e(qt),e(gt);var Jt=r(gt,2);Se(Jt,20,()=>["str","agi","int","wil"],nt,(j,I)=>{var A=Fs(),ge=t(A),_e=t(ge,!0);e(ge);var Z=r(ge,2),i=t(Z),o=r(i),d=t(o);e(o),e(Z),e(A),g(()=>{n(_e,I),n(i,`${a(v).stats[I]??""} `),Ie(o,1,`text-xs ${a(v).stats[I]-10>=0?"text-green-500":"text-red-500"}`),n(d,`(${a(v).stats[I]-10>=0?"+":""}${a(v).stats[I]-10})`)}),c(j,A)}),e(Jt);var Ut=r(Jt,2),ra=t(Ut);{var ca=j=>{var I=Bs(),A=t(I),ge=t(A);e(A);var _e=r(A,2),Z=t(_e,!0);e(_e),e(I),g(i=>{n(ge,`${i??""}:`),n(Z,a(v).senses)},[()=>l()("session.enemy_modal.senses")]),c(j,I)};M(ra,j=>{a(v).senses&&j(ca)})}var f=r(ra,2);{var y=j=>{var I=Vs(),A=t(I),ge=t(A);e(A);var _e=r(A,2),Z=t(_e,!0);e(_e),e(I),g(i=>{n(ge,`${i??""}:`),n(Z,a(v).languages)},[()=>l()("session.enemy_modal.languages")]),c(j,I)};M(f,j=>{a(v).languages&&j(y)})}var ee=r(f,2);{var te=j=>{var I=Ws(),A=t(I),ge=t(A);e(A);var _e=r(A,2),Z=t(_e,!0);e(_e),e(I),g(i=>{n(ge,`${i??""}:`),n(Z,a(v).immune)},[()=>l()("session.enemy_modal.immunities")]),c(j,I)};M(ee,j=>{a(v).immune&&j(te)})}e(Ut);var Ae=r(Ut,2),ct=t(Ae);{var Ft=j=>{var I=Js(),A=t(I),ge=t(A,!0);e(A);var _e=r(A,2);Se(_e,17,()=>a(v).traits,nt,(Z,i,o,d)=>{var u=Gs(),m=t(u),p=t(m);e(m);var b=r(m,2),h=t(b,!0);e(b),e(u),g(()=>{n(p,`${a(i).name??""}:`),n(h,a(i).desc)}),c(Z,u)}),e(I),g(Z=>n(ge,Z),[()=>l()("session.enemy_modal.traits")]),c(j,I)};M(ct,j=>{a(v).traits.length>0&&j(Ft)})}var Bt=r(ct,2);{var Dt=j=>{var I=Zs(),A=t(I),ge=t(A,!0);e(A);var _e=r(A,2);Se(_e,17,()=>a(v).actions,nt,(Z,i,o,d)=>{var u=Qs(),m=t(u),p=t(m);e(m);var b=r(m,2),h=t(b,!0);e(b),e(u),g(()=>{n(p,`${a(i).name??""}:`),n(h,a(i).desc)}),c(Z,u)}),e(I),g(Z=>n(ge,Z),[()=>l()("session.enemy_modal.actions")]),c(j,I)};M(Bt,j=>{a(v).actions.length>0&&j(Dt)})}var Vt=r(Bt,2);{var oa=j=>{var I=Ks(),A=t(I),ge=t(A,!0);e(A);var _e=r(A,2);Se(_e,17,()=>a(v).reactions,nt,(Z,i,o,d)=>{var u=Xs(),m=t(u),p=t(m);e(m);var b=r(m,2),h=t(b,!0);e(b),e(u),g(()=>{n(p,`${a(i).name??""}:`),n(h,a(i).desc)}),c(Z,u)}),e(I),g(Z=>n(ge,Z),[()=>l()("session.enemy_modal.reactions")]),c(j,I)};M(Vt,j=>{a(v).reactions.length>0&&j(oa)})}var la=r(Vt,2);{var da=j=>{var I=ei(),A=t(I),ge=t(A,!0);e(A);var _e=r(A,2);Se(_e,17,()=>a(v).endOfRound,nt,(Z,i,o,d)=>{var u=Ys(),m=t(u),p=t(m);e(m);var b=r(m,2),h=t(b,!0);e(b),e(u),g(()=>{n(p,`${a(i).name??""}:`),n(h,a(i).desc)}),c(Z,u)}),e(I),g(Z=>n(ge,Z),[()=>l()("session.enemy_modal.end_of_round")]),c(j,I)};M(la,j=>{a(v).endOfRound.length>0&&j(da)})}e(Ae),e($),e(Ge),e(Ue),e(G),e(se);var Wt=r(se,2);Wt.__change=je,wr(Wt,j=>P(Y,j),()=>a(Y));var Qt=r(Wt,2);dr(Qt,{get isOpen(){return a(N)},get imageUrl(){return a(K)},onClose:()=>P(N,!1),onCrop:ce}),g((j,I,A,ge,_e,Z,i,o,d,u,m,p,b,h)=>{qe(se,"aria-label",j),n(de,I),Ie(Xe,1,`flex-1 py-3 text-sm font-bold border-b-2 transition-colors ${a(O)==="stats"?"border-indigo-500 text-indigo-400 bg-slate-800":"border-transparent text-slate-500 hover:text-white"}`),n(Te,A),Ie(We,1,`flex-1 py-3 text-sm font-bold border-b-2 transition-colors ${a(O)==="attributes"?"border-indigo-500 text-indigo-400 bg-slate-800":"border-transparent text-slate-500 hover:text-white"}`),n(ft,ge),Ie(bt,1,`flex-1 py-3 text-sm font-bold border-b-2 transition-colors ${a(O)==="abilities"?"border-indigo-500 text-indigo-400 bg-slate-800":"border-transparent text-slate-500 hover:text-white"}`),n(xt,_e),n(tt,Z),n(Me,` ${i??""}`),n(Ke,` ${o??""}`),n(ie,`${d??""} ${a(v).difficulty??""}`),n(Rt,u),n($t,m),n(yt,a(v).defense),n(vt,p),n(rt,a(v).health),n(_t,b),n(Et,a(v).size),n(ia,h),n(na,a(v).speed)},[()=>l()("session.enemy_modal.close"),()=>l()("session.enemy_modal.title"),()=>l()("session.enemy_modal.tab_general"),()=>l()("session.enemy_modal.tab_attributes"),()=>l()("session.enemy_modal.tab_abilities"),()=>l()("common.buttons.cancel"),()=>l()("common.buttons.save"),()=>l()("session.enemy_modal.preview"),()=>l()("session.enemy_modal.difficulty"),()=>a(v).name||l()("session.enemy_modal.enemy_default"),()=>l()("session.enemy_modal.defense"),()=>l()("session.enemy_modal.health"),()=>l()("session.enemy_modal.size"),()=>l()("session.enemy_modal.speed")]),c(F,W)};M(le,F=>{D()&&F(ke)})}c(C,oe),ea(),k()}ta(["click","change"]);var ri=_('<div class="flex justify-between items-center bg-slate-800 p-2 rounded border border-slate-700"><div class="flex-1"><div class="text-sm font-bold text-white"> </div> <div class="text-[10px] text-slate-400"> </div></div> <div class="flex items-center gap-2"><input type="number" min="1" class="w-12 bg-slate-900 border border-slate-600 rounded text-center text-white"/> <button class="text-red-400 hover:text-red-300"><!></button></div></div>'),si=_('<div class="text-center text-slate-600 italic text-sm py-4"> </div>'),ii=_('<div class="flex justify-between items-center bg-slate-950 p-2 rounded border border-slate-800 hover:border-indigo-500/30 transition-colors"><div><div class="text-sm font-bold text-white max-w-[120px] truncate"> </div> <div class="text-[10px] text-slate-500"> </div></div> <button class="text-indigo-400 hover:text-white p-1 bg-slate-900 rounded border border-slate-800"><!></button></div>'),ni=_('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/80 p-4" role="button" tabindex="-1"><div class="bg-slate-800 rounded-xl w-full max-w-2xl p-6 border border-slate-700 shadow-2xl flex flex-col max-h-[90vh]" role="dialog" aria-modal="true" aria-labelledby="encounter-modal-title"><div class="flex justify-between items-center mb-6"><h3 id="encounter-modal-title" class="text-xl font-bold text-white"> </h3> <button class="text-slate-400 hover:text-white"><!></button></div> <div class="space-y-4 mb-6"><div><label for="encounter-name" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="encounter-name" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white outline-hidden focus:border-indigo-500"/></div></div> <div class="flex-1 flex gap-4 min-h-0"><div class="flex-1 bg-slate-900 border border-slate-800 rounded-lg p-3 flex flex-col"><h4 class="text-xs text-slate-500 uppercase font-bold mb-2"> </h4> <div class="flex-1 overflow-y-auto space-y-2 custom-scrollbar"><!> <!></div></div> <div class="flex-1 bg-slate-900 border border-slate-800 rounded-lg p-3 flex flex-col"><h4 class="text-xs text-slate-500 uppercase font-bold mb-2"> </h4> <div class="flex-1 overflow-y-auto space-y-2 custom-scrollbar"></div></div></div> <div class="flex gap-3 mt-6 pt-4 border-t border-slate-700"><button class="flex-1 bg-slate-700 hover:bg-slate-600 text-white py-2 rounded font-bold"> </button> <button class="flex-1 bg-indigo-600 hover:bg-indigo-500 text-white py-2 rounded font-bold flex items-center justify-center gap-2"><!> </button></div></div></div>');function oi(C,s){Yt(s,!0);const l=()=>et(Lt,"$t",k),x=()=>et(Ca,"$liveEnemies",k),[k,D]=aa();let w=Ot(s,"isOpen",3,!1),v=Ot(s,"initialData",3,"{}"),O=Le(Zt({name:"",enemies:[]}));za(()=>{if(w()&&v())try{const H=JSON.parse(v());P(O,{name:H.name||"",enemies:H.enemies||[]},!0)}catch{P(O,{name:"",enemies:[]},!0)}});function N(H){a(O).enemies.find(oe=>oe.enemyId===H)?a(O).enemies=a(O).enemies.map(oe=>oe.enemyId===H?{...oe,count:oe.count+1}:oe):a(O).enemies=[...a(O).enemies,{enemyId:H,count:1}]}function K(H){a(O).enemies=a(O).enemies.filter((Q,oe)=>oe!==H)}function Y(H,Q){const oe=Math.max(1,parseInt(Q)||1);a(O).enemies[H].count=oe}function je(H){}var ce=Ze(),we=ye(ce);{var Re=H=>{var Q=ni();Q.__click=je;var oe=t(Q),le=t(oe),ke=t(le),F=t(ke,!0);e(ke);var W=r(ke,2);W.__click=function(...Me){s.onClose?.apply(this,Me)};var se=t(W);xa(se,{size:20}),e(W),e(le);var G=r(le,2),$e=t(G),U=t($e),E=t(U,!0);e(U);var de=r(U,2);Ct(de),e($e),e(G);var xe=r(G,2),ze=t(xe),me=t(ze),Xe=t(me,!0);e(me);var Te=r(me,2),We=t(Te);Se(We,17,()=>a(O).enemies,nt,(Me,Ue,Ne)=>{const Ce=pe(()=>x().find(lt=>lt.id===a(Ue).enemyId));var Fe=ri(),Ke=t(Fe),Ge=t(Ke),$=t(Ge,!0);e(Ge);var z=r(Ge,2),ie=t(z);e(z),e(Ke);var Ee=r(Ke,2),Be=t(Ee);Ct(Be),Be.__input=lt=>Y(Ne,lt.target.value);var Je=r(Be,2);Je.__click=()=>K(Ne);var De=t(Je);va(De,{size:16}),e(Je),e(Ee),e(Fe),g(lt=>{n($,lt),n(ie,`Dif ${(a(Ce)?a(Ce).difficulty:"?")??""}`),wa(Be,a(Ue).count)},[()=>a(Ce)?a(Ce).name:l()("session.encounter_modal.unknown")]),c(Me,Fe)});var ft=r(We,2);{var bt=Me=>{var Ue=si(),Ne=t(Ue,!0);e(Ue),g(Ce=>n(Ne,Ce),[()=>l()("session.encounter_modal.none_added")]),c(Me,Ue)};M(ft,Me=>{a(O).enemies.length===0&&Me(bt)})}e(Te),e(ze);var xt=r(ze,2),ot=t(xt),pt=t(ot,!0);e(ot);var kt=r(ot,2);Se(kt,5,x,Me=>Me.id,(Me,Ue)=>{var Ne=ii(),Ce=t(Ne),Fe=t(Ce),Ke=t(Fe,!0);e(Fe);var Ge=r(Fe,2),$=t(Ge);e(Ge),e(Ce);var z=r(Ce,2);z.__click=()=>N(a(Ue).id);var ie=t(z);Kt(ie,{size:16}),e(z),e(Ne),g(()=>{n(Ke,a(Ue).name),n($,`Dif ${a(Ue).difficulty??""}`)}),c(Me,Ne)}),e(kt),e(xt),e(xe);var V=r(xe,2),Pe=t(V);Pe.__click=function(...Me){s.onClose?.apply(this,Me)};var Qe=t(Pe,!0);e(Pe);var tt=r(Pe,2);tt.__click=()=>s.onSave(a(O));var at=t(tt);Va(at,{size:18});var st=r(at);e(tt),e(V),e(oe),e(Q),g((Me,Ue,Ne,Ce,Fe,Ke,Ge,$)=>{qe(Q,"aria-label",Me),n(F,Ue),n(E,Ne),qe(de,"placeholder",Ce),n(Xe,Fe),n(pt,Ke),n(Qe,Ge),n(st,` ${$??""}`)},[()=>l()("session.encounter_modal.close"),()=>l()("session.encounter_modal.title"),()=>l()("session.encounter_modal.name"),()=>l()("session.encounter_modal.name_placeholder"),()=>l()("session.encounter_modal.enemies_in_encounter"),()=>l()("session.encounter_modal.add_enemies"),()=>l()("common.buttons.cancel"),()=>l()("session.encounter_modal.save_encounter")]),Mt(de,()=>a(O).name,Me=>a(O).name=Me),c(H,Q)};M(we,H=>{w()&&H(Re)})}c(C,ce),ea(),D()}ta(["click","input"]);var li=_('<div class="text-[10px] text-slate-400 flex items-center gap-1.5 bg-slate-950 p-1 px-1.5 rounded-lg border border-slate-800/50"><span class="text-indigo-400 font-black"> </span> <span class="font-medium truncate max-w-[80px]"> </span></div>'),di=_('<div class="text-[10px] text-slate-600 italic"> </div>'),vi=_('<div class="bg-slate-900 border border-slate-800 rounded-2xl p-4 transition-all hover:border-indigo-500/30 group relative flex flex-col justify-between shadow-lg hover:shadow-indigo-500/10" role="region"><div class="flex-1"><div class="font-bold text-white text-base mb-2 group-hover:text-indigo-400 transition-colors uppercase tracking-tight truncate"> </div> <div class="flex flex-wrap gap-1"><!> <!></div></div> <div class="flex gap-2 mt-3 pt-3 border-t border-slate-800/50"><button class="flex-1 bg-indigo-600 hover:bg-indigo-500 text-white py-1.5 rounded-lg text-xs font-bold flex items-center justify-center gap-2 transition-all active:scale-95 shadow-lg shadow-indigo-900/20"><!> </button> <button class="p-1.5 text-slate-400 hover:text-white bg-slate-800/50 rounded-lg border border-slate-800 transition-all" title="Editar"><!></button> <button class="p-1.5 text-slate-400 hover:text-red-400 bg-slate-800/50 rounded-lg border border-slate-800 hover:border-red-900/30 transition-all"><!></button></div></div>'),ci=_('<button class="text-[10px] font-bold text-indigo-400 hover:text-indigo-300 mt-1 uppercase tracking-wider"> </button>'),ui=_('<div class="mb-4 flex-1"><p> </p> <!></div>'),bi=_('<div class="mb-4 flex-1 text-[10px] text-slate-600 italic"> </div>'),xi=_('<div class="bg-slate-900 border border-slate-800 rounded-2xl p-5 hover:border-indigo-500/30 transition-all relative group cursor-move hover:shadow-lg hover:shadow-indigo-500/10 active:scale-[0.98] flex flex-col" draggable="true" role="listitem"><div class="flex justify-between items-start mb-3"><h3 class="font-bold text-lg text-white group-hover:text-indigo-400 transition-colors"> </h3> <span class="text-[10px] font-black bg-indigo-500/10 text-indigo-400 border border-indigo-400/20 px-2 py-1 rounded-lg uppercase"> </span></div> <!> <div class="mt-auto flex gap-2 pt-4 border-t border-slate-800/50"><button class="flex-1 bg-slate-800/50 hover:bg-slate-800 text-white py-2 rounded-xl text-xs font-bold border border-slate-800 transition-all"> </button> <button class="bg-slate-800/50 hover:bg-red-900/20 text-slate-500 hover:text-red-400 px-3 rounded-xl border border-slate-800 hover:border-red-900/30 transition-all"><!></button></div></div>'),mi=_('<div class="text-center text-slate-500 italic col-span-3"> </div>'),_i=_('<div><div class="mb-12"><div class="flex justify-between items-center mb-6"><h3 class="text-sm font-black text-indigo-400 uppercase tracking-widest flex items-center gap-2"><!> </h3></div> <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"><button class="min-h-[120px] border-2 border-dashed border-slate-800 rounded-2xl flex flex-col items-center justify-center text-slate-500 hover:border-indigo-500 hover:text-indigo-400 transition-all hover:bg-indigo-500/5 gap-2 group"><!> <span class="font-bold text-sm"> </span></button> <!></div></div> <div class="mb-6"><h3 class="text-sm font-black text-indigo-400 uppercase tracking-widest flex items-center gap-2 mb-6"><!> </h3></div> <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"><button class="min-h-[180px] border-2 border-dashed border-slate-800 rounded-2xl flex flex-col items-center justify-center text-slate-500 hover:border-indigo-500 hover:text-indigo-400 transition-all hover:bg-indigo-500/5 gap-2 group"><!> <span class="font-bold text-sm"> </span></button> <!> <!></div> <!> <!> <!></div>');function fi(C,s){Yt(s,!0);const l=()=>et(Ca,"$liveEnemies",D),x=()=>et(Ta,"$liveEncounters",D),k=()=>et(Lt,"$t",D),[D,w]=aa();let v=Le(!1),O=Le(null),N=Le("{}"),K=Le(!1),Y=Le(null),je=Le("{}"),ce=Le(Zt({isOpen:!1,title:"",message:"",onConfirm:()=>{}}));function we(){return{name:"",difficulty:1,defense:10,health:10,damage:0,size:1,speed:10,description:"",senses:"",languages:"",immune:"",stats:{str:10,agi:10,int:10,wil:10},traits:[],actions:[],reactions:[],endOfRound:[]}}function Re($=null){P(O,$?$.id:null,!0),P(N,JSON.stringify($||we()),!0),P(v,!0)}let H=Zt(new Set);function Q($){H.has($)?H.delete($):H.add($)}function oe($){const z=a(O)||ba();Na.set(z,{...$,id:z}),P(v,!1)}function le($){const z=l().find(ie=>ie.id===$);P(ce,{isOpen:!0,title:"Excluir Inimigo",message:`Tem certeza que deseja excluir permanentemente o inimigo "${z?.name||"este inimigo"}"?`,onConfirm:()=>{Na.delete($),a(ce).isOpen=!1}},!0)}function ke($=null){P(Y,$?$.id:null,!0),P(je,JSON.stringify($||{name:"",enemies:[]}),!0),P(K,!0)}function F($){const z=a(Y)||ba();ya.set(z,{...$,id:z}),P(K,!1)}function W($){const z=x().find(ie=>ie.id===$);P(ce,{isOpen:!0,title:"Excluir Encontro",message:`Tem certeza que deseja excluir permanentemente o encontro "${z?.name||"este encontro"}"?`,onConfirm:()=>{ya.delete($),a(ce).isOpen=!1}},!0)}function se($){const z=wt.get(s.campId);if(!z)return;const ie=z.activeEnemies||[];let Ee=[];$.enemies.forEach(Be=>{const Je=l().find(De=>De.id===Be.enemyId);if(Je)for(let De=0;De<Be.count;De++)Ee.push({...Je,instanceId:ba(),damage:0,currentHealth:Je.health,afflictions:[],acted:!1,initiative:!1})}),wt.set(s.campId,{...z,activeEnemies:[...ie,...Ee]})}function G($,z){$.dataTransfer.setData("text/plain",z.id),$.dataTransfer.effectAllowed="copy"}function $e($){return $.preventDefault(),!1}function U($,z){$.preventDefault();const ie=$.dataTransfer.getData("text/plain");if(!ie)return;const Ee=z.enemies||[],Be=Ee.find(De=>De.enemyId===ie);let Je;Be?Je=Ee.map(De=>De.enemyId===ie?{...De,count:De.count+1}:De):Je=[...Ee,{enemyId:ie,count:1}],ya.set(z.id,{...z,enemies:Je})}var E=_i(),de=t(E),xe=t(de),ze=t(xe),me=t(ze);Ba(me,{size:16});var Xe=r(me);e(ze),e(xe);var Te=r(xe,2),We=t(Te);We.__click=()=>ke();var ft=t(We);Kt(ft,{size:28,class:"group-hover:scale-110 transition-transform"});var bt=r(ft,2),xt=t(bt,!0);e(bt),e(We);var ot=r(We,2);Se(ot,1,x,$=>$.id,($,z)=>{var ie=vi(),Ee=t(ie),Be=t(Ee),Je=t(Be,!0);e(Be);var De=r(Be,2),lt=t(De);Se(lt,17,()=>a(z).enemies||[],nt,(He,rt)=>{const Ye=pe(()=>l().find(Pt=>Pt.id===a(rt).enemyId));var mt=li(),_t=t(mt),it=t(_t);e(_t);var Et=r(_t,2),qt=t(Et,!0);e(Et),e(mt),g(()=>{n(it,`${a(rt).count??""}x`),n(qt,a(Ye)?a(Ye).name:"...")}),c(He,mt)});var Rt=r(lt,2);{var gt=He=>{var rt=di(),Ye=t(rt,!0);e(rt),g(mt=>n(Ye,mt),[()=>k()("session.bestiary.empty_encounter")]),c(He,rt)};M(Rt,He=>{a(z).enemies?.length||He(gt)})}e(De),e(Ee);var ht=r(Ee,2),dt=t(ht);dt.__click=()=>se(a(z));var $t=t(dt);Fa($t,{size:12,fill:"currentColor"});var Tt=r($t);e(dt);var yt=r(dt,2);yt.__click=()=>ke(a(z));var zt=t(yt);fr(zt,{size:14}),e(yt);var Ve=r(yt,2);Ve.__click=()=>W(a(z).id);var vt=t(Ve);va(vt,{size:14}),e(Ve),e(ht),e(ie),g(He=>{qe(ie,"aria-label",`Encontro ${a(z).name??""}`),n(Je,a(z).name),n(Tt,` ${He??""}`)},[()=>k()("session.bestiary.start")]),ha("dragover",ie,$e),ha("drop",ie,He=>U(He,a(z))),c($,ie)}),e(Te),e(de);var pt=r(de,2),kt=t(pt),V=t(kt);pa(V,{size:16});var Pe=r(V);e(kt),e(pt);var Qe=r(pt,2),tt=t(Qe);tt.__click=()=>Re();var at=t(tt);Kt(at,{size:32,class:"group-hover:scale-110 transition-transform"});var st=r(at,2),Me=t(st,!0);e(st),e(tt);var Ue=r(tt,2);Se(Ue,1,l,$=>$.id,($,z)=>{var ie=xi(),Ee=t(ie),Be=t(Ee),Je=t(Be,!0);e(Be);var De=r(Be,2),lt=t(De);e(De),e(Ee);var Rt=r(Ee,2);{var gt=Ve=>{var vt=ui(),He=t(vt),rt=t(He,!0);e(He);var Ye=r(He,2);{var mt=_t=>{var it=ci();it.__click=()=>Q(a(z).id);var Et=t(it,!0);e(it),g(qt=>n(Et,qt),[()=>H.has(a(z).id)?k()("session.bestiary.see_less"):k()("session.bestiary.see_more")]),c(_t,it)};M(Ye,_t=>{a(z).description.length>120&&_t(mt)})}e(vt),g(_t=>{Ie(He,1,`text-xs text-slate-400 leading-relaxed ${_t??""}`),n(rt,a(z).description)},[()=>H.has(a(z).id)?"":"line-clamp-3"]),c(Ve,vt)},ht=Ve=>{var vt=bi(),He=t(vt,!0);e(vt),g(rt=>n(He,rt),[()=>k()("session.bestiary.no_description")]),c(Ve,vt)};M(Rt,Ve=>{a(z).description?Ve(gt):Ve(ht,!1)})}var dt=r(Rt,2),$t=t(dt);$t.__click=()=>Re(a(z));var Tt=t($t,!0);e($t);var yt=r($t,2);yt.__click=()=>le(a(z).id);var zt=t(yt);va(zt,{size:14}),e(yt),e(dt),e(ie),g((Ve,vt)=>{n(Je,a(z).name),n(lt,`${Ve??""} ${a(z).difficulty??""}`),n(Tt,vt)},[()=>k()("session.bestiary.level"),()=>k()("common.buttons.edit")]),ha("dragstart",ie,Ve=>G(Ve,a(z))),c($,ie)});var Ne=r(Ue,2);{var Ce=$=>{var z=mi(),ie=t(z,!0);e(z),g(Ee=>n(ie,Ee),[()=>k()("session.bestiary.no_enemies")]),c($,z)};M(Ne,$=>{l().length===0&&$(Ce)})}e(Qe);var Fe=r(Qe,2);ai(Fe,{get isOpen(){return a(v)},get initialData(){return a(N)},onClose:()=>P(v,!1),onSave:oe});var Ke=r(Fe,2);oi(Ke,{get isOpen(){return a(K)},get initialData(){return a(je)},onClose:()=>P(K,!1),onSave:F});var Ge=r(Ke,2);Ra(Ge,{get isOpen(){return a(ce).isOpen},get title(){return a(ce).title},get message(){return a(ce).message},get onConfirm(){return a(ce).onConfirm},onCancel:()=>a(ce).isOpen=!1}),e(E),g(($,z,ie,Ee)=>{n(Xe,` ${$??""}`),n(xt,z),n(Pe,` ${ie??""}`),n(Me,Ee)},[()=>k()("session.bestiary.encounters_title"),()=>k()("session.bestiary.new_encounter"),()=>k()("session.bestiary.title"),()=>k()("session.bestiary.new_enemy")]),c(C,E),ea(),w()}ta(["click"]);var pi=_('<div class="flex items-center gap-1 text-slate-400 ml-1"><!> <span class="text-xs"> </span></div>'),gi=_('<div class="flex items-center gap-1 text-emerald-400"><!> <span class="text-xs font-bold hidden sm:block"> </span></div> <!>',1),hi=_('<div class="flex items-center gap-1 text-slate-500"><!> <span class="text-xs hidden sm:block"> </span></div>'),yi=_('<span class="absolute -top-1 -right-1 flex h-3 w-3"><span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-red-400 opacity-75"></span> <span class="relative inline-flex rounded-full h-3 w-3 bg-red-500 border border-slate-900"></span></span>'),wi=_('<header class="bg-slate-900/80 backdrop-blur-md border-b border-white/5 sticky top-0 z-40 shadow-2xl"><div class="max-w-7xl mx-auto px-2 sm:px-4 py-2 sm:py-3"><div class="flex items-center justify-between gap-2 sm:gap-4"><div class="flex items-center gap-1 sm:gap-3 shrink-0"><button class="p-2 text-slate-400 hover:text-white hover:bg-white/5 rounded-full transition-all flex items-center gap-1 group" aria-label="Voltar para Dashboard" title="Voltar para Dashboard"><!> <!></button> <div class="flex flex-col"><h1 class="text-sm sm:text-base font-bold text-white leading-tight truncate max-w-[120px] sm:max-w-none"> </h1> <span class="text-[10px] text-indigo-400 font-mono font-bold uppercase tracking-wider"> </span></div></div> <div class="flex bg-slate-950/50 p-1 rounded-xl border border-white/5"><button><!> <span class="hidden min-[400px]:block">Sessão</span></button> <button><!> <span class="hidden min-[400px]:block">Bestiário</span></button></div> <div class="flex items-center gap-1 sm:gap-2"><div class="flex items-center gap-2 mr-2 border-r border-white/10 pr-2"><!></div> <button class="p-2 text-slate-400 hover:text-white hover:bg-white/5 rounded-lg transition-all" aria-label="Configurações da Campanha" title="Configurações"><!></button> <button class="p-2 bg-indigo-600/10 text-indigo-400 border border-indigo-400/20 rounded-lg hover:bg-indigo-600 hover:text-white transition-all relative" aria-label="Toggle Histórico" title="Histórico"><!> <!></button></div></div></div></header>');function ki(C,s){Yt(s,!0);const l=()=>et(Ya,"$syncState",w),x=()=>et(Lt,"$t",w),k=()=>et(sa,"$isHistoryOpen",w),D=()=>et(er,"$rollHistory",w),[w,v]=aa();let O=Ot(s,"campaignName",3,""),N=Ot(s,"gmName",3,"Mestre"),K=Ot(s,"activeSubTab",3,"session"),Y=Ot(s,"onTabChange",3,()=>{}),je=Ot(s,"onOpenSettings",3,()=>{});var ce=wi(),we=t(ce),Re=t(we),H=t(Re),Q=t(H);Q.__click=()=>kr(Ha("/"));var oe=t(Q);La(oe,{size:20,class:"group-hover:-translate-x-0.5 transition-transform"});var le=r(oe,2);ur(le,{size:18,class:"hidden sm:block opacity-50"}),e(Q);var ke=r(Q,2),F=t(ke),W=t(F,!0);e(F);var se=r(F,2),G=t(se,!0);e(se),e(ke),e(H);var $e=r(H,2),U=t($e);U.__click=()=>Y()("session");var E=t(U);{let V=pe(()=>K()==="session"?"opacity-100":"opacity-50");br(E,{size:14,get class(){return a(V)}})}Xt(2),e(U);var de=r(U,2);de.__click=()=>Y()("bestiary");var xe=t(de);{let V=pe(()=>K()==="bestiary"?"opacity-100":"opacity-50");Ir(xe,{size:14,get class(){return a(V)}})}Xt(2),e(de),e($e);var ze=r($e,2),me=t(ze),Xe=t(me);{var Te=V=>{var Pe=gi(),Qe=ye(Pe),tt=t(Qe);Da(tt,{size:16});var at=r(tt,2),st=t(at,!0);e(at),e(Qe);var Me=r(Qe,2);{var Ue=Ne=>{var Ce=pi(),Fe=t(Ce);Pa(Fe,{size:14});var Ke=r(Fe,2),Ge=t(Ke,!0);e(Ke),e(Ce),g($=>{qe(Ce,"title",$),n(Ge,l().peers.length)},[()=>x()("common.status.peers",{count:l().peers.length})]),c(Ne,Ce)};M(Me,Ne=>{l().peers.length>0&&Ne(Ue)})}g((Ne,Ce)=>{qe(Qe,"title",Ne),n(st,Ce)},[()=>x()("common.status.connected"),()=>x()("common.status.connected")]),c(V,Pe)},We=V=>{var Pe=hi(),Qe=t(Pe);$r(Qe,{size:16});var tt=r(Qe,2),at=t(tt,!0);e(tt),e(Pe),g((st,Me)=>{qe(Pe,"title",st),n(at,Me)},[()=>x()("common.status.offline"),()=>x()("common.status.offline")]),c(V,Pe)};M(Xe,V=>{l().isConnected?V(Te):V(We,!1)})}e(me);var ft=r(me,2);ft.__click=function(...V){je()?.apply(this,V)};var bt=t(ft);pr(bt,{size:18}),e(ft);var xt=r(ft,2);xt.__click=()=>sa.update(V=>!V);var ot=t(xt);xr(ot,{size:18});var pt=r(ot,2);{var kt=V=>{var Pe=yi();c(V,Pe)};M(pt,V=>{D()&&D().length>0&&V(kt)})}e(xt),e(ze),e(Re),e(we),e(ce),g(()=>{n(W,O()),n(G,N()),Ie(U,1,`flex items-center gap-2 px-3 sm:px-4 py-1.5 rounded-lg text-xs font-black transition-all ${K()==="session"?"bg-indigo-600 text-white shadow-lg shadow-indigo-500/20":"text-slate-500 hover:text-slate-300"}`),qe(U,"aria-pressed",K()==="session"),Ie(de,1,`flex items-center gap-2 px-3 sm:px-4 py-1.5 rounded-lg text-xs font-black transition-all ${K()==="bestiary"?"bg-indigo-600 text-white shadow-lg shadow-indigo-500/20":"text-slate-500 hover:text-slate-300"}`),qe(de,"aria-pressed",K()==="bestiary"),qe(xt,"aria-pressed",k())}),c(C,ce),ea(),v()}ta(["click"]);var $i=_('<!> <!> <main class="max-w-7xl mx-auto p-4 md:p-8 animate-in slide-in-from-bottom-4 duration-500"><!></main>',1),zi=_('<div class="flex flex-col items-center justify-center min-h-screen p-4 text-center"><div class="w-20 h-20 bg-slate-800 rounded-full flex items-center justify-center mx-auto mb-6 text-slate-600"><svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-ghost"><path d="M9 10h.01"></path><path d="M15 10h.01"></path><path d="M12 2a8 8 0 0 0-8 8v12l3-3 2.5 2.5L12 19l2.5 2.5L17 19l3 3V10a8 8 0 0 0-8-8z"></path></svg></div> <h1 class="text-2xl font-black text-white mb-2 uppercase tracking-tight"> </h1> <p class="text-slate-400 mb-8 max-w-md"> </p> <button class="bg-indigo-600 hover:bg-indigo-500 text-white px-8 py-3 rounded-xl font-bold transition-all flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-arrow-left"><path d="m12 19-7-7 7-7"></path><path d="19 12H5"></path></svg> </button></div>'),Ci=_('<div class="flex items-center justify-center min-h-screen"><div class="relative w-16 h-16"><div class="absolute inset-0 border-4 border-indigo-500/20 rounded-full"></div> <div class="absolute inset-0 border-4 border-indigo-500 border-t-transparent rounded-full animate-spin"></div></div></div>'),Ei=_('<div class="min-h-screen bg-slate-950 text-slate-100 font-sans pb-20"><!> <!></div>');function Qi(C,s){Yt(s,!0);const l=()=>et(Qa,"$page",w),x=()=>et(ar,"$liveCampaigns",w),k=()=>et(Lt,"$t",w),D=()=>et(sa,"$isHistoryOpen",w),[w,v]=aa();let O=Le("session"),N=Le(!1),K=pe(()=>l().params.id),Y=pe(()=>x().find(le=>le.id===a(K))),je=pe(()=>!!a(Y));function ce(le){if(!a(K)||!a(Y))return;const ke={...a(Y),...le};wt.set(a(K),ke),ka(a(K),{name:ke.name,gmName:ke.gmName}),P(N,!1)}var we=Ei(),Re=t(we);{var H=le=>{var ke=$i(),F=ye(ke);ki(F,{get campaignName(){return a(Y).name},get gmName(){return a(Y).gmName},get activeSubTab(){return a(O)},onTabChange:E=>P(O,E,!0),onOpenSettings:()=>P(N,!0)});var W=r(F,2);{let E=pe(()=>JSON.stringify(a(Y)));yr(W,{get isOpen(){return a(N)},get initialData(){return a(E)},onClose:()=>P(N,!1),onSave:ce})}var se=r(W,2),G=t(se);{var $e=E=>{Rs(E,{get campaign(){return a(Y)}})},U=E=>{var de=Ze(),xe=ye(de);{var ze=me=>{fi(me,{get campId(){return a(K)}})};M(xe,me=>{a(O)==="bestiary"&&me(ze)},!0)}c(E,de)};M(G,E=>{a(O)==="session"?E($e):E(U,!1)})}e(se),c(le,ke)},Q=le=>{var ke=Ze(),F=ye(ke);{var W=G=>{var $e=zi(),U=r(t($e),2),E=t(U,!0);e(U);var de=r(U,2),xe=t(de,!0);e(de);var ze=r(de,2);ze.__click=()=>window.history.back();var me=r(t(ze));e(ze),e($e),g((Xe,Te,We)=>{n(E,Xe),n(xe,Te),n(me,` ${We??""}`)},[()=>k()("campaign.not_found.title"),()=>k()("campaign.not_found.message"),()=>k()("common.buttons.back")]),c(G,$e)},se=G=>{var $e=Ci();c(G,$e)};M(F,G=>{a(je)&&!a(Y)?G(W):G(se,!1)},!0)}c(le,ke)};M(Re,le=>{a(je)&&a(Y)?le(H):le(Q,!1)})}var oe=r(Re,2);Aa(oe,{get isOpen(){return D()},onClose:()=>sa.set(!1)}),e(we),c(C,we),ea(),v()}ta(["click"]);export{Qi as component};
