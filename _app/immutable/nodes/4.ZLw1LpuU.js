import"../chunks/DsnmJJEf.js";import{B as St,o as qe,k as d,p as ua,v as ba,j as u,q as t,x as a,u as s,z as ke,A as e,t as p,O as Ra,w as y,y as bt,n as va,a2 as ca,at as xa}from"../chunks/CeF9Pysg.js";import{d as _a,s as r,o as Ga,g as Ta,e as ha}from"../chunks/s5ZUjNrT.js";import{l as sa,s as ra,i as f,p as Yt}from"../chunks/BO4Hk4Jc.js";import{e as Ge,s as et,i as Ct,$ as ta,r as dt,a as xe,h as Pa,g as bs,j as _s}from"../chunks/L5xVHH7A.js";import{a as pa,s as Ft}from"../chunks/BuEkqW-1.js";import{p as ps}from"../chunks/B6gsh4Gm.js";import{d as Wa,m as Ma,j as xs,c as Qa,e as Vt,n as Ua,o as ms,q as ya,t as Ea,u as Oa,b as Ke,v as Ya,f as Va,g as Aa,x as fs,y as gs,z as hs}from"../chunks/COofWgfh.js";import{C as Ka,D as wa,l as ys,b as Fa,c as es,a as ws}from"../chunks/BO5uUsVl.js";import{b as ks,t as Ia,f as Sa}from"../chunks/DzIHbexc.js";import{U as ts,C as Za,W as as,r as ss}from"../chunks/vQbAEYqD.js";import{A as zs,a as $s,b as ja,B as Cs,T as Os,E as qa,M as js,G as ga,H as rs,C as Na,R as Es,c as Ms,I as is,s as ns,d as os,L as Is,S as ls,e as Ss,D as ka,f as Rs}from"../chunks/CdMvnKdi.js";import{k as Ba}from"../chunks/53slW3xx.js";import{M as Ns,X as ma,P as ea,a as Xa,c as Ds,T as aa,b as As}from"../chunks/B9mfT_8k.js";import{C as ds,G as da,P as Ha,S as Ts,a as Ps}from"../chunks/DbSKv2P5.js";import"../chunks/C3FPqVk7.js";import{I as ia,s as na}from"../chunks/axHpSoOd.js";import{b as vs}from"../chunks/CWVXqVlC.js";import{g as Us}from"../chunks/DEi3UCcr.js";import{W as Hs}from"../chunks/7Z-uDSBK.js";function Ls(V,o){const n=sa(o,["children","$$slots","$$events","$$legacy"]);const ue=[["path",{d:"m6 9 6 6 6-6"}]];ia(V,ra({name:"chevron-down"},()=>n,{get iconNode(){return ue},children:(J,x)=>{var G=St(),Z=qe(G);na(Z,o,"default",{}),d(J,G)},$$slots:{default:!0}}))}function Fs(V,o){const n=sa(o,["children","$$slots","$$events","$$legacy"]);const ue=[["path",{d:"m18 15-6-6-6 6"}]];ia(V,ra({name:"chevron-up"},()=>n,{get iconNode(){return ue},children:(J,x)=>{var G=St(),Z=qe(G);na(Z,o,"default",{}),d(J,G)},$$slots:{default:!0}}))}function qs(V,o){const n=sa(o,["children","$$slots","$$events","$$legacy"]);const ue=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"}]];ia(V,ra({name:"copy"},()=>n,{get iconNode(){return ue},children:(J,x)=>{var G=St(),Z=qe(G);na(Z,o,"default",{}),d(J,G)},$$slots:{default:!0}}))}function Bs(V,o){const n=sa(o,["children","$$slots","$$events","$$legacy"]);const ue=[["path",{d:"M12 3q1 4 4 6.5t3 5.5a1 1 0 0 1-14 0 5 5 0 0 1 1-3 1 1 0 0 0 5 0c0-2-1.5-3-1.5-5q0-2 2.5-4"}]];ia(V,ra({name:"flame"},()=>n,{get iconNode(){return ue},children:(J,x)=>{var G=St(),Z=qe(G);na(Z,o,"default",{}),d(J,G)},$$slots:{default:!0}}))}function Js(V,o){const n=sa(o,["children","$$slots","$$events","$$legacy"]);const ue=[["circle",{cx:"9",cy:"12",r:"1"}],["circle",{cx:"9",cy:"5",r:"1"}],["circle",{cx:"9",cy:"19",r:"1"}],["circle",{cx:"15",cy:"12",r:"1"}],["circle",{cx:"15",cy:"5",r:"1"}],["circle",{cx:"15",cy:"19",r:"1"}]];ia(V,ra({name:"grip-vertical"},()=>n,{get iconNode(){return ue},children:(J,x)=>{var G=St(),Z=qe(G);na(Z,o,"default",{}),d(J,G)},$$slots:{default:!0}}))}function La(V,o){const n=sa(o,["children","$$slots","$$events","$$legacy"]);const ue=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17"}]];ia(V,ra({name:"layers"},()=>n,{get iconNode(){return ue},children:(J,x)=>{var G=St(),Z=qe(G);na(Z,o,"default",{}),d(J,G)},$$slots:{default:!0}}))}function cs(V,o){const n=sa(o,["children","$$slots","$$events","$$legacy"]);const ue=[["path",{d:"m16 6 4 14"}],["path",{d:"M12 6v14"}],["path",{d:"M8 8v12"}],["path",{d:"M4 4v16"}]];ia(V,ra({name:"library"},()=>n,{get iconNode(){return ue},children:(J,x)=>{var G=St(),Z=qe(G);na(Z,o,"default",{}),d(J,G)},$$slots:{default:!0}}))}function Gs(V,o){const n=sa(o,["children","$$slots","$$events","$$legacy"]);const ue=[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3"}],["path",{d:"M21 21v.01"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7"}],["path",{d:"M3 12h.01"}],["path",{d:"M12 3h.01"}],["path",{d:"M12 16v.01"}],["path",{d:"M16 12h1"}],["path",{d:"M21 12v.01"}],["path",{d:"M12 21v-1"}]];ia(V,ra({name:"qr-code"},()=>n,{get iconNode(){return ue},children:(J,x)=>{var G=St(),Z=qe(G);na(Z,o,"default",{}),d(J,G)},$$slots:{default:!0}}))}function Ja(V,o){const n=sa(o,["children","$$slots","$$events","$$legacy"]);const ue=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7"}]];ia(V,ra({name:"save"},()=>n,{get iconNode(){return ue},children:(J,x)=>{var G=St(),Z=qe(G);na(Z,o,"default",{}),d(J,G)},$$slots:{default:!0}}))}function us(V,o){const n=sa(o,["children","$$slots","$$events","$$legacy"]);const ue=[["polyline",{points:"14.5 17.5 3 6 3 3 6 3 17.5 14.5"}],["line",{x1:"13",x2:"19",y1:"19",y2:"13"}],["line",{x1:"16",x2:"20",y1:"16",y2:"20"}],["line",{x1:"19",x2:"21",y1:"21",y2:"19"}],["polyline",{points:"14.5 6.5 18 3 21 3 21 6 17.5 9.5"}],["line",{x1:"5",x2:"9",y1:"14",y2:"18"}],["line",{x1:"7",x2:"4",y1:"17",y2:"20"}],["line",{x1:"3",x2:"5",y1:"19",y2:"21"}]];ia(V,ra({name:"swords"},()=>n,{get iconNode(){return ue},children:(J,x)=>{var G=St(),Z=qe(G);na(Z,o,"default",{}),d(J,G)},$$slots:{default:!0}}))}function Ws(V){let o=!1;return document.body&&(document.body.appendChild(V),o=!0),{destroy(){o&&V.parentNode&&V.parentNode.removeChild(V)}}}var Qs=u("<button> <!></button>"),Vs=u('<p class="text-xs text-slate-600 italic"> </p>'),Zs=u('<div class="text-xs leading-tight"><span class="text-red-400 font-bold"> </span> <span class="text-slate-400"> </span></div>'),Xs=u('<div class="space-y-1"></div>'),Ys=u('<div class="grid grid-cols-2 gap-2 max-h-[60vh] overflow-y-auto custom-scrollbar p-1"></div> <div class="mt-4 pt-3 border-t border-slate-800 flex flex-col gap-2"><div class="p-3 bg-slate-900/50 rounded-lg border border-slate-700/50 min-h-[60px]"><p class="text-[10px] text-slate-500 uppercase font-bold mb-1"> </p> <!></div> <div class="flex justify-end mt-2"><button class="bg-indigo-600 text-white px-4 py-2 rounded-xl font-bold text-sm shadow hover:bg-indigo-500 transition-colors w-full sm:w-auto"> </button></div></div>',1),Ks=u("<div><!></div>");function er(V,o){ua(o,!0);const n=()=>Ft(ta,"$t",ue),[ue,J]=pa();var x=St(),G=qe(x);{var Z=i=>{var g=Ks(),se=t(g);{let Pe=ke(()=>n()("session.affliction_modal.title"));Ns(se,{get isOpen(){return o.isOpen},get onClose(){return o.onClose},get title(){return a(Pe)},maxWidth:"max-w-md",children:(ze,We)=>{var Ee=Ys(),Me=qe(Ee);Ge(Me,21,()=>Object.keys(zs),Ct,(me,Ne)=>{const ct=ke(()=>o.afflictions.includes(a(Ne)));var F=Qs();F.__click=()=>o.onToggle(a(Ne));var te=t(F),T=s(te);{var Be=Ve=>{ds(Ve,{size:14,class:"text-red-400"})};f(T,Ve=>{a(ct)&&Ve(Be)})}e(F),p(Ve=>{et(F,1,`flex items-center justify-between px-3 py-2 rounded-lg border text-xs font-bold transition-all ${a(ct)?"bg-red-500/20 border-red-500 text-red-100":"bg-slate-800 border-slate-700 text-slate-400 hover:bg-slate-750"}`),r(te,`${Ve??""} `)},[()=>n()(`character.afflictions.${a(Ne)}`)]),d(me,F)}),e(Me);var _e=s(Me,2),De=t(_e),ye=t(De),Mt=t(ye,!0);e(ye);var yt=s(ye,2);{var Ut=me=>{var Ne=Vs(),ct=t(Ne,!0);e(Ne),p(F=>r(ct,F),[()=>n()("session.affliction_modal.none_selected")]),d(me,Ne)},$e=me=>{var Ne=Xs();Ge(Ne,21,()=>o.afflictions,Ct,(ct,F)=>{var te=Zs(),T=t(te),Be=t(T);e(T);var Ve=s(T,2),it=t(Ve,!0);e(Ve),e(te),p((wt,at)=>{r(Be,`${wt??""}:`),r(it,at)},[()=>n()(`character.afflictions.${a(F)}`),()=>n()(`sofww.afflictions.${a(F).toLowerCase().replace(" ","_")}.effect`)]),d(ct,te)}),e(Ne),d(me,Ne)};f(yt,me=>{o.afflictions.length===0?me(Ut):me($e,!1)})}e(De);var Re=s(De,2),Qe=t(Re);Qe.__click=function(...me){o.onClose?.apply(this,me)};var tt=t(Qe,!0);e(Qe),e(Re),e(_e),p((me,Ne)=>{r(Mt,me),r(tt,Ne)},[()=>n()("session.affliction_modal.effects"),()=>n()("session.affliction_modal.done")]),d(ze,Ee)},$$slots:{default:!0}})}e(g),$s(g,Pe=>Ws?.(Pe)),d(i,g)};f(G,i=>{o.isOpen&&i(Z)})}d(V,x),ba(),J()}_a(["click"]);var tr=u('<div class="absolute top-0 right-0 bg-gradient-to-l from-yellow-600/20 to-transparent border-l border-b border-yellow-500/30 text-yellow-500 text-[9px] font-black tracking-widest px-3 py-1 rounded-bl-xl z-20 uppercase shadow-[0_0_10px_rgba(234,179,8,0.2)]"> </div>'),ar=u('<div class="absolute inset-0 bg-red-950/40 animate-pulse z-0 pointer-events-none"></div>'),sr=u('<span class="text-[9px] font-black bg-red-950/40 text-red-500 px-1.5 py-0.5 rounded border border-red-900/30 uppercase tracking-wider flex-shrink-0"> </span>'),rr=u("<button><!></button>"),ir=u('<button class="w-7 h-7 flex items-center justify-center rounded bg-slate-800/50 text-slate-600 hover:text-red-400 hover:bg-red-950/30 border border-slate-700/50 transition-colors"><!></button>'),nr=u('<div><div class="absolute inset-0 bg-gradient-to-b from-white/20 to-transparent"></div></div>'),or=u('<div class="absolute inset-0 bg-gradient-to-r from-emerald-500/20 via-emerald-400/30 to-emerald-500/20 z-10"><div class="absolute inset-0 bg-gradient-to-b from-white/10 to-transparent"></div></div>'),lr=u('<div class="absolute inset-0 flex items-center justify-center pointer-events-none z-20"><span class="text-[9px] font-black uppercase text-white drop-shadow-[0_1px_1px_rgba(0,0,0,0.8)] tracking-widest leading-none mt-0.5"> </span></div>'),dr=u('<div class="absolute inset-0 flex items-center justify-center pointer-events-none z-20"><span class="text-[9px] font-black uppercase text-white drop-shadow-[0_1px_1px_rgba(0,0,0,0.8)] tracking-widest leading-none mt-0.5"> </span></div>'),vr=u('<div class="flex flex-col items-center justify-between bg-cyan-950/20 border border-cyan-500/30 rounded-lg p-1.5 w-[4.5rem] h-[3.75rem] shadow-sm"><span class="text-[9px] font-black text-cyan-400 uppercase tracking-wider mb-0.5"> </span> <span class="text-xl font-bold text-white font-mono leading-none"> </span></div>'),cr=u('<button class="text-[9px] bg-red-500/10 text-red-400 px-1.5 py-0.5 rounded border border-red-500/20 hover:bg-red-500/20 hover:border-red-500/40 transition-all flex items-center gap-1 group/btn"> <!></button>'),ur=u('<div class="bg-slate-900/50 p-2 rounded border border-slate-800/50 text-center"><span class="text-[9px] text-slate-500 uppercase font-black block mb-0.5"> </span> <div class="text-white font-bold font-mono text-lg leading-none"> </div> <div> </div></div>'),br=u('<div class="grid grid-cols-2 gap-4 mb-4"><div class="p-3 rounded-xl bg-purple-950/20 border border-purple-500/30 flex justify-between items-center group/ins"><div><span class="text-[9px] text-purple-400 uppercase font-black block"> </span> <span class="text-white font-bold text-lg font-mono leading-none"> </span></div> <!></div> <div class="p-3 rounded-xl bg-red-950/20 border border-red-500/30 flex justify-between items-center group/cor"><div><span class="text-[9px] text-red-400 uppercase font-black block"> </span> <span class="text-white font-bold text-lg font-mono leading-none"> </span></div> <!></div></div>'),_r=u("<!> ",1),pr=u('<div><div class="text-emerald-500 text-[10px] font-black uppercase mb-2 flex items-center gap-2"> <span class="h-px flex-1 bg-current opacity-20"></span></div> <div class="flex flex-wrap gap-2"></div></div>'),xr=u('<div class="text-sm bg-slate-900/30 p-2 rounded border border-slate-800/30"><span class="font-bold text-slate-300"> </span> <span class="text-slate-400 text-xs block mt-1 leading-relaxed"> </span></div>'),mr=u('<div><div> <span class="h-px flex-1 bg-current opacity-20"></span></div> <div class="grid gap-2"></div></div>'),fr=u('<div class="border-t border-slate-800/50 bg-slate-950/30 p-4"><div class="mb-4"><div class="text-slate-500 font-bold uppercase text-[10px] mb-2 flex items-center gap-2"><span> </span> <div class="h-px flex-1 bg-slate-800"></div></div> <div class="grid grid-cols-4 gap-2"></div></div> <!> <div class="grid grid-cols-2 gap-4 mb-4"><div class="p-2 rounded bg-slate-900/50 border border-slate-800/50 flex flex-col items-center"><span class="text-[9px] text-slate-500 uppercase font-black"> </span> <span class="text-white font-bold"> </span></div> <div class="p-2 rounded bg-slate-900/50 border border-slate-800/50 flex flex-col items-center"><span class="text-[9px] text-slate-500 uppercase font-black"> </span> <span class="text-white font-bold"> </span></div></div> <div class="space-y-4"><!> <!></div></div>'),gr=u('<div><!> <!> <div class="relative z-10 p-4"><div class="flex items-start gap-4 mb-3"><div class="relative flex-shrink-0"><div><!></div> <button><!></button></div> <div class="flex-1 min-w-0"><div class="flex justify-between items-start mb-1"><div class="flex flex-col min-w-0 mr-2"><div class="flex items-center gap-2"><h3> </h3> <!></div></div> <div class="flex gap-1 flex-shrink-0"><button class="w-7 h-7 flex items-center justify-center rounded bg-slate-800 text-slate-500 hover:text-white hover:bg-slate-700 border border-slate-700/50 transition-colors"><!></button> <!></div></div>  <div class="relative w-full h-3.5 sm:h-4 bg-slate-950 rounded-full border border-white/5 overflow-hidden shadow-inner group-hover:border-white/20 transition-all mb-2"><div></div> <!> <!> <!></div> <div class="flex flex-col sm:flex-row gap-3"><div class="flex items-start gap-1.5"><div class="flex flex-col items-center justify-between bg-slate-900 border border-slate-700 rounded-lg p-1.5 w-[4.5rem] h-[3.75rem] shadow-sm"><span class="text-[9px] font-black text-slate-400 uppercase tracking-wider mb-0.5"> </span> <span class="text-xl font-bold text-white font-mono leading-none"> </span></div> <div class="flex flex-col items-center justify-between bg-red-950/30 border border-red-900/50 rounded-lg p-1.5 w-[4.5rem] h-[3.75rem] shadow-sm relative group/dmg"><span class="text-[9px] font-black text-red-400 uppercase tracking-wider mb-0.5"> </span> <input type="number" class="w-full bg-transparent text-center text-white font-mono font-bold text-xl focus:outline-none p-0 leading-none placeholder-red-800"/> <span class="absolute -top-1 -right-1 flex h-2 w-2 opacity-0 group-hover/dmg:opacity-100 transition-opacity"><span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-red-400 opacity-75"></span> <span class="relative inline-flex rounded-full h-2 w-2 bg-red-500"></span></span></div> <div><span> </span> <div class="flex items-baseline gap-0.5 justify-center w-full"><input type="number" class="w-full bg-transparent text-right text-white font-mono font-bold text-xl focus:outline-none p-0 leading-none"/> <span class="text-[10px] text-slate-500 font-mono self-end mb-0.5 opacity-70"> </span></div></div> <!></div> <div class="flex flex-wrap gap-1.5 items-center flex-1"><!> <button class="text-[10px] sm:text-[9px] font-bold text-slate-500 hover:text-indigo-400 px-1.5 py-0.5 rounded border border-transparent hover:border-indigo-500/30 hover:bg-indigo-500/10 transition-all flex items-center gap-1 whitespace-nowrap"><!> </button></div></div></div></div></div>  <!> <!></div>');function hr(V,o){ua(o,!0);const n=()=>Ft(ta,"$t",ue),[ue,J]=pa();let x=Yt(o,"updateEnemy",3,(v,b)=>{}),G=Yt(o,"updatePlayer",3,(v,b)=>{}),Z=Yt(o,"removeFromCombat",3,v=>{}),i=ke(()=>o.entity.type==="player"),g=ke(()=>o.entity.system==="sofdl"),se=ke(()=>o.entity.damage||0),Pe=ke(()=>o.entity.normalHealth||o.entity.health||10),ze=ke(()=>o.entity.currentHealth??a(Pe)),We=ke(()=>a(se)>=a(ze)),Ee=ke(()=>a(se)>=a(ze)/2&&!a(We)),Me=ke(()=>a(ze)>0?Math.min(100,Math.max(0,a(se)/a(ze)*100)):100),_e=bt(!1),De=bt(!1);Ra(()=>{const v=o.entity.afflictions||[],b=v.includes("Incapacitated");if(a(We)&&!b){const D={afflictions:[...v,"Incapacitated"]};o.entity.type==="player"?ye(D):x()(o.entity.instanceId,D)}else if(!a(We)&&b){const D={afflictions:v.filter(ve=>ve!=="Incapacitated")};o.entity.type==="player"?ye(D):x()(o.entity.instanceId,D)}});function ye(v){if(o.entity.type!=="player")return;const b=Wa.get(o.entity.id);b&&Wa.set(o.entity.id,{...b,...v}),G()(o.entity.id,v),Ma({id:o.entity.id,...v})}function Mt(v){const b=parseInt(v.target.value);if(isNaN(b))return;const D={damage:Math.max(0,b)};o.entity.type==="player"?ye(D):x()(o.entity.instanceId,D)}function yt(v){const b=parseInt(v.target.value);if(isNaN(b))return;const m=Math.max(0,b);let D=a(se);m<a(se)&&(D=m);const ve={currentHealth:m,damage:D};o.entity.type==="player"?ye(ve):x()(o.entity.instanceId,ve)}function Ut(){const v=!o.entity.acted;o.entity.type==="player"?ye({acted:v}):x()(o.entity.instanceId,{acted:v})}function $e(){o.entity.type==="player"&&ye({initiative:!o.entity.initiative})}function Re(v){const b=o.entity.afflictions||[],D={afflictions:b.includes(v)?b.filter(ve=>ve!==v):[...b,v]};o.entity.type==="player"?ye(D):x()(o.entity.instanceId,D)}var Qe=gr(),tt=t(Qe);{var me=v=>{var b=tr(),m=t(b,!0);e(b),p(D=>r(m,D),[()=>n()("session.combat_card.initiative")]),d(v,b)};f(tt,v=>{a(i)&&o.entity.initiative&&v(me)})}var Ne=s(tt,2);{var ct=v=>{var b=ar();d(v,b)};f(Ne,v=>{a(We)&&v(ct)})}var F=s(Ne,2),te=t(F),T=t(te),Be=t(T),Ve=t(Be);Ba(Ve,()=>o.entity.imageUrl,v=>{{let b=ke(()=>o.entity.name.charAt(0));ja(v,{get hash(){return o.entity.imageUrl},get alt(){return o.entity.name},size:"custom",get fallbackText(){return a(b)}})}}),e(Be);var it=s(Be,2);it.__click=Ut;var wt=t(it);{var at=v=>{Xa(v,{size:14,class:""})},Rt=v=>{var b=St(),m=qe(b);{var D=we=>{ds(we,{size:14})},ve=we=>{us(we,{size:14})};f(m,we=>{o.entity.acted?we(D):we(ve,!1)},!0)}d(v,b)};f(wt,v=>{a(We)?v(at):v(Rt,!1)})}e(it),e(T);var mt=s(T,2),re=t(mt),be=t(re),Ze=t(be),Ue=t(Ze),vt=t(Ue,!0);e(Ue);var st=s(Ue,2);{var ie=v=>{var b=sr(),m=t(b);e(b),p(()=>r(m,`Dif ${o.entity.difficulty??""}`)),d(v,b)};f(st,v=>{a(i)||v(ie)})}e(Ze),e(be);var Le=s(be,2),E=t(Le);E.__click=()=>y(_e,!a(_e));var Ce=t(E);{var fe=v=>{Fs(v,{size:14})},He=v=>{Ls(v,{size:14})};f(Ce,v=>{a(_e)?v(fe):v(He,!1)})}e(E);var Ie=s(E,2);{var ut=v=>{var b=rr();b.__click=$e;var m=t(b);Bs(m,{size:14}),e(b),p(D=>{et(b,1,`w-7 h-7 flex items-center justify-center rounded transition-all ${o.entity.initiative?"bg-yellow-500 text-yellow-950 shadow-lg shadow-yellow-500/20":"bg-slate-800 text-slate-500 hover:text-white hover:bg-slate-700"}`),xe(b,"title",D)},[()=>n()("session.combat_card.initiative")]),d(v,b)},Xe=v=>{var b=ir();b.__click=()=>Z()(o.entity.instanceId);var m=t(b);ma(m,{size:14}),e(b),d(v,b)};f(Ie,v=>{a(i)?v(ut):v(Xe,!1)})}e(Le),e(re);var Ye=s(re,2),kt=t(Ye),jt=s(kt,2);{var Dt=v=>{var b=nr();p(()=>{et(b,1,`absolute top-0 left-0 h-full transition-all duration-500 ease-out z-10
                            ${a(We)?"bg-gradient-to-r from-red-600 via-red-500 to-rose-500 animate-pulse":a(Me)>=80?"bg-gradient-to-r from-red-600 to-rose-500":a(Ee)?"bg-gradient-to-r from-amber-600 to-orange-500":"bg-gradient-to-r from-orange-500 to-amber-400"}`),bs(b,`width: ${a(Me)??""}%`)}),d(v,b)};f(jt,v=>{a(Me)>0&&v(Dt)})}var Tt=s(jt,2);{var k=v=>{var b=or();d(v,b)};f(Tt,v=>{a(se)===0&&v(k)})}var R=s(Tt,2);{var H=v=>{var b=lr(),m=t(b),D=t(m,!0);e(m),e(b),p(ve=>r(D,ve),[()=>n()("session.combat_card.incapacitated")]),d(v,b)},Oe=v=>{var b=St(),m=qe(b);{var D=ve=>{var we=dr(),Te=t(we),pt=t(Te,!0);e(Te),e(we),p(xt=>r(pt,xt),[()=>n()("session.combat_card.injured")]),d(ve,we)};f(m,ve=>{a(Ee)&&ve(D)},!0)}d(v,b)};f(R,v=>{a(We)?v(H):v(Oe,!1)})}e(Ye);var nt=s(Ye,2),Fe=t(nt),rt=t(Fe),ft=t(rt),Et=t(ft,!0);e(ft);var Ae=s(ft,2),ht=t(Ae,!0);e(Ae),e(rt);var P=s(rt,2),C=t(P),U=t(C,!0);e(C);var ne=s(C,2);dt(ne),ne.__input=Mt,va(2),e(P);var N=s(P,2),W=t(N),X=t(W,!0);e(W);var je=s(W,2),de=t(je);dt(de),de.__input=yt;var oe=s(de,2),L=t(oe);e(oe),e(je),e(N);var ge=s(N,2);{var pe=v=>{var b=vr(),m=t(b),D=t(m,!0);e(m);var ve=s(m,2),we=t(ve,!0);e(ve),e(b),p(Te=>{r(D,Te),r(we,o.entity.perception||10)},[()=>n()("sofdl.attributes.perception")]),d(v,b)};f(ge,v=>{a(g)&&v(pe)})}e(Fe);var Se=s(Fe,2),ot=t(Se);Ge(ot,17,()=>o.entity.afflictions||[],Ct,(v,b)=>{var m=cr();m.__click=()=>Re(a(b));var D=t(m),ve=s(D);ma(ve,{size:8,class:"opacity-50 group-hover/btn:opacity-100"}),e(m),p(()=>r(D,`${a(b)??""} `)),d(v,m)});var lt=s(ot,2);lt.__click=()=>y(De,!0);var _t=t(lt);ea(_t,{size:10});var zt=s(_t);e(lt),e(Se),e(nt),e(mt),e(te),e(F);var It=s(F,2);{var qt=v=>{var b=fr(),m=t(b),D=t(m),ve=t(D),we=t(ve,!0);e(ve),va(2),e(D);var Te=s(D,2);Ge(Te,21,()=>a(g)?["strength","agility","intellect","will"]:["str","agi","int","wil"],Ct,(K,j)=>{const le=ke(()=>a(g)?o.entity.attributes?.[a(j)]??10:o.entity.stats?.[a(j)]??o.entity.attributes?.[a(j)]??10),he=ke(()=>a(le)-10);var q=ur(),S=t(q),M=t(S,!0);e(S);var O=s(S,2),ee=t(O,!0);e(O);var z=s(O,2),A=t(z);e(z),e(q),p(B=>{r(M,B),r(ee,a(le)),et(z,1,`text-[9px] font-bold ${a(he)>=0?"text-emerald-500":"text-red-500"}`),r(A,`${a(he)>=0?"+":""}${a(he)??""}`)},[()=>a(g)?a(j).slice(0,3):a(j)]),d(K,q)}),e(Te),e(m);var pt=s(m,2);{var xt=K=>{var j=br(),le=t(j),he=t(le),q=t(he),S=t(q,!0);e(q);var M=s(q,2),O=t(M,!0);e(M),e(he);var ee=s(he,2);Cs(ee,{size:20,class:"text-purple-500/30 group-hover/ins:text-purple-500 transition-colors"}),e(le);var z=s(le,2),A=t(z),B=t(A),I=t(B,!0);e(B);var ae=s(B,2),ce=t(ae,!0);e(ae),e(A);var Je=s(A,2);Xa(Je,{size:20,class:"text-red-500/30 group-hover/cor:text-red-500 transition-colors"}),e(z),e(j),p((Pt,gt)=>{r(S,Pt),r(O,o.entity.insanity||0),r(I,gt),r(ce,o.entity.corruption||0)},[()=>n()("sofdl.attributes.insanity"),()=>n()("sofdl.attributes.corruption")]),d(K,j)};f(pt,K=>{a(g)&&K(xt)})}var Nt=s(pt,2),$t=t(Nt),Ht=t($t),Lt=t(Ht,!0);e(Ht);var Wt=s(Ht,2),Gt=t(Wt,!0);e(Wt),e($t);var Qt=s($t,2),l=t(Qt),c=t(l,!0);e(l);var _=s(l,2),h=t(_,!0);e(_),e(Qt),e(Nt);var Y=s(Nt,2),w=t(Y);{var $=K=>{var j=pr(),le=t(j),he=t(le);va(),e(le);var q=s(le,2);Ge(q,21,()=>o.entity.senses,Ct,(S,M)=>{const O=ke(()=>{const[A,B]=a(M).split(":");return{key:A,val:B}}),ee=ke(()=>n()(`character.senses.list.${a(O).key}`)+(a(O).val?` ${a(O).val}`:"")),z=ke(()=>n()(`character.senses.descriptions.${a(O).key}`));Os(S,{get text(){return a(z)},class:"text-xs bg-emerald-950/30 text-emerald-200 px-3 py-1.5 rounded border border-emerald-900/50 font-bold flex items-center gap-2 cursor-help whitespace-nowrap",children:(A,B)=>{var I=_r(),ae=qe(I);qa(ae,{size:12,class:"text-emerald-500 flex-shrink-0"});var ce=s(ae);p(()=>r(ce,` ${a(ee)??""}`)),d(A,I)},$$slots:{default:!0}})}),e(q),e(j),p(S=>r(he,`${S??""} `),[()=>n()("character.senses.title")]),d(K,j)};f(w,K=>{o.entity.senses&&o.entity.senses.length>0&&K($)})}var Q=s(w,2);Ge(Q,16,()=>[{key:"traits",label:"Traços",color:"text-amber-500"},{key:"actions",label:"Ações",color:"text-red-400"},{key:"reactions",label:"Reações",color:"text-indigo-400"},{key:"end_of_round",label:"Fim da Rodada",color:"text-emerald-400"}],Ct,(K,j)=>{var le=St(),he=qe(le);{var q=S=>{var M=mr(),O=t(M),ee=t(O);va(),e(O);var z=s(O,2);Ge(z,21,()=>o.entity[j.key],Ct,(A,B)=>{var I=xr(),ae=t(I),ce=t(ae,!0);e(ae);var Je=s(ae,2),Pt=t(Je,!0);e(Je),e(I),p(()=>{r(ce,a(B).name),r(Pt,a(B).description||a(B).effect)}),d(A,I)}),e(z),e(M),p(()=>{et(O,1,`${j.color??""} text-[10px] font-black uppercase mb-2 flex items-center gap-2`),r(ee,`${j.label??""} `)}),d(S,M)};f(he,S=>{o.entity[j.key]&&o.entity[j.key].length>0&&S(q)})}d(K,le)}),e(Y),e(b),p((K,j,le)=>{r(we,K),r(Lt,j),r(Gt,o.entity.size||1),r(c,le),r(h,o.entity.speed||10)},[()=>n()("session.combat_card.attributes"),()=>n()("session.combat_card.size"),()=>n()("session.combat_card.speed")]),d(v,b)};f(It,v=>{a(_e)&&v(qt)})}var At=s(It,2);{let v=ke(()=>o.entity.afflictions||[]);er(At,{get isOpen(){return a(De)},onClose:()=>y(De,!1),get afflictions(){return a(v)},onToggle:Re})}e(Qe),p((v,b,m,D,ve)=>{et(Qe,1,`group relative overflow-hidden transition-all duration-300 rounded-2xl border ${a(i)?"bg-slate-900/80 border-indigo-500/30 hover:border-indigo-500/50 hover:shadow-indigo-900/20":"bg-slate-950/80 border-red-900/30 hover:border-red-800/50 hover:shadow-red-900/10"} shadow-lg backdrop-blur-sm`),et(Be,1,`w-14 h-14 rounded-2xl overflow-hidden border-2 shadow-xl transition-transform group-hover:scale-105 ${a(We)?"border-red-600 grayscale brightness-50":a(i)?"border-indigo-500/50":"border-red-900/50"}`),et(it,1,`absolute -bottom-2 -right-2 w-7 h-7 rounded-lg flex items-center justify-center border shadow-lg transition-all hover:scale-110 z-20 ${o.entity.acted?"bg-slate-800 border-slate-600 text-slate-500":a(i)?"bg-indigo-600 border-indigo-400 text-white":"bg-red-600 border-red-400 text-white"}`),xe(it,"title",v),et(Ue,1,`text-base font-bold truncate leading-snug ${a(i)?"text-white":"text-red-100 font-serif tracking-wide"}`),r(vt,o.entity.name),et(kt,1,`absolute inset-0 w-full ${a(se)===0?"bg-emerald-900/20":"bg-slate-900/50"}`),r(Et,b),r(ht,o.entity.defense||10),r(U,m),Pa(ne,a(se)),et(N,1,`flex flex-col items-center justify-between border rounded-lg p-1.5 w-[5.5rem] h-[3.75rem] shadow-sm relative transition-colors ${a(We)?"bg-red-950/50 border-red-500":a(Ee)?"bg-orange-950/30 border-orange-500":"bg-emerald-950/30 border-emerald-900/50"}`),et(W,1,`text-[9px] font-black uppercase tracking-wider mb-0.5 ${a(We)?"text-red-400":a(Ee)?"text-orange-400":"text-emerald-400"}`),r(X,D),Pa(de,a(ze)),r(L,`/${a(Pe)??""}`),r(zt,` ${ve??""}`)},[()=>o.entity.acted?n()("session.combat_card.acted"):n()("session.combat_card.act"),()=>n()("session.combat_card.defense"),()=>n()("session.combat_card.damage"),()=>n()("session.combat_card.health"),()=>n()("session.combat_card.add_affliction")]),d(V,Qe),ba(),J()}_a(["click","input"]);function yr(V,{from:o,to:n},ue={}){var{delay:J=0,duration:x=$e=>Math.sqrt($e)*120,easing:G=Ds}=ue,Z=getComputedStyle(V),i=Z.transform==="none"?"":Z.transform,[g,se]=Z.transformOrigin.split(" ").map(parseFloat);g/=V.clientWidth,se/=V.clientHeight;var Pe=wr(V),ze=V.clientWidth/n.width/Pe,We=V.clientHeight/n.height/Pe,Ee=o.left+o.width*g,Me=o.top+o.height*se,_e=n.left+n.width*g,De=n.top+n.height*se,ye=(Ee-_e)*ze,Mt=(Me-De)*We,yt=o.width/n.width,Ut=o.height/n.height;return{delay:J,duration:typeof x=="function"?x(Math.sqrt(ye*ye+Mt*Mt)):x,easing:G,css:($e,Re)=>{var Qe=Re*ye,tt=Re*Mt,me=$e+Re*yt,Ne=$e+Re*Ut;return`transform: ${i} translate(${Qe}px, ${tt}px) scale(${me}, ${Ne});`}}}function wr(V){if("currentCSSZoom"in V)return V.currentCSSZoom;for(var o=V,n=1;o!==null;)n*=+getComputedStyle(o).zoom,o=o.parentElement;return n}function kr(V,o=1,n=0){const ue=[];let J=0;for(let i=0;i<o;i++){const g=Math.floor(Math.random()*V)+1;ue.push(g),J+=g}let x=`${o}d${V}`,G=[],Z=0;if(n!==0)if(V===20){const i=Math.abs(n);for(let se=0;se<i;se++)G.push(Math.floor(Math.random()*6)+1);const g=Math.max(...G);n>0?(Z=g,J+=g,x+=` + ${g} [Boon]`):(Z=-g,J-=g,x+=` - ${g} [Bane]`)}else Z=n,J+=n,x+=n>0?` + ${n}`:` - ${Math.abs(n)}`;return{total:J,results:ue,bonusRolls:G,formula:x,crit:V===20&&ue.includes(20),modifierTotal:Z}}function zr(V,o,n){const ue=n.map(i=>({...i,type:"enemy"}));if(V==="standard"){const i=o.filter(ze=>ze.initiative).map(ze=>({...ze,type:"player",isFast:!0})),g=o.filter(ze=>!ze.initiative).map(ze=>({...ze,type:"player",isFast:!1})),se=ue.filter(ze=>ze.initiative).map(ze=>({...ze,isFast:!0})),Pe=ue.filter(ze=>!ze.initiative).map(ze=>({...ze,isFast:!1}));return[...i,...se,...g,...Pe]}if(V==="individual")return[...o.map(g=>({...g,type:"player",totalInit:(g.initiativeRoll||0)+(g.attributes?.agility||10)-10})),...ue.map(g=>({...g,type:"enemy",totalInit:(g.initiativeRoll||0)+(g.attributes?.agility||10)-10}))].sort((g,se)=>se.totalInit-g.totalInit);const J=o.filter(i=>i&&i.initiative).map(i=>({...i,type:"player"})),x=o.filter(i=>i&&!i.initiative).map(i=>({...i,type:"player"})),G=[...J,...ue,...x],Z=new Set;return G.filter(i=>{if(!i)return!1;const g=i.type==="player"?i.id:i.instanceId;return Z.has(g)?!1:(Z.add(g),!0)})}var $r=u('<span class="text-[10px] bg-slate-800 text-slate-400 px-1.5 py-0.5 rounded-full"> </span>'),Cr=u('<div class="p-3 rounded-xl border border-amber-500/30 bg-amber-500/5 flex items-center gap-3 transition-all hover:bg-amber-500/10 shadow-sm"><div class="flex-1"><div class="font-bold text-sm text-amber-200 leading-none"> </div> <div class="text-[9px] text-amber-500/60 font-medium mt-1 uppercase tracking-tighter"> </div></div> <div class="flex items-center gap-1.5"><button class="p-2 rounded-lg bg-green-600/20 text-green-400 hover:bg-green-600 hover:text-white transition-all shadow-lg active:scale-90" title="Aprovar"><!></button> <button class="p-2 rounded-lg bg-red-600/20 text-red-400 hover:bg-red-600 hover:text-white transition-all shadow-lg active:scale-90" title="Recusar"><!></button></div></div>'),Or=u('<div class="space-y-2 animate-in fade-in slide-in-from-top-2"><div class="flex items-center gap-2 px-1"><div class="w-1.5 h-1.5 rounded-full bg-amber-500 animate-pulse"></div> <span class="text-[10px] font-black text-amber-500 uppercase tracking-wider"> </span></div> <!> <div class="h-px bg-slate-800/50 mx-2 my-2"></div></div>'),jr=u('<span class="text-indigo-400 font-bold uppercase tracking-tighter mr-1"> </span>'),Er=u('<div><div></div> <div class="flex-1"><div> </div> <div class="text-[10px] text-slate-500 font-medium"><!> </div></div> <div class="flex items-center gap-1"><button><!></button> <button class="text-slate-600 hover:text-red-400 p-1.5 hover:bg-red-400/10 rounded-lg transition-all"><!></button></div></div>'),Mr=u('<div class="text-xs text-slate-600 italic p-6 border-2 border-dashed border-slate-800 rounded-xl text-center"> </div>'),Ir=u('<button class="w-full bg-indigo-600 hover:bg-indigo-500 text-white py-3 rounded-xl font-black uppercase text-[10px] tracking-[0.2em] shadow-lg shadow-indigo-900/20 transition-all active:scale-[0.98] flex items-center justify-center gap-2"><!> </button> <p class="text-[9px] text-slate-600 text-center font-bold uppercase tracking-tighter"> </p>',1),Sr=u('<div class="flex justify-center p-3 bg-white rounded-xl mb-2 animate-in zoom-in-95 duration-200 shadow-xl mx-auto w-32 h-32"><img class="w-24 h-24"/></div>'),Rr=u('<div class="absolute bottom-full left-1/2 -translate-x-1/2 mb-2 px-2 py-1 bg-green-500 text-white text-[10px] font-bold rounded shadow-lg animate-in fade-in slide-in-from-bottom-1 whitespace-nowrap"><!> </div>'),Nr=u('<div class="flex items-center justify-between"><div class="flex items-center gap-2"><span class="text-[10px] font-black text-indigo-400 uppercase tracking-widest flex items-center gap-1"><!> </span></div> <button class="text-slate-500 hover:text-white transition-colors p-1"><!></button></div> <!> <div class="relative group"><div class="flex gap-1"><div class="flex-1 bg-slate-950 border border-slate-800 rounded-lg p-2 text-[10px] text-slate-400 font-mono truncate cursor-pointer hover:border-slate-700 transition-colors flex items-center"> </div> <button class="bg-indigo-600 hover:bg-indigo-500 text-white p-2 rounded-lg transition-all active:scale-95 shadow-lg shadow-indigo-900/20 relative"><!> <!></button></div></div> <button class="w-full text-[9px] text-slate-600 hover:text-red-400 font-bold uppercase tracking-widest transition-colors mt-1"> </button>',1),Dr=u('<div class="flex justify-between items-center bg-slate-950 p-2 rounded border border-slate-800 group hover:border-indigo-500/30 transition-all cursor-move hover:bg-slate-800/50" draggable="true"><div class="truncate flex-1 flex items-center gap-2"><!> <div class="min-w-0 flex-1"><div class="text-sm font-bold text-white truncate flex items-center gap-1"> <!></div> <div class="text-[10px] text-slate-500"> </div></div></div> <button class="text-slate-500 hover:text-indigo-400 p-1 ml-2 bg-slate-900 rounded border border-slate-800 hover:bg-slate-800"><!></button></div>'),Ar=u('<div class="text-center text-slate-600 italic text-xs mt-4"> </div>'),Tr=u("<!> <!>",1),Pr=u('<div class="flex justify-between items-center bg-slate-950 p-2 rounded border border-slate-800 group hover:border-indigo-500/30 transition-all cursor-move hover:bg-slate-800/50" draggable="true"><div class="truncate flex-1"><div class="text-sm font-bold text-white truncate flex items-center gap-1"> <!></div> <div class="text-[10px] text-slate-500"> </div></div> <button class="text-slate-500 hover:text-indigo-400 p-1 ml-2 bg-slate-900 rounded border border-slate-800 hover:bg-slate-800"><!></button></div>'),Ur=u('<div class="text-center text-slate-600 italic text-xs mt-4"> </div>'),Hr=u("<!> <!>",1),Lr=u('<button class="bg-green-600 hover:bg-green-500 text-white px-6 py-2 rounded-lg font-bold flex items-center gap-2 shadow-lg shadow-green-900/20"><!> </button>'),Fr=u('<div class="flex items-center gap-4"><button class="p-2 hover:bg-slate-700 rounded text-slate-400"><!></button> <div class="text-center"><div class="text-[10px] font-bold text-slate-500 uppercase"> </div><div class="text-3xl font-mono font-bold text-white leading-none"> </div></div> <button class="bg-indigo-600 hover:bg-indigo-500 text-white px-4 py-2 rounded font-bold flex items-center gap-2"><!> </button> <div class="h-8 w-px bg-slate-700 mx-2"></div> <button class="text-red-400 hover:text-red-300 text-xs font-bold px-3 py-2 border border-red-900/30 rounded bg-red-900/10"> </button></div>'),qr=u("<div><!></div>"),Br=u('<div class="text-center text-slate-500 italic py-10"> </div>'),Jr=u('<div class="text-sm"><span class="font-bold text-yellow-500"> </span> <span class="text-slate-300"> </span></div>'),Gr=u('<div class="bg-slate-900 border border-slate-700 rounded-lg p-4"><h4 class="font-bold text-white mb-2 pb-2 border-b border-slate-800 flex items-center gap-2"><!> </h4> <div class="space-y-2"></div></div>'),Wr=u('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/80 p-4" role="button" aria-label="Fechar" tabindex="-1"><div class="bg-slate-800 rounded-xl w-full max-w-lg border border-slate-700 shadow-2xl p-6 relative" role="dialog" aria-modal="true"><div class="flex items-center gap-3 mb-6"><div class="p-3 bg-yellow-900/20 rounded-full border border-yellow-500/30 text-yellow-500"><!></div> <div><h3 class="font-bold text-white text-xl"> </h3> <p class="text-slate-400 text-sm"> </p></div></div> <div class="space-y-4 mb-8 max-h-[60vh] overflow-y-auto custom-scrollbar"></div> <div class="flex gap-3"><button class="flex-1 py-1.5 rounded bg-slate-700 hover:bg-slate-600 text-white font-bold text-sm"> </button> <button class="flex-1 py-1.5 rounded bg-indigo-600 hover:bg-indigo-500 text-white font-bold text-sm"> </button></div></div></div>'),Qr=u('<button class="w-full text-left flex items-center gap-3 p-3 bg-slate-900 border border-slate-700 hover:border-indigo-500 hover:bg-indigo-500/10 rounded-xl group transition-all"><div class="w-10 h-10 rounded-full bg-slate-800 flex items-center justify-center text-sm font-bold text-slate-500 group-hover:text-indigo-400 border border-slate-700 group-hover:border-indigo-500/30"> </div> <div class="flex-1"><div class="font-bold text-white group-hover:text-indigo-300"> </div> <div class="text-[10px] text-slate-500"> </div></div> <div class="bg-slate-800 p-2 rounded-lg text-slate-500 group-hover:bg-indigo-500 group-hover:text-white transition-colors"><!></div></button>'),Vr=u('<div class="text-center py-8"><div class="w-12 h-12 bg-slate-700/50 rounded-full flex items-center justify-center mx-auto mb-3 text-slate-500"><!></div> <p class="text-slate-500 text-sm font-bold"> </p> <p class="text-[10px] text-slate-600 mt-1"> </p></div>'),Zr=u('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/80 p-4" role="button" aria-label="Fechar" tabindex="-1"><div class="bg-slate-800 rounded-xl w-full max-w-md border border-slate-700 shadow-2xl p-6" role="dialog" aria-modal="true"><div class="flex justify-between items-center mb-6"><div><h3 class="font-bold text-white text-lg"> </h3> <p class="text-xs text-slate-400"> </p></div> <button class="bg-slate-700 hover:bg-slate-600 p-2 rounded-lg text-white transition-colors"><!></button></div> <div class="space-y-3 max-h-[60vh] overflow-y-auto custom-scrollbar pr-2"><!> <!></div></div></div>'),Xr=u('<div class="flex justify-between items-center bg-slate-950 p-3 rounded-xl border border-slate-800 group active:border-indigo-500/50 transition-all"><div class="truncate flex-1 flex flex-col"><div class="text-sm font-bold text-white truncate flex items-center gap-1"> <!></div> <div class="text-[10px] text-slate-500"> </div></div> <button class="text-white hover:bg-indigo-600 p-2 bg-slate-800 rounded-lg border border-slate-700"><!></button></div>'),Yr=u('<div class="text-center text-slate-600 italic text-xs mt-4"> </div>'),Kr=u("<!> <!>",1),ei=u('<div class="flex justify-between items-center bg-slate-950 p-3 rounded-xl border border-slate-800 group active:border-indigo-500/50 transition-all"><div class="truncate flex-1"><div class="text-sm font-bold text-white truncate flex items-center gap-1"> <!></div> <div class="text-[10px] text-slate-500"> </div></div> <button class="text-white hover:bg-indigo-600 p-2 bg-slate-800 rounded-lg border border-slate-700"><!></button></div>'),ti=u('<div class="text-center text-slate-600 italic text-xs mt-4"> </div>'),ai=u("<!> <!>",1),si=u('<div class="fixed inset-0 z-50 flex justify-end bg-black/60"><div class="w-full max-w-[300px] h-full bg-slate-900 border-l border-slate-800 p-4 shadow-2xl animate-in slide-in-from-right duration-300"><div class="flex justify-between items-center mb-4"><h3 class="font-bold text-white uppercase tracking-widest text-sm flex items-center gap-2"><!> </h3> <button class="bg-slate-800 p-2 rounded-lg text-slate-400 hover:text-white"><!></button></div> <div class="flex items-center gap-2 mb-3 bg-slate-950 p-1 rounded-lg border border-slate-800"><button><!> </button> <button><!> </button></div> <div class="h-[calc(100%-100px)] overflow-y-auto custom-scrollbar space-y-2"><!></div></div></div>'),ri=u('<div class="grid grid-cols-1 lg:grid-cols-4 gap-6 h-full relative"><div class="space-y-6"><div class="bg-slate-900 border border-slate-800 rounded-xl p-4 flex flex-col gap-4"><div class="flex justify-between items-center bg-slate-950/50 p-2 rounded-lg border border-slate-800"><h3 class="text-xs font-black text-slate-500 uppercase tracking-widest flex items-center gap-2"><!> <!></h3> <button class="text-[10px] bg-slate-800 hover:bg-slate-700 text-white px-2.5 py-1.5 rounded-md font-bold transition-all border border-slate-700 active:scale-95"> </button></div> <!> <div class="space-y-2 flex-1 overflow-y-auto max-h-[300px] custom-scrollbar pr-1"><div class="space-y-2"><!> <!></div></div> <div class="pt-4 border-t border-slate-800 space-y-3"><!></div></div> <div class="hidden lg:flex flex-col h-[400px] bg-slate-900 border border-slate-800 rounded-xl p-4"><div class="flex items-center gap-2 mb-3 bg-slate-950 p-1 rounded-lg border border-slate-800"><button><!> </button> <button><!> </button></div> <div class="flex-1 overflow-y-auto pr-1 custom-scrollbar space-y-2"><!></div></div></div> <div class="lg:col-span-2 space-y-4" role="region" aria-label="Combat Zone"><div class="bg-slate-900 border border-slate-800 rounded-xl p-4 flex justify-between items-center shadow-lg sticky top-0 z-20"><div class="flex items-center gap-4"><!></div></div> <div class="space-y-3 pb-20"><!> <!></div></div> <div class="hidden lg:flex flex-col gap-4"></div></div> <!> <!> <!> <button class="lg:hidden fixed bottom-24 right-4 bg-slate-800 text-white p-3 rounded-full shadow-lg border border-slate-700 z-40 active:scale-90 transition-transform" aria-label="Add Enemy"><!></button> <!> <!>',1);function ii(V,o){ua(o,!0);const n=()=>Ft(ys,"$liveCharacters",Z),ue=()=>Ft(Fa,"$liveEnemies",Z),J=()=>Ft(es,"$liveEncounters",Z),x=()=>Ft(ta,"$t",Z),G=()=>Ft(ya,"$isHistoryOpen",Z),[Z,i]=pa();let g=bt(!1),se=bt(!1),Pe=bt(!1),ze=bt(!1);const We={active:!1,round:1};let Ee=bt("enemies"),Me=bt(!1),_e=bt(ca([])),De=bt(ca({isOpen:!1,title:"",message:"",onConfirm:()=>{}}));Ga(()=>{if(o.campaign?.id){xs(o.campaign.id,!0);const l=Ta(ta)("common.labels.master");Qa.update(_=>({..._,campaignId:o.campaign.id,name:o.campaign.gmName||l}));const c=setInterval(()=>{const _=Vt.get(o.campaign.id)||o.campaign,h=Ta(ta)("common.labels.master");Ua(o.campaign.id,{name:_.name,gmName:_.gmName||h})},3e4);return()=>{clearInterval(c),ms(),Qa.update(_=>({..._,campaignId:null}))}}});const ye=ke(()=>typeof window<"u"?`${window.location.origin}${ss("/campaigns/[id]/invite",{id:o.campaign?.id})}`:"");function Mt(){a(ye)&&(navigator.clipboard.writeText(a(ye)),y(Pe,!0),setTimeout(()=>{y(Pe,!1)},2e3))}let yt=ke(()=>o.campaign?.sessionRoster||[]),Ut=ke(()=>o.campaign?.combat||We),$e=ke(()=>o.campaign?.activeEnemies||[]),Re=ke(()=>o.campaign?.members||[]),Qe=ke(()=>o.campaign?.initiativeStyle||"dle"),tt=ke(()=>Array.from(new Set([...a(yt),...a(Re).map(c=>c.id)])).map(c=>{const _=n().find(Y=>Y.id===c),h=a(Re).find(Y=>Y.id===c);return _&&h?{..._,...h,lastUpdate:h.lastUpdate}:_||h}).filter(Boolean)),me=ke(()=>a(tt).filter(l=>!l.campaignApproval||l.campaignApproval==="approved")),Ne=ke(()=>a(tt).filter(l=>l.campaignApproval==="pending")),ct=ke(()=>n().filter(l=>!a(yt).includes(l.id)&&!a(Re).some(c=>c.id===l.id)&&(l.system||wa)===(o.campaign?.system||wa))),F=ke(()=>ue().filter(l=>{const c=(l.system||wa)===(o.campaign?.system||wa),_=l.campaignId===o.campaign?.id||l.global;return c&&_})),te=ke(()=>J().filter(l=>(l.system||wa)===(o.campaign?.system||wa)&&!0));function T(l){if(!o.campaign?.id)return;const _={...Vt.get(o.campaign.id)||o.campaign,...l};Vt.set(o.campaign.id,_),l.combat&&Ea(o.campaign.id,l.combat),(l.name||l.gmName)&&Ua(o.campaign.id,{name:_.name,gmName:_.gmName})}function Be(l){if(a(yt).includes(l)){const c=a(yt).filter(_=>_!==l);T({sessionRoster:c})}else{const c=[...a(yt),l];T({sessionRoster:c})}}function Ve(l){Ce(l,{campaignApproval:"approved"}),Ma({id:l,campaignApproval:"approved"})}function it(l){Ma({id:l,campaignApproval:"rejected",campaignId:null});const _=((Vt.get(o.campaign.id)||o.campaign).members||[]).filter(h=>h.id!==l);T({members:_})}function wt(l){const c=a(tt).find(_=>_.id===l);y(De,{isOpen:!0,title:x()("session.players.remove_title"),message:x()("session.players.remove_message",{values:{name:c?.name||"este personagem"}}),onConfirm:()=>{const _=Vt.get(o.campaign.id)||o.campaign;Ma({id:l,campaignId:null});const h=(_.sessionRoster||[]).filter($=>$!==l),Y=(_.members||[]).filter($=>$.id!==l),w=(_.activeEnemies||[]).filter($=>$.type!=="player"||$.id!==l);T({sessionRoster:h,members:Y,activeEnemies:w}),a(De).isOpen=!1}},!0)}function at(l){const _=(Vt.get(o.campaign.id)||o.campaign).activeEnemies||[],h={...l,instanceId:Oa(),damage:0,currentHealth:l.health,afflictions:[],acted:!1,initiative:!1};T({activeEnemies:[..._,h]})}function Rt(l){const _=(Vt.get(o.campaign.id)||o.campaign).activeEnemies||[];let h=[];l.enemies.forEach(Y=>{const w=ue().find($=>$.id===Y.enemyId);if(w)for(let $=0;$<Y.count;$++)h.push({...w,instanceId:Oa(),damage:0,currentHealth:w.health,afflictions:[],acted:!1,initiative:!1})}),T({activeEnemies:[..._,...h]})}function mt(){T({combat:{active:!0,round:1}}),Ea(o.campaign.id,{active:!0,round:1})}function re(){const l=a($e).filter(c=>c.damage<(c.currentHealth??c.health)&&c.endOfRound&&c.endOfRound.length>0).map(c=>({name:c.name,effects:c.endOfRound}));if(l.length>0){y(_e,l,!0),y(Me,!0);return}be()}function be(){const l=Vt.get(o.campaign.id)||o.campaign,c=(l.combat?.round||1)+1,_=(l.activeEnemies||[]).map(h=>({...h,acted:!1}));T({combat:{...l.combat,round:c},activeEnemies:_}),Ea(o.campaign.id,{active:!0,round:c}),y(Me,!1)}function Ze(l){T({combat:{active:!1,round:1}}),Ea(o.campaign.id,{active:!1,round:1})}function Ue(l){const c=Vt.get(o.campaign.id)||o.campaign;T({activeEnemies:(c.activeEnemies||[]).filter(_=>_.instanceId!==l)})}function vt(l,c){const _=Vt.get(o.campaign.id)||o.campaign;T({activeEnemies:(_.activeEnemies||[]).map(h=>h.instanceId===l?{...h,...c}:h)})}function st(){const l=Vt.get(o.campaign.id)||o.campaign,c=l.combat?.round||1;c>1&&T({combat:{...l.combat,round:c-1}})}let ie=bt(ca(Date.now()));Ga(()=>{const l=setInterval(()=>{y(ie,Date.now(),!0)},1e4);return()=>clearInterval(l)});let Le=ke(()=>(()=>{const l=a(me).filter(c=>a(yt).includes(c.id));return zr(a(Qe),l,a($e))})());function E(l){return l.lastUpdate?a(ie)-l.lastUpdate<6e4:!1}function Ce(l,c){const _=Vt.get(o.campaign.id)||o.campaign,h=_.members||[],Y=h.findIndex(j=>j.id===l);let w=h;Y!==-1&&(w=[...h],w[Y]={...w[Y],...c});const $=_.activeEnemies||[],Q=$.findIndex(j=>j.id===l&&j.type==="player");let K=$;Q!==-1&&(K=[...$],K[Q]={...K[Q],...c}),T({members:w,activeEnemies:K})}function fe(l,c,_){l.dataTransfer&&(l.dataTransfer.setData("application/json",JSON.stringify({item:c,type:_})),l.dataTransfer.effectAllowed="copy")}function He(l){return l.preventDefault(),!1}function Ie(l){l.preventDefault();const c=l.dataTransfer?.getData("application/json");if(c)try{const{item:_,type:h}=JSON.parse(c);h==="enemy"?at(_):h==="encounter"&&Rt(_)}catch(_){console.error("Drop error",_)}}var ut=ri(),Xe=qe(ut),Ye=t(Xe),kt=t(Ye),jt=t(kt),Dt=t(jt),Tt=t(Dt);ts(Tt,{size:14,class:"text-indigo-500"});var k=s(Tt),R=s(k);{var H=l=>{var c=$r(),_=t(c,!0);e(c),p(()=>r(_,a(me).length)),d(l,c)};f(R,l=>{a(me).length>0&&l(H)})}e(Dt);var Oe=s(Dt,2);Oe.__click=()=>y(g,!a(g));var nt=t(Oe,!0);e(Oe),e(jt);var Fe=s(jt,2);{var rt=l=>{var c=Or(),_=t(c),h=s(t(_),2),Y=t(h);e(h),e(_);var w=s(_,2);Ge(w,17,()=>a(Ne),$=>$.id,($,Q)=>{var K=Cr(),j=t(K),le=t(j),he=t(le,!0);e(le);var q=s(le,2),S=t(q,!0);e(q),e(j);var M=s(j,2),O=t(M);O.__click=()=>Ve(a(Q).id);var ee=t(O);Za(ee,{size:14}),e(O);var z=s(O,2);z.__click=()=>it(a(Q).id);var A=t(z);aa(A,{size:14}),e(z),e(M),e(K),p(B=>{r(he,a(Q).name),r(S,B)},[()=>x()("session.players.new_request")]),d($,K)}),va(2),e(c),p($=>r(Y,`${$??""} (${a(Ne).length??""})`),[()=>x()("session.players.waiting_approval")]),d(l,c)};f(Fe,l=>{a(Ne).length>0&&l(rt)})}var ft=s(Fe,2),Et=t(ft),Ae=t(Et);Ge(Ae,17,()=>a(me),l=>l.id,(l,c)=>{const _=ke(()=>E(a(c))),h=ke(()=>a(yt).includes(a(c).id));var Y=Er(),w=t(Y),$=s(w,2),Q=t($),K=t(Q,!0);e(Q);var j=s(Q,2),le=t(j);{var he=I=>{var ae=jr(),ce=t(ae,!0);e(ae),p(Je=>r(ce,Je),[()=>x()("common.labels.session")]),d(I,ae)};f(le,I=>{a(h)&&I(he)})}var q=s(le);e(j),e($);var S=s($,2),M=t(S);M.__click=()=>Be(a(c).id);var O=t(M);{var ee=I=>{js(I,{size:14})},z=I=>{ea(I,{size:14})};f(O,I=>{a(h)?I(ee):I(z,!1)})}e(M);var A=s(M,2);A.__click=()=>wt(a(c).id);var B=t(A);aa(B,{size:14}),e(A),e(S),e(Y),p((I,ae,ce)=>{et(Y,1,`p-2.5 rounded-xl border flex items-center gap-3 transition-all ${a(_)?"bg-indigo-900/10 border-indigo-500/20":"bg-slate-900/50 border-slate-800"} ${a(_)||a(h)?"opacity-100":"opacity-40"} hover:border-indigo-500/40 group shadow-sm`),et(w,1,`w-2 h-2 rounded-full ${a(_)?"bg-green-500 shadow-[0_0_8px_rgba(74,222,128,0.4)]":"bg-slate-700"}`),et(Q,1,`font-bold text-sm ${a(_)?"text-white":"text-slate-500"} group-hover:text-indigo-300 transition-colors`),r(K,a(c).name),r(q,` ${I??""} ${a(c).level??""} • ${a(c).ancestry??""}`),et(M,1,`p-1.5 rounded-lg transition-all ${a(h)?"text-amber-400 hover:bg-amber-400/10":"text-slate-500 hover:text-indigo-400 hover:bg-indigo-400/10"}`),xe(M,"title",ae),xe(A,"title",ce)},[()=>x()("common.labels.level"),()=>a(h)?x()("session.players.remove_from_session"):x()("session.players.add_to_session"),()=>x()("session.players.kick_from_campaign")]),d(l,Y)});var ht=s(Ae,2);{var P=l=>{var c=Mr(),_=t(c,!0);e(c),p(h=>r(_,h),[()=>x()("session.players.none")]),d(l,c)};f(ht,l=>{a(me).length===0&&l(P)})}e(Et),e(ft);var C=s(ft,2),U=t(C);{var ne=l=>{var c=Ir(),_=qe(c);_.__click=()=>T({isPublished:!0});var h=t(_);da(h,{size:14});var Y=s(h);e(_);var w=s(_,2),$=t(w,!0);e(w),p((Q,K)=>{r(Y,` ${Q??""}`),r($,K)},[()=>x()("session.publish.publish_session"),()=>x()("session.publish.make_visible")]),d(l,c)},N=l=>{var c=Nr(),_=qe(c),h=t(_),Y=t(h),w=t(Y);as(w,{size:10,class:"animate-pulse"});var $=s(w);e(Y),e(h);var Q=s(h,2);Q.__click=()=>y(ze,!a(ze));var K=t(Q);Gs(K,{size:14}),e(Q),e(_);var j=s(_,2);{var le=ae=>{var ce=Sr(),Je=t(ce);e(ce),p((Pt,gt)=>{xe(Je,"src",Pt),xe(Je,"alt",gt)},[()=>`https://api.qrserver.com/v1/create-qr-code/?size=100x100&data=${encodeURIComponent(a(ye))}`,()=>x()("session.publish.qr_alt")]),d(ae,ce)};f(j,ae=>{a(ze)&&ae(le)})}var he=s(j,2),q=t(he),S=t(q);S.__click=Mt;var M=t(S,!0);e(S);var O=s(S,2);O.__click=Mt;var ee=t(O);{var z=ae=>{var ce=Rr(),Je=t(ce);Za(Je,{size:10,class:"inline mr-1"});var Pt=s(Je);e(ce),p(gt=>r(Pt,` ${gt??""}`),[()=>x()("common.buttons.copied")]),d(ae,ce)};f(ee,ae=>{a(Pe)&&ae(z)})}var A=s(ee,2);qs(A,{size:14}),e(O),e(q),e(he);var B=s(he,2);B.__click=()=>T({isPublished:!1});var I=t(B,!0);e(B),p((ae,ce,Je,Pt)=>{r($,` ${ae??""}`),xe(Q,"title",ce),r(M,a(ye)),xe(O,"aria-label",Je),r(I,Pt)},[()=>x()("session.publish.public_session"),()=>x()("session.publish.qr_code"),()=>x()("session.publish.copy_link"),()=>x()("session.publish.remove_public")]),d(l,c)};f(U,l=>{o.campaign?.isPublished?l(N,!1):l(ne)})}e(C),e(kt);var W=s(kt,2),X=t(W),je=t(X);je.__click=()=>y(Ee,"enemies");var de=t(je);ga(de,{size:14});var oe=s(de);e(je);var L=s(je,2);L.__click=()=>y(Ee,"encounters");var ge=t(L);La(ge,{size:14});var pe=s(ge);e(L),e(X);var Se=s(X,2),ot=t(Se);{var lt=l=>{var c=Tr(),_=qe(c);Ge(_,17,()=>a(F),w=>w.id,(w,$)=>{var Q=Dr(),K=t(Q),j=t(K);Js(j,{size:12,class:"text-slate-600 cursor-grab"});var le=s(j,2),he=t(le),q=t(he),S=s(q);{var M=B=>{da(B,{size:10,class:"text-indigo-400"})};f(S,B=>{a($).global&&B(M)})}e(he);var O=s(he,2),ee=t(O);e(O),e(le),e(K);var z=s(K,2);z.__click=()=>at(a($));var A=t(z);ea(A,{size:16}),e(z),e(Q),p(B=>{r(q,`${a($).name??""} `),r(ee,`${B??""} ${a($).difficulty??""}`)},[()=>x()("session.enemies.difficulty")]),ha("dragstart",Q,B=>fe(B,a($),"enemy")),d(w,Q)});var h=s(_,2);{var Y=w=>{var $=Ar(),Q=t($,!0);e($),p(K=>r(Q,K),[()=>x()("session.enemies.none")]),d(w,$)};f(h,w=>{a(F).length===0&&w(Y)})}d(l,c)},_t=l=>{var c=Hr(),_=qe(c);Ge(_,17,()=>a(te),w=>w.id,(w,$)=>{var Q=Pr(),K=t(Q),j=t(K),le=t(j),he=s(le);{var q=z=>{da(z,{size:10,class:"text-indigo-400"})};f(he,z=>{a($).global&&z(q)})}e(j);var S=s(j,2),M=t(S);e(S),e(K);var O=s(K,2);O.__click=()=>Rt(a($));var ee=t(O);Ha(ee,{size:14}),e(O),e(Q),p((z,A)=>{r(le,`${a($).name??""} `),r(M,`${z??""} ${A??""}`)},[()=>a($).enemies?.reduce((z,A)=>z+A.count,0)||0,()=>x()("session.enemies.title")]),ha("dragstart",Q,z=>fe(z,a($),"encounter")),d(w,Q)});var h=s(_,2);{var Y=w=>{var $=Ur(),Q=t($,!0);e($),p(K=>r(Q,K),[()=>x()("session.enemies.no_encounters")]),d(w,$)};f(h,w=>{a(te).length===0&&w(Y)})}d(l,c)};f(ot,l=>{a(Ee)==="enemies"?l(lt):l(_t,!1)})}e(Se),e(W),e(Ye);var zt=s(Ye,2),It=t(zt),qt=t(It),At=t(qt);{var v=l=>{var c=Lr();c.__click=mt;var _=t(c);us(_,{size:20});var h=s(_);e(c),p(Y=>r(h,` ${Y??""}`),[()=>x()("session.combat.start")]),d(l,c)},b=l=>{var c=Fr(),_=t(c);_.__click=st;var h=t(_);Na(h,{size:20}),e(_);var Y=s(_,2),w=t(Y),$=t(w,!0);e(w);var Q=s(w),K=t(Q,!0);e(Q),e(Y);var j=s(Y,2);j.__click=re;var le=t(j);Es(le,{size:16});var he=s(le);e(j);var q=s(j,4);q.__click=()=>Ze();var S=t(q,!0);e(q),e(c),p((M,O,ee,z,A)=>{xe(_,"title",M),r($,O),r(K,a(Ut).round),xe(j,"title",ee),r(he,` ${z??""}`),r(S,A)},[()=>x()("session.combat.previous"),()=>x()("session.combat.round"),()=>x()("session.combat.next"),()=>x()("session.combat.next"),()=>x()("session.combat.end")]),d(l,c)};f(At,l=>{a(Ut).active?l(b,!1):l(v)})}e(qt),e(It);var m=s(It,2),D=t(m);Ge(D,25,()=>a(Le),l=>l.type==="player"?l.id:l.instanceId,(l,c)=>{var _=qr(),h=t(_);hr(h,{get entity(){return a(c)},updateEnemy:vt,removeFromCombat:Ue,updatePlayer:Ce}),e(_),ks(_,()=>yr,()=>({duration:300})),d(l,_)});var ve=s(D,2);{var we=l=>{var c=Br(),_=t(c,!0);e(c),p(h=>r(_,h),[()=>x()("session.combat.empty")]),d(l,c)};f(ve,l=>{a(Le).length===0&&l(we)})}e(m),e(zt),va(2),e(Xe);var Te=s(Xe,2);{var pt=l=>{var c=Wr();c.__click=z=>{z.target===z.currentTarget&&y(Me,!1)};var _=t(c),h=t(_),Y=t(h),w=t(Y);Ms(w,{size:24}),e(Y);var $=s(Y,2),Q=t($),K=t(Q,!0);e(Q);var j=s(Q,2),le=t(j,!0);e(j),e($),e(h);var he=s(h,2);Ge(he,21,()=>a(_e),Ct,(z,A)=>{var B=Gr(),I=t(B),ae=t(I);ga(ae,{size:14,class:"text-slate-500"});var ce=s(ae);e(I);var Je=s(I,2);Ge(Je,21,()=>a(A).effects,Ct,(Pt,gt)=>{var Ot=Jr(),Bt=t(Ot),Jt=t(Bt);e(Bt);var Xt=s(Bt,2),oa=t(Xt,!0);e(Xt),e(Ot),p(()=>{r(Jt,`${a(gt).name??""}:`),r(oa,a(gt).desc)}),d(Pt,Ot)}),e(Je),e(B),p(()=>r(ce,` ${a(A).name??""}`)),d(z,B)}),e(he);var q=s(he,2),S=t(q);S.__click=()=>y(Me,!1);var M=t(S,!0);e(S);var O=s(S,2);O.__click=be;var ee=t(O,!0);e(O),e(q),e(_),e(c),p((z,A,B,I)=>{r(K,z),r(le,A),r(M,B),r(ee,I)},[()=>x()("session.end_of_round.title"),()=>x()("session.end_of_round.summary"),()=>x()("common.buttons.cancel"),()=>x()("session.end_of_round.advance")]),d(l,c)};f(Te,l=>{a(Me)&&l(pt)})}var xt=s(Te,2);{var Nt=l=>{var c=Zr();c.__click=O=>{O.target===O.currentTarget&&y(g,!1)};var _=t(c),h=t(_),Y=t(h),w=t(Y),$=t(w,!0);e(w);var Q=s(w,2),K=t(Q,!0);e(Q),e(Y);var j=s(Y,2);j.__click=()=>y(g,!1);var le=t(j);ma(le,{size:16}),e(j),e(h);var he=s(h,2),q=t(he);Ge(q,17,()=>a(ct),Ct,(O,ee)=>{var z=Qr();z.__click=()=>Be(a(ee).id);var A=t(z),B=t(A,!0);e(A);var I=s(A,2),ae=t(I),ce=t(ae,!0);e(ae);var Je=s(ae,2),Pt=t(Je);e(Je),e(I);var gt=s(I,2),Ot=t(gt);ea(Ot,{size:16}),e(gt),e(z),p((Bt,Jt)=>{r(B,Bt),r(ce,a(ee).name),r(Pt,`${Jt??""} ${a(ee).level??""} • ${a(ee).ancestry??""}`)},[()=>a(ee).name.charAt(0),()=>x()("common.labels.level")]),d(O,z)});var S=s(q,2);{var M=O=>{var ee=Vr(),z=t(ee),A=t(z);ga(A,{size:24}),e(z);var B=s(z,2),I=t(B,!0);e(B);var ae=s(B,2),ce=t(ae,!0);e(ae),e(ee),p((Je,Pt)=>{r(I,Je),r(ce,Pt)},[()=>x()("session.manage_session.no_available"),()=>x()("session.manage_session.all_in_session")]),d(O,ee)};f(S,O=>{a(ct).length===0&&O(M)})}e(he),e(_),e(c),p((O,ee)=>{r($,O),r(K,ee)},[()=>x()("session.manage_session.title"),()=>x()("session.manage_session.description")]),d(l,c)};f(xt,l=>{a(g)&&l(Nt)})}var $t=s(xt,2);{var Ht=l=>{var c=si();c.__click=I=>{I.target===I.currentTarget&&y(se,!1)};var _=t(c),h=t(_),Y=t(h),w=t(Y);ga(w,{size:16});var $=s(w);e(Y);var Q=s(Y,2);Q.__click=()=>y(se,!1);var K=t(Q);ma(K,{size:18}),e(Q),e(h);var j=s(h,2),le=t(j);le.__click=()=>y(Ee,"enemies");var he=t(le);ga(he,{size:14});var q=s(he);e(le);var S=s(le,2);S.__click=()=>y(Ee,"encounters");var M=t(S);La(M,{size:14});var O=s(M);e(S),e(j);var ee=s(j,2),z=t(ee);{var A=I=>{var ae=Kr(),ce=qe(ae);Ge(ce,17,()=>a(F),gt=>gt.id,(gt,Ot)=>{var Bt=Xr(),Jt=t(Bt),Xt=t(Jt),oa=t(Xt),Zt=s(oa);{var za=Kt=>{da(Kt,{size:10,class:"text-indigo-400"})};f(Zt,Kt=>{a(Ot).global&&Kt(za)})}e(Xt);var fa=s(Xt,2),$a=t(fa);e(fa),e(Jt);var la=s(Jt,2);la.__click=()=>{at(a(Ot)),y(se,!1)};var Ca=t(la);ea(Ca,{size:16}),e(la),e(Bt),p(Kt=>{r(oa,`${a(Ot).name??""} `),r($a,`${Kt??""} ${a(Ot).difficulty??""}`)},[()=>x()("session.enemies.difficulty")]),d(gt,Bt)});var Je=s(ce,2);{var Pt=gt=>{var Ot=Yr(),Bt=t(Ot,!0);e(Ot),p(Jt=>r(Bt,Jt),[()=>x()("session.enemies.none")]),d(gt,Ot)};f(Je,gt=>{a(F).length===0&&gt(Pt)})}d(I,ae)},B=I=>{var ae=ai(),ce=qe(ae);Ge(ce,17,()=>a(te),gt=>gt.id,(gt,Ot)=>{var Bt=ei(),Jt=t(Bt),Xt=t(Jt),oa=t(Xt),Zt=s(oa);{var za=Kt=>{da(Kt,{size:10,class:"text-indigo-400"})};f(Zt,Kt=>{a(Ot).global&&Kt(za)})}e(Xt);var fa=s(Xt,2),$a=t(fa);e(fa),e(Jt);var la=s(Jt,2);la.__click=()=>{Rt(a(Ot)),y(se,!1)};var Ca=t(la);Ha(Ca,{size:16}),e(la),e(Bt),p((Kt,Da)=>{r(oa,`${a(Ot).name??""} `),r($a,`${Kt??""} ${Da??""}`)},[()=>a(Ot).enemies?.reduce((Kt,Da)=>Kt+Da.count,0)||0,()=>x()("session.enemies.title")]),d(gt,Bt)});var Je=s(ce,2);{var Pt=gt=>{var Ot=ti(),Bt=t(Ot,!0);e(Ot),p(Jt=>r(Bt,Jt),[()=>x()("session.enemies.no_encounters")]),d(gt,Ot)};f(Je,gt=>{a(te).length===0&&gt(Pt)})}d(I,ae)};f(z,I=>{a(Ee)==="enemies"?I(A):I(B,!1)})}e(ee),e(_),e(c),p((I,ae,ce)=>{r($,` ${I??""}`),et(le,1,`flex-1 text-xs font-bold py-2 rounded flex items-center justify-center gap-2 transition-colors ${a(Ee)==="enemies"?"bg-indigo-600 text-white":"text-slate-500 hover:text-white"}`),r(q,` ${ae??""}`),et(S,1,`flex-1 text-xs font-bold py-2 rounded flex items-center justify-center gap-2 transition-colors ${a(Ee)==="encounters"?"bg-indigo-600 text-white":"text-slate-500 hover:text-white"}`),r(O,` ${ce??""}`)},[()=>x()("session.enemies.title"),()=>x()("session.enemies.title"),()=>x()("session.enemies.encounters")]),d(l,c)};f($t,l=>{a(se)&&l(Ht)})}var Lt=s($t,2);Lt.__click=()=>y(se,!0);var Wt=t(Lt);ga(Wt,{size:24}),e(Lt);var Gt=s(Lt,2);rs(Gt,{get isOpen(){return G()},onClose:()=>ya.set(!1)});var Qt=s(Gt,2);Ka(Qt,{get isOpen(){return a(De).isOpen},get title(){return a(De).title},get message(){return a(De).message},get onConfirm(){return a(De).onConfirm},onCancel:()=>a(De).isOpen=!1}),p((l,c,_,h)=>{r(k,` ${l??""} `),r(nt,c),et(je,1,`flex-1 text-xs font-bold py-1.5 rounded flex items-center justify-center gap-2 transition-colors ${a(Ee)==="enemies"?"bg-indigo-600 text-white":"text-slate-500 hover:text-white"}`),r(oe,` ${_??""}`),et(L,1,`flex-1 text-xs font-bold py-1.5 rounded flex items-center justify-center gap-2 transition-colors ${a(Ee)==="encounters"?"bg-indigo-600 text-white":"text-slate-500 hover:text-white"}`),r(pe,` ${h??""}`)},[()=>x()("session.players.title"),()=>a(g)?x()("session.players.close"):x()("session.players.add"),()=>x()("session.enemies.title"),()=>x()("session.enemies.encounters")]),ha("dragover",zt,He),ha("drop",zt,Ie),d(V,ut),ba(),i()}_a(["click"]);var ni=u('<div class="w-16 h-16 rounded-lg overflow-hidden border border-slate-700 shadow-lg flex-shrink-0"><!></div>'),oi=u('<div class="text-xs text-slate-500 italic mt-2 leading-relaxed opacity-75"> </div>'),li=u('<span class="text-slate-400"> </span>'),di=u('<span class="text-slate-400"> </span>'),vi=u('<div class="text-sm mb-4"><span class="text-slate-500 font-bold"> </span> <span class="text-white ml-1"> </span></div>'),ci=u('<div class="mb-3 text-sm"><span class="font-bold text-indigo-400"> </span> <span class="text-slate-300 ml-1"> </span></div>'),ui=u('<span class="text-slate-300"> </span>'),bi=u('<div class="mb-2 text-sm"><span class="font-bold text-white"> </span> <span class="text-slate-400"> </span> <span class="text-white ml-1"> </span> <!></div>'),_i=u('<div class="mt-4"><h4 class="text-red-500 font-bold text-xs uppercase mb-2 tracking-wider"> </h4> <!></div>'),pi=u('<div class="mb-2 text-sm"><span class="font-bold text-white"> </span> <span class="text-slate-300 ml-1"> </span></div>'),xi=u('<div class="mt-4"><h4 class="text-orange-500 font-bold text-xs uppercase mb-2 tracking-wider"> </h4> <!></div>'),mi=u('<div class="mb-2 text-sm"><span class="font-bold text-white"> </span> <span class="text-slate-300 ml-1"> </span></div>'),fi=u('<div class="mt-4"><h4 class="text-yellow-500 font-bold text-xs uppercase mb-2 tracking-wider"> </h4> <!></div>'),gi=u('<div class="w-full max-w-md bg-slate-900 border border-slate-700 rounded-xl p-5 shadow-2xl"><div class="flex items-start gap-3 mb-4"><!> <div class="flex-1 min-w-0"><div class="flex items-baseline gap-2"><h2 class="text-xl font-bold text-white font-serif tracking-wide"> </h2> <span class="text-red-500 font-bold text-sm"> </span></div> <div class="text-sm text-slate-400 mt-1"> </div> <!></div></div> <div class="text-sm mb-3"><span class="text-slate-500 font-bold"> </span> <span class="text-white ml-1"> </span> <!></div> <div class="text-sm mb-3"><span class="text-slate-500 font-bold"> </span> <span class="text-white ml-1"> </span> <span class="text-slate-500 font-bold ml-3"> </span> <span class="text-white ml-1"> </span></div> <div class="text-sm mb-3"><span class="text-white"><span class="text-slate-500 font-bold"> </span> <span class="text-slate-500 font-bold"> </span> <span class="text-slate-500 font-bold"> </span> <span class="text-slate-500 font-bold"> </span> </span></div> <div class="text-sm mb-3"><span class="text-slate-500 font-bold"> </span> <span class="text-white ml-1"> </span> <!></div> <!> <div class="border-t border-slate-700 my-4"></div> <!> <!> <!> <!></div>'),hi=u('<div class="space-y-4 animate-in fade-in slide-in-from-bottom-2 duration-300"><div class="flex items-center gap-4"><div class="relative group cursor-pointer"><div class="w-16 h-16 rounded-xl overflow-hidden border border-slate-700"><!></div> <div class="absolute inset-0 bg-black/50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity rounded-xl"><!></div></div> <div class="flex-1"><label for="enemy-name" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-name" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white font-bold text-lg"/></div></div> <div><label for="enemy-desc-text" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <textarea id="enemy-desc-text" class="w-full bg-slate-900 border border-slate-700 rounded p-3 text-white text-sm min-h-[100px] resize-none focus:border-indigo-500 focus:outline-none transition-colors"></textarea></div> <div><label for="enemy-desc" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-desc" type="text" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white text-sm"/></div> <div class="flex items-center gap-2 mt-4"><input id="enemy-global" type="checkbox" class="w-4 h-4 bg-slate-900 border-slate-700 rounded focus:ring-indigo-500"/> <label for="enemy-global" class="text-sm font-bold text-slate-400 select-none cursor-pointer flex items-center gap-2"><!> </label></div></div>'),yi=u('<div class="bg-slate-900 p-3 rounded border border-slate-700 text-center"><label class="text-[10px] text-slate-500 uppercase font-bold block mb-1 text-ellipsis overflow-hidden whitespace-nowrap"> </label> <input type="number" class="w-full bg-transparent text-center font-bold text-white text-xl focus:outline-none mb-1"/> <div> </div></div>'),wi=u('<div class="space-y-6 animate-in fade-in slide-in-from-bottom-2 duration-300"><div class="grid grid-cols-2 gap-4"><div><label for="enemy-diff" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-diff" type="number" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div> <div><label for="enemy-size" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-size" type="text" placeholder="1/2, 1, 2..." class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div></div> <div class="grid grid-cols-2 gap-4"><div><label for="enemy-speed" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-speed" type="number" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div> <div><label for="enemy-health" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-health" type="number" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div></div> <div class="grid grid-cols-2 gap-4"><div><label for="enemy-defense" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-defense" type="number" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div> <div><label for="enemy-perception" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-perception" type="number" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div></div> <div><h4 class="text-indigo-400 font-bold text-sm uppercase mb-3 border-b border-indigo-500/20 pb-2"> </h4> <div class="grid grid-cols-4 gap-3"></div></div> <div class="space-y-3 pt-4 border-t border-slate-800"><div><label for="enemy-speed-notes" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-speed-notes" type="text" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white text-sm"/></div> <div><label for="enemy-senses" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-senses" type="text" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white text-sm"/></div> <div><label for="enemy-immune" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <textarea id="enemy-immune" class="w-full bg-slate-900 border border-slate-700 rounded p-3 text-white text-sm min-h-[80px] resize-none focus:border-indigo-500 focus:outline-none transition-colors"></textarea></div></div></div>'),ki=u('<div class="flex gap-2 items-start"><div class="flex-1 space-y-1"><input class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm font-bold placeholder-slate-600"/> <textarea class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm placeholder-slate-600 resize-none" rows="2"></textarea></div> <button class="mt-1 text-slate-600 hover:text-red-400 p-2 hover:bg-slate-800 rounded"><!></button></div>'),zi=u('<div class="flex gap-2 items-start"><div class="flex-1 space-y-2"><div class="grid grid-cols-2 gap-2"><input class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm font-bold placeholder-slate-600"/> <select class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm"><option> </option><option> </option></select></div> <div class="grid grid-cols-2 gap-2"><input class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm placeholder-slate-600"/> <input class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm placeholder-slate-600"/></div> <textarea class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm placeholder-slate-600 resize-none" rows="2"></textarea></div> <button class="mt-1 text-slate-600 hover:text-red-400 p-2 hover:bg-slate-800 rounded"><!></button></div>'),$i=u('<div class="flex gap-2 items-start"><div class="flex-1 space-y-1"><input class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm font-bold placeholder-slate-600"/> <textarea class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm placeholder-slate-600 resize-none" rows="2"></textarea></div> <button class="mt-1 text-slate-600 hover:text-red-400 p-2 hover:bg-slate-800 rounded"><!></button></div>'),Ci=u('<div class="flex gap-2 items-start"><div class="flex-1 space-y-1"><input class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm font-bold placeholder-slate-600"/> <textarea class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm placeholder-slate-600 resize-none" rows="2"></textarea></div> <button class="mt-1 text-slate-600 hover:text-red-400 p-2 hover:bg-slate-800 rounded"><!></button></div>'),Oi=u('<div class="space-y-6 animate-in fade-in slide-in-from-bottom-2 duration-300"><div class="p-4 bg-slate-900 rounded border border-indigo-500/30"><div class="mb-3"><h4 class="font-bold text-sm uppercase text-indigo-400"> </h4></div> <div class="space-y-3"><!> <button class="w-full py-3 border-2 border-dashed border-slate-700 rounded hover:border-slate-500 hover:bg-slate-800 transition-colors flex items-center justify-center gap-2 text-slate-500 hover:text-white font-bold text-sm group"><div class="p-1 rounded-full bg-slate-800 group-hover:bg-slate-700 transition-colors"><!></div> </button></div></div> <div class="p-4 bg-slate-900 rounded border border-red-500/30"><div class="mb-3"><h4 class="font-bold text-sm uppercase text-red-400"> </h4></div> <div class="space-y-3"><!> <button class="w-full py-3 border-2 border-dashed border-slate-700 rounded hover:border-slate-500 hover:bg-slate-800 transition-colors flex items-center justify-center gap-2 text-slate-500 hover:text-white font-bold text-sm group"><div class="p-1 rounded-full bg-slate-800 group-hover:bg-slate-700 transition-colors"><!></div> </button></div></div> <div class="p-4 bg-slate-900 rounded border border-orange-500/30"><div class="mb-3"><h4 class="font-bold text-sm uppercase text-orange-400"> </h4></div> <div class="space-y-3"><!> <button class="w-full py-3 border-2 border-dashed border-slate-700 rounded hover:border-slate-500 hover:bg-slate-800 transition-colors flex items-center justify-center gap-2 text-slate-500 hover:text-white font-bold text-sm group"><div class="p-1 rounded-full bg-slate-800 group-hover:bg-slate-700 transition-colors"><!></div> </button></div></div> <div class="p-4 bg-slate-900 rounded border border-yellow-500/30"><div class="mb-3"><h4 class="font-bold text-sm uppercase text-yellow-400"> </h4></div> <div class="space-y-3"><!> <button class="w-full py-3 border-2 border-dashed border-slate-700 rounded hover:border-slate-500 hover:bg-slate-800 transition-colors flex items-center justify-center gap-2 text-slate-500 hover:text-white font-bold text-sm group"><div class="p-1 rounded-full bg-slate-800 group-hover:bg-slate-700 transition-colors"><!></div> </button></div></div></div>'),ji=u('<div class="flex-1 flex items-start justify-center p-4 min-h-0 animate-in fade-in slide-in-from-right-2 duration-300"><!></div>'),Ei=u('<div class="fixed inset-0 z-[100] flex items-center justify-center bg-black/80 lg:p-4" role="button" aria-label="Close" tabindex="-1"><div class="bg-slate-900 w-full h-full lg:rounded-xl lg:max-w-6xl lg:h-[90vh] border-0 lg:border border-slate-700 shadow-2xl overflow-hidden flex flex-col lg:flex-row" role="dialog" aria-modal="true" aria-labelledby="modal-title"><div class="w-full lg:w-1/2 flex flex-col h-full border-r border-slate-700"><div class="p-4 border-b border-slate-700 bg-slate-900 flex justify-between items-center"><div class="flex items-center gap-3"><button class="lg:hidden text-slate-400 hover:text-white p-1 rounded-full hover:bg-slate-800 transition-colors"><!></button> <h3 id="modal-title" class="font-bold text-white text-lg"> </h3></div> <button class="hidden lg:block text-slate-400 hover:text-white"><!></button></div> <div class="flex border-b border-slate-700 bg-slate-900/50 overflow-x-auto"><button> </button> <button> </button> <button> </button> <button> </button></div> <div class="flex-1 overflow-y-auto p-6 custom-scrollbar bg-slate-800/50"><!></div> <div class="p-4 border-t border-slate-700 bg-slate-900 flex justify-end gap-3 safe-area-bottom"><button class="px-6 py-2 rounded bg-indigo-600 hover:bg-indigo-500 text-white font-bold flex items-center gap-2 transition-colors"><!> </button></div></div> <div class="hidden lg:flex w-1/2 bg-slate-950 flex-col border-l border-slate-800"><div class="p-4 border-b border-slate-800 bg-slate-950"><h3 class="font-bold text-slate-500 text-xs uppercase flex items-center gap-2"><!> </h3></div> <div class="flex-1 p-8 overflow-y-auto flex items-start justify-center bg-[radial-gradient(ellipse_at_top,_var(--tw-gradient-stops))] from-slate-900 via-slate-950 to-slate-950"><!></div></div></div></div> <input type="file" hidden="" accept="image/*"/> <!>',1);function Mi(V,o){ua(o,!0);const n=()=>Ft(ta,"$t",ue),[ue,J]=pa(),x=F=>{var te=gi(),T=t(te),Be=t(T);{var Ve=v=>{var b=ni(),m=t(b);ja(m,{get hash(){return a(i).imageUrl},get alt(){return a(i).name},size:"custom"}),e(b),d(v,b)};f(Be,v=>{a(i).imageUrl&&v(Ve)})}var it=s(Be,2),wt=t(it),at=t(wt),Rt=t(at,!0);e(at);var mt=s(at,2),re=t(mt);e(mt),e(wt);var be=s(wt,2),Ze=t(be);e(be);var Ue=s(be,2);{var vt=v=>{var b=oi(),m=t(b,!0);e(b),p(()=>r(m,a(i).description)),d(v,b)};f(Ue,v=>{a(i).description&&v(vt)})}e(it),e(T);var st=s(T,2),ie=t(st),Le=t(ie,!0);e(ie);var E=s(ie,2),Ce=t(E);e(E);var fe=s(E,2);{var He=v=>{var b=li(),m=t(b);e(b),p(()=>r(m,`; ${a(i).senses??""}`)),d(v,b)};f(fe,v=>{a(i).senses&&v(He)})}e(st);var Ie=s(st,2),ut=t(Ie),Xe=t(ut,!0);e(ut);var Ye=s(ut,2),kt=t(Ye,!0);e(Ye);var jt=s(Ye,2),Dt=t(jt,!0);e(jt);var Tt=s(jt,2),k=t(Tt,!0);e(Tt),e(Ie);var R=s(Ie,2),H=t(R),Oe=t(H),nt=t(Oe,!0);e(Oe);var Fe=s(Oe),rt=s(Fe),ft=t(rt,!0);e(rt);var Et=s(rt),Ae=s(Et),ht=t(Ae,!0);e(Ae);var P=s(Ae),C=s(P),U=t(C,!0);e(C);var ne=s(C);e(H),e(R);var N=s(R,2),W=t(N),X=t(W,!0);e(W);var je=s(W,2),de=t(je,!0);e(je);var oe=s(je,2);{var L=v=>{var b=di(),m=t(b);e(b),p(()=>r(m,`; ${a(i).speedNotes??""}`)),d(v,b)};f(oe,v=>{a(i).speedNotes&&v(L)})}e(N);var ge=s(N,2);{var pe=v=>{var b=vi(),m=t(b),D=t(m,!0);e(m);var ve=s(m,2),we=t(ve,!0);e(ve),e(b),p(Te=>{r(D,Te),r(we,a(i).immunities)},[()=>n()("session.enemy_modal.immunities")]),d(v,b)};f(ge,v=>{a(i).immunities&&v(pe)})}var Se=s(ge,4);{var ot=v=>{var b=St(),m=qe(b);Ge(m,17,()=>a(i).traits,Ct,(D,ve)=>{var we=ci(),Te=t(we),pt=t(Te,!0);e(Te);var xt=s(Te,2),Nt=t(xt,!0);e(xt),e(we),p(()=>{r(pt,a(ve).name),r(Nt,a(ve).desc)}),d(D,we)}),d(v,b)};f(Se,v=>{a(i).traits.length>0&&v(ot)})}var lt=s(Se,2);{var _t=v=>{var b=_i(),m=t(b),D=t(m,!0);e(m);var ve=s(m,2);Ge(ve,17,()=>a(i).attackOptions,Ct,(we,Te)=>{var pt=bi(),xt=t(pt),Nt=t(xt,!0);e(xt);var $t=s(xt,2),Ht=t($t);e($t);var Lt=s($t,2),Wt=t(Lt);e(Lt);var Gt=s(Lt,2);{var Qt=l=>{var c=ui(),_=t(c);e(c),p(()=>r(_,`; ${a(Te).desc??""}`)),d(l,c)};f(Gt,l=>{a(Te).desc&&l(Qt)})}e(pt),p(l=>{r(Nt,a(Te).name),r(Ht,`(${l??""})`),r(Wt,`${a(Te).attackRoll??""} (${a(Te).damage??""})`)},[()=>a(Te).type==="melee"?n()("session.enemy_modal.melee").toLowerCase():n()("session.enemy_modal.ranged").toLowerCase()]),d(we,pt)}),e(b),p(we=>r(D,we),[()=>n()("session.enemy_modal.attack_options")]),d(v,b)};f(lt,v=>{a(i).attackOptions.length>0&&v(_t)})}var zt=s(lt,2);{var It=v=>{var b=xi(),m=t(b),D=t(m,!0);e(m);var ve=s(m,2);Ge(ve,17,()=>a(i).specialAttacks,Ct,(we,Te)=>{var pt=pi(),xt=t(pt),Nt=t(xt,!0);e(xt);var $t=s(xt,2),Ht=t($t,!0);e($t),e(pt),p(()=>{r(Nt,a(Te).name),r(Ht,a(Te).desc)}),d(we,pt)}),e(b),p(we=>r(D,we),[()=>n()("session.enemy_modal.special_attacks")]),d(v,b)};f(zt,v=>{a(i).specialAttacks.length>0&&v(It)})}var qt=s(zt,2);{var At=v=>{var b=fi(),m=t(b),D=t(m,!0);e(m);var ve=s(m,2);Ge(ve,17,()=>a(i).endOfRound,Ct,(we,Te)=>{var pt=mi(),xt=t(pt),Nt=t(xt,!0);e(xt);var $t=s(xt,2),Ht=t($t,!0);e($t),e(pt),p(()=>{r(Nt,a(Te).name),r(Ht,a(Te).desc)}),d(we,pt)}),e(b),p(we=>r(D,we),[()=>n()("session.enemy_modal.end_of_round")]),d(v,b)};f(qt,v=>{a(i).endOfRound.length>0&&v(At)})}e(te),p((v,b,m,D,ve,we,Te,pt,xt,Nt,$t,Ht,Lt,Wt,Gt,Qt)=>{r(Rt,v),r(re,`${b??""} ${a(i).difficulty??""}`),r(Ze,`${m??""} ${a(i).size??""} ${a(i).descriptors??""}`),r(Le,D),r(Ce,`${a(i).perception??""} (${ve??""})`),r(Xe,we),r(kt,a(i).defense),r(Dt,Te),r(k,a(i).health),r(nt,pt),r(Fe,` ${a(i).attributes.strength??""} (${xt??""}), `),r(ft,Nt),r(Et,` ${a(i).attributes.agility??""} (${$t??""}), `),r(ht,Ht),r(P,` ${a(i).attributes.intellect??""} (${Lt??""}), `),r(U,Wt),r(ne,` ${a(i).attributes.will??""} (${Gt??""})`),r(X,Qt),r(de,a(i).speed)},[()=>a(i).name||n()("session.enemy_modal.enemy_default"),()=>n()("session.enemies.difficulty").toUpperCase(),()=>n()("session.enemy_modal.size"),()=>n()("sofdl.attributes.perception"),()=>_e(a(i).perception),()=>n()("session.enemy_modal.defense"),()=>n()("session.enemy_modal.health"),()=>n()("sofdl.attributes.strength"),()=>_e(a(i).attributes.strength),()=>n()("sofdl.attributes.agility"),()=>_e(a(i).attributes.agility),()=>n()("sofdl.attributes.intellect"),()=>_e(a(i).attributes.intellect),()=>n()("sofdl.attributes.will"),()=>_e(a(i).attributes.will),()=>n()("session.enemy_modal.speed")]),d(F,te)};let G=Yt(o,"isOpen",3,!1),Z=Yt(o,"initialData",3,"{}"),i=bt(ca(Me())),g=bt("general"),se=bt(!1),Pe=bt(""),ze=bt(void 0);function We(F){const te=F.target.files;if(te&&te.length>0){const T=te[0],Be=new FileReader;Be.onload=()=>{y(Pe,Be.result,!0),y(se,!0)},Be.readAsDataURL(T)}F.target&&(F.target.value="")}async function Ee(F){try{const te=await ns(F);a(i).imageUrl=te,y(se,!1)}catch(te){console.error(te),alert(te.message||"Erro ao salvar imagem")}}function Me(){return{name:"",difficulty:1,size:"1",description:"",descriptors:"",perception:10,senses:"",defense:10,health:10,attributes:{strength:10,agility:10,intellect:10,will:10},speed:10,speedNotes:"",immunities:"",traits:[],attackOptions:[],specialAttacks:[],endOfRound:[],imageUrl:"",global:!1}}function _e(F){const te=F-10;return te>=0?`+${te}`:`${te}`}Ra(()=>{if(G()&&Z())try{const F=JSON.parse(Z());Object.keys(F).length===0?y(i,Me(),!0):y(i,{...Me(),...F},!0)}catch{y(i,Me(),!0)}});function De(){a(i).traits=[...a(i).traits,{name:"",desc:""}]}function ye(F){a(i).traits=a(i).traits.filter((te,T)=>T!==F)}function Mt(){a(i).attackOptions=[...a(i).attackOptions,{name:"",type:"melee",attackRoll:"+0",damage:"1d6",desc:""}]}function yt(F){a(i).attackOptions=a(i).attackOptions.filter((te,T)=>T!==F)}function Ut(){a(i).specialAttacks=[...a(i).specialAttacks,{name:"",desc:""}]}function $e(F){a(i).specialAttacks=a(i).specialAttacks.filter((te,T)=>T!==F)}function Re(){a(i).endOfRound=[...a(i).endOfRound,{name:"",desc:""}]}function Qe(F){a(i).endOfRound=a(i).endOfRound.filter((te,T)=>T!==F)}function tt(F){}var me=St(),Ne=qe(me);{var ct=F=>{var te=Ei(),T=qe(te);T.__click=tt;var Be=t(T),Ve=t(Be),it=t(Ve),wt=t(it),at=t(wt);at.__click=function(...Ae){o.onClose?.apply(this,Ae)};var Rt=t(at);Na(Rt,{size:24}),e(at);var mt=s(at,2),re=t(mt,!0);e(mt),e(wt);var be=s(wt,2);be.__click=function(...Ae){o.onClose?.apply(this,Ae)};var Ze=t(be);ma(Ze,{size:20}),e(be),e(it);var Ue=s(it,2),vt=t(Ue);vt.__click=()=>y(g,"general");var st=t(vt,!0);e(vt);var ie=s(vt,2);ie.__click=()=>y(g,"stats");var Le=t(ie,!0);e(ie);var E=s(ie,2);E.__click=()=>y(g,"abilities");var Ce=t(E,!0);e(E);var fe=s(E,2);fe.__click=()=>y(g,"preview");var He=t(fe,!0);e(fe),e(Ue);var Ie=s(Ue,2),ut=t(Ie);{var Xe=Ae=>{var ht=hi(),P=t(ht),C=t(P);C.__click=()=>a(ze)?.click();var U=t(C),ne=t(U);Ba(ne,()=>a(i).imageUrl,m=>{ja(m,{get hash(){return a(i).imageUrl},get alt(){return a(i).name},size:"custom",fallbackText:"?"})}),e(U);var N=s(U,2),W=t(N);os(W,{size:20,class:"text-white"}),e(N),e(C);var X=s(C,2),je=t(X),de=t(je,!0);e(je);var oe=s(je,2);dt(oe),e(X),e(P);var L=s(P,2),ge=t(L),pe=t(ge,!0);e(ge);var Se=s(ge,2);xa(Se),e(L);var ot=s(L,2),lt=t(ot),_t=t(lt,!0);e(lt);var zt=s(lt,2);dt(zt),e(ot);var It=s(ot,2),qt=t(It);dt(qt);var At=s(qt,2),v=t(At);da(v,{size:14});var b=s(v);e(At),e(It),e(ht),p((m,D,ve,we,Te,pt)=>{r(de,m),r(pe,D),xe(Se,"placeholder",ve),r(_t,we),xe(zt,"placeholder",Te),r(b,` ${pt??""}`)},[()=>n()("session.enemy_modal.name"),()=>n()("session.enemy_modal.description"),()=>n()("session.enemy_modal.description_placeholder"),()=>n()("session.enemy_modal.descriptors"),()=>n()("session.enemy_modal.descriptors_placeholder"),()=>n()("session.enemy_modal.global_enemy")]),Ke(oe,()=>a(i).name,m=>a(i).name=m),Ke(Se,()=>a(i).description,m=>a(i).description=m),Ke(zt,()=>a(i).descriptors,m=>a(i).descriptors=m),Ya(qt,()=>a(i).global,m=>a(i).global=m),d(Ae,ht)},Ye=Ae=>{var ht=St(),P=qe(ht);{var C=ne=>{var N=wi(),W=t(N),X=t(W),je=t(X),de=t(je,!0);e(je);var oe=s(je,2);dt(oe),e(X);var L=s(X,2),ge=t(L),pe=t(ge,!0);e(ge);var Se=s(ge,2);dt(Se),e(L),e(W);var ot=s(W,2),lt=t(ot),_t=t(lt),zt=t(_t,!0);e(_t);var It=s(_t,2);dt(It),e(lt);var qt=s(lt,2),At=t(qt),v=t(At,!0);e(At);var b=s(At,2);dt(b),e(qt),e(ot);var m=s(ot,2),D=t(m),ve=t(D),we=t(ve,!0);e(ve);var Te=s(ve,2);dt(Te),e(D);var pt=s(D,2),xt=t(pt),Nt=t(xt,!0);e(xt);var $t=s(xt,2);dt($t),e(pt),e(m);var Ht=s(m,2),Lt=t(Ht),Wt=t(Lt,!0);e(Lt);var Gt=s(Lt,2);Ge(Gt,5,()=>[{key:"strength",label:n()("sofdl.attributes.strength")},{key:"agility",label:n()("sofdl.attributes.agility")},{key:"intellect",label:n()("sofdl.attributes.intellect")},{key:"will",label:n()("sofdl.attributes.will")}],Ct,(q,S)=>{var M=yi(),O=t(M),ee=t(O,!0);e(O);var z=s(O,2);dt(z);var A=s(z,2),B=t(A,!0);e(A),e(M),p((I,ae)=>{xe(O,"for",`attr-${a(S).key??""}`),xe(O,"title",a(S).label),r(ee,I),xe(z,"id",`attr-${a(S).key??""}`),et(A,1,`text-xs font-bold ${a(i).attributes[a(S).key]-10>=0?"text-green-500":"text-red-500"}`),r(B,ae)},[()=>a(S).label.substring(0,3),()=>_e(a(i).attributes[a(S).key])]),Ke(z,()=>a(i).attributes[a(S).key],I=>a(i).attributes[a(S).key]=I),d(q,M)}),e(Gt),e(Ht);var Qt=s(Ht,2),l=t(Qt),c=t(l),_=t(c,!0);e(c);var h=s(c,2);dt(h),e(l);var Y=s(l,2),w=t(Y),$=t(w,!0);e(w);var Q=s(w,2);dt(Q),e(Y);var K=s(Y,2),j=t(K),le=t(j,!0);e(j);var he=s(j,2);xa(he),e(K),e(Qt),e(N),p((q,S,M,O,ee,z,A,B,I,ae,ce,Je,Pt)=>{r(de,q),r(pe,S),r(zt,M),r(v,O),r(we,ee),r(Nt,z),r(Wt,A),r(_,B),xe(h,"placeholder",I),r($,ae),xe(Q,"placeholder",ce),r(le,Je),xe(he,"placeholder",Pt)},[()=>n()("session.enemy_modal.difficulty"),()=>n()("session.enemy_modal.size"),()=>n()("session.enemy_modal.speed"),()=>n()("session.enemy_modal.health"),()=>n()("session.enemy_modal.defense"),()=>n()("sofdl.attributes.perception"),()=>n()("session.enemy_modal.main_attributes"),()=>n()("session.enemy_modal.speed_notes"),()=>n()("session.enemy_modal.speed_notes_placeholder"),()=>n()("session.enemy_modal.senses"),()=>n()("session.enemy_modal.senses_placeholder_sotdl"),()=>n()("session.enemy_modal.immunities"),()=>n()("session.enemy_modal.immunities_placeholder_sotdl")]),Ke(oe,()=>a(i).difficulty,q=>a(i).difficulty=q),Ke(Se,()=>a(i).size,q=>a(i).size=q),Ke(It,()=>a(i).speed,q=>a(i).speed=q),Ke(b,()=>a(i).health,q=>a(i).health=q),Ke(Te,()=>a(i).defense,q=>a(i).defense=q),Ke($t,()=>a(i).perception,q=>a(i).perception=q),Ke(h,()=>a(i).speedNotes,q=>a(i).speedNotes=q),Ke(Q,()=>a(i).senses,q=>a(i).senses=q),Ke(he,()=>a(i).immunities,q=>a(i).immunities=q),d(ne,N)},U=ne=>{var N=St(),W=qe(N);{var X=de=>{var oe=Oi(),L=t(oe),ge=t(L),pe=t(ge),Se=t(pe,!0);e(pe),e(ge);var ot=s(ge,2),lt=t(ot);Ge(lt,17,()=>a(i).traits,Ct,(S,M,O)=>{var ee=ki(),z=t(ee),A=t(z);dt(A);var B=s(A,2);xa(B),e(z);var I=s(z,2);I.__click=()=>ye(O);var ae=t(I);aa(ae,{size:16}),e(I),e(ee),p((ce,Je)=>{xe(A,"placeholder",ce),xe(B,"placeholder",Je)},[()=>n()("session.enemy_modal.name_placeholder"),()=>n()("session.enemy_modal.desc_placeholder")]),Ke(A,()=>a(M).name,ce=>a(M).name=ce),Ke(B,()=>a(M).desc,ce=>a(M).desc=ce),d(S,ee)});var _t=s(lt,2);_t.__click=De;var zt=t(_t),It=t(zt);ea(It,{size:16}),e(zt);var qt=s(zt);e(_t),e(ot),e(L);var At=s(L,2),v=t(At),b=t(v),m=t(b,!0);e(b),e(v);var D=s(v,2),ve=t(D);Ge(ve,17,()=>a(i).attackOptions,Ct,(S,M,O)=>{var ee=zi(),z=t(ee),A=t(z),B=t(A);dt(B);var I=s(B,2),ae=t(I),ce=t(ae,!0);e(ae),ae.value=ae.__value="melee";var Je=s(ae),Pt=t(Je,!0);e(Je),Je.value=Je.__value="ranged",e(I),e(A);var gt=s(A,2),Ot=t(gt);dt(Ot);var Bt=s(Ot,2);dt(Bt),e(gt);var Jt=s(gt,2);xa(Jt),e(z);var Xt=s(z,2);Xt.__click=()=>yt(O);var oa=t(Xt);aa(oa,{size:16}),e(Xt),e(ee),p((Zt,za,fa,$a,la,Ca)=>{xe(B,"placeholder",Zt),r(ce,za),r(Pt,fa),xe(Ot,"placeholder",$a),xe(Bt,"placeholder",la),xe(Jt,"placeholder",Ca)},[()=>n()("session.enemy_modal.name_placeholder"),()=>n()("session.enemy_modal.melee"),()=>n()("session.enemy_modal.ranged"),()=>n()("session.enemy_modal.attack_placeholder"),()=>n()("session.enemy_modal.damage_placeholder"),()=>n()("session.enemy_modal.desc_effects_placeholder")]),Ke(B,()=>a(M).name,Zt=>a(M).name=Zt),_s(I,()=>a(M).type,Zt=>a(M).type=Zt),Ke(Ot,()=>a(M).attackRoll,Zt=>a(M).attackRoll=Zt),Ke(Bt,()=>a(M).damage,Zt=>a(M).damage=Zt),Ke(Jt,()=>a(M).desc,Zt=>a(M).desc=Zt),d(S,ee)});var we=s(ve,2);we.__click=Mt;var Te=t(we),pt=t(Te);ea(pt,{size:16}),e(Te);var xt=s(Te);e(we),e(D),e(At);var Nt=s(At,2),$t=t(Nt),Ht=t($t),Lt=t(Ht,!0);e(Ht),e($t);var Wt=s($t,2),Gt=t(Wt);Ge(Gt,17,()=>a(i).specialAttacks,Ct,(S,M,O)=>{var ee=$i(),z=t(ee),A=t(z);dt(A);var B=s(A,2);xa(B),e(z);var I=s(z,2);I.__click=()=>$e(O);var ae=t(I);aa(ae,{size:16}),e(I),e(ee),p((ce,Je)=>{xe(A,"placeholder",ce),xe(B,"placeholder",Je)},[()=>n()("session.enemy_modal.name_placeholder"),()=>n()("session.enemy_modal.desc_placeholder")]),Ke(A,()=>a(M).name,ce=>a(M).name=ce),Ke(B,()=>a(M).desc,ce=>a(M).desc=ce),d(S,ee)});var Qt=s(Gt,2);Qt.__click=Ut;var l=t(Qt),c=t(l);ea(c,{size:16}),e(l);var _=s(l);e(Qt),e(Wt),e(Nt);var h=s(Nt,2),Y=t(h),w=t(Y),$=t(w,!0);e(w),e(Y);var Q=s(Y,2),K=t(Q);Ge(K,17,()=>a(i).endOfRound,Ct,(S,M,O)=>{var ee=Ci(),z=t(ee),A=t(z);dt(A);var B=s(A,2);xa(B),e(z);var I=s(z,2);I.__click=()=>Qe(O);var ae=t(I);aa(ae,{size:16}),e(I),e(ee),p((ce,Je)=>{xe(A,"placeholder",ce),xe(B,"placeholder",Je)},[()=>n()("session.enemy_modal.name_placeholder"),()=>n()("session.enemy_modal.desc_placeholder")]),Ke(A,()=>a(M).name,ce=>a(M).name=ce),Ke(B,()=>a(M).desc,ce=>a(M).desc=ce),d(S,ee)});var j=s(K,2);j.__click=Re;var le=t(j),he=t(le);ea(he,{size:16}),e(le);var q=s(le);e(j),e(Q),e(h),e(oe),p((S,M,O,ee,z,A,B,I)=>{r(Se,S),r(qt,` ${M??""}`),r(m,O),r(xt,` ${ee??""}`),r(Lt,z),r(_,` ${A??""}`),r($,B),r(q,` ${I??""}`)},[()=>n()("session.enemy_modal.traits"),()=>n()("common.buttons.add"),()=>n()("session.enemy_modal.attack_options"),()=>n()("common.buttons.add"),()=>n()("session.enemy_modal.special_attacks"),()=>n()("common.buttons.add"),()=>n()("session.enemy_modal.end_of_round"),()=>n()("common.buttons.add")]),d(de,oe)},je=de=>{var oe=St(),L=qe(oe);{var ge=pe=>{var Se=ji(),ot=t(Se);x(ot),e(Se),d(pe,Se)};f(L,pe=>{a(g)==="preview"&&pe(ge)},!0)}d(de,oe)};f(W,de=>{a(g)==="abilities"?de(X):de(je,!1)},!0)}d(ne,N)};f(P,ne=>{a(g)==="stats"?ne(C):ne(U,!1)},!0)}d(Ae,ht)};f(ut,Ae=>{a(g)==="general"?Ae(Xe):Ae(Ye,!1)})}e(Ie);var kt=s(Ie,2),jt=t(kt);jt.__click=()=>o.onSave(a(i));var Dt=t(jt);Ja(Dt,{size:18});var Tt=s(Dt);e(jt),e(kt),e(Ve);var k=s(Ve,2),R=t(k),H=t(R),Oe=t(H);qa(Oe,{size:14});var nt=s(Oe);e(H),e(R);var Fe=s(R,2),rt=t(Fe);x(rt),e(Fe),e(k),e(Be),e(T);var ft=s(T,2);ft.__change=We,vs(ft,Ae=>y(ze,Ae),()=>a(ze));var Et=s(ft,2);is(Et,{get isOpen(){return a(se)},get imageUrl(){return a(Pe)},onClose:()=>y(se,!1),onCrop:Ee}),p((Ae,ht,P,C,U,ne,N)=>{r(re,Ae),et(vt,1,`flex-1 py-3 px-4 text-sm font-bold border-b-2 whitespace-nowrap transition-colors ${a(g)==="general"?"border-indigo-500 text-indigo-400 bg-slate-800":"border-transparent text-slate-500 hover:text-white"}`),r(st,ht),et(ie,1,`flex-1 py-3 px-4 text-sm font-bold border-b-2 whitespace-nowrap transition-colors ${a(g)==="stats"?"border-indigo-500 text-indigo-400 bg-slate-800":"border-transparent text-slate-500 hover:text-white"}`),r(Le,P),et(E,1,`flex-1 py-3 px-4 text-sm font-bold border-b-2 whitespace-nowrap transition-colors ${a(g)==="abilities"?"border-indigo-500 text-indigo-400 bg-slate-800":"border-transparent text-slate-500 hover:text-white"}`),r(Ce,C),et(fe,1,`lg:hidden flex-1 py-3 px-4 text-sm font-bold border-b-2 whitespace-nowrap transition-colors ${a(g)==="preview"?"border-indigo-500 text-indigo-400 bg-slate-800":"border-transparent text-slate-500 hover:text-white"}`),r(He,U),r(Tt,` ${ne??""}`),r(nt,` ${N??""}`)},[()=>n()("session.enemy_modal.title_sotdl"),()=>n()("session.enemy_modal.tab_general"),()=>n()("session.enemy_modal.tab_stats"),()=>n()("session.enemy_modal.tab_abilities"),()=>n()("session.enemy_modal.preview"),()=>n()("common.buttons.save"),()=>n()("session.enemy_modal.preview")]),Ia(3,Be,()=>Sa,()=>({y:20,duration:300})),Ia(3,T,()=>Sa,()=>({duration:200,opacity:1})),d(F,te)};f(Ne,F=>{G()&&F(ct)})}d(V,me),ba(),J()}_a(["click","change"]);var Ii=u('<div class="w-16 h-16 rounded-lg overflow-hidden border border-slate-700 shadow-lg flex-shrink-0"><!></div>'),Si=u('<div class="bg-slate-950 p-2 rounded border border-slate-800"><div class="text-[10px] text-slate-500 uppercase font-bold mb-1"> </div> <div class="text-white font-bold"> <span> </span></div></div>'),Ri=u('<div class="flex gap-2"><span class="font-bold text-slate-500 uppercase"> </span> <span class="text-white"> </span></div>'),Ni=u('<div class="flex gap-2"><span class="font-bold text-slate-500 uppercase"> </span> <span class="text-white"> </span></div>'),Di=u('<div class="flex gap-2"><span class="font-bold text-slate-500 uppercase"> </span> <span class="text-white"> </span></div>'),Ai=u('<div class="mb-2 pl-3 border-l-2 border-indigo-900"><span class="font-bold text-white"> </span> <span class="text-slate-300"> </span></div>'),Ti=u('<div><h4 class="font-bold text-indigo-400 uppercase text-xs mb-2 tracking-wider"> </h4> <!></div>'),Pi=u('<div class="mb-2 pl-3 border-l-2 border-red-900/50"><span class="font-bold text-white"> </span> <span class="text-slate-300"> </span></div>'),Ui=u('<div><h4 class="font-bold text-red-500 uppercase text-xs mb-2 tracking-wider"> </h4> <!></div>'),Hi=u('<div class="mb-2 pl-3 border-l-2 border-orange-900/50"><span class="font-bold text-white"> </span> <span class="text-slate-300"> </span></div>'),Li=u('<div><h4 class="font-bold text-orange-400 uppercase text-xs mb-2 tracking-wider"> </h4> <!></div>'),Fi=u('<div class="mb-2 pl-3 border-l-2 border-yellow-900/50"><span class="font-bold text-white"> </span> <span class="text-slate-300"> </span></div>'),qi=u('<div><h4 class="font-bold text-yellow-500 uppercase text-xs mb-2 tracking-wider"> </h4> <!></div>'),Bi=u('<div class="w-full max-w-md bg-slate-900 border border-slate-700 rounded-xl p-5 shadow-2xl relative"><div class="absolute -top-3 -right-3 bg-red-600 text-white text-xs font-bold px-3 py-1 rounded-full shadow-lg border border-red-400"> </div> <div class="flex items-center gap-3 mb-4"><!> <div class="flex-1 min-w-0"><h2 class="text-2xl font-bold text-white mb-1 font-serif tracking-wide truncate"> </h2> <div class="h-1 w-20 bg-red-600 rounded-full"></div></div></div> <div class="grid grid-cols-2 gap-4 mb-4 text-sm"><div class="bg-slate-950 p-2 rounded border border-slate-800 flex justify-between items-center"><span class="text-slate-500 uppercase font-bold text-[10px]"> </span> <span class="text-white font-mono font-bold text-lg"> </span></div> <div class="bg-slate-950 p-2 rounded border border-slate-800 flex justify-between items-center"><span class="text-slate-500 uppercase font-bold text-[10px]"> </span> <span class="text-white font-mono font-bold text-lg"> </span></div> <div class="bg-slate-950 p-2 rounded border border-slate-800 flex justify-between items-center"><span class="text-slate-500 uppercase font-bold text-[10px]"> </span> <span class="text-white font-mono font-bold"> </span></div> <div class="bg-slate-950 p-2 rounded border border-slate-800 flex justify-between items-center"><span class="text-slate-500 uppercase font-bold text-[10px]"> </span> <span class="text-white font-mono font-bold"> </span></div></div> <div class="grid grid-cols-4 gap-2 mb-6 text-center font-mono text-slate-300"></div> <div class="mb-6 space-y-2 text-xs"><!> <!> <!></div> <div class="space-y-5 text-sm"><!> <!> <!> <!></div></div>'),Ji=u('<div class="space-y-4 animate-in fade-in slide-in-from-bottom-2 duration-300"><div class="flex items-center gap-4"><div class="relative group cursor-pointer"><div class="w-16 h-16 rounded-xl overflow-hidden border border-slate-700"><!></div> <div class="absolute inset-0 bg-black/50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity rounded-xl"><!></div></div> <div class="flex-1"><label for="enemy-name" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-name" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white font-bold text-lg"/></div></div> <div><label for="enemy-desc" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <textarea id="enemy-desc" class="w-full bg-slate-900 border border-slate-700 rounded p-3 text-white text-sm min-h-[100px] resize-none focus:border-indigo-500 focus:outline-none transition-colors"></textarea></div> <div class="flex items-center gap-2"><input id="enemy-global" type="checkbox" class="w-4 h-4 bg-slate-900 border-slate-700 rounded focus:ring-indigo-500"/> <label for="enemy-global" class="text-sm font-bold text-slate-400 select-none cursor-pointer flex items-center gap-2"><!> </label></div></div>'),Gi=u('<div class="bg-slate-900 p-2 rounded border border-slate-700 text-center"><label class="text-[10px] text-slate-500 uppercase font-bold block mb-1 text-ellipsis overflow-hidden whitespace-nowrap"> </label> <input type="number" class="w-full bg-transparent text-center font-bold text-white text-xl focus:outline-none mb-1"/> <div> </div></div>'),Wi=u('<div class="space-y-6 animate-in fade-in slide-in-from-bottom-2 duration-300"><div class="grid grid-cols-2 gap-4"><div><label for="enemy-diff" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label><input id="enemy-diff" type="number" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div> <div><label for="enemy-size" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label><input id="enemy-size" type="number" step="0.5" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div></div> <div class="grid grid-cols-2 gap-4"><div><label for="enemy-defense" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label><input id="enemy-defense" type="number" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div> <div><label for="enemy-health" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label><input id="enemy-health" type="number" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div></div> <div class="grid grid-cols-2 gap-4"><div><label for="enemy-damage" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label><input id="enemy-damage" type="number" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div> <div><label for="enemy-speed" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label><input id="enemy-speed" type="number" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div></div> <div><h4 class="text-indigo-400 font-bold text-sm uppercase mb-3 text-center border-b border-indigo-500/20 pb-2"> </h4> <div class="grid grid-cols-4 gap-3"></div></div> <div class="space-y-3 pt-4 border-t border-slate-800"><div><label for="enemy-senses" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label><input id="enemy-senses" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white text-sm"/></div> <div><label for="enemy-langs" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label><input id="enemy-langs" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white text-sm"/></div> <div><label for="enemy-immune" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label><input id="enemy-immune" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white text-sm"/></div></div></div>'),Qi=u('<div class="flex gap-2 items-start animate-in fade-in slide-in-from-left-2"><div class="flex-1 space-y-1"><input class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm font-bold placeholder-slate-600 focus:border-indigo-500 focus:outline-none"/> <textarea class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm placeholder-slate-600 resize-none focus:border-indigo-500 focus:outline-none" rows="2"></textarea></div> <button class="mt-1 text-slate-600 hover:text-red-400 p-2 hover:bg-slate-800 rounded"><!></button></div>'),Vi=u('<div><div class="mb-3"><h4> </h4></div> <div class="space-y-3"><!> <button class="w-full py-3 border-2 border-dashed border-slate-700 rounded hover:border-slate-500 hover:bg-slate-800 transition-colors flex items-center justify-center gap-2 text-slate-500 hover:text-white font-bold text-sm group"><div class="p-1 rounded-full bg-slate-800 group-hover:bg-slate-700 transition-colors"><!></div> </button></div></div>'),Zi=u('<div class="space-y-6 animate-in fade-in slide-in-from-bottom-2 duration-300"></div>'),Xi=u('<div class="flex-1 flex items-start justify-center p-4 min-h-0 animate-in fade-in slide-in-from-right-2 duration-300"><!></div>'),Yi=u('<div class="fixed inset-0 z-[100] flex items-center justify-center bg-black/80 lg:p-4" role="button" tabindex="-1"><div class="bg-slate-900 w-full h-full lg:rounded-xl lg:max-w-6xl lg:h-[90vh] border-0 lg:border border-slate-700 shadow-2xl overflow-hidden flex flex-col lg:flex-row" role="dialog" aria-modal="true" aria-labelledby="modal-title"><div class="w-full lg:w-1/2 flex flex-col h-full border-r border-slate-700"><div class="p-4 border-b border-slate-700 bg-slate-900 flex justify-between items-center"><div class="flex items-center gap-3"><button class="lg:hidden text-slate-400 hover:text-white p-1 rounded-full hover:bg-slate-800 transition-colors"><!></button> <h3 id="modal-title" class="font-bold text-white text-lg"> </h3></div> <button class="hidden lg:block text-slate-400 hover:text-white"><!></button></div> <div class="flex border-b border-slate-700 bg-slate-900/50 overflow-x-auto"><button> </button> <button> </button> <button> </button> <button> </button></div> <div class="flex-1 overflow-y-auto p-6 custom-scrollbar bg-slate-800/50"><!></div> <div class="p-4 border-t border-slate-700 bg-slate-900 flex justify-end gap-3 safe-area-bottom"><button class="px-6 py-2 rounded bg-indigo-600 hover:bg-indigo-500 text-white font-bold flex items-center gap-2 transition-colors"><!> </button></div></div> <div class="hidden lg:flex w-1/2 bg-slate-950 flex-col border-l border-slate-800"><div class="p-4 border-b border-slate-800 bg-slate-950"><h3 class="font-bold text-slate-500 text-xs uppercase flex items-center gap-2"><!> </h3></div> <div class="flex-1 p-8 overflow-y-auto flex items-center justify-center bg-[radial-gradient(ellipse_at_top,_var(--tw-gradient-stops))] from-slate-900 via-slate-950 to-slate-950"><!></div></div></div></div> <input type="file" hidden="" accept="image/*"/> <!>',1);function Ki(V,o){ua(o,!0);const n=()=>Ft(ta,"$t",ue),[ue,J]=pa(),x=$e=>{var Re=Bi(),Qe=t(Re),tt=t(Qe);e(Qe);var me=s(Qe,2),Ne=t(me);{var ct=P=>{var C=Ii(),U=t(C);ja(U,{get hash(){return a(i).imageUrl},get alt(){return a(i).name},size:"custom"}),e(C),d(P,C)};f(Ne,P=>{a(i).imageUrl&&P(ct)})}var F=s(Ne,2),te=t(F),T=t(te,!0);e(te),va(2),e(F),e(me);var Be=s(me,2),Ve=t(Be),it=t(Ve),wt=t(it,!0);e(it);var at=s(it,2),Rt=t(at,!0);e(at),e(Ve);var mt=s(Ve,2),re=t(mt),be=t(re,!0);e(re);var Ze=s(re,2),Ue=t(Ze,!0);e(Ze),e(mt);var vt=s(mt,2),st=t(vt),ie=t(st,!0);e(st);var Le=s(st,2),E=t(Le,!0);e(Le),e(vt);var Ce=s(vt,2),fe=t(Ce),He=t(fe,!0);e(fe);var Ie=s(fe,2),ut=t(Ie,!0);e(Ie),e(Ce),e(Be);var Xe=s(Be,2);Ge(Xe,20,()=>["str","agi","int","wil"],Ct,(P,C)=>{var U=Si(),ne=t(U),N=t(ne,!0);e(ne);var W=s(ne,2),X=t(W),je=s(X),de=t(je);e(je),e(W),e(U),p(()=>{r(N,C),r(X,`${a(i).stats[C]??""} `),et(je,1,`text-xs ${a(i).stats[C]-10>=0?"text-green-500":"text-red-500"}`),r(de,`(${a(i).stats[C]-10>=0?"+":""}${a(i).stats[C]-10})`)}),d(P,U)}),e(Xe);var Ye=s(Xe,2),kt=t(Ye);{var jt=P=>{var C=Ri(),U=t(C),ne=t(U);e(U);var N=s(U,2),W=t(N,!0);e(N),e(C),p(X=>{r(ne,`${X??""}:`),r(W,a(i).senses)},[()=>n()("session.enemy_modal.senses")]),d(P,C)};f(kt,P=>{a(i).senses&&P(jt)})}var Dt=s(kt,2);{var Tt=P=>{var C=Ni(),U=t(C),ne=t(U);e(U);var N=s(U,2),W=t(N,!0);e(N),e(C),p(X=>{r(ne,`${X??""}:`),r(W,a(i).languages)},[()=>n()("session.enemy_modal.languages")]),d(P,C)};f(Dt,P=>{a(i).languages&&P(Tt)})}var k=s(Dt,2);{var R=P=>{var C=Di(),U=t(C),ne=t(U);e(U);var N=s(U,2),W=t(N,!0);e(N),e(C),p(X=>{r(ne,`${X??""}:`),r(W,a(i).immune)},[()=>n()("session.enemy_modal.immunities")]),d(P,C)};f(k,P=>{a(i).immune&&P(R)})}e(Ye);var H=s(Ye,2),Oe=t(H);{var nt=P=>{var C=Ti(),U=t(C),ne=t(U,!0);e(U);var N=s(U,2);Ge(N,17,()=>a(i).traits,Ct,(W,X,je,de)=>{var oe=Ai(),L=t(oe),ge=t(L);e(L);var pe=s(L,2),Se=t(pe,!0);e(pe),e(oe),p(()=>{r(ge,`${a(X).name??""}:`),r(Se,a(X).desc)}),d(W,oe)}),e(C),p(W=>r(ne,W),[()=>n()("session.enemy_modal.traits")]),d(P,C)};f(Oe,P=>{a(i).traits.length>0&&P(nt)})}var Fe=s(Oe,2);{var rt=P=>{var C=Ui(),U=t(C),ne=t(U,!0);e(U);var N=s(U,2);Ge(N,17,()=>a(i).actions,Ct,(W,X,je,de)=>{var oe=Pi(),L=t(oe),ge=t(L);e(L);var pe=s(L,2),Se=t(pe,!0);e(pe),e(oe),p(()=>{r(ge,`${a(X).name??""}:`),r(Se,a(X).desc)}),d(W,oe)}),e(C),p(W=>r(ne,W),[()=>n()("session.enemy_modal.actions")]),d(P,C)};f(Fe,P=>{a(i).actions.length>0&&P(rt)})}var ft=s(Fe,2);{var Et=P=>{var C=Li(),U=t(C),ne=t(U,!0);e(U);var N=s(U,2);Ge(N,17,()=>a(i).reactions,Ct,(W,X,je,de)=>{var oe=Hi(),L=t(oe),ge=t(L);e(L);var pe=s(L,2),Se=t(pe,!0);e(pe),e(oe),p(()=>{r(ge,`${a(X).name??""}:`),r(Se,a(X).desc)}),d(W,oe)}),e(C),p(W=>r(ne,W),[()=>n()("session.enemy_modal.reactions")]),d(P,C)};f(ft,P=>{a(i).reactions.length>0&&P(Et)})}var Ae=s(ft,2);{var ht=P=>{var C=qi(),U=t(C),ne=t(U,!0);e(U);var N=s(U,2);Ge(N,17,()=>a(i).endOfRound,Ct,(W,X,je,de)=>{var oe=Fi(),L=t(oe),ge=t(L);e(L);var pe=s(L,2),Se=t(pe,!0);e(pe),e(oe),p(()=>{r(ge,`${a(X).name??""}:`),r(Se,a(X).desc)}),d(W,oe)}),e(C),p(W=>r(ne,W),[()=>n()("session.enemy_modal.end_of_round")]),d(P,C)};f(Ae,P=>{a(i).endOfRound.length>0&&P(ht)})}e(H),e(Re),p((P,C,U,ne,N,W)=>{r(tt,`${P??""} ${a(i).difficulty??""}`),r(T,C),r(wt,U),r(Rt,a(i).defense),r(be,ne),r(Ue,a(i).health),r(ie,N),r(E,a(i).size),r(He,W),r(ut,a(i).speed)},[()=>n()("session.enemy_modal.difficulty"),()=>a(i).name||n()("session.enemy_modal.enemy_default"),()=>n()("session.enemy_modal.defense"),()=>n()("session.enemy_modal.health"),()=>n()("session.enemy_modal.size"),()=>n()("session.enemy_modal.speed")]),d($e,Re)};let G=Yt(o,"isOpen",3,!1),Z=Yt(o,"initialData",3,"{}"),i=bt(ca(Me())),g=bt("general"),se=bt(!1),Pe=bt(""),ze=bt(void 0);function We($e){const Re=$e.target.files;if(Re&&Re.length>0){const Qe=Re[0],tt=new FileReader;tt.onload=()=>{y(Pe,tt.result,!0),y(se,!0)},tt.readAsDataURL(Qe)}$e.target&&($e.target.value="")}async function Ee($e){try{const Re=await ns($e);a(i).imageUrl=Re,y(se,!1)}catch(Re){console.error(Re),alert(Re.message||"Erro ao salvar imagem")}}function Me(){return{name:"",difficulty:1,defense:10,health:10,damage:0,size:1,speed:10,description:"",senses:"",languages:"",immune:"",imageUrl:"",stats:{str:10,agi:10,int:10,wil:10},traits:[],actions:[],reactions:[],endOfRound:[],global:!1}}Ra(()=>{if(G()&&Z())try{const $e=JSON.parse(Z());Object.keys($e).length===0?y(i,Me(),!0):y(i,{...Me(),...$e},!0)}catch{y(i,Me(),!0)}});function _e($e){a(i)[$e]=[...a(i)[$e],{name:"",desc:""}]}function De($e,Re){a(i)[$e]=a(i)[$e].filter((Qe,tt)=>tt!==Re)}function ye($e){}var Mt=St(),yt=qe(Mt);{var Ut=$e=>{var Re=Yi(),Qe=qe(Re);Qe.__click=ye;var tt=t(Qe),me=t(tt),Ne=t(me),ct=t(Ne),F=t(ct);F.__click=function(...H){o.onClose?.apply(this,H)};var te=t(F);Na(te,{size:24}),e(F);var T=s(F,2),Be=t(T,!0);e(T),e(ct);var Ve=s(ct,2);Ve.__click=function(...H){o.onClose?.apply(this,H)};var it=t(Ve);ma(it,{size:20}),e(Ve),e(Ne);var wt=s(Ne,2),at=t(wt);at.__click=()=>y(g,"general");var Rt=t(at,!0);e(at);var mt=s(at,2);mt.__click=()=>y(g,"stats");var re=t(mt,!0);e(mt);var be=s(mt,2);be.__click=()=>y(g,"abilities");var Ze=t(be,!0);e(be);var Ue=s(be,2);Ue.__click=()=>y(g,"preview");var vt=t(Ue,!0);e(Ue),e(wt);var st=s(wt,2),ie=t(st);{var Le=H=>{var Oe=Ji(),nt=t(Oe),Fe=t(nt);Fe.__click=()=>a(ze)?.click();var rt=t(Fe),ft=t(rt);Ba(ft,()=>a(i).imageUrl,pe=>{ja(pe,{get hash(){return a(i).imageUrl},get alt(){return a(i).name},size:"custom",fallbackText:"?"})}),e(rt);var Et=s(rt,2),Ae=t(Et);os(Ae,{size:20,class:"text-white"}),e(Et),e(Fe);var ht=s(Fe,2),P=t(ht),C=t(P,!0);e(P);var U=s(P,2);dt(U),e(ht),e(nt);var ne=s(nt,2),N=t(ne),W=t(N,!0);e(N);var X=s(N,2);xa(X),e(ne);var je=s(ne,2),de=t(je);dt(de);var oe=s(de,2),L=t(oe);da(L,{size:14});var ge=s(L);e(oe),e(je),e(Oe),p((pe,Se,ot,lt)=>{r(C,pe),r(W,Se),xe(X,"placeholder",ot),r(ge,` ${lt??""}`)},[()=>n()("session.enemy_modal.name"),()=>n()("session.enemy_modal.description"),()=>n()("session.enemy_modal.description_placeholder"),()=>n()("session.enemy_modal.global_enemy")]),Ke(U,()=>a(i).name,pe=>a(i).name=pe),Ke(X,()=>a(i).description,pe=>a(i).description=pe),Ya(de,()=>a(i).global,pe=>a(i).global=pe),d(H,Oe)},E=H=>{var Oe=St(),nt=qe(Oe);{var Fe=ft=>{var Et=Wi(),Ae=t(Et),ht=t(Ae),P=t(ht),C=t(P,!0);e(P);var U=s(P);dt(U),e(ht);var ne=s(ht,2),N=t(ne),W=t(N,!0);e(N);var X=s(N);dt(X),e(ne),e(Ae);var je=s(Ae,2),de=t(je),oe=t(de),L=t(oe,!0);e(oe);var ge=s(oe);dt(ge),e(de);var pe=s(de,2),Se=t(pe),ot=t(Se,!0);e(Se);var lt=s(Se);dt(lt),e(pe),e(je);var _t=s(je,2),zt=t(_t),It=t(zt),qt=t(It,!0);e(It);var At=s(It);dt(At),e(zt);var v=s(zt,2),b=t(v),m=t(b,!0);e(b);var D=s(b);dt(D),e(v),e(_t);var ve=s(_t,2),we=t(ve),Te=t(we,!0);e(we);var pt=s(we,2);Ge(pt,20,()=>["str","agi","int","wil"],Ct,(w,$)=>{var Q=Gi(),K=t(Q),j=t(K,!0);e(K);var le=s(K,2);dt(le);var he=s(le,2),q=t(he);e(he),e(Q),p(S=>{xe(K,"for",`attr-${$??""}`),r(j,S),xe(le,"id",`attr-${$??""}`),et(he,1,`text-xs font-bold ${a(i).stats[$]-10>=0?"text-green-500":"text-red-500"}`),r(q,`${a(i).stats[$]-10>=0?"+":""}${a(i).stats[$]-10}`)},[()=>n()("sofww.attributes."+$).substring(0,3)]),Ke(le,()=>a(i).stats[$],S=>a(i).stats[$]=S),d(w,Q)}),e(pt),e(ve);var xt=s(ve,2),Nt=t(xt),$t=t(Nt),Ht=t($t,!0);e($t);var Lt=s($t);dt(Lt),e(Nt);var Wt=s(Nt,2),Gt=t(Wt),Qt=t(Gt,!0);e(Gt);var l=s(Gt);dt(l),e(Wt);var c=s(Wt,2),_=t(c),h=t(_,!0);e(_);var Y=s(_);dt(Y),e(c),e(xt),e(Et),p((w,$,Q,K,j,le,he,q,S,M,O,ee,z)=>{r(C,w),r(W,$),r(L,Q),r(ot,K),r(qt,j),r(m,le),r(Te,he),r(Ht,q),xe(Lt,"placeholder",S),r(Qt,M),xe(l,"placeholder",O),r(h,ee),xe(Y,"placeholder",z)},[()=>n()("session.enemy_modal.difficulty"),()=>n()("session.enemy_modal.size"),()=>n()("session.enemy_modal.defense"),()=>n()("session.enemy_modal.health"),()=>n()("session.enemy_modal.damage"),()=>n()("session.enemy_modal.speed"),()=>n()("session.enemy_modal.main_attributes"),()=>n()("session.enemy_modal.senses"),()=>n()("session.enemy_modal.senses_placeholder"),()=>n()("session.enemy_modal.languages"),()=>n()("session.enemy_modal.languages_placeholder"),()=>n()("session.enemy_modal.immunities"),()=>n()("session.enemy_modal.immunities_placeholder")]),Ke(U,()=>a(i).difficulty,w=>a(i).difficulty=w),Ke(X,()=>a(i).size,w=>a(i).size=w),Ke(ge,()=>a(i).defense,w=>a(i).defense=w),Ke(lt,()=>a(i).health,w=>a(i).health=w),Ke(At,()=>a(i).damage,w=>a(i).damage=w),Ke(D,()=>a(i).speed,w=>a(i).speed=w),Ke(Lt,()=>a(i).senses,w=>a(i).senses=w),Ke(l,()=>a(i).languages,w=>a(i).languages=w),Ke(Y,()=>a(i).immune,w=>a(i).immune=w),d(ft,Et)},rt=ft=>{var Et=St(),Ae=qe(Et);{var ht=C=>{var U=Zi();Ge(U,20,()=>[{key:"traits",label:"traits",color:"text-indigo-400",border:"border-indigo-500/30"},{key:"actions",label:"actions",color:"text-red-400",border:"border-red-500/30"},{key:"reactions",label:"reactions",color:"text-orange-400",border:"border-orange-500/30"},{key:"endOfRound",label:"end_of_round",color:"text-yellow-400",border:"border-yellow-500/30"}],Ct,(ne,N)=>{var W=Vi(),X=t(W),je=t(X),de=t(je,!0);e(je),e(X);var oe=s(X,2),L=t(oe);Ge(L,17,()=>a(i)[N.key],Ct,(lt,_t,zt)=>{var It=Qi(),qt=t(It),At=t(qt);dt(At);var v=s(At,2);xa(v),e(qt);var b=s(qt,2);b.__click=()=>De(N.key,zt);var m=t(b);aa(m,{size:16}),e(b),e(It),p((D,ve)=>{xe(At,"placeholder",D),xe(v,"placeholder",ve)},[()=>n()("session.enemy_modal.name_placeholder"),()=>n()("session.enemy_modal.desc_placeholder")]),Ke(At,()=>a(_t).name,D=>a(_t).name=D),Ke(v,()=>a(_t).desc,D=>a(_t).desc=D),d(lt,It)});var ge=s(L,2);ge.__click=()=>_e(N.key);var pe=t(ge),Se=t(pe);ea(Se,{size:16}),e(pe);var ot=s(pe);e(ge),e(oe),e(W),p((lt,_t)=>{et(W,1,`p-4 bg-slate-900 rounded border ${N.border??""}`),et(je,1,`font-bold text-sm uppercase ${N.color??""}`),r(de,lt),r(ot,` ${_t??""}`)},[()=>n()("session.enemy_modal."+N.label),()=>n()("common.buttons.add")]),d(ne,W)}),e(U),d(C,U)},P=C=>{var U=St(),ne=qe(U);{var N=W=>{var X=Xi(),je=t(X);x(je),e(X),d(W,X)};f(ne,W=>{a(g)==="preview"&&W(N)},!0)}d(C,U)};f(Ae,C=>{a(g)==="abilities"?C(ht):C(P,!1)},!0)}d(ft,Et)};f(nt,ft=>{a(g)==="stats"?ft(Fe):ft(rt,!1)},!0)}d(H,Oe)};f(ie,H=>{a(g)==="general"?H(Le):H(E,!1)})}e(st);var Ce=s(st,2),fe=t(Ce);fe.__click=()=>o.onSave(a(i));var He=t(fe);Ja(He,{size:18});var Ie=s(He);e(fe),e(Ce),e(me);var ut=s(me,2),Xe=t(ut),Ye=t(Xe),kt=t(Ye);qa(kt,{size:14});var jt=s(kt);e(Ye),e(Xe);var Dt=s(Xe,2),Tt=t(Dt);x(Tt),e(Dt),e(ut),e(tt),e(Qe);var k=s(Qe,2);k.__change=We,vs(k,H=>y(ze,H),()=>a(ze));var R=s(k,2);is(R,{get isOpen(){return a(se)},get imageUrl(){return a(Pe)},onClose:()=>y(se,!1),onCrop:Ee}),p((H,Oe,nt,Fe,rt,ft,Et,Ae)=>{xe(Qe,"aria-label",H),r(Be,Oe),et(at,1,`flex-1 py-3 px-4 text-sm font-bold border-b-2 whitespace-nowrap transition-colors ${a(g)==="general"?"border-indigo-500 text-indigo-400 bg-slate-800":"border-transparent text-slate-500 hover:text-white"}`),r(Rt,nt),et(mt,1,`flex-1 py-3 px-4 text-sm font-bold border-b-2 whitespace-nowrap transition-colors ${a(g)==="stats"?"border-indigo-500 text-indigo-400 bg-slate-800":"border-transparent text-slate-500 hover:text-white"}`),r(re,Fe),et(be,1,`flex-1 py-3 px-4 text-sm font-bold border-b-2 whitespace-nowrap transition-colors ${a(g)==="abilities"?"border-indigo-500 text-indigo-400 bg-slate-800":"border-transparent text-slate-500 hover:text-white"}`),r(Ze,rt),et(Ue,1,`lg:hidden flex-1 py-3 px-4 text-sm font-bold border-b-2 whitespace-nowrap transition-colors ${a(g)==="preview"?"border-indigo-500 text-indigo-400 bg-slate-800":"border-transparent text-slate-500 hover:text-white"}`),r(vt,ft),r(Ie,` ${Et??""}`),r(jt,` ${Ae??""}`)},[()=>n()("session.enemy_modal.close"),()=>n()("session.enemy_modal.title"),()=>n()("session.enemy_modal.tab_general"),()=>n()("session.enemy_modal.tab_stats"),()=>n()("session.enemy_modal.tab_abilities"),()=>n()("session.enemy_modal.preview"),()=>n()("common.buttons.save"),()=>n()("session.enemy_modal.preview")]),Ia(3,tt,()=>Sa,()=>({y:20,duration:300})),Ia(3,Qe,()=>Sa,()=>({duration:200,opacity:1})),d($e,Re)};f(yt,$e=>{G()&&$e(Ut)})}d(V,Mt),ba(),J()}_a(["click","change"]);var en=u('<div class="flex justify-between items-center bg-slate-800 p-2 rounded border border-slate-700"><div class="flex-1"><div class="text-sm font-bold text-white"> </div> <div class="text-[10px] text-slate-400"> </div></div> <div class="flex items-center gap-2"><input type="number" min="1" class="w-12 bg-slate-900 border border-slate-600 rounded text-center text-white"/> <button class="text-red-400 hover:text-red-300"><!></button></div></div>'),tn=u('<div class="text-center text-slate-600 italic text-sm py-4"> </div>'),an=u('<div class="flex justify-between items-center bg-slate-950 p-2 rounded border border-slate-800 hover:border-indigo-500/30 transition-colors"><div><div class="text-sm font-bold text-white max-w-[120px] truncate"> </div> <div class="text-[10px] text-slate-500"> </div></div> <button class="text-indigo-400 hover:text-white p-1 bg-slate-900 rounded border border-slate-800"><!></button></div>'),sn=u('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/80 p-4" role="button" tabindex="-1"><div class="bg-slate-800 rounded-xl w-full max-w-2xl p-6 border border-slate-700 shadow-2xl flex flex-col max-h-[90vh]" role="dialog" aria-modal="true" aria-labelledby="encounter-modal-title"><div class="flex justify-between items-center mb-6"><h3 id="encounter-modal-title" class="text-xl font-bold text-white"> </h3> <button class="text-slate-400 hover:text-white"><!></button></div> <div class="space-y-4 mb-6"><div><label for="encounter-name" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="encounter-name" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white outline-hidden focus:border-indigo-500"/></div></div> <div class="flex-1 flex gap-4 min-h-0"><div class="flex-1 bg-slate-900 border border-slate-800 rounded-lg p-3 flex flex-col"><h4 class="text-xs text-slate-500 uppercase font-bold mb-2"> </h4> <div class="flex-1 overflow-y-auto space-y-2 custom-scrollbar"><!> <!></div></div> <div class="flex-1 bg-slate-900 border border-slate-800 rounded-lg p-3 flex flex-col"><h4 class="text-xs text-slate-500 uppercase font-bold mb-2"> </h4> <div class="flex-1 overflow-y-auto space-y-2 custom-scrollbar"></div></div></div> <div class="flex gap-3 mt-6 pt-4 border-t border-slate-700"><button class="flex-1 bg-slate-700 hover:bg-slate-600 text-white py-2 rounded font-bold"> </button> <button class="flex-1 bg-indigo-600 hover:bg-indigo-500 text-white py-2 rounded font-bold flex items-center justify-center gap-2"><!> </button></div></div></div>');function rn(V,o){ua(o,!0);const n=()=>Ft(ta,"$t",J),ue=()=>Ft(Fa,"$liveEnemies",J),[J,x]=pa();let G=Yt(o,"isOpen",3,!1),Z=Yt(o,"initialData",3,"{}"),i=bt(ca({name:"",enemies:[]}));Ra(()=>{if(G()&&Z())try{const _e=JSON.parse(Z());y(i,{name:_e.name||"",enemies:_e.enemies||[]},!0)}catch{y(i,{name:"",enemies:[]},!0)}});function g(_e){a(i).enemies.find(ye=>ye.enemyId===_e)?a(i).enemies=a(i).enemies.map(ye=>ye.enemyId===_e?{...ye,count:ye.count+1}:ye):a(i).enemies=[...a(i).enemies,{enemyId:_e,count:1}]}function se(_e){a(i).enemies=a(i).enemies.filter((De,ye)=>ye!==_e)}function Pe(_e,De){const ye=Math.max(1,parseInt(De)||1);a(i).enemies[_e].count=ye}function ze(_e){}var We=St(),Ee=qe(We);{var Me=_e=>{var De=sn();De.__click=ze;var ye=t(De),Mt=t(ye),yt=t(Mt),Ut=t(yt,!0);e(yt);var $e=s(yt,2);$e.__click=function(...E){o.onClose?.apply(this,E)};var Re=t($e);ma(Re,{size:20}),e($e),e(Mt);var Qe=s(Mt,2),tt=t(Qe),me=t(tt),Ne=t(me,!0);e(me);var ct=s(me,2);dt(ct),e(tt),e(Qe);var F=s(Qe,2),te=t(F),T=t(te),Be=t(T,!0);e(T);var Ve=s(T,2),it=t(Ve);Ge(it,17,()=>a(i).enemies,Ct,(E,Ce,fe)=>{const He=ke(()=>ue().find(H=>H.id===a(Ce).enemyId));var Ie=en(),ut=t(Ie),Xe=t(ut),Ye=t(Xe,!0);e(Xe);var kt=s(Xe,2),jt=t(kt);e(kt),e(ut);var Dt=s(ut,2),Tt=t(Dt);dt(Tt),Tt.__input=H=>Pe(fe,H.target.value);var k=s(Tt,2);k.__click=()=>se(fe);var R=t(k);aa(R,{size:16}),e(k),e(Dt),e(Ie),p(H=>{r(Ye,H),r(jt,`Dif ${(a(He)?a(He).difficulty:"?")??""}`),Pa(Tt,a(Ce).count)},[()=>a(He)?a(He).name:n()("session.encounter_modal.unknown")]),d(E,Ie)});var wt=s(it,2);{var at=E=>{var Ce=tn(),fe=t(Ce,!0);e(Ce),p(He=>r(fe,He),[()=>n()("session.encounter_modal.none_added")]),d(E,Ce)};f(wt,E=>{a(i).enemies.length===0&&E(at)})}e(Ve),e(te);var Rt=s(te,2),mt=t(Rt),re=t(mt,!0);e(mt);var be=s(mt,2);Ge(be,5,ue,E=>E.id,(E,Ce)=>{var fe=an(),He=t(fe),Ie=t(He),ut=t(Ie,!0);e(Ie);var Xe=s(Ie,2),Ye=t(Xe);e(Xe),e(He);var kt=s(He,2);kt.__click=()=>g(a(Ce).id);var jt=t(kt);ea(jt,{size:16}),e(kt),e(fe),p(()=>{r(ut,a(Ce).name),r(Ye,`Dif ${a(Ce).difficulty??""}`)}),d(E,fe)}),e(be),e(Rt),e(F);var Ze=s(F,2),Ue=t(Ze);Ue.__click=function(...E){o.onClose?.apply(this,E)};var vt=t(Ue,!0);e(Ue);var st=s(Ue,2);st.__click=()=>o.onSave(a(i));var ie=t(st);Ja(ie,{size:18});var Le=s(ie);e(st),e(Ze),e(ye),e(De),p((E,Ce,fe,He,Ie,ut,Xe,Ye)=>{xe(De,"aria-label",E),r(Ut,Ce),r(Ne,fe),xe(ct,"placeholder",He),r(Be,Ie),r(re,ut),r(vt,Xe),r(Le,` ${Ye??""}`)},[()=>n()("session.encounter_modal.close"),()=>n()("session.encounter_modal.title"),()=>n()("session.encounter_modal.name"),()=>n()("session.encounter_modal.name_placeholder"),()=>n()("session.encounter_modal.enemies_in_encounter"),()=>n()("session.encounter_modal.add_enemies"),()=>n()("common.buttons.cancel"),()=>n()("session.encounter_modal.save_encounter")]),Ke(ct,()=>a(i).name,E=>a(i).name=E),d(_e,De)};f(Ee,_e=>{G()&&_e(Me)})}d(V,We),ba(),x()}_a(["click","input"]);var nn=u('<div class="text-[10px] text-slate-400 flex items-center gap-1.5 bg-slate-950 p-1 px-1.5 rounded-lg border border-slate-800/50"><span class="text-indigo-400 font-black"> </span> <span class="font-medium truncate max-w-[80px]"> </span></div>'),on=u('<div class="text-[10px] text-slate-600 italic"> </div>'),ln=u('<div class="bg-slate-900 border border-slate-800 rounded-2xl p-4 transition-all hover:border-indigo-500/30 group relative flex flex-col justify-between shadow-lg hover:shadow-indigo-500/10" role="region"><div class="flex-1"><div class="flex items-center gap-2 mb-2"><div class="font-bold text-white text-base group-hover:text-indigo-400 transition-colors uppercase tracking-tight truncate"> </div> <!></div> <div class="flex flex-wrap gap-1"><!> <!></div></div> <div class="flex gap-2 mt-3 pt-3 border-t border-slate-800/50"><button class="flex-1 bg-indigo-600 hover:bg-indigo-500 text-white py-1.5 rounded-lg text-xs font-bold flex items-center justify-center gap-2 transition-all active:scale-95 shadow-lg shadow-indigo-900/20"><!> </button> <button class="p-1.5 text-slate-400 hover:text-white bg-slate-800/50 rounded-lg border border-slate-800 transition-all" title="Editar"><!></button> <button class="p-1.5 text-slate-400 hover:text-red-400 bg-slate-800/50 rounded-lg border border-slate-800 hover:border-red-900/30 transition-all"><!></button></div></div>'),dn=u('<button class="text-[10px] font-bold text-indigo-400 hover:text-indigo-300 mt-1 uppercase tracking-wider"> </button>'),vn=u('<div class="mb-4 flex-1"><p> </p> <!></div>'),cn=u('<div class="mb-4 flex-1 text-[10px] text-slate-600 italic"> </div>'),un=u('<div class="bg-slate-900 border border-slate-800 rounded-2xl p-5 hover:border-indigo-500/30 transition-all relative group cursor-move hover:shadow-lg hover:shadow-indigo-500/10 active:scale-[0.98] flex flex-col" draggable="true" role="listitem"><div class="flex justify-between items-start mb-3"><div class="flex items-center gap-2"><h3 class="font-bold text-lg text-white group-hover:text-indigo-400 transition-colors"> </h3> <!></div> <span class="text-[10px] font-black bg-indigo-500/10 text-indigo-400 border border-indigo-400/20 px-2 py-1 rounded-lg uppercase"> </span></div> <!> <div class="mt-auto flex gap-2 pt-4 border-t border-slate-800/50"><button class="flex-1 bg-slate-800/50 hover:bg-slate-800 text-white py-2 rounded-xl text-xs font-bold border border-slate-800 transition-all"> </button> <button class="bg-slate-800/50 hover:bg-red-900/20 text-slate-500 hover:text-red-400 px-3 rounded-xl border border-slate-800 hover:border-red-900/30 transition-all"><!></button></div></div>'),bn=u('<div class="text-center text-slate-500 italic col-span-3"> </div>'),_n=u('<div><div class="mb-12"><div class="flex justify-between items-center mb-6"><h3 class="text-sm font-black text-indigo-400 uppercase tracking-widest flex items-center gap-2"><!> </h3></div> <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"><button class="min-h-[120px] border-2 border-dashed border-slate-800 rounded-2xl flex flex-col items-center justify-center text-slate-500 hover:border-indigo-500 hover:text-indigo-400 transition-all hover:bg-indigo-500/5 gap-2 group"><!> <span class="font-bold text-sm"> </span></button> <!></div></div> <div class="mb-6"><h3 class="text-sm font-black text-indigo-400 uppercase tracking-widest flex items-center gap-2 mb-6"><!> </h3></div> <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"><button class="min-h-[180px] border-2 border-dashed border-slate-800 rounded-2xl flex flex-col items-center justify-center text-slate-500 hover:border-indigo-500 hover:text-indigo-400 transition-all hover:bg-indigo-500/5 gap-2 group"><!> <span class="font-bold text-sm"> </span></button> <!> <!></div> <!> <!> <!></div>');function pn(V,o){ua(o,!0);const n=()=>Ft(Fa,"$liveEnemies",x),ue=()=>Ft(es,"$liveEncounters",x),J=()=>Ft(ta,"$t",x),[x,G]=pa();let Z=bt(!1),i=bt(null),g=bt("{}"),se=bt(!1),Pe=bt(null),ze=bt("{}"),We=bt(ca({isOpen:!1,title:"",message:"",onConfirm:()=>{}}));function Ee(){return{name:"",difficulty:1,defense:10,health:10,damage:0,size:1,speed:10,description:"",senses:"",languages:"",immune:"",stats:{str:10,agi:10,int:10,wil:10},traits:[],actions:[],reactions:[],endOfRound:[]}}function Me(k=null){y(i,k?k.id:null,!0),k?y(g,JSON.stringify(k),!0):a(Ne)==="sofdl"?y(g,"{}"):y(g,JSON.stringify(Ee()),!0),y(Z,!0)}let _e=ca(new Set);function De(k){_e.has(k)?_e.delete(k):_e.add(k)}function ye(k){const R=a(i)||Oa(),H=Vt.get(o.campId);Va.set(R,{...k,id:R,campaignId:o.campId,system:H?.system||"sofww"}),y(Z,!1)}function Mt(k){const R=n().find(H=>H.id===k);y(We,{isOpen:!0,title:"Excluir Inimigo",message:`Tem certeza que deseja excluir permanentemente o inimigo "${R?.name||"este inimigo"}"?`,onConfirm:()=>{Va.delete(k),a(We).isOpen=!1}},!0)}function yt(k=null){y(Pe,k?k.id:null,!0),y(ze,JSON.stringify(k||{name:"",enemies:[]}),!0),y(se,!0)}function Ut(k){const R=a(Pe)||Oa();Aa.set(R,{...k,id:R,system:a(Ne)}),y(se,!1)}function $e(k){const R=ue().find(H=>H.id===k);y(We,{isOpen:!0,title:"Excluir Encontro",message:`Tem certeza que deseja excluir permanentemente o encontro "${R?.name||"este encontro"}"?`,onConfirm:()=>{Aa.delete(k),a(We).isOpen=!1}},!0)}function Re(k){const R=Vt.get(o.campId);if(!R)return;const H=R.activeEnemies||[];let Oe=[];k.enemies.forEach(nt=>{const Fe=n().find(rt=>rt.id===nt.enemyId);if(Fe)for(let rt=0;rt<nt.count;rt++)Oe.push({...Fe,instanceId:Oa(),damage:0,currentHealth:Fe.health,afflictions:[],acted:!1,initiative:!1})}),Vt.set(o.campId,{...R,activeEnemies:[...H,...Oe]})}function Qe(k,R){k.dataTransfer.setData("text/plain",R.id),k.dataTransfer.effectAllowed="copy"}function tt(k){return k.preventDefault(),!1}function me(k,R){k.preventDefault();const H=k.dataTransfer.getData("text/plain");if(!H)return;const Oe=R.enemies||[],nt=Oe.find(rt=>rt.enemyId===H);let Fe;nt?Fe=Oe.map(rt=>rt.enemyId===H?{...rt,count:rt.count+1}:rt):Fe=[...Oe,{enemyId:H,count:1}],Aa.set(R.id,{...R,enemies:Fe})}let Ne=ke(()=>Vt.get(o.campId)?.system||"sofww"),ct=ke(()=>n().filter(k=>{const H=(k.system||"sofww")===a(Ne),Oe=k.global===!0,nt=k.campaignId===o.campId;return H&&(Oe||nt)})),F=ke(()=>ue().filter(k=>{const H=(k.system||"sofww")===a(Ne),Oe=k.global===!0,nt=k.campaignId===o.campId;return H&&(Oe||nt)}));var te=_n(),T=t(te),Be=t(T),Ve=t(Be),it=t(Ve);La(it,{size:16});var wt=s(it);e(Ve),e(Be);var at=s(Be,2),Rt=t(at);Rt.__click=()=>yt();var mt=t(Rt);ea(mt,{size:28,class:"group-hover:scale-110 transition-transform"});var re=s(mt,2),be=t(re,!0);e(re),e(Rt);var Ze=s(Rt,2);Ge(Ze,17,()=>a(F),k=>k.id,(k,R)=>{var H=ln(),Oe=t(H),nt=t(Oe),Fe=t(nt),rt=t(Fe,!0);e(Fe);var ft=s(Fe,2);{var Et=L=>{da(L,{size:12,class:"text-indigo-400"})};f(ft,L=>{a(R).global&&L(Et)})}e(nt);var Ae=s(nt,2),ht=t(Ae);Ge(ht,17,()=>a(R).enemies||[],Ct,(L,ge)=>{const pe=ke(()=>n().find(It=>It.id===a(ge).enemyId));var Se=nn(),ot=t(Se),lt=t(ot);e(ot);var _t=s(ot,2),zt=t(_t,!0);e(_t),e(Se),p(()=>{r(lt,`${a(ge).count??""}x`),r(zt,a(pe)?a(pe).name:"...")}),d(L,Se)});var P=s(ht,2);{var C=L=>{var ge=on(),pe=t(ge,!0);e(ge),p(Se=>r(pe,Se),[()=>J()("session.bestiary.empty_encounter")]),d(L,ge)};f(P,L=>{a(R).enemies?.length||L(C)})}e(Ae),e(Oe);var U=s(Oe,2),ne=t(U);ne.__click=()=>Re(a(R));var N=t(ne);Ha(N,{size:12,fill:"currentColor"});var W=s(N);e(ne);var X=s(ne,2);X.__click=()=>yt(a(R));var je=t(X);As(je,{size:14}),e(X);var de=s(X,2);de.__click=()=>$e(a(R).id);var oe=t(de);aa(oe,{size:14}),e(de),e(U),e(H),p(L=>{xe(H,"aria-label",`Encontro ${a(R).name??""}`),r(rt,a(R).name),r(W,` ${L??""}`)},[()=>J()("session.bestiary.start")]),ha("dragover",H,tt),ha("drop",H,L=>me(L,a(R))),d(k,H)}),e(at),e(T);var Ue=s(T,2),vt=t(Ue),st=t(vt);ga(st,{size:16});var ie=s(st);e(vt),e(Ue);var Le=s(Ue,2),E=t(Le);E.__click=()=>Me();var Ce=t(E);ea(Ce,{size:32,class:"group-hover:scale-110 transition-transform"});var fe=s(Ce,2),He=t(fe,!0);e(fe),e(E);var Ie=s(E,2);Ge(Ie,17,()=>a(ct),k=>k.id,(k,R)=>{var H=un(),Oe=t(H),nt=t(Oe),Fe=t(nt),rt=t(Fe,!0);e(Fe);var ft=s(Fe,2);{var Et=de=>{da(de,{size:14,class:"text-indigo-400"})};f(ft,de=>{a(R).global&&de(Et)})}e(nt);var Ae=s(nt,2),ht=t(Ae);e(Ae),e(Oe);var P=s(Oe,2);{var C=de=>{var oe=vn(),L=t(oe),ge=t(L,!0);e(L);var pe=s(L,2);{var Se=ot=>{var lt=dn();lt.__click=()=>De(a(R).id);var _t=t(lt,!0);e(lt),p(zt=>r(_t,zt),[()=>_e.has(a(R).id)?J()("session.bestiary.see_less"):J()("session.bestiary.see_more")]),d(ot,lt)};f(pe,ot=>{a(R).description.length>120&&ot(Se)})}e(oe),p(ot=>{et(L,1,`text-xs text-slate-400 leading-relaxed ${ot??""}`),r(ge,a(R).description)},[()=>_e.has(a(R).id)?"":"line-clamp-3"]),d(de,oe)},U=de=>{var oe=cn(),L=t(oe,!0);e(oe),p(ge=>r(L,ge),[()=>J()("session.bestiary.no_description")]),d(de,oe)};f(P,de=>{a(R).description?de(C):de(U,!1)})}var ne=s(P,2),N=t(ne);N.__click=()=>Me(a(R));var W=t(N,!0);e(N);var X=s(N,2);X.__click=()=>Mt(a(R).id);var je=t(X);aa(je,{size:14}),e(X),e(ne),e(H),p((de,oe)=>{r(rt,a(R).name),r(ht,`${de??""} ${a(R).difficulty??""}`),r(W,oe)},[()=>J()("session.bestiary.level"),()=>J()("common.buttons.edit")]),ha("dragstart",H,de=>Qe(de,a(R))),d(k,H)});var ut=s(Ie,2);{var Xe=k=>{var R=bn(),H=t(R,!0);e(R),p(Oe=>r(H,Oe),[()=>J()("session.bestiary.no_enemies")]),d(k,R)};f(ut,k=>{a(ct).length===0&&k(Xe)})}e(Le);var Ye=s(Le,2);{var kt=k=>{Mi(k,{get isOpen(){return a(Z)},get initialData(){return a(g)},onClose:()=>y(Z,!1),onSave:ye})},jt=k=>{Ki(k,{get isOpen(){return a(Z)},get initialData(){return a(g)},onClose:()=>y(Z,!1),onSave:ye})};f(Ye,k=>{a(Ne)==="sofdl"?k(kt):k(jt,!1)})}var Dt=s(Ye,2);rn(Dt,{get isOpen(){return a(se)},get initialData(){return a(ze)},onClose:()=>y(se,!1),onSave:Ut});var Tt=s(Dt,2);Ka(Tt,{get isOpen(){return a(We).isOpen},get title(){return a(We).title},get message(){return a(We).message},get onConfirm(){return a(We).onConfirm},onCancel:()=>a(We).isOpen=!1}),e(te),p((k,R,H,Oe)=>{r(wt,` ${k??""}`),r(be,R),r(ie,` ${H??""}`),r(He,Oe)},[()=>J()("session.bestiary.encounters_title"),()=>J()("session.bestiary.new_encounter"),()=>J()("session.bestiary.title"),()=>J()("session.bestiary.new_enemy")]),d(V,te),ba(),G()}_a(["click"]);var xn=u('<div class="flex items-center gap-1 text-slate-400 ml-1"><!> <span class="text-xs"> </span></div>'),mn=u('<div class="flex items-center gap-1 text-emerald-400"><!> <span class="text-xs font-bold hidden sm:block"> </span></div> <!>',1),fn=u('<div class="flex items-center gap-1 text-slate-500"><!> <span class="text-xs hidden sm:block"> </span></div>'),gn=u('<span class="absolute -top-1 -right-1 flex h-3 w-3"><span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-red-400 opacity-75"></span> <span class="relative inline-flex rounded-full h-3 w-3 bg-red-500 border border-slate-900"></span></span>'),hn=u('<header class="bg-slate-900/80 backdrop-blur-md border-b border-white/5 sticky top-0 z-40 shadow-2xl"><div class="max-w-7xl mx-auto px-2 sm:px-4 py-4 sm:py-3"><div class="flex items-center justify-between gap-2 sm:gap-4"><div class="flex items-center gap-1 sm:gap-3 shrink-0"><button class="p-2 text-slate-400 hover:text-white hover:bg-white/5 rounded-full transition-all flex items-center gap-1 group"><!> <!></button> <div class="flex flex-col"><h1 class="text-base sm:text-lg font-black text-white leading-tight truncate max-w-[140px] sm:max-w-none"> </h1> <span class="text-xs text-indigo-400 font-mono font-black uppercase tracking-wider"> </span></div></div> <div class="hidden md:flex bg-slate-950/50 p-1 rounded-xl border border-white/5"><button><!> <span class="hidden min-[400px]:block"> </span></button> <button><!> <span class="hidden min-[400px]:block"> </span></button></div> <div class="flex items-center gap-1 sm:gap-2"><div class="flex items-center gap-2 mr-2 border-r border-white/10 pr-2"><!></div> <button class="p-2 sm:p-2.5 text-slate-400 hover:text-white hover:bg-white/5 rounded-lg transition-all"><!></button> <button class="p-2 sm:p-2.5 bg-indigo-600/10 text-indigo-400 border border-indigo-400/20 rounded-lg hover:bg-indigo-600 hover:text-white transition-all relative"><!> <!></button></div></div></div></header>');function yn(V,o){ua(o,!0);const n=()=>Ft(ta,"$t",G),ue=()=>Ft(fs,"$syncState",G),J=()=>Ft(ya,"$isHistoryOpen",G),x=()=>Ft(gs,"$hasUnreadRolls",G),[G,Z]=pa();let i=Yt(o,"campaignName",3,""),g=Yt(o,"gmName",3,"Mestre"),se=Yt(o,"activeSubTab",3,"session"),Pe=Yt(o,"onTabChange",3,()=>{}),ze=Yt(o,"onOpenSettings",3,()=>{});var We=hn(),Ee=t(We),Me=t(Ee),_e=t(Me),De=t(_e);De.__click=()=>Us(ss("/"));var ye=t(De);Na(ye,{size:20,class:"group-hover:-translate-x-0.5 transition-transform"});var Mt=s(ye,2);Is(Mt,{size:18,class:"hidden sm:block opacity-50"}),e(De);var yt=s(De,2),Ut=t(yt),$e=t(Ut,!0);e(Ut);var Re=s(Ut,2),Qe=t(Re,!0);e(Re),e(yt),e(_e);var tt=s(_e,2),me=t(tt);me.__click=()=>Pe()("session");var Ne=t(me);{let ie=ke(()=>se()==="session"?"opacity-100":"opacity-50");ls(Ne,{size:14,get class(){return a(ie)}})}var ct=s(Ne,2),F=t(ct,!0);e(ct),e(me);var te=s(me,2);te.__click=()=>Pe()("bestiary");var T=t(te);{let ie=ke(()=>se()==="bestiary"?"opacity-100":"opacity-50");cs(T,{size:14,get class(){return a(ie)}})}var Be=s(T,2),Ve=t(Be,!0);e(Be),e(te),e(tt);var it=s(tt,2),wt=t(it),at=t(wt);{var Rt=ie=>{var Le=mn(),E=qe(Le),Ce=t(E);as(Ce,{size:16});var fe=s(Ce,2),He=t(fe,!0);e(fe),e(E);var Ie=s(E,2);{var ut=Xe=>{var Ye=xn(),kt=t(Ye);ts(kt,{size:14});var jt=s(kt,2),Dt=t(jt,!0);e(jt),e(Ye),p(Tt=>{xe(Ye,"title",Tt),r(Dt,ue().peers.length)},[()=>n()("common.status.peers",{values:{count:ue().peers.length}})]),d(Xe,Ye)};f(Ie,Xe=>{ue().peers.length>0&&Xe(ut)})}p((Xe,Ye)=>{xe(E,"title",Xe),r(He,Ye)},[()=>n()("common.status.connected"),()=>n()("common.status.connected")]),d(ie,Le)},mt=ie=>{var Le=fn(),E=t(Le);Hs(E,{size:16});var Ce=s(E,2),fe=t(Ce,!0);e(Ce),e(Le),p((He,Ie)=>{xe(Le,"title",He),r(fe,Ie)},[()=>n()("common.status.offline"),()=>n()("common.status.offline")]),d(ie,Le)};f(at,ie=>{ue().isConnected?ie(Rt):ie(mt,!1)})}e(wt);var re=s(wt,2);re.__click=function(...ie){ze()?.apply(this,ie)};var be=t(re);Ts(be,{size:20}),e(re);var Ze=s(re,2);Ze.__click=()=>ya.update(ie=>!ie);var Ue=t(Ze);Ss(Ue,{size:20});var vt=s(Ue,2);{var st=ie=>{var Le=gn();d(ie,Le)};f(vt,ie=>{x()&&ie(st)})}e(Ze),e(it),e(Me),e(Ee),e(We),p((ie,Le,E,Ce,fe,He,Ie,ut)=>{xe(De,"aria-label",ie),xe(De,"title",Le),r($e,i()),r(Qe,g()),et(me,1,`flex items-center gap-2 px-3 sm:px-4 py-1.5 rounded-lg text-xs font-black transition-all ${se()==="session"?"bg-indigo-600 text-white shadow-lg shadow-indigo-500/20":"text-slate-500 hover:text-slate-300"}`),xe(me,"aria-pressed",se()==="session"),r(F,E),et(te,1,`flex items-center gap-2 px-3 sm:px-4 py-1.5 rounded-lg text-xs font-black transition-all ${se()==="bestiary"?"bg-indigo-600 text-white shadow-lg shadow-indigo-500/20":"text-slate-500 hover:text-slate-300"}`),xe(te,"aria-pressed",se()==="bestiary"),r(Ve,Ce),xe(re,"aria-label",fe),xe(re,"title",He),xe(Ze,"aria-label",Ie),xe(Ze,"title",ut),xe(Ze,"aria-pressed",J())},[()=>n()("character.header.back_dashboard"),()=>n()("character.header.back_dashboard"),()=>n()("common.labels.session"),()=>n()("common.labels.bestiary"),()=>n()("common.buttons.settings"),()=>n()("common.buttons.settings"),()=>n()("character.header.history"),()=>n()("character.header.history")]),d(V,We),ba(),Z()}_a(["click"]);var wn=u('<!> <!> <main class="max-w-7xl mx-auto p-4 md:p-8 animate-in slide-in-from-bottom-4 duration-500"><!></main>',1),kn=u('<div class="flex flex-col items-center justify-center min-h-screen p-4 text-center"><div class="w-20 h-20 bg-slate-800 rounded-full flex items-center justify-center mx-auto mb-6 text-slate-600"><svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-ghost"><path d="M9 10h.01"></path><path d="M15 10h.01"></path><path d="M12 2a8 8 0 0 0-8 8v12l3-3 2.5 2.5L12 19l2.5 2.5L17 19l3 3V10a8 8 0 0 0-8-8z"></path></svg></div> <h1 class="text-2xl font-black text-white mb-2 uppercase tracking-tight"> </h1> <p class="text-slate-400 mb-8 max-w-md"> </p> <button class="bg-indigo-600 hover:bg-indigo-500 text-white px-8 py-3 rounded-xl font-bold transition-all flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-arrow-left"><path d="m12 19-7-7 7-7"></path><path d="19 12H5"></path></svg> </button></div>'),zn=u('<div class="flex items-center justify-center min-h-screen"><div class="relative w-16 h-16"><div class="absolute inset-0 border-4 border-indigo-500/20 rounded-full"></div> <div class="absolute inset-0 border-4 border-indigo-500 border-t-transparent rounded-full animate-spin"></div></div></div>'),$n=u('<div class="fixed bottom-24 left-1/2 -translate-x-1/2 md:left-8 md:translate-x-0 z-[60] flex flex-col items-center gap-2"><div class="bg-slate-900/95 backdrop-blur-md border border-white/10 rounded-2xl p-2 flex items-center gap-2 shadow-2xl animate-in zoom-in-95 slide-in-from-bottom-4 duration-200"><button class="bg-indigo-600/20 hover:bg-indigo-600 text-indigo-400 hover:text-white font-bold w-12 h-12 rounded-xl flex flex-col items-center justify-center transition-all active:scale-95 shadow-lg border border-indigo-500/20"><span class="text-[10px] opacity-70">d20</span> <!></button> <button class="bg-slate-800 hover:bg-slate-700 text-white font-bold w-12 h-12 rounded-xl flex flex-col items-center justify-center transition-all active:scale-95 shadow-lg border border-white/5"><span class="text-[10px] opacity-70">1d6</span> <!></button> <button class="bg-slate-800 hover:bg-slate-700 text-white font-bold w-12 h-12 rounded-xl flex flex-col items-center justify-center transition-all active:scale-95 shadow-lg border border-white/5"><span class="text-[10px] opacity-70">2d6</span> <!></button> <button class="bg-slate-800 hover:bg-slate-700 text-white font-bold w-12 h-12 rounded-xl flex flex-col items-center justify-center transition-all active:scale-95 shadow-lg border border-white/5"><span class="text-[10px] opacity-70">3d6</span> <!></button> <div class="w-px h-8 bg-white/10 mx-1"></div> <button class="w-10 h-10 flex items-center justify-center text-slate-500 hover:text-white transition-colors"><!></button></div></div>  <div class="fixed inset-0 bg-black/40 z-[55]"></div>',1),Cn=u('<div class="min-h-screen bg-slate-950 text-slate-100 font-sans pb-20"><!> <!> <!> <div class="hidden md:block fixed bottom-8 left-8 z-[60]"><button class="w-16 h-16 bg-indigo-600 hover:bg-indigo-500 text-white rounded-full shadow-[0_0_20px_rgba(79,70,229,0.4)] flex items-center justify-center transition-all active:scale-90 border-2 border-white/10 group" title="Rolagens Rápidas"><!></button></div> <nav class="md:hidden fixed bottom-0 left-0 right-0 z-50 px-4 pb-6 pt-2 pointer-events-none"><div class="max-w-md mx-auto relative h-16 pointer-events-auto"><div class="absolute inset-0 bg-slate-900 border border-white/10 rounded-2xl shadow-2xl overflow-hidden"><div class="absolute inset-x-0 top-0 h-px bg-gradient-to-r from-transparent via-indigo-500/30 to-transparent"></div></div> <div class="relative h-full flex items-center justify-around px-2"><button><!> <span class="text-[9px] font-black uppercase tracking-widest leading-none">Sessão</span></button> <div class="relative w-16 h-16 -mt-10 flex items-center justify-center"><div class="absolute inset-0 bg-indigo-600/20 rounded-full blur-xl animate-pulse"></div> <button class="relative w-14 h-14 bg-indigo-600 rounded-full flex items-center justify-center shadow-[0_0_20px_rgba(79,70,229,0.5)] border-4 border-slate-900 transition-all active:scale-90 hover:bg-indigo-500 z-10" aria-label="Rolar Dados"><!></button></div> <button><!> <span class="text-[9px] font-black uppercase tracking-widest leading-none">Bestiário</span></button></div></div></nav> <!></div>');function Wn(V,o){ua(o,!0);const n=()=>Ft(ps,"$page",G),ue=()=>Ft(ws,"$liveCampaigns",G),J=()=>Ft(ta,"$t",G),x=()=>Ft(ya,"$isHistoryOpen",G),[G,Z]=pa();let i=bt("session"),g=bt(!1),se=ke(()=>n().params.id),Pe=ke(()=>ue().find(re=>re.id===a(se))),ze=ke(()=>!!a(Pe));function We(re){if(!a(se)||!a(Pe))return;const be={...a(Pe),...re};Vt.set(a(se),be),Ua(a(se),{name:be.name,gmName:be.gmName}),y(g,!1)}let Ee=bt(!1),Me=bt(ca({isOpen:!1,sides:20,count:1,modifier:0}));function _e(re,be=1){y(Me,{isOpen:!0,sides:re,count:be,modifier:0},!0)}function De(re){if(!a(Pe))return;const be=kr(a(Me).sides,a(Me).count,re);let Ze="";a(Me).count>1&&(Ze+=`Dados: [${be.results.join(", ")}] `),be.bonusRolls?.length>0&&(Ze+=`Bonus Rolls: [${be.bonusRolls.join(", ")}] -> ${Math.abs(be.modifierTotal)}`);const Ue=a(Pe).gmName||Ta(ta)("common.labels.master");hs.addToHistory({source:"GM",charName:Ue,name:`${a(Me).count}d${a(Me).sides} ${re?re>0?`+${re}`:re:""}`,description:Ze.trim()||null,total:be.total,formula:be.formula,crit:be.crit}),ya.set(!0),a(Me).isOpen=!1}var ye=Cn(),Mt=t(ye);{var yt=re=>{var be=wn(),Ze=qe(be);yn(Ze,{get campaignName(){return a(Pe).name},get gmName(){return a(Pe).gmName},get activeSubTab(){return a(i)},onTabChange:E=>y(i,E,!0),onOpenSettings:()=>y(g,!0)});var Ue=s(Ze,2);{let E=ke(()=>JSON.stringify(a(Pe)));Ps(Ue,{get isOpen(){return a(g)},get initialData(){return a(E)},onClose:()=>y(g,!1),onSave:We})}var vt=s(Ue,2),st=t(vt);{var ie=E=>{ii(E,{get campaign(){return a(Pe)}})},Le=E=>{var Ce=St(),fe=qe(Ce);{var He=Ie=>{pn(Ie,{get campId(){return a(se)}})};f(fe,Ie=>{a(i)==="bestiary"&&Ie(He)},!0)}d(E,Ce)};f(st,E=>{a(i)==="session"?E(ie):E(Le,!1)})}e(vt),d(re,be)},Ut=re=>{var be=St(),Ze=qe(be);{var Ue=st=>{var ie=kn(),Le=s(t(ie),2),E=t(Le,!0);e(Le);var Ce=s(Le,2),fe=t(Ce,!0);e(Ce);var He=s(Ce,2);He.__click=()=>window.history.back();var Ie=s(t(He));e(He),e(ie),p((ut,Xe,Ye)=>{r(E,ut),r(fe,Xe),r(Ie,` ${Ye??""}`)},[()=>J()("campaign.not_found.title"),()=>J()("campaign.not_found.message"),()=>J()("common.buttons.back")]),d(st,ie)},vt=st=>{var ie=zn();d(st,ie)};f(Ze,st=>{a(ze)&&!a(Pe)?st(Ue):st(vt,!1)},!0)}d(re,be)};f(Mt,re=>{a(ze)&&a(Pe)?re(yt):re(Ut,!1)})}var $e=s(Mt,2);rs($e,{get isOpen(){return x()},onClose:()=>ya.set(!1)});var Re=s($e,2);{var Qe=re=>{var be=$n(),Ze=qe(be),Ue=t(Ze),vt=t(Ue);vt.__click=()=>{_e(20),y(Ee,!1)};var st=s(t(vt),2);ka(st,{size:16}),e(vt);var ie=s(vt,2);ie.__click=()=>{_e(6),y(Ee,!1)};var Le=s(t(ie),2);ka(Le,{size:16}),e(ie);var E=s(ie,2);E.__click=()=>{_e(6,2),y(Ee,!1)};var Ce=s(t(E),2);ka(Ce,{size:16}),e(E);var fe=s(E,2);fe.__click=()=>{_e(6,3),y(Ee,!1)};var He=s(t(fe),2);ka(He,{size:16}),e(fe);var Ie=s(fe,4);Ie.__click=()=>y(Ee,!1);var ut=t(Ie);ma(ut,{size:20}),e(Ie),e(Ue),e(Ze);var Xe=s(Ze,2);Xe.__click=()=>y(Ee,!1),d(re,be)};f(Re,re=>{a(Ee)&&re(Qe)})}var tt=s(Re,2),me=t(tt);me.__click=()=>y(Ee,!a(Ee));var Ne=t(me);ka(Ne,{size:32,class:"group-hover:rotate-12 transition-transform"}),e(me),e(tt);var ct=s(tt,2),F=t(ct),te=s(t(F),2),T=t(te);T.__click=()=>{y(i,"session"),y(Ee,!1)};var Be=t(T);{let re=ke(()=>a(i)==="session"?"animate-in zoom-in-75 duration-300":"");ls(Be,{size:20,get class(){return a(re)}})}va(2),e(T);var Ve=s(T,2),it=s(t(Ve),2);it.__click=()=>y(Ee,!a(Ee));var wt=t(it);{let re=ke(()=>a(Ee)?"rotate-90":"rotate-0");ka(wt,{size:28,get class(){return`text-white ${a(re)??""} transition-transform duration-300`}})}e(it),e(Ve);var at=s(Ve,2);at.__click=()=>{y(i,"bestiary"),y(Ee,!1)};var Rt=t(at);{let re=ke(()=>a(i)==="bestiary"?"animate-in zoom-in-75 duration-300":"");cs(Rt,{size:20,get class(){return a(re)}})}va(2),e(at),e(te),e(F),e(ct);var mt=s(ct,2);{let re=ke(()=>`${J()("session.quick.roll_title")} (${a(Me).count}d${a(Me).sides})`),be=ke(()=>a(Me).sides===20?J()("session.quick.boons_banes"):J()("session.quick.fixed_modifier"));Rs(mt,{get isOpen(){return a(Me).isOpen},get title(){return a(re)},get label(){return a(be)},onClose:()=>a(Me).isOpen=!1,onRoll:De,initialModifier:0})}e(ye),p(()=>{et(T,1,`flex flex-col items-center justify-center gap-1 flex-1 transition-all ${a(i)==="session"?"text-indigo-400":"text-slate-500 hover:text-slate-300"}`),et(at,1,`flex flex-col items-center justify-center gap-1 flex-1 transition-all ${a(i)==="bestiary"?"text-indigo-400":"text-slate-500 hover:text-slate-300"}`)}),d(V,ye),ba(),Z()}_a(["click"]);export{Wn as component};
