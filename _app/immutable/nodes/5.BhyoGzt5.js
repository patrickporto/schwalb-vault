const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["../chunks/DpieVsxQ.js","../chunks/BkhWOpPj.js","../chunks/CqLQNChA.js","../chunks/CPHStP6i.js"])))=>i.map(i=>d[i]);
import{a as G,s as Ee,_ as Me}from"../chunks/CPHStP6i.js";import"../chunks/DsnmJJEf.js";import{d as ze,o as Ae,s as x}from"../chunks/CqLQNChA.js";import{d as le,e as q,a as l,p as Pe,f as p,l as o,s as n,t as I,k as Oe,o as c,j as a,G as h,H as N,w as i,n as E,I as Ge}from"../chunks/BkhWOpPj.js";import{e as Ve,s as oe,i as Be,r as De}from"../chunks/Am2pCLS3.js";import{l as He,s as Re,i as f}from"../chunks/DbalZYyT.js";import{c as Se,a as Te,i as Je,b as Le}from"../chunks/DpieVsxQ.js";import{p as Ue}from"../chunks/DzkggBSF.js";import{C as We,l as qe}from"../chunks/CbAYYRpU.js";import{g as ie}from"../chunks/hqda9HG3.js";import{U as Fe,r as ne,W as Ke}from"../chunks/Byzf0FCw.js";import{v as Qe}from"../chunks/BYmFNSF7.js";import{C as Xe}from"../chunks/DLp-uDZ5.js";import"../chunks/D9IBKMOw.js";import{I as Ye,s as Ze}from"../chunks/CUvy-rMn.js";function de(V,M){const B=He(M,["children","$$slots","$$events","$$legacy"]);const w=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3"}],["path",{d:"M12 9v4"}],["path",{d:"M12 17h.01"}]];Ye(V,Re({name:"triangle-alert"},()=>B,{get iconNode(){return w},children:(g,F)=>{var b=le(),D=q(b);Ze(D,M,"default",{}),l(g,b)},$$slots:{default:!0}}))}var ea=p('<span class="block text-xs mt-1 uppercase tracking-widest text-slate-500 font-black"> </span>'),aa=p('<div class="mt-4 px-3 py-1 bg-amber-500/10 border border-amber-500/20 rounded-full text-[10px] text-amber-500 font-bold uppercase tracking-wider animate-pulse flex items-center gap-2"><!> Aguardando o Mestre ficar online...</div>'),ta=p('<div class="mb-6 bg-red-500/10 border border-red-500/20 rounded-xl p-3 flex items-center gap-3"><!> <p class="text-red-400 text-sm font-bold"> </p></div>'),ra=p('<p class="text-red-400 text-xs mt-1">Senha incorreta.</p>'),sa=p('<div class="mb-6 bg-slate-950/50 p-4 rounded-xl border border-slate-800"><label for="campaign-pwd-input" class="block text-xs font-bold text-slate-500 uppercase tracking-widest mb-2 flex items-center gap-2"><div class="w-2 h-2 rounded-full bg-indigo-500 animate-pulse"></div> Senha Necessária</label> <input id="campaign-pwd-input" type="password" placeholder="Digite a senha da campanha..."/> <!></div>'),oa=p('<button><div class="w-8 h-8 rounded-full bg-slate-800 flex items-center justify-center text-xs font-bold"> </div> <div class="flex-1 text-left"><div class="font-bold text-sm"> </div> <div class="text-[10px] opacity-60"> </div></div> <!></button>'),ia=p("<div>Nenhum personagem encontrado.</div> <div>Crie um personagem primeiro!</div>",1),na=p('<div class="flex flex-col items-center gap-2"><!> <div class="text-amber-500 font-bold">Todos os seus personagens já estão em campanhas.</div> <div class="text-xs text-slate-500">Crie um novo personagem ou saia de uma campanha existente.</div></div>'),da=p('<div class="text-center py-8 text-slate-600 italic text-sm space-y-2"><!></div>'),la=p('<div class="w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"></div> Validando...',1),ca=p('<div class="w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"></div> Carregando...',1),va=p('<div class="min-h-screen bg-slate-950 flex items-center justify-center p-4"><div class="max-w-md w-full bg-slate-900 border border-slate-800 rounded-2xl p-8 shadow-2xl"><div class="flex flex-col items-center text-center mb-8"><div class="w-16 h-16 bg-indigo-600/20 rounded-full flex items-center justify-center text-indigo-400 mb-4 border border-indigo-500/30"><!></div> <h1 class="text-2xl font-bold text-white mb-2">Convite para Campanha</h1> <p class="text-slate-400">Você foi convidado para participar de <span class="text-indigo-400 font-bold"> </span> <!></p> <!></div> <!> <!> <div class="space-y-4 mb-8"><label for="char-selector" class="block text-xs font-bold text-slate-500 uppercase tracking-widest mb-2">Escolha seu Personagem</label> <div id="char-selector" class="space-y-2 max-h-60 overflow-y-auto custom-scrollbar pr-2"><!> <!></div></div> <div class="flex gap-3"><button class="flex-1 py-3 rounded-xl bg-slate-800 hover:bg-slate-700 text-white font-bold transition-all">Recusar</button> <button class="flex-1 py-3 rounded-xl bg-indigo-600 hover:bg-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed text-white font-bold transition-all shadow-lg shadow-indigo-900/20 flex items-center justify-center gap-2"><!></button></div></div></div> <!>',1);function Ia(V,M){Pe(M,!0);const B=()=>G(Ue,"$page",b),w=()=>G(Se,"$character",b),g=()=>G(qe,"$liveCharacters",b),F=()=>G(Je,"$isGmOnline",b),[b,D]=Ee(),$=B().params.id;let y=N(()=>w().campaignName||"Buscando campanha..."),H=N(()=>w().gmName||"..."),z=N(()=>w().passwordHash),K=N(()=>g().filter(t=>!t.campaignId)),m=h(null),A=h(!1),C=h(""),k=h(!1),P=h(!1),_=h("");Ae(()=>{$&&Te($,!1)});async function ce(){if(c(_,""),!a(m)||!$)return;if(g().find(e=>e.id===a(m))?.campaignId){c(_,"Este personagem já está em uma campanha!");return}if(a(z)){if(!a(C)){c(k,!0);return}c(P,!0);const e=await Qe(a(C),a(z));if(c(P,!1),!e){c(k,!0);return}}c(k,!1),c(A,!0)}function ve(){if(!a(m)||!$)return;const t=g().find(e=>e.id===a(m));if(t){if(t.campaignId){c(_,"Este personagem já está em uma campanha!"),c(A,!1);return}Me(async()=>{const{charactersMap:e}=await import("../chunks/DpieVsxQ.js").then(r=>r.S);return{charactersMap:e}},__vite__mapDeps([0,1,2,3]),import.meta.url).then(({charactersMap:e})=>{e.set(a(m),{...t,campaignId:$,campaignName:a(y),gmName:a(H),campaignApproval:"pending"}),ie(ne("/characters/[id]",{id:a(m)}))})}}var Q=va(),R=q(Q),X=o(R),S=o(X),T=o(S),pe=o(T);Fe(pe,{size:32}),i(T);var J=n(T,4),L=n(o(J)),me=o(L,!0);i(L);var fe=n(L,2);{var ue=t=>{var e=ea(),r=o(e);i(e),I(()=>x(r,`Mestre: ${a(H)??""}`)),l(t,e)};f(fe,t=>{a(H)!=="..."&&t(ue)})}i(J);var ge=n(J,2);{var be=t=>{var e=aa(),r=o(e);Ke(r,{size:12}),E(),i(e),l(t,e)};f(ge,t=>{F()||t(be)})}i(S);var Y=n(S,2);{var _e=t=>{var e=ta(),r=o(e);de(r,{size:20,class:"text-red-500 mb-0.5"});var v=n(r,2),u=o(v,!0);i(v),i(e),I(()=>x(u,a(_))),l(t,e)};f(Y,t=>{a(_)&&t(_e)})}var Z=n(Y,2);{var xe=t=>{var e=sa(),r=n(o(e),2);De(r);var v=n(r,2);{var u=s=>{var d=ra();l(s,d)};f(v,s=>{a(k)&&s(u)})}i(e),I(()=>oe(r,1,`w-full bg-slate-900 border ${a(k)?"border-red-500":"border-slate-700"} rounded-lg p-3 text-white outline-none focus:border-indigo-500 transition-colors`)),Le(r,()=>a(C),s=>c(C,s)),l(t,e)};f(Z,t=>{a(z)&&t(xe)})}var U=n(Z,2),ee=n(o(U),2),ae=o(ee);Ve(ae,17,()=>a(K),Be,(t,e)=>{var r=oa();r.__click=()=>{c(m,a(e).id,!0),c(_,"")};var v=o(r),u=o(v,!0);i(v);var s=n(v,2),d=o(s),W=o(d,!0);i(d);var se=n(d,2),je=o(se);i(se),i(s);var Ie=n(s,2);{var Ne=j=>{Xe(j,{size:16,class:"text-indigo-400"})};f(Ie,j=>{a(m)===a(e).id&&j(Ne)})}i(r),I(j=>{oe(r,1,`w-full flex items-center gap-3 p-3 rounded-xl border transition-all ${a(m)===a(e).id?"bg-indigo-600/20 border-indigo-500 text-white":"bg-slate-950 border-slate-800 text-slate-400 hover:border-slate-700"}`),x(u,j),x(W,a(e).name),x(je,`Lvl ${a(e).level??""} • ${a(e).ancestry??""}`)},[()=>a(e).name.charAt(0)]),l(t,r)});var he=n(ae,2);{var we=t=>{var e=da(),r=o(e);{var v=s=>{var d=ia();E(2),l(s,d)},u=s=>{var d=na(),W=o(d);de(W,{size:24,class:"text-amber-500"}),E(4),i(d),l(s,d)};f(r,s=>{g().length===0?s(v):s(u,!1)})}i(e),l(t,e)};f(he,t=>{a(K).length===0&&t(we)})}i(ee),i(U);var te=n(U,2),re=o(te);re.__click=()=>ie(ne("/"));var O=n(re,2);O.__click=ce;var $e=o(O);{var ye=t=>{var e=la();E(),l(t,e)},Ce=t=>{var e=le(),r=q(e);{var v=s=>{var d=ca();E(),l(s,d)},u=s=>{var d=Ge("Aceitar Convite");l(s,d)};f(r,s=>{a(y)==="Buscando campanha..."?s(v):s(u,!1)},!0)}l(t,e)};f($e,t=>{a(P)?t(ye):t(Ce,!1)})}i(O),i(te),i(X),i(R);var ke=n(R,2);{let t=N(()=>`Deseja entrar na campanha "${a(y)}" com o personagem "${g().find(e=>e.id===a(m))?.name}"?`);We(ke,{get isOpen(){return a(A)},title:"Confirmar Participação",get message(){return a(t)},onConfirm:ve,onCancel:()=>c(A,!1)})}I(()=>{x(me,a(y)),O.disabled=!a(m)||a(P)||!!a(z)&&!a(C)||a(y)==="Buscando campanha..."}),l(V,Q),Oe(),D()}ze(["click"]);export{Ia as component};
